[["index.html", "R for Data Journalism About", " R for Data Journalism HSIEH, JI-LUNG 2022-05-26 About é€™æœ¬æ›¸æ˜¯å¯«çµ¦è‡ºå¤§æ–°èæ‰€ã€Œæ–°èè³‡æ–™åˆ†æèˆ‡è¦–è¦ºåŒ–ã€èª²ç¨‹ä½¿ç”¨ã€‚è©²èª²ç¨‹ä¸¦é‡ä¸‰å€‹é¢å‘çš„è¨“ç·´ï¼šç¨‹å¼èªè¨€ã€è¦–è¦ºåŒ–ã€è³‡æ–™æ–°èã€‚å­¸ç”Ÿå¿…é ˆå…ˆèƒ½å¤ ç†Ÿç·´åœ°ä½¿ç”¨Rèªè¨€ä¾†æ“ä½œã€è®€å–ã€æ¸…ç†ã€è¦–è¦ºåŒ–è³‡æ–™ï¼›ç„¶å¾Œä»¥ç”¢è£½æ–°èç‚ºèª²ç¨‹ç›®æ¨™ï¼Œäº†è§£è³‡æ–™è¦å¦‚ä½•æ¸…ç†ï¼Œä»¥åŠé¸æ“‡é©åˆçš„è¦–è¦ºåŒ–çš„æ–¹æ³•ä¾†å¼·åŒ–æ–°èæ•˜äº‹ï¼Œä¸¦é¿å…è¦–è¦ºåŒ–æ–¹å¼å¼•èµ·è®€è€…å°æ–°èçš„ç†è§£è¬¬èª¤ã€‚æº–æ­¤ï¼Œæœ¬æ›¸åˆ†ç‚ºå¹¾å€‹éƒ¨åˆ†ï¼ŒåŒ…å«PART Iä»‹ç´¹ç¨‹å¼èªè¨€åŸºç¤ï¼›PART IIå‰‡ä»¥åœ‹éš›æˆ–åœ‹å…§æ–°èç‚ºå€‹æ¡ˆï¼Œä¾†ä»‹ç´¹è³‡æ–™ç²å–ï¼ˆçˆ¬èŸ²ï¼‰ã€æ¸…ç†ã€åˆä½µã€ç¯©é¸ã€è½‰æ›ï¼›PART IIIå‰‡è‘—é‡å¦‚ä½•ç”¨è³‡æ–™è¦–è¦ºåŒ–ä¾†å¼·åŒ–æ•˜äº‹ã€‚ æœ¬æ›¸æ‰€æ²¿ç”¨çš„è³‡æ–™åˆ†æèˆ‡è¦–è¦ºåŒ–æ¡ˆä¾‹å‡ç‚ºåœ‹å…§ã€åœ‹å¤–çš„æ–°èæ¡ˆä¾‹å¦‚å„åœ‹ç”¢å‡æ”¯è–ªç­‰ç´šã€å±…ä½æ­£ç¾©ã€ç©ºæ°£æ±¡æŸ“ã€äººå£è­°é¡Œã€COVID-19ã€è³‡æºå€åŸŸåˆ†ä½ˆä¸å‡ã€é¸èˆ‰èˆ‡å…¬æŠ•ã€é‹è¼¸äº¤é€šç­‰ç›¸é—œè­°é¡Œçš„æ–°èã€‚ä¸¦å¤§é‡æ¡ç”¨ç´ç´„æ™‚å ±æŒ‘é¸ä½œç‚ºæ•¸æ“šç†è§£èˆ‡è¦–è¦ºåŒ–æ¨å»£çš„ã€ŒWhatâ€™s going on in this graph?ã€ç³»åˆ—æ–°èï¼ŒåŒ…å«ç¾åœ‹ä¸åŒå¹´ä»£å„å¹´é½¡å±¤çš„æ·¨è³‡ç”¢ä¾†åšè¦–è¦ºåŒ–æ¡ˆä¾‹ã€‚åœ¨è¦–è¦ºåŒ–æ•™æçš„è¨­è¨ˆä¸Šï¼Œæœ¬æ›¸å¤§é‡åƒè€ƒç´æ™‚ã€ŒWhatâ€™s going on in this graph?ã€çš„åˆ†é¡èˆ‡(Wilke 2019)æ‰€è‘—ã€ŒFundamentals of Data Visualizationã€ä¸€æ›¸çš„å…§å®¹å®‰æ’ï¼Œå¼·èª¿åˆ©ç”¨è³‡æ–™è¦–è¦ºåŒ–æ–¹æ³•ä¾†å‘ˆç¾æ–°èæ•¸æ“šä¸­çš„æ•¸é‡ã€åˆ†ä½ˆã€æ¯”ä¾‹ã€è¶¨å‹¢ç­‰ï¼Œä¸¦å‡æ›ç”¨åœ‹å…§æˆ–ç´æ™‚çš„ç›¸é—œè³‡æ–™æ–°èæ¡ˆä¾‹åšç¯„ä¾‹ï¼Œä»¥åˆ©ä¸­æ–‡è®€è€…çš„ç†è§£ã€‚ å­¸ç¿’è·¯å¾‘ References "],["introduction.html", "Chapter 1 Introduction", " Chapter 1 Introduction "],["basic.html", "Chapter 2 Rèªè¨€åŸºç¤", " Chapter 2 Rèªè¨€åŸºç¤ æœ¬ç« ç¯€å°‡ä»‹ç´¹å¦‚ä½•ä½¿ç”¨RStudioä¾†åŸ·è¡ŒRèªè¨€çš„æŒ‡ä»¤ã€‚ä¸¦ç°¡å–®ä»‹ç´¹Rèªè¨€çš„åŸºç¤æ“ä½œï¼Œä¸¦ä»‹ç´¹vectorèˆ‡data.frameå…©å€‹åŸºç¤è³‡æ–™å‹æ…‹ã€‚ "],["ä½¿ç”¨rstudio.html", "2.1 ä½¿ç”¨RStudio", " 2.1 ä½¿ç”¨RStudio Using Cmd+Enter (Ctrl+Enter in Window) to excute the line where your cursor is located. Using Cmd(Ctrl)+Shift+Enter to run all code in a cell Using mouse to select multiple lines, then Cmd(Ctrl)+Shift+c to comment/uncomment multiple lines. a &lt;- c(1, 2, 3, 4, 5) b &lt;- 4 a*b ## [1] 4 8 12 16 20 2.1.1 æ’å…¥æ–°çš„ç¨‹å¼å€ Using Cmd(Ctrl)+Option(Alt)+i to insert a new cell 2.1.2 å®‰è£èˆ‡è¼‰å…¥å¥—ä»¶ å¥—ä»¶çš„ä½¿ç”¨åˆ†ç‚ºå®‰è£(install.packages(\"pkg_name\"))å’Œè¼‰å…¥ï¼ˆlibrary(pkg_name)ï¼‰å…©å€‹å‹•ä½œã€‚é€šå¸¸å®‰è£å¥½Rçš„æ™‚å€™å°±å·²ç¶“å®‰è£å¥½åŸºæœ¬baseå¥—ä»¶ã€‚ç•¶åŸ·è¡ŒRæ™‚ä¾¿æœƒå°‡baseå¥—ä»¶é è¼‰å…¥ç¨‹å¼çš„åŸ·è¡Œç’°å¢ƒä¸­ã€‚ éå¸¸å¤šçš„Rä½¿ç”¨è€…æœƒç·¨å¯«ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼Œä¸¦ä¸”å°‡é€™äº›å¥—ä»¶é–‹æ”¾çµ¦ç¾¤çœ¾ä½¿ç”¨ã€‚é€šå¸¸é€™äº›å¥—ä»¶å·²ç¶“è¢«ä¸Šè¼‰åˆ°R cranæä¾›ä¸‹è¼‰ã€‚è€ŒR cranä¸Šçš„å¥—ä»¶æˆ‘å€‘å¯ä»¥ä½¿ç”¨install.packages(\"package_name\")ä¾†è‡ªå‹•å®‰è£åˆ°æˆ‘å€‘çš„é›»è…¦ä¸­ã€‚ Practice 1. å˜—è©¦å®‰è£ä¸‹åˆ—å‡½å¼åº«ï¼ˆå¥—ä»¶ï¼‰ã€‚ 2.1.3 è¼‰å…¥æ‰€å®‰è£çš„ç¬¬ä¸‰æ–¹å¥—ä»¶ é€™äº›ç¬¬ä¸‰æ–¹å¥—ä»¶è¢«å®‰è£å¥½å¾Œï¼Œé‚„éœ€è¦è¢«åŠ è¼‰åˆ°ç¨‹å¼çš„åŸ·è¡Œç’°å¢ƒä¸­æ‰å¯ä»¥ä½¿ç”¨ã€‚å› æ­¤è¦ç”¨library(package_name)å°‡å…¶è¼‰å…¥ã€‚ library(tidyverse) library(jsonlite) library(httr) 2.1.4 è¨»è§£ ä¸‹åˆ—ç¨‹å¼ç¢¼ä¸­é–‹é ­æœ‰#ç¬¦è™Ÿè€…ç‚ºè¨»è§£ï¼Œç¨‹å¼åœ¨åŸ·è¡Œæ™‚æœƒè‡ªå‹•å¿½ç•¥å‰é¢æœ‰#ç¬¦è™Ÿçš„ç¨‹å¼ç¢¼ã€‚ # a &lt;- c(1, 2, 3, 4, 5) # b &lt;- 4 # a*b "],["ç¬¬ä¸€æ¬¡è³‡æ–™å˜—è©¦.html", "2.2 ç¬¬ä¸€æ¬¡è³‡æ–™å˜—è©¦", " 2.2 ç¬¬ä¸€æ¬¡è³‡æ–™å˜—è©¦ 2.2.1 è¼‰å…¥dcardé é¢è³‡æ–™ å…ˆä¸è¦å»ç®¡ä»¥ä¸‹ç¨‹å¼ç¢¼å¦‚fromJSON(content(GET(url), \"text\"))æ˜¯ä»€éº¼æ„æ€ï¼Œå…ˆè‘—é‡åœ¨èªè¨€çš„å½¢å¼ã€‚é€šå¸¸ä¸€å€‹å‡½å¼æœƒå¯«ç‚ºfunc_name()ï¼Œæ‰€ä»¥ä¸Šè¿°å…¶å¯¦æ˜¯ä¸‰å€‹å‡½å¼ç”±å…§è€Œå¤–ä¸€å±¤å¥—ä¸€å±¤ï¼Œå¾æœ€å…§å±¤é–‹å§‹å¾€å¤–åšã€‚é€™å…¶å¯¦å¾ˆã€Œmake-senseã€ï¼Œå› ç‚ºå¦‚æœä½ æœ‰ä¸€å€‹æ•¸å­¸å¼(1 + (3-3)/2)/8ï¼Œä¹Ÿæ˜¯æœƒå¾æœ€è£¡é¢é‚£å±¤åšå‡ºä¾†ã€‚ library(jsonlite) library(httr) url &lt;- &quot;https://www.dcard.tw/_api/forums/relationship/posts?popular=true&quot; res &lt;- fromJSON(content(GET(url), &quot;text&quot;)) # View(res) dplyr::glimpse(res) ## Rows: 30 ## Columns: 52 ## $ id &lt;int&gt; 235931948, 238975096, 238978653, 238975895, 23897â€¦ ## $ title &lt;chr&gt; &quot;#å…¬å‘Š é—œæ–¼æ„Ÿæƒ…æ¿çš„å¾®è¥¿æ–¯å…§å®¹&quot;, &quot;ç”·å‹é€±å¹´ç´€å¿µå¸¶æˆ‘â€¦ ## $ excerpt &lt;chr&gt; &quot;å„ä½å¡å‹å€‘å¥½ï¼Œå°å¤©ä½¿è¿‘æœŸæ”¶åˆ°è¨±å¤šé—œæ–¼æ„Ÿæƒ…æ¿è¥¿æ–¯å…§â€¦ ## $ anonymousSchool &lt;lgl&gt; FALSE, FALSE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUEâ€¦ ## $ anonymousDepartment &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, Tâ€¦ ## $ pinned &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, Fâ€¦ ## $ forumId &lt;chr&gt; &quot;42851318-b9e2-4a75-8a05-9fe180becefe&quot;, &quot;42851318â€¦ ## $ replyId &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ createdAt &lt;chr&gt; &quot;2021-05-07T06:11:32.413Z&quot;, &quot;2022-05-24T06:04:28.â€¦ ## $ updatedAt &lt;chr&gt; &quot;2021-05-07T18:00:24.726Z&quot;, &quot;2022-05-25T09:33:12.â€¦ ## $ commentCount &lt;int&gt; 36, 141, 922, 106, 35, 256, 168, 112, 82, 112, 45â€¦ ## $ likeCount &lt;int&gt; 324, 3203, 1615, 659, 628, 602, 568, 290, 263, 26â€¦ ## $ withNickname &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, Fâ€¦ ## $ tags &lt;list&gt; &quot;HIDE_THUMBNAIL&quot;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &quot;HIDE_THUMBNAIL&quot;, â€¦ ## $ topics &lt;list&gt; &lt;&gt;, &lt;&gt;, &lt;&quot;ç”·å‹&quot;, &quot;å…„å¼Ÿ&quot;, &quot;å°è©±&quot;&gt;, &lt;&quot;æ„Ÿæƒ…&quot;, &quot;æ„›æƒ…â€¦ ## $ meta &lt;df[,3]&gt; &lt;data.frame[26 x 3]&gt; ## $ forumName &lt;chr&gt; &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;â€¦ ## $ forumAlias &lt;chr&gt; &quot;relationship&quot;, &quot;relationship&quot;, &quot;relationship&quot;, &quot;â€¦ ## $ nsfw &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ gender &lt;chr&gt; &quot;D&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;,â€¦ ## $ school &lt;chr&gt; &quot;å®¢æœå°å¤©ä½¿&quot;, &quot;è¼”ä»å¤§å­¸&quot;, NA, NA, &quot;åœ‹ç«‹è‡ºåŒ—å¤§å­¸&quot;,â€¦ ## $ department &lt;chr&gt; &quot;dcard_support_1&quot;, NA, NA, NA, NA, NA, NA, NA, NAâ€¦ ## $ replyTitle &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ mediaMeta &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[8 x 11]&gt;], [&lt;â€¦ ## $ reactions &lt;list&gt; [&lt;data.frame[4 x 2]&gt;], [&lt;data.frame[4 x 2]&gt;], [&lt;â€¦ ## $ hidden &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,â€¦ ## $ customStyle &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ isSuspiciousAccount &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ isModerator &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ layout &lt;chr&gt; &quot;classic&quot;, &quot;classic&quot;, &quot;classic&quot;, &quot;classic&quot;, &quot;clasâ€¦ ## $ pinnedType &lt;chr&gt; &quot;dcard&quot;, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦ ## $ pinnedPriority &lt;dbl&gt; 1.620368e+12, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦ ## $ spoilerAlert &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ categories &lt;list&gt; &quot;å…¬å‘Š&quot;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;â€¦ ## $ isSelectedPost &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,â€¦ ## $ unsafe &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ totalCommentCount &lt;int&gt; 36, 243, 1148, 166, 52, 614, 415, 159, 157, 394, â€¦ ## $ withImages &lt;lgl&gt; FALSE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSâ€¦ ## $ withVideos &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ media &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[7 x 1]&gt;], [&lt;dâ€¦ ## $ reportReasonText &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, â€¦ ## $ supportedReactions &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ excerptComments &lt;list&gt; [], [], [], [], [], [], [], [], [], [], [], [], [â€¦ ## $ edited &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,â€¦ ## $ collectionCount &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0â€¦ ## $ postAvatar &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;â€¦ ## $ activityAvatar &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;â€¦ ## $ verifiedBadge &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, Fâ€¦ ## $ memberType &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;â€¦ ## $ hiddenOnPlatforms &lt;list&gt; &lt;NULL&gt;, &lt;&quot;android-x&quot;, &quot;android&quot;, &quot;ios&quot;, &quot;web&quot;&gt;, &lt;â€¦ ## $ enablePrivateMessage &lt;lgl&gt; NA, FALSE, NA, NA, NA, NA, FALSE, NA, NA, FALSE,â€¦ ## $ enableNestedComment &lt;lgl&gt; NA, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUâ€¦ head(res) %&gt;% select(id, title, excerpt) id title excerpt 235931948 #å…¬å‘Š é—œæ–¼æ„Ÿæƒ…æ¿çš„å¾®è¥¿æ–¯å…§å®¹ å„ä½å¡å‹å€‘å¥½ï¼Œå°å¤©ä½¿è¿‘æœŸæ”¶åˆ°è¨±å¤šé—œæ–¼æ„Ÿæƒ…æ¿è¥¿æ–¯å…§å®¹çš„æª¢èˆ‰ä»¥åŠç›¸é—œè©¢å•ï¼Œæˆ‘å€‘äº†è§£æ„Ÿæƒ…æ¿æ˜¯ç‚ºè¨è«–æƒ…æ„Ÿé—œä¿‚æ‰€è¨­ç«‹ï¼Œè€Œã€Œæ€§ã€ä¹Ÿæ˜¯æ„Ÿæƒ…ä¸­çš„ä¸€éƒ¨ä»½ï¼Œå› æ­¤ä¸æœƒç¦æ­¢è¨è«–é€™äº›å…§å®¹ã€‚ä½†æœ‰éƒ¨åˆ†æ–‡ç« å…§å®¹æè¿°éæ–¼éœ²éª¨ï¼Œæˆ–æ˜¯é™¤äº† 238975096 ç”·å‹é€±å¹´ç´€å¿µå¸¶æˆ‘ä¾†é£¯åº—ğŸ™ˆ #æ›´ï¼Œå„ä½ï½ çœŸçš„å…ˆèªªè²å°ä¸èµ·ï¼Œè®“å¤§å®¶èª¤æœƒå–é…’å¾Œæœ‰æ²’æœ‰é¨è»Šé€™ä»¶äº‹ï¼Œæˆ‘å·²ç¶“æœ‰æŠŠå›è¦†ç•™åœ¨ B13ï¼Œç„¶å¾ŒåŒæ­¥è£œå……èªªæ˜ï¼Œè»Šæ˜¯æˆ‘é¨çš„ï¼ï¼ï¼ï¼ï¼ï¼Œæˆ‘é¨æˆ‘ç”·å‹çš„è»Šï¼Œç„¶å¾Œè¼‰æˆ‘ç”·å‹å›å»æ‹¿å…§è¡£è¤²çš„ï¼Œæ‹è¬ï½ç¬¬ä¸€æ¬¡poæ–‡ï¼Œé‚ 238978653 å¯ä»¥æ¥å—ç”·å‹è·Ÿå…„å¼Ÿä¹‹é–“é€™æ¨£çš„å°è©±å—ï¼Ÿ ç”·å‹è¢«æˆ‘çœ‹åˆ°é€™æ®µå°è©±ï¼Œä»–æ—©ä¸Šä¸‹è·ªé“æ­‰ï¼Œè·Ÿæˆ‘èªªç”·ç”Ÿè·Ÿå…„å¼Ÿä¹‹é–“å˜´ç ²è€Œå·²ï¼Œä»–æ²’æƒ³éé€™æ¨£å°æˆ‘ï¼Œèªªé‚„æ²’å¹¹è†©ä¹Ÿæ˜¯æƒ³å˜´è´æœ‹å‹è€Œå·²ï¼Œå¦³å€‘èƒ½æ¥å—å—ï¼Ÿé¡˜æ„ç›¸ä¿¡/æ¥å—å—ï¼Ÿä»–ä¸‹è·ªé‚„è‡ªå·±æ‹å½±ç‰‡ å‚³çµ¦æˆ‘ï¼Œè·Ÿæˆ‘èªªå¦‚æœæˆ‘ä¸çˆ½å¯ä»¥çµ¦åˆ¥ 238975895 å¥³å‹è®“æˆ‘å¥½è‡ªå‘ ä»Šå¤©æˆ‘åˆè·Ÿå¥³å‹é„­é‡èªªäº†ä¸€æ¬¡ï¼Œå› ç‚ºæˆ‘å€‘å¾äº¤å¾€ä»¥ä¾†ï¼Œéƒ½2ã€3å€‹æœˆæ‰ä¸€æ¬¡ï¼ˆæœ‰æ™‚å€™ç”šè‡³æ²’æœ‰ï¼Œæ¯æ¬¡éƒ½é‚„æ˜¯æˆ‘å—ä¸äº†ä¸»å‹•è¦æ±‚å¥¹çš„ï¼Œè€Œä¸”å¥¹æ¯ä¸€æ¬¡éƒ½åƒä¸€æ¢æ­»é­šä¸€æ¨£ï¼Œä¹…äº†æˆ‘å£“åŠ›ä¹Ÿå¤§åˆ°è‡¨ç•Œé»äº†ï¼Œä»Šå¤©æºé€šçš„çµæœå¥¹ç«Ÿç„¶ç›´æ¥èªªå¥¹ 238975402 å› ç‚ºä¸€ç‰‡è­·å¢Šå·®é»geté–ƒå…‰ï¼Ÿ ä¸Šæ˜ŸæœŸçª©åœ¨åœ–æ›¸é¤¨çš„æ™‚ä¾¯ï¼Œæœˆç¶“çªç„¶ä¾†äº†ï¼Œä½†é‚„å¥½æˆ‘æœ‰å¢Šè­·å¢Šæ‰€ä»¥æ²’æœ‰é‡€æˆè¡€ç½å¥³ç”Ÿæ‡‰è©²éƒ½å¾ˆæ‡‚å¤–æ¼çš„éº»ç…©à² _à² ï¼Œå°±åœ¨æˆ‘å»å®Œå»æ‰€å›åˆ°ä½å­æº–å‚™æ•´ç†æ±è¥¿å›å®¶ï¼Œç™¼ç¾æ¡Œä¸Šå¤šäº†ä¸€ç‰‡è­·å¢Šï¼Œè€Œä¸”å°±æ˜¯æˆ‘ç¾åœ¨ç”¨çš„ï¼ï¼ï¼Œå¿ƒè£¡oså¥‡æ€ª 238978299 æˆ‘æœ‰ä¸€å€‹8ï¼‹9ç”·å‹ æˆ‘çš„ç”·æœ‹å‹æ˜¯æœ‰é»ç‰¹åˆ¥çš„é‚£ç¨®8ï¼‹9ï¼Œä»–æˆç¸¾ä¸éŒ¯æ˜¯æœƒç‚ºäº†è‡ªå·±æœªä¾†åŠªåŠ›çš„äººï¼Œå¹³å¸¸ä¹Ÿå¾ˆé¡§å®¶æœƒåœ¨å¦¹å¦¹ä¸Šä¸‹èª²ï¼Œå°æ„Ÿæƒ…ä¹Ÿå¾ˆå¿ èª ï¼Œä¸æœƒè·Ÿå…¶ä»–å¥³ç”Ÿææ›–æ˜§ï¼Œä½†æ˜¯ä»–çš„åœ¨å­¸æ ¡å¤–çš„è¡Œç‚ºï¼Œå°±è·Ÿå¤§å®¶å£ä¸­æ‰€è¬‚çš„çŒ´å­ä¸€æ¨£ï¼Œé™¤äº†å¤œåº—æ¯’å“ 2.2.2 è®€å–å°åŒ—ä½å®…ç«Šç›œé»ä½è³‡æ–™ Go to data.taipei Make a query â€œä½å®…ç«Šç›œâ€ Open â€œä½å®…ç«Šç›œé»ä½è³‡è¨Šâ€ Click â€œAPIâ€ Copy the API address and assign to url 2.2.3 è®€å–å…ˆè¡Œä¸‹è¼‰çš„csvæª” df &lt;- read.csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) head(df) ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ 2.2.4 ç›´æ¥å¾ç¶²è·¯è¼‰å…¥å…§æ”¿éƒ¨é–‹æ”¾è³‡æ–™ library(httr) library(jsonlite) url &lt;- &quot;https://www.ris.gov.tw/rs-opendata/api/v1/datastore/ODRP024/107?page=1&quot; first_page &lt;- fromJSON(content(GET(url), &quot;text&quot;)) head(first_page$responseData) %&gt;% rename(æˆ¶é•·=headhousehold_count) statistic_yyy district_code site_id village edu sex æˆ¶é•· 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ åšç•¢ ç”· 3 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ ç¢©ç•¢ ç”· 26 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ å¤§ç•¢ ç”· 71 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ å°ˆç•¢ ç”· 52 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ é«˜ä¸­ç•¢ ç”· 122 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ åœ‹ä¸­ç•¢ ç”· 40 2.2.5 ç²å–ubikeå³æ™‚è³‡æ–™ https://taipeicity.github.io/traffic_realtime/ url &lt;- &quot;https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json&quot; ubike.list &lt;- fromJSON(content(GET(url),&quot;text&quot;, encoding = &quot;utf-8&quot;)) ubike.v &lt;- unlist(ubike.list$retVal) ubike.m &lt;- matrix(ubike.v, byrow = T, ncol = 14) ubike.df &lt;- as.data.frame(ubike.m) names(ubike.df) &lt;- names(ubike.list$retVal$`0001`) head(ubike.df) %&gt;% select(1:6) sno sna tot sbi sarea mday 0001 æ·é‹å¸‚æ”¿åºœç«™(3è™Ÿå‡ºå£) 88 42 ä¿¡ç¾©å€ 20220526003329 0002 æ·é‹åœ‹çˆ¶ç´€å¿µé¤¨ç«™(2è™Ÿå‡ºå£) 16 8 å¤§å®‰å€ 20220526003316 0004 å¸‚æ°‘å»£å ´ 32 27 ä¿¡ç¾©å€ 20220526003343 0005 èˆˆé›…åœ‹ä¸­ 32 15 ä¿¡ç¾©å€ 20220526003332 0006 è‡ºåŒ—å—å±±å»£å ´ 54 17 ä¿¡ç¾©å€ 20220526003318 0007 ä¿¡ç¾©å»£å ´(å°åŒ—101) 80 47 ä¿¡ç¾©å€ 20220526003321 "],["å…¶ä»–ç’°å¢ƒè¨­å®š.html", "2.3 å…¶ä»–ç’°å¢ƒè¨­å®š", " 2.3 å…¶ä»–ç’°å¢ƒè¨­å®š 2.3.1 ç·¨ç¢¼èˆ‡è¨­å®šèªç³» Sys.setlocale(category = &quot;LC_ALL&quot;, locale = &quot;UTF-8&quot;) Sys.setlocale(category = &quot;LC_ALL&quot;, locale = &quot;cht&quot;) å¦‚æœè®€å–åˆ°è³‡æ–™æœ‰ä¸­æ–‡çš„è©±ï¼Œå¯èƒ½æœƒçœ‹åˆ°ä»¥ä¸‹çš„æƒ…å½¢ã€‚æ­¤æ™‚ï¼Œä½ åªéœ€è¦æŒ‡å®šlocaleç‚ºchtï¼Œç„¶å¾Œé‡é–‹è©²data.frameå°±å¯ä»¥è§£æ±ºè©²å•é¡Œã€‚ Sys.setlocale(category = &quot;LC_ALL&quot;, locale = &quot;cht&quot;) ä½†ä½ åœ¨å¯«ç¨‹å¼å‰–æHTMLæ™‚è‹¥ä½¿ç”¨äº†rvesté€™å€‹å¥—ä»¶ï¼Œæœ‰å¯èƒ½åœ¨html_node()å‡½å¼æ™‚æœƒå› ç‚ºç·¨ç¢¼è€Œç”¢ç”Ÿå•é¡Œï¼Œæ­¤æ™‚ä½ æœƒéœ€è¦æŠŠlocaleæ”¹ç‚ºCã€‚é€™å€‹CæŒ‡çš„æ˜¯Cèªè¨€çš„Cã€‚ Sys.setlocale(category = &quot;LC_ALL&quot;, locale = &quot;C&quot;) åƒè€ƒé€£çµï¼šhttp://psmethods.postach.io/post/ru-he-geng-gai-rde-yu-she-yu-xi åƒè€ƒé€£çµï¼šhttps://stat.ethz.ch/R-manual/R-devel/library/base/html/locales.html The locale describes aspects of the internationalization of a program. Initially most aspects of the locale of R are set to â€œCâ€ (which is the default for the C language and reflects North-American usage) 2.3.2 RMD/R Notebookç„¡æ³•å„²å­˜ R Notebook è¦å­˜æª”çš„æ™‚å€™æª”åçµ•å°ä¸è¦æœ‰ç©ºç™½ï¼Œè‹¥æœ‰ç©ºç™½å°±ç”¨åº•ç·š_ä»£æ›¿ï¼Œå¦å‰‡Notebookå¯«åˆ°ä¸€åŠæœƒç„¡æ³•é è¦½ä¸‹åŠéƒ¨çš„ç¨‹å¼ä¸¦å‡ºç¾éŒ¯èª¤è¨Šæ¯ã€‚è‹¥ä»ç„¶ç„¡æ³•å„²å­˜æˆ–å‡ºç¾éŒ¯èª¤è¨Šæ¯ï¼Œæ‡‰è©²åªè¦é–‹å¦å¤–ä¸€å€‹R Notebookæª”æ¡ˆï¼Œè¤‡è£½ç¨‹å¼ç¢¼å³å¯ã€‚ "],["vectors.html", "Chapter 3 Vectors ", " Chapter 3 Vectors "],["r-syntax.html", "3.1 R Syntax", " 3.1 R Syntax 3.1.1 Assignment &lt;- å°‡å³é‚Šçš„ç®—å¼æˆ–æ•¸å€¼æŒ‡æ´¾çµ¦å·¦é‚Šçš„è®Šæ•¸ã€‚å³é‚Šå¦‚æœæ˜¯numericï¼Œé‚£å·¦é‚Šçš„è®Šæ•¸å°±æ˜¯numeric variableï¼›å³é‚Šå¦‚æœæ˜¯characterï¼Œå·¦é‚Šçš„è®Šæ•¸å°±æ˜¯character variableã€‚ åœ¨å¹¾ä¹æ‰€æœ‰ç¨‹å¼èªè¨€ä¸­ï¼Œå–®ç­‰è™Ÿ=æŒ‡çš„æ˜¯assignmentï¼ŒæŠŠå³æ–¹çš„ç®—å¼ã€å€¼æˆ–ç‰©ä»¶æŒ‡çµ¦å·¦æ–¹çš„è®Šæ•¸ã€‚è€Œæ¯”è¼ƒå…©è€…ç›¸ä¸ç›¸ç­‰ï¼Œå‰‡ç”¨é›™ç­‰è™Ÿ==ï¼Œä¾‹å¦‚1==3-2ã€‚ a &lt;- 1 b &lt;- c(1, 2, 3, 4) c &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;) d &lt;- c(b, a) e &lt;- &quot;abcd&quot; 3.1.2 comments è¨»è§£ è¨»è§£ï¼šåœ¨ç¨‹å¼ç¢¼å€å¡Šè‹¥å‰é¢æœ‰#å­—è™Ÿå¾Œé¢è·Ÿè‘—ç©ºç™½çš„è©±ï¼Œé‚£ä»£è¡¨é‚£è¡Œè¢«æ¨™ç¤ºç‚ºè¨»è§£ï¼Œç¨‹å¼åŸ·è¡Œæ™‚æœƒè‡ªå‹•è·³éè¨»è§£ä¸åŸ·è¡Œã€‚ å¿«é€Ÿéµï¼šç•¶æ¸¸æ¨™åœ¨æŸä¸€è¡Œç¨‹å¼ç¢¼æ™‚æ‰“cmd(ctrl)-shift-cï¼Œå°±å¯ä»¥ç”¢ç”Ÿè¨»è§£ã€‚ # df &lt;- data.frame(a = c(1, 2, 3), b = c(3, 4, 5)) "],["basic-operations.html", "3.2 Basic operations", " 3.2 Basic operations å„ç¸£å¸‚å¹³å‡æ¯æœˆè–ªè³‡æ‰€å¾— å„ç¸£å¸‚äººå£æ•¸ 3.2.1 Creating åœ¨ç¨‹å¼ç¢¼ä¸­ï¼Œåªè¦æ˜¯æ–‡å­—å¿…ç”¨æˆå°çš„é›™å¼•è™Ÿæˆ–å–®å¼•è™ŸåŒ…å«å…¶ä¸­ï¼Œä»¥å€éš”ã€Œè®Šæ•¸ã€å’Œã€Œæ•¸å­—ã€ã€‚ä¾‹å¦‚å¦‚æœçœ‹åˆ°æ²’æœ‰é›™å¼•è™Ÿçš„ã€Œè‹±æ–‡å­—æ¯ã€å¿…å®šæ˜¯è®Šæ•¸åç¨±ï¼Œæˆ–å‡½å¼åç¨±ã€‚ å¦‚æœçœ‹åˆ°æœ‰é›™å¼•è™Ÿçš„æ•¸å­—ï¼Œé‚£ä¹Ÿæ˜¯æ–‡å­—ã€‚ income &lt;- c(70100, 51300, 51100, 48400, 47600, 43000) county &lt;- c(&quot;å°åŒ—&quot;, &quot;æ–°åŒ—&quot;, &quot;æ¡ƒåœ’&quot;, &quot;é«˜é›„&quot;, &quot;å°ä¸­&quot;, &quot;å°å—&quot;) population &lt;- c(2.6, 3.9, 2.2, 2.7, 2.8, 1.8) area &lt;- c(271.8, 2052.5, 1221, 2951.9, 2214.9, 2191.7) income ## [1] 70100 51300 51100 48400 47600 43000 county[c(5, 3, 1)] ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; county &lt;- county[c(5, 3, 1)] county ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; area ## [1] 271.8 2052.5 1221.0 2951.9 2214.9 2191.7 population ## [1] 2.6 3.9 2.2 2.7 2.8 1.8 3.2.1.1 Creating a sequence a &lt;- seq(11, 99, 11) a ## [1] 11 22 33 44 55 66 77 88 99 b &lt;- 11:20 b ## [1] 11 12 13 14 15 16 17 18 19 20 3.2.1.2 Creating sequences by distribution x &lt;- runif(10000000, 1, 10) # uniform dist, n=1000 plot(density(x)) x &lt;- rnorm(1000, 1, 10) # uniform dist, n=1000 plot(density(x)) x &lt;- rnorm(10000000, 1, 10) # normal dist, n=1000 plot(density(x)) 3.2.2 Viewing county ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; income ## [1] 70100 51300 51100 48400 47600 43000 head(county) ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; tail(county) ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; length(county) ## [1] 3 mode(county) ## [1] &quot;character&quot; class(county) ## [1] &quot;character&quot; # View(county) length(county) ## [1] 3 length(income) ## [1] 6 3.2.3 Subsetting, filtering It is important to know how to neglect first n or last n elements. For example, a[1:(length(a)-2)] will neglect the last two elements. Thinking why I need parentheses for length(a)-2 here. county ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; county[c(5, 3, 1)] # how about country[c(1, 3, 5)] ## [1] NA &quot;å°åŒ—&quot; &quot;å°ä¸­&quot; county[3:6] # is it equal to country[c(3, 4, 5, 6)] ## [1] &quot;å°åŒ—&quot; NA NA NA a &lt;- 11:19 a[3:length(a)] ## [1] 13 14 15 16 17 18 19 a[length(a):3] ## [1] 19 18 17 16 15 14 13 3.2.4 Deleting Without assignment, deletion wonâ€™t change original vectors b &lt;- 11:20 b[-(3:5)] ## [1] 11 12 16 17 18 19 20 b[-c(1, 3, 5)] ## [1] 12 14 16 17 18 19 20 b ## [1] 11 12 13 14 15 16 17 18 19 20 Correct deleting operations with assignment to replace original vector b &lt;- b[-(3:5)] b ## [1] 11 12 16 17 18 19 20 a &lt;- seq(11, 99, 11) a &lt;- a[-c(1, 3, 5)] a ## [1] 22 44 66 77 88 99 3.2.5 Concatinating Concatinating is quite useful for web crawling when you crawl article links page by page. You may be not sure the number of page you need to crawl. So you need to append entire new vector to old vector. It is concatinating. (â€œAppendingâ€ often means adding one new element at the end of data.) a &lt;- 1:10 a &lt;- c(a, 11) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 b ## [1] 11 12 16 17 18 19 20 a &lt;- c(a, b) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 11 12 16 17 18 19 20 a &lt;- c(a, a, b) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 11 12 16 17 18 19 20 1 2 3 4 5 6 7 ## [26] 8 9 10 11 11 12 16 17 18 19 20 11 12 16 17 18 19 20 "],["calculating-with-vectors.html", "3.3 Calculating with vectors", " 3.3 Calculating with vectors 3.3.1 Arithmetic operations a &lt;- 11:19 a + 3 ## [1] 14 15 16 17 18 19 20 21 22 a / 2 ## [1] 5.5 6.0 6.5 7.0 7.5 8.0 8.5 9.0 9.5 a %% 2 ## [1] 1 0 1 0 1 0 1 0 1 a %/% 2 ## [1] 5 6 6 7 7 8 8 9 9 a %% 2== 0 ## [1] FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE FALSE which(a %% 2== 0) ## [1] 2 4 6 8 a[which(a%% 2 == 0)] ## [1] 12 14 16 18 a[c(2, 4, 6, 8)] ## [1] 12 14 16 18 a %% 2 != 0 ## [1] TRUE FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE a[a%% 2 == 0] ## [1] 12 14 16 18 a[a%%2 != 0] ## [1] 11 13 15 17 19 a &lt;- a %% 2 # modular arithmetic, get the reminder a &lt;- a %/% 2 # Quotient 3.3.2 Logic comparisons a %% 2 == 0 # deteting odd/even number ## [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE a %% 2 != 0 ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE a[a%%2==0] ## [1] 0 0 0 0 0 0 0 0 0 a &gt; b ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE income &gt; mean(income) ## [1] TRUE FALSE FALSE FALSE FALSE FALSE TRUE == T # == equal to, ## [1] TRUE TRUE != F # != Not equal to ## [1] TRUE any(a&gt;11) # is there any element larger than 1 ## [1] FALSE all(a&gt;11) # are all elements larger than 1 ## [1] FALSE 3.3.3 Subsetting by logic comparisons two methods to filter data from vectors, by index vector or a logical vector with equal length. a &lt;- seq(11, 55, 11) a[c(T, F, T, F, T)] ## [1] 11 33 55 a[a%%2==1] ## [1] 11 33 55 a%%2 ## [1] 1 0 1 0 1 a%%2==1 ## [1] TRUE FALSE TRUE FALSE TRUE a &lt;- c(&quot;ä½ å¥½&quot;,&quot;ä½ å¥½æ£’æ£’&quot;,&quot;ä½ å¥½æ£’&quot;,&quot;ä½ çœŸçš„å¥½æ£’&quot;) a[nchar(a)&gt;3] ## [1] &quot;ä½ å¥½æ£’æ£’&quot; &quot;ä½ çœŸçš„å¥½æ£’&quot; # which will return &quot;index-of&quot; a &lt;- seq(11, 55, 11) a[which(a%%2==1)] ## [1] 11 33 55 which(a%%2==1) ## [1] 1 3 5 3.3.4 Sorting and ordering sort(x)çš„çµæœå¿…é ˆç”¨&lt;-è¦†è“‹åŸæœ¬çš„xï¼Œæ­¤æ™‚çš„xæ‰ç®—è¢«æ’åºçš„çµæœã€‚ order(x)å‡½å¼æœƒå‚³å›xæ•¸å€¼ç”±å°åˆ°å¤§çš„ç´¢å¼•ã€‚é€™å€‹ä¾‹å­çš„çµæœæ˜¯5, 4, 3, 6, 1, 2ï¼Œä¹Ÿå°±æ˜¯5ä½ç½®çš„é‚£å€‹æ•¸æœ€å°ã€4é‚£å€‹ä½ç½®çš„æ•¸æ¬¡å°ã€æ¥ä¸‹ä¾†3, 6, 1, 2ã€‚ x[order(x)]æŠŠorder(x)çµæœï¼ˆä¹Ÿå°±æ˜¯c(5, 4, 3, 6, 1, 2)ï¼‰å‚³çµ¦åŸæœ¬çš„xä¾¿æœƒä½¿å¾—åŸæœ¬çš„xé‡æ–°æ’åºã€‚é€šå¸¸order()çš„ç”¨é€”æ˜¯ï¼Œæˆ‘å€‘å¯ä»¥å°‡å…©å€‹ç­‰é•·çš„variablesä¾‹å¦‚var1å’Œvar2ï¼Œä¾æ“švar2ä¾†é‡æ–°æ’åºvar1ï¼Œä¾‹å¦‚var1[order(var2)]ã€‚ x &lt;- c(33, 55, 22, 13, 4, 24) mode(x) ## [1] &quot;numeric&quot; class(x) ## [1] &quot;numeric&quot; sort(x) ## [1] 4 13 22 24 33 55 # x &lt;- sort(x) # assign to replace original x order(x) ## [1] 5 4 3 6 1 2 x[order(x)] ## [1] 4 13 22 24 33 55 x[c(5, 4, 3, 6, 1, 2)] ## [1] 4 13 22 24 33 55 3.3.5 Built-in math functions a &lt;- 11:19 min(a); max(a); mean(a); median(a); sd(a) ## [1] 11 ## [1] 19 ## [1] 15 ## [1] 15 ## [1] 2.738613 log2(a) ## [1] 3.459432 3.584963 3.700440 3.807355 3.906891 4.000000 4.087463 4.169925 ## [9] 4.247928 log1p(a) ## [1] 2.484907 2.564949 2.639057 2.708050 2.772589 2.833213 2.890372 2.944439 ## [9] 2.995732 ?log1p log R Documentation Logarithms and Exponentials Description log computes logarithms, by default natural logarithms, log10 computes common (i.e., base 10) logarithms, and log2 computes binary (i.e., base 2) logarithms. The general form log(x, base) computes logarithms with base base. log1p(x) computes log(1+x) accurately also for |x| &lt;&lt; 1. exp computes the exponential function. expm1(x) computes exp(x) - 1 accurately also for |x| &lt;&lt; 1. Usage log(x, base = exp(1)) logb(x, base = exp(1)) log10(x) log2(x) log1p(x) exp(x) expm1(x) Arguments x a numeric or complex vector. base a positive or complex number: the base with respect to which logarithms are computed. Defaults to e=exp(1). Details All except logb are generic functions: methods can be defined for them individually or via the Math group generic. log10 and log2 are only convenience wrappers, but logs to bases 10 and 2 (whether computed via log or the wrappers) will be computed more efficiently and accurately where supported by the OS. Methods can be set for them individually (and otherwise methods for log will be used). logb is a wrapper for log for compatibility with S. If (S3 or S4) methods are set for log they will be dispatched. Do not set S4 methods on logb itself. All except log are primitive functions. Value A vector of the same length as x containing the transformed values. log(0) gives -Inf, and log(x) for negative values of x is NaN. exp(-Inf) is 0. For complex inputs to the log functions, the value is a complex number with imaginary part in the range [-pi, pi]: which end of the range is used might be platform-specific. S4 methods exp, expm1, log, log10, log2 and log1p are S4 generic and are members of the Math group generic. Note that this means that the S4 generic for log has a signature with only one argument, x, but that base can be passed to methods (but will not be used for method selection). On the other hand, if you only set a method for the Math group generic then base argument of log will be ignored for your class. Source log1p and expm1 may be taken from the operating system, but if not available there then they are based on the Fortran subroutine dlnrel by W. Fullerton of Los Alamos Scientific Laboratory (see https://www.netlib.org/slatec/fnlib/dlnrel.f) and (for small x) a single Newton step for the solution of log1p(y) = x respectively. References Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language. Wadsworth &amp; Brooks/Cole. (for log, log10 and exp.) Chambers, J. M. (1998) Programming with Data. A Guide to the S Language. Springer. (for logb.) See Also Trig, sqrt, Arithmetic. Examples log(exp(3)) log10(1e7) # = 7 x &lt;- 10^-(1+2*1:9) cbind(x, log(1+x), log1p(x), exp(x)-1, expm1(x)) "],["data-types.html", "3.4 Data types", " 3.4 Data types 3.4.1 Checking data type mode(county) # character ## [1] &quot;character&quot; mode(income) # numeric ## [1] &quot;numeric&quot; mode(income &gt; mean(income)) # logical ## [1] &quot;logical&quot; testing &lt;- c(&quot;26.142&quot;, &quot;12.008&quot;, &quot;7.032&quot;, &quot;13.646&quot;, &quot;4.589&quot;) mode(testing) # character ## [1] &quot;character&quot; 3.4.2 Converting data type numeric vectorå¯ä»¥ç”¨as.character(x)è½‰æˆcharcterï¼›logical vectorå¯ä»¥ç”¨as.numeric(x)è½‰ç‚ºnumericã€‚æ¦‚å¿µä¸Šå¯ä»¥èªªæ˜¯character &gt; numeric &gt; logicalã€‚ å¦‚æœç¡¬æ˜¯åœ¨logical vectorå¾Œé™„åŠ ä¸€å€‹numeric elementçš„è©±ï¼Œé‚£å°±æœƒæ•´å€‹vectorè¢«è½‰ç‚ºnumeric vectorï¼›ç›¸ä»¿åœ°ï¼Œå¦‚æœnumeric vectorå¾Œé™„åŠ ä¸€å€‹character elementçš„è©±é‚£æ•´å€‹vectorå°±æœƒè¢«è½‰ç‚ºcharacter vectorã€‚ å¯ä»¥ç”¨sum()å‡½å¼ä¾†è¨ˆç®—logical vectoræœ‰å¹¾å€‹TRUEå€¼ã€‚ä¾‹å¦‚sum(a%%2==1)å°±æ˜¯è¨ˆç®—aä¸­æœ‰å¹¾å€‹å¥‡æ•¸ã€‚TRUEå¯è¦–ç‚º1ã€FALSEå¯è¦–ç‚º0ï¼Œæ‰€ä»¥åŠ ç¸½èµ·ä¾†å°±æ˜¯TRUEæœ‰å¹¾å€‹ã€‚ income.c &lt;- as.character(income) population.c &lt;- as.numeric(population) a &lt;- seq(11, 99, 11) a &lt;- c(a, &quot;100&quot;) a &lt;- seq(11, 99, 11) sum(a%%2==1) ## [1] 5 max(a) ## [1] 99 "],["character-operations.html", "3.5 Character operations", " 3.5 Character operations a &lt;- seq(11, 55, 11) paste(&quot;A&quot;, a) # concatenate ## [1] &quot;A 11&quot; &quot;A 22&quot; &quot;A 33&quot; &quot;A 44&quot; &quot;A 55&quot; paste0(&quot;A&quot;, a) # concatenate ## [1] &quot;A11&quot; &quot;A22&quot; &quot;A33&quot; &quot;A44&quot; &quot;A55&quot; "],["dataframe.html", "Chapter 4 Dataframe ", " Chapter 4 Dataframe "],["åŸºæœ¬æ“ä½œ.html", "4.1 åŸºæœ¬æ“ä½œ", " 4.1 åŸºæœ¬æ“ä½œ 4.1.1 ç”¢ç”Ÿæ–°çš„Dataframe 4.1.1.1 è¤‡è£½è³‡æ–™è‡³vector ç›´æ¥è¤‡è£½Wikipediaä¸Šçš„å°åŒ—å¸‚æŸäº”å€äººå£è³‡æ–™ population &lt;- c(158228, 126687, 228075, 204903, 308383, 187920) town &lt;- c(&quot;ä¸­æ­£&quot;, &quot;å¤§åŒ&quot;, &quot;ä¸­å±±&quot;, &quot;æ¾å±±&quot;, &quot;å¤§å®‰&quot;, &quot;è¬è¯&quot;) area &lt;- c(7.6071, 5.6815, 13.6821, 9.2878, 11.3614, 8.8522) 4.1.1.2 åˆä½µç­‰é•·vectorç‚ºdataframe df &lt;- data.frame(town, population, area) df$density = df$population / df$area str(df) ## &#39;data.frame&#39;: 6 obs. of 4 variables: ## $ town : chr &quot;ä¸­æ­£&quot; &quot;å¤§åŒ&quot; &quot;ä¸­å±±&quot; &quot;æ¾å±±&quot; ... ## $ population: num 158228 126687 228075 204903 308383 ... ## $ area : num 7.61 5.68 13.68 9.29 11.36 ... ## $ density : num 20800 22298 16670 22062 27143 ... summary(df) town population area density Length:6 Min. :126687 Min. : 5.681 Min. :16670 Class :character 1st Qu.:165651 1st Qu.: 7.918 1st Qu.:20907 Mode :character Median :196412 Median : 9.070 Median :21645 NA Mean :202366 Mean : 9.412 Mean :21700 NA 3rd Qu.:222282 3rd Qu.:10.843 3rd Qu.:22239 NA Max. :308383 Max. :13.682 Max. :27143 # View(df) 4.1.1.3 å­˜æ”¾å°ç£è²¿æ˜“å„åœ‹é€²å‡ºå£é‡ é‹ç”¨å°ç£å‡ºå£é€²å£è³‡æ–™ å°ç£å‡ºå£é€²å£è²¿æ˜“è³‡æ–™æŸ¥è©¢ country &lt;- c(&quot;CN&quot;, &quot;US&quot;, &quot;JP&quot;, &quot;HK&quot;, &quot;KR&quot;, &quot;SG&quot;, &quot;DE&quot;, &quot;MY&quot;, &quot;VN&quot;, &quot;PH&quot;, &quot;TH&quot;, &quot;AU&quot;, &quot;NL&quot;, &quot;SA&quot;, &quot;ID&quot;, &quot;GB&quot;, &quot;IN&quot;, &quot;FR&quot;, &quot;IT&quot;, &quot;AE&quot;) import &lt;- c(26.142, 12.008, 7.032, 13.646, 4.589, 5.768, 2.131, 2.802, 3.428, 3.019, 1.976, 1.118, 1.624, 0.449, 0.983, 1.302, 1.027, 0.553, 0.670, 0.455) export &lt;- c(22.987, 12.204, 11.837, 7.739, 5.381, 4.610, 2.866, 2.784, 2.414, 2.092, 1.839, 1.788, 1.665, 1.409, 1.391, 1.075, 0.974, 0.899, 0.800, 0.728) 4.1.1.4 åˆä½µvectorç‚ºdata.frame é€™æ™‚å€™æˆ‘å€‘è‹¥ä»¥str(df)è§€å¯Ÿè©²dfçš„çµæ§‹æœƒç™¼ç¾ï¼Œæ–‡å­—å‹æ…‹çš„è³‡æ–™è¢«è½‰ç‚ºFactorsï¼Œé€™æ˜¯æˆ‘å€‘æ‰€ä¸æ¨‚è¦‹çš„ã€‚éå»çµ±è¨ˆé€šå¸¸æœƒæŠŠæ–‡å­—å‹æ…‹ç•¶æˆé¡åˆ¥è®Šæ•¸ï¼Œæ–¼æ˜¯ç”¨Factorsä½œç‚ºè³‡æ–™å‹æ…‹ï¼Œä½†è³‡æ–™ç§‘å­¸ä¸­ç¶“å¸¸è¦è™•ç†å¤§é‡çš„æ–‡å­—è³‡æ–™ï¼Œæ­¤æ™‚ï¼Œæˆ‘å€‘å¯ä»¥æŠŠread.csvçš„ä¸€å€‹åƒæ•¸stringsAsFactorsè¨­ç‚ºFALSEï¼Œæ„å‘³è‘—é è¨­ä¸è¦å°‡æ–‡å­—çš„è³‡æ–™è½‰ç‚ºFactorè€Œæ˜¯ç›´æ¥ä»¥æ–‡å­—è®Šé …ä¾†è™•ç†ã€‚* stringsAsFactors = FALSEä¹Ÿæ˜¯read.csv()çš„åƒæ•¸ï¼ˆparameterã€argumentï¼‰ã€‚å› ç‚ºä¸€èˆ¬è®€æª”æœƒé è¨­æŠŠæ–‡å­—è®€ç‚ºé¡åˆ¥è®Šé …ä¹Ÿå°±æ˜¯Factorï¼Œä½†è³‡æ–™åˆ†æç¶“å¸¸è¦è™•ç†æ–‡å­—è³‡æ–™è€Œä¸æ˜¯é¡åˆ¥è®Šé …ï¼Œæ‰€ä»¥æœƒå¸Œæœ›é è¨­ä¸è¦æŠŠæ–‡å­—è®€å–ç‚ºé¡åˆ¥è®Šé …ï¼Œå› æ­¤è¦è¨­å®šstringsAsFactors = FALSEã€‚ ç‚ºäº†é¿å…æ¯æ¬¡éƒ½è¦æ‰“é€™ä¸²åƒæ•¸ï¼Œå¯ä»¥æŠŠå®ƒè¨­å®šç‚ºå…¨åŸŸåƒæ•¸ï¼Œå¯ä»¥åœ¨ç¨‹å¼ä¸€é–‹å§‹æ™‚ä¾¿åŠ ä¸Šoptions(stringsAsFactors = FASLE)ï¼Œæ„å‘³è‘—åº•ä¸‹æ‰€æœ‰çš„å‡½å¼å¦‚æœæœ‰stringsAsFactorsé€™å€‹åƒæ•¸ï¼Œä¸€å¾‹è‡ªå‹•è¨­ç‚ºFALSEã€‚ df &lt;- data.frame(country, import, export) str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... df &lt;- data.frame(country, import, export, stringsAsFactors = FALSE) str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... ç”šè‡³ä¹Ÿå¯ä»¥å»ºç«‹ä¸€å€‹æ–°çš„ã€ç©ºçš„data.frameã€‚ df.testå°±Rçš„ç”¨æ³•å°±æ˜¯ä¸€å€‹è®Šæ•¸ï¼Œä¸¦ä¸æ˜¯dfå’Œtestå„è‡ªæ˜¯ä¸€å€‹è®Šæ•¸ã€‚ df.test &lt;- data.frame() 4.1.2 è§€å¯Ÿdataframe View(df) ç”¨RStudioæ‰€æä¾›çš„GUIç›´æ¥è§€çœ‹è®Šæ•¸ head(df) å–å‰é¢å…­ç­†è³‡æ–™ï¼ˆä¹Ÿå°±æ˜¯å…­åˆ—çš„è³‡æ–™ä¾†æ¦‚è§€è©²è³‡æ–™ï¼‰ class(df) str(df) summary(df) # View(df) head(df) # get first part of the data.frame country import export CN 26.142 22.987 US 12.008 12.204 JP 7.032 11.837 HK 13.646 7.739 KR 4.589 5.381 SG 5.768 4.610 class(df) ## [1] &quot;data.frame&quot; str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... summary(df) country import export Length:20 Min. : 0.449 Min. : 0.728 Class :character 1st Qu.: 1.016 1st Qu.: 1.312 Mode :character Median : 2.054 Median : 1.966 NA Mean : 4.536 Mean : 4.374 NA 3rd Qu.: 4.884 3rd Qu.: 4.803 NA Max. :26.142 Max. :22.987 # look up help help(summary) summary R Documentation Object Summaries Description summary is a generic function used to produce result summaries of the results of various model fitting functions. The function invokes particular methods which depend on the class of the first argument. Usage summary(object, ...) ## Default S3 method: summary(object, ..., digits, quantile.type = 7) ## S3 method for class 'data.frame' summary(object, maxsum = 7, digits = max(3, getOption(\"digits\")-3), ...) ## S3 method for class 'factor' summary(object, maxsum = 100, ...) ## S3 method for class 'matrix' summary(object, ...) ## S3 method for class 'summaryDefault' format(x, digits = max(3L, getOption(\"digits\") - 3L), ...) ## S3 method for class 'summaryDefault' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...) Arguments object an object for which a summary is desired. x a result of the default method of summary(). maxsum integer, indicating how many levels should be shown for factors. digits integer, used for number formatting with signif() (for summary.default) or format() (for summary.data.frame). In summary.default, if not specified (i.e., missing(.)), signif() will not be called anymore (since R &gt;= 3.4.0, where the default has been changed to only round in the print and format methods). quantile.type integer code used in quantile(*, type=quantile.type) for the default method. â€¦ additional arguments affecting the summary produced. Details For factors, the frequency of the first maxsum - 1 most frequent levels is shown, and the less frequent levels are summarized in â€œ(Others)â€ (resulting in at most maxsum frequencies). The functions summary.lm and summary.glm are examples of particular methods which summarize the results produced by lm and glm. Value The form of the value returned by summary depends on the class of its argument. See the documentation of the particular methods for details of what is produced by that method. The default method returns an object of class c(â€œsummaryDefaultâ€, â€œtableâ€) which has specialized format and print methods. The factor method returns an integer vector. The matrix and data frame methods return a matrix of class â€œtableâ€, obtained by applying summary to each column and collating the results. References Chambers, J. M. and Hastie, T. J. (1992) Statistical Models in S. Wadsworth &amp; Brooks/Cole. See Also anova, summary.glm, summary.lm. Examples summary(attenu, digits = 4) #-&gt; summary.data.frame(...), default precision summary(attenu $ station, maxsum = 20) #-&gt; summary.factor(...) lst &lt;- unclass(attenu$station) &gt; 20 # logical with NAs ## summary.default() for logicals -- different from *.factor: summary(lst) summary(as.factor(lst)) ?summary summary R Documentation Object Summaries Description summary is a generic function used to produce result summaries of the results of various model fitting functions. The function invokes particular methods which depend on the class of the first argument. Usage summary(object, ...) ## Default S3 method: summary(object, ..., digits, quantile.type = 7) ## S3 method for class 'data.frame' summary(object, maxsum = 7, digits = max(3, getOption(\"digits\")-3), ...) ## S3 method for class 'factor' summary(object, maxsum = 100, ...) ## S3 method for class 'matrix' summary(object, ...) ## S3 method for class 'summaryDefault' format(x, digits = max(3L, getOption(\"digits\") - 3L), ...) ## S3 method for class 'summaryDefault' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...) Arguments object an object for which a summary is desired. x a result of the default method of summary(). maxsum integer, indicating how many levels should be shown for factors. digits integer, used for number formatting with signif() (for summary.default) or format() (for summary.data.frame). In summary.default, if not specified (i.e., missing(.)), signif() will not be called anymore (since R &gt;= 3.4.0, where the default has been changed to only round in the print and format methods). quantile.type integer code used in quantile(*, type=quantile.type) for the default method. â€¦ additional arguments affecting the summary produced. Details For factors, the frequency of the first maxsum - 1 most frequent levels is shown, and the less frequent levels are summarized in â€œ(Others)â€ (resulting in at most maxsum frequencies). The functions summary.lm and summary.glm are examples of particular methods which summarize the results produced by lm and glm. Value The form of the value returned by summary depends on the class of its argument. See the documentation of the particular methods for details of what is produced by that method. The default method returns an object of class c(â€œsummaryDefaultâ€, â€œtableâ€) which has specialized format and print methods. The factor method returns an integer vector. The matrix and data frame methods return a matrix of class â€œtableâ€, obtained by applying summary to each column and collating the results. References Chambers, J. M. and Hastie, T. J. (1992) Statistical Models in S. Wadsworth &amp; Brooks/Cole. See Also anova, summary.glm, summary.lm. Examples summary(attenu, digits = 4) #-&gt; summary.data.frame(...), default precision summary(attenu $ station, maxsum = 20) #-&gt; summary.factor(...) lst &lt;- unclass(attenu$station) &gt; 20 # logical with NAs ## summary.default() for logicals -- different from *.factor: summary(lst) summary(as.factor(lst)) 4.1.2.1 è§€å¯Ÿè³‡æ–™ç¶­åº¦ dim(df) ## [1] 20 3 ncol(df) ## [1] 3 nrow(df) ## [1] 20 length(df) ## [1] 3 4.1.3 æ“ä½œdataframe 4.1.3.1 å–å‡ºä¸€å€‹è®Šé … names(df) åˆ—å‡ºè®Šæ•¸åç¨± df$ç™¼ç”Ÿ.ç¾.åœ°é» é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ df$ç™¼ç”Ÿæ™‚æ®µ é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ length(df$ç™¼ç”Ÿæ™‚æ®µ) é¡¯ç¤ºè©²è®Šæ•¸çš„é•·åº¦ï¼ˆç›¸ç•¶æ–¼æœ‰å¹¾å€‹ï¼‰ names(df) ## [1] &quot;country&quot; &quot;import&quot; &quot;export&quot; head(df$ç™¼ç”Ÿ.ç¾.åœ°é») ## NULL head(df$ç™¼ç”Ÿæ™‚æ®µ) ## NULL length(df$ç™¼ç”Ÿæ™‚æ®µ) ## [1] 0 summary(df) country import export Length:20 Min. : 0.449 Min. : 0.728 Class :character 1st Qu.: 1.016 1st Qu.: 1.312 Mode :character Median : 2.054 Median : 1.966 NA Mean : 4.536 Mean : 4.374 NA 3rd Qu.: 4.884 3rd Qu.: 4.803 NA Max. :26.142 Max. :22.987 4.1.3.2 (mutate)é€éé‹ç®—ç”¢ç”Ÿæ–°è®Šæ•¸ é€™è£¡å®¹æ˜“çŠ¯éŒ¯çš„æ˜¯ï¼Œè¦è¨˜å¾—è·Ÿç¨‹å¼è¬›èªªä½ è¦åŠ ç¸½æˆ–å››å‰‡é‹ç®—çš„æ˜¯å“ªå€‹dfçš„variableã€‚ å¾ä¸‹é¢çš„é€™å€‹æ“ä½œä¸­ï¼Œè©²data.frameæœƒç”¢ç”Ÿä¸€å€‹æ–°çš„è®Šæ•¸subï¼Œé€™å°±ç›¸ç•¶æ–¼Excelä¸­çš„æŸä¸€è¡Œæ¸›å»æŸä¸€è¡Œï¼Œç„¶å¾ŒæŠŠè³‡æ–™æ”¾åœ¨æ–°çš„ä¸€è¡Œã€‚ df$sub &lt;- df$import - df$export 4.1.3.3 (filter)ç¯©é¸è³‡æ–™ã€é¸å–è®Šæ•¸ æ³¨æ„ï¼Œè¦å‘Šè¨´ç¨‹å¼importå’Œexportæ˜¯å“ªå€‹data.frameçš„ã€‚ df[,]ç‚ºå­˜å–dfä¸­æŸå€‹å€æ®µçš„æ•¸å€¼æˆ–æŸå€‹æ•¸å€¼çš„æ–¹æ³•ã€‚å› æ­¤df[1, 1]æœƒå–å‡ºç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ç­†è³‡æ–™çš„ç¬¬ä¸€å€‹vectorã€‚df[2, 3]å‰‡æœƒå–å‡ºç¬¬äºŒç­†è³‡æ–™çš„ç¬¬ä¸‰å€‹variableã€‚ ä¸‹é¢çš„ä¾‹å­nrow(df)ç‚º1894ï¼Œæœ‰1894ç­†è³‡æ–™ï¼Œæ‰€ä»¥è‡ªç„¶df\\(importèˆ‡df\\)exportçš„é•·åº¦éƒ½æ˜¯1894ã€‚å› æ­¤ï¼Œæ¯”è¼ƒé€™å…©å€‹è®Šæ•¸çš„å¤§å°æœƒå¾—åˆ°ä¸€å€‹é•·åº¦ç‚º1894çš„boolean (logical) variableã€‚å› æ­¤æŠŠé€™å€‹é•·åº¦ç‚º1894ã€å……æ»¿TRUEå’ŒFALSEçš„logical vectorä¸Ÿé€²dfçš„rowä¹‹è™•ï¼Œå› ç‚ºå–è‡ªdfï¼Œå¤§å°åˆ¤æ–·å¼çµæœçš„é•·åº¦è‡ªç„¶å’ŒåŸæœ¬çš„dfçš„åˆ—æ•¸ç›¸åŒã€‚å› æ­¤ç•¶é€™å€‹TRUE/FALSEè¢«ä¸Ÿåœ¨dfçš„åˆ—ä¹‹è™•ï¼Œä¾¿æœƒç¯©é¸å‡ºimportå¤§æ–¼p.xportçš„æ•¸å€¼ã€‚ åŸæœ¬çš„dfæœ‰äº”å€‹variableï¼Œè€Œä¸Šè¿°çš„æ“ä½œæ˜¯ç¯©é¸è³‡æ–™ï¼Œæ‰€ä»¥è¢«ç¯©é¸çš„æ˜¯åˆ—ï¼Œå› æ­¤è¡Œçš„æ•¸é‡ã€åç¨±éƒ½ä¸æœƒè®Šã€‚å› æ­¤ï¼Œæˆ‘ç¯©é¸å®Œå¾Œï¼Œç›´æ¥å­˜å–é€™å€‹è¢«ç¯©é¸éçš„data.frameçš„country variableï¼Œè‡ªç„¶æ˜¯å¯ä»¥çš„ã€‚ df country import export sub CN 26.142 22.987 3.155 US 12.008 12.204 -0.196 JP 7.032 11.837 -4.805 HK 13.646 7.739 5.907 KR 4.589 5.381 -0.792 SG 5.768 4.610 1.158 DE 2.131 2.866 -0.735 MY 2.802 2.784 0.018 VN 3.428 2.414 1.014 PH 3.019 2.092 0.927 TH 1.976 1.839 0.137 AU 1.118 1.788 -0.670 NL 1.624 1.665 -0.041 SA 0.449 1.409 -0.960 ID 0.983 1.391 -0.408 GB 1.302 1.075 0.227 IN 1.027 0.974 0.053 FR 0.553 0.899 -0.346 IT 0.670 0.800 -0.130 AE 0.455 0.728 -0.273 names(df) ## [1] &quot;country&quot; &quot;import&quot; &quot;export&quot; &quot;sub&quot; nrow(df) ## [1] 20 # filter row data by column value df[df$import &gt; df$export,] country import export sub 1 CN 26.142 22.987 3.155 4 HK 13.646 7.739 5.907 6 SG 5.768 4.610 1.158 8 MY 2.802 2.784 0.018 9 VN 3.428 2.414 1.014 10 PH 3.019 2.092 0.927 11 TH 1.976 1.839 0.137 16 GB 1.302 1.075 0.227 17 IN 1.027 0.974 0.053 df[df$import &gt; df$export,]$country ## [1] &quot;CN&quot; &quot;HK&quot; &quot;SG&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;GB&quot; &quot;IN&quot; df[df$import &gt; df$export,1] ## [1] &quot;CN&quot; &quot;HK&quot; &quot;SG&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;GB&quot; &quot;IN&quot; # 1 row == a data.frame with only one data entry class(df[df$import &gt; df$export,1]) ## [1] &quot;character&quot; class(df[,1]) # character vector ## [1] &quot;character&quot; class(df[1,]) # data.frame ## [1] &quot;data.frame&quot; class(unlist(df[1, -1])) # filter the 1st row and select all columns except 1 ## [1] &quot;numeric&quot; 4.1.3.4 (arrange) æŒ‰æŸå€‹è®Šæ•¸æ’åº df.sorted &lt;- df[order(df$import),]æœƒä½¿å¾—æ•´å€‹dfç…§importçš„å¤§å°æ’åºé‡æ–°åšæ’åˆ—ã€‚å› ç‚ºorder(df$import)æœƒæŠŠè³‡æ–™ç…§æŒ‡å®šé †åºæ’åˆ—å¾Œçš„ä½ç½®å‚³å›ä¾†ï¼Œæ‰€ä»¥æŠŠä»–ä¸Ÿçµ¦dfçš„åˆ—çš„ä½ç½®ï¼Œä¾¿æœƒä½¿å¾—dfçš„è³‡æ–™ç…§æŒ‡å®šçš„é †åºæ’åˆ—ã€‚ é è¨­æ˜¯ç”±å°åˆ°å¤§ï¼ŒåŠ ä¸Šdecreasing = Té€™å€‹åƒæ•¸å¾Œè®Šæˆç”±å¤§è€Œå°ã€‚ # sort rows by df$import column df.sorted &lt;- df[order(df$import),] # View(df.sorted) # sort rows in decreasing order df.sorted &lt;- df[order(df$import, decreasing = T),] # add - to column in order() can sort in decreasing order df.sorted &lt;- df[order(-df$import),] head(df.sorted) country import export sub 1 CN 26.142 22.987 3.155 4 HK 13.646 7.739 5.907 2 US 12.008 12.204 -0.196 3 JP 7.032 11.837 -4.805 6 SG 5.768 4.610 1.158 5 KR 4.589 5.381 -0.792 "],["ç°¡æ˜“ç¹ªåœ–.html", "4.2 ç°¡æ˜“ç¹ªåœ–", " 4.2 ç°¡æ˜“ç¹ªåœ– graphics::plot()ç‚ºæœƒé è¼‰å…¥Rçš„ç¹ªåœ–å¥—ä»¶ï¼Œå¦‚æœå¸Œæœ›ç¹ªåœ–çš„åŒæ™‚åŠ ä¸Šå›æ­¸ç·šå’Œè³‡æ–™é»æ¨™ç±¤çš„è©±ï¼Œå¿…é ˆè¦ä¸‰è¡Œä¸€èµ·åŸ·è¡Œã€‚ # plot(df) # raise error, 1st column is a character vector plot(df[, 2:3]) plot(df[1:10, 2:3]) text(import, export, labels=country, cex= 0.5, pos=3) lines(1:25, 1:25, col=&#39;red&#39;) ?plot ## Help on topic &#39;plot&#39; was found in the following packages: ## ## * base ## * graphics "],["åŸºæœ¬æ“ä½œä½¿ç”¨dplyr.html", "4.3 åŸºæœ¬æ“ä½œï¼šä½¿ç”¨dplyr", " 4.3 åŸºæœ¬æ“ä½œï¼šä½¿ç”¨dplyr library(dplyr) df &lt;- data.frame(country, import, export, stringsAsFactors = F) df &lt;- mutate(df, sub = import - export) filter(df, import &gt; export) country import export sub CN 26.142 22.987 3.155 HK 13.646 7.739 5.907 SG 5.768 4.610 1.158 MY 2.802 2.784 0.018 VN 3.428 2.414 1.014 PH 3.019 2.092 0.927 TH 1.976 1.839 0.137 GB 1.302 1.075 0.227 IN 1.027 0.974 0.053 select(df, c(1, 3)) country export CN 22.987 US 12.204 JP 11.837 HK 7.739 KR 5.381 SG 4.610 DE 2.866 MY 2.784 VN 2.414 PH 2.092 TH 1.839 AU 1.788 NL 1.665 SA 1.409 ID 1.391 GB 1.075 IN 0.974 FR 0.899 IT 0.800 AE 0.728 message(df$country) print(df$country) ## [1] &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; &quot;KR&quot; &quot;SG&quot; &quot;DE&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;AU&quot; &quot;NL&quot; &quot;SA&quot; &quot;ID&quot; ## [16] &quot;GB&quot; &quot;IN&quot; &quot;FR&quot; &quot;IT&quot; &quot;AE&quot; "],["tibble-data_frame-data.html", "4.4 tibble, data_frame, data.frame", " 4.4 tibble, data_frame, data.frame è­¦å‘Šï¼š \"data_frame()\" was deprecated in tibble 1.1.0. Please use \"tibble()\" instead. df &lt;- data.frame(a=1:2, b=3:4, c=5:6) class(df) ## [1] &quot;data.frame&quot; df &lt;- data_frame(a=1:2, b=3:4, c=5:6) class(df) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; df &lt;- tibble(a=1:2, b=3:4, c=5:6) class(df) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; "],["database---sqlite.html", "4.5 Database - SQLite", " 4.5 Database - SQLite &lt;!--chapter:end:R13_dataframe.Rmd--&gt; # (PART) DATA MANIPULATION{-} # ä½¿ç”¨åŸºç¤Rå¥—ä»¶ &lt;!--chapter:end:R20-base-R-Data-Analysis.Rmd--&gt; ## æ¡ˆä¾‹ï¼šç”¢å‡æ”¯è–ªè·¨åœ‹è·¨æ™‚æ¯”è¼ƒ * æœ¬æ¡ˆä¾‹å°‡åˆ©ç”¨Rä¾†é‡è£½è¯ç››é “éƒµå ±åœ¨2016/08/13çš„ä¸€ç¯‡è«‡è«–ç¾åœ‹å©¦å¥³ç”¢å‡æ”¯è–ªæƒ…å½¢çš„å ±å°ã€‚é€™å€‹æ¡ˆä¾‹ä¸­å°‡æœƒæ‡‰ç”¨åˆ°data.frameå’ŒåŸºæœ¬çš„ç¹ªåœ–èˆ‡è³‡æ–™æ‘˜è¦æ–¹æ³•ã€‚The case adaped Washington Post&#39;s paid maternity leave as an exmaple to introduce basic skill of data.frame, plotting, and data mamipulation. * åŸå§‹æ–°èä¾†æºï¼šhttps://www.washingtonpost.com/news/worldviews/wp/2016/08/13/the-world-is-getting-better-at-paid-maternity-leave-the-u-s-is-not/?tid=sm_tw&amp;utm_term=.f8cd50280326#comments ### Reading .xlsx by readxl package * readxlä¹ŸåŒ…å«åœ¨tidyverseçš„å¥—ä»¶é›†ä¸­ï¼Œæ‰€ä»¥æ‡‰è©²å·²ç¶“åœ¨å‰æ¬¡å®‰è£éï¼Œä¸ç”¨ç‰¹åˆ¥å®‰è£ã€‚ ```r # Import readxl package library(readxl) options(stringsAsFactors = FALSE) # Use read_excel() to convert excel sheet to data.frame df &lt;- read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) 4.5.1 Previewing data by View(), class(), dim(), str(), summary() and names() # View(df) class(df) # [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; dim(df) ## [1] 197 156 # Show names of variables (vectors, columns) by names() names(df) ## [1] &quot;country&quot; &quot;iso2&quot; &quot;iso3&quot; ## [4] &quot;region&quot; &quot;wb_econ&quot; &quot;matleave_95&quot; ## [7] &quot;matleave_96&quot; &quot;matleave_97&quot; &quot;matleave_98&quot; ## [10] &quot;matleave_99&quot; &quot;matleave_00&quot; &quot;matleave_01&quot; ## [13] &quot;matleave_02&quot; &quot;matleave_03&quot; &quot;matleave_04&quot; ## [16] &quot;matleave_05&quot; &quot;matleave_06&quot; &quot;matleave_07&quot; ## [19] &quot;matleave_08&quot; &quot;matleave_09&quot; &quot;matleave_10&quot; ## [22] &quot;matleave_11&quot; &quot;matleave_12&quot; &quot;matleave_13&quot; ## [25] &quot;matleave_wrr_95&quot; &quot;matleave_wrr_96&quot; &quot;matleave_wrr_97&quot; ## [28] &quot;matleave_wrr_98&quot; &quot;matleave_wrr_99&quot; &quot;matleave_wrr_00&quot; ## [31] &quot;matleave_wrr_01&quot; &quot;matleave_wrr_02&quot; &quot;matleave_wrr_03&quot; ## [34] &quot;matleave_wrr_04&quot; &quot;matleave_wrr_05&quot; &quot;matleave_wrr_06&quot; ## [37] &quot;matleave_wrr_07&quot; &quot;matleave_wrr_08&quot; &quot;matleave_wrr_09&quot; ## [40] &quot;matleave_wrr_10&quot; &quot;matleave_wrr_11&quot; &quot;matleave_wrr_12&quot; ## [43] &quot;matleave_wrr_13&quot; &quot;bf_dur_95&quot; &quot;bf_dur_96&quot; ## [46] &quot;bf_dur_97&quot; &quot;bf_dur_98&quot; &quot;bf_dur_99&quot; ## [49] &quot;bf_dur_00&quot; &quot;bf_dur_01&quot; &quot;bf_dur_02&quot; ## [52] &quot;bf_dur_03&quot; &quot;bf_dur_04&quot; &quot;bf_dur_05&quot; ## [55] &quot;bf_dur_06&quot; &quot;bf_dur_07&quot; &quot;bf_dur_08&quot; ## [58] &quot;bf_dur_09&quot; &quot;bf_dur_10&quot; &quot;bf_dur_11&quot; ## [61] &quot;bf_dur_12&quot; &quot;bf_dur_13&quot; &quot;mat_bfeed_6mon_95&quot; ## [64] &quot;mat_bfeed_6mon_96&quot; &quot;mat_bfeed_6mon_97&quot; &quot;mat_bfeed_6mon_98&quot; ## [67] &quot;mat_bfeed_6mon_99&quot; &quot;mat_bfeed_6mon_00&quot; &quot;mat_bfeed_6mon_01&quot; ## [70] &quot;mat_bfeed_6mon_02&quot; &quot;mat_bfeed_6mon_03&quot; &quot;mat_bfeed_6mon_04&quot; ## [73] &quot;mat_bfeed_6mon_05&quot; &quot;mat_bfeed_6mon_06&quot; &quot;mat_bfeed_6mon_07&quot; ## [76] &quot;mat_bfeed_6mon_08&quot; &quot;mat_bfeed_6mon_09&quot; &quot;mat_bfeed_6mon_10&quot; ## [79] &quot;mat_bfeed_6mon_11&quot; &quot;mat_bfeed_6mon_12&quot; &quot;mat_bfeed_6mon_13&quot; ## [82] &quot;minage_fem_leg_95&quot; &quot;minage_fem_leg_96&quot; &quot;minage_fem_leg_97&quot; ## [85] &quot;minage_fem_leg_98&quot; &quot;minage_fem_leg_99&quot; &quot;minage_fem_leg_00&quot; ## [88] &quot;minage_fem_leg_01&quot; &quot;minage_fem_leg_02&quot; &quot;minage_fem_leg_03&quot; ## [91] &quot;minage_fem_leg_04&quot; &quot;minage_fem_leg_05&quot; &quot;minage_fem_leg_06&quot; ## [94] &quot;minage_fem_leg_07&quot; &quot;minage_fem_leg_08&quot; &quot;minage_fem_leg_09&quot; ## [97] &quot;minage_fem_leg_10&quot; &quot;minage_fem_leg_11&quot; &quot;minage_fem_leg_12&quot; ## [100] &quot;legal_diff_leg_95&quot; &quot;legal_diff_leg_96&quot; &quot;legal_diff_leg_97&quot; ## [103] &quot;legal_diff_leg_98&quot; &quot;legal_diff_leg_99&quot; &quot;legal_diff_leg_00&quot; ## [106] &quot;legal_diff_leg_01&quot; &quot;legal_diff_leg_02&quot; &quot;legal_diff_leg_03&quot; ## [109] &quot;legal_diff_leg_04&quot; &quot;legal_diff_leg_05&quot; &quot;legal_diff_leg_06&quot; ## [112] &quot;legal_diff_leg_07&quot; &quot;legal_diff_leg_08&quot; &quot;legal_diff_leg_09&quot; ## [115] &quot;legal_diff_leg_10&quot; &quot;legal_diff_leg_11&quot; &quot;legal_diff_leg_12&quot; ## [118] &quot;minage_fem_pc_95&quot; &quot;minage_fem_pc_96&quot; &quot;minage_fem_pc_97&quot; ## [121] &quot;minage_fem_pc_98&quot; &quot;minage_fem_pc_99&quot; &quot;minage_fem_pc_00&quot; ## [124] &quot;minage_fem_pc_01&quot; &quot;minage_fem_pc_02&quot; &quot;minage_fem_pc_03&quot; ## [127] &quot;minage_fem_pc_04&quot; &quot;minage_fem_pc_05&quot; &quot;minage_fem_pc_06&quot; ## [130] &quot;minage_fem_pc_07&quot; &quot;minage_fem_pc_08&quot; &quot;minage_fem_pc_09&quot; ## [133] &quot;minage_fem_pc_10&quot; &quot;minage_fem_pc_11&quot; &quot;minage_fem_pc_12&quot; ## [136] &quot;legal_diff_pc_95&quot; &quot;legal_diff_pc_96&quot; &quot;legal_diff_pc_97&quot; ## [139] &quot;legal_diff_pc_98&quot; &quot;legal_diff_pc_99&quot; &quot;legal_diff_pc_00&quot; ## [142] &quot;legal_diff_pc_01&quot; &quot;legal_diff_pc_02&quot; &quot;legal_diff_pc_03&quot; ## [145] &quot;legal_diff_pc_04&quot; &quot;legal_diff_pc_05&quot; &quot;legal_diff_pc_06&quot; ## [148] &quot;legal_diff_pc_07&quot; &quot;legal_diff_pc_08&quot; &quot;legal_diff_pc_09&quot; ## [151] &quot;legal_diff_pc_10&quot; &quot;legal_diff_pc_11&quot; &quot;legal_diff_pc_12&quot; ## [154] &quot;minwage_ppp_2013&quot; &quot;mw_overtime&quot; &quot;oecd&quot; 4.5.2 Select variables # Select the 3rd and 6th to 24th columns matleave &lt;- df[ , c(3, 6:24)] # Use class(), dim(), and str() to inspect the data class(matleave) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; dim(matleave) ## [1] 197 20 str(matleave) ## tibble [197 Ã— 20] (S3: tbl_df/tbl/data.frame) ## $ iso3 : chr [1:197] &quot;AFG&quot; &quot;ALB&quot; &quot;DZA&quot; &quot;AND&quot; ... ## $ matleave_95: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_96: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_97: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_98: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_99: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_00: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_01: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_02: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_03: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_04: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_05: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_06: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_07: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_08: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_09: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_10: num [1:197] 2 5 3 3 2 2 2 5 NA 5 ... ## $ matleave_11: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_12: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_13: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... 4.5.3 Check &amp; Replace NAs NA: Not Available v[is.na(v)] will select all NA cells ä»¥0å–ä»£NAçš„è³‡æ–™æ ¼ã€‚é¿å…ç¹ªåœ–ç”¢ç”ŸéŒ¯èª¤ sum(is.na(matleave))çš„ç›®çš„æ˜¯æª¢æ¸¬é‚„æœ‰æ²’æœ‰NAå€¼ã€‚å¦‚æœæœ‰çš„è©±is.na()å°±æœƒæ˜¯TRUEï¼Œé‚£éº¼åŠ ç¸½å¾Œï¼Œå¦‚æœä¸æ˜¯0ï¼Œé‚£å°±ä»£è¡¨é‚„æœ‰NAã€‚ # is.na() to indicate each element is NA or NOT(TRUE/FALSE) head(is.na(matleave), n=20) iso3 matleave_95 matleave_96 matleave_97 matleave_98 matleave_99 matleave_00 matleave_01 matleave_02 matleave_03 matleave_04 matleave_05 matleave_06 matleave_07 matleave_08 matleave_09 matleave_10 matleave_11 matleave_12 matleave_13 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE TRUE FALSE FALSE FALSE FALSE FALSE # Assign 0 to those NA data matleave[is.na(matleave)] &lt;- 0 # anyNA() to check if there are still NA cells. anyNA(matleave) ## [1] FALSE # sum(is.na()) to count the number of NA sum(is.na(matleave)) ## [1] 0 4.5.4 Filtering data 4.5.4.1 Filtered by the last year value # Use logical comparison to see if the last year equals to 5 # Assign matching data to var m5 m5 &lt;- matleave[matleave$&#39;matleave_13&#39;==5, ] # nrow() to count matching data nrow(m5) ## [1] 34 # Is it possible to use length() to check the data length? # matleave$&#39;matleave_13&#39; # matleave$&#39;matleave_13&#39;==5 # length(matleave$&#39;matleave_13&#39;==5) 4.5.4.2 Filtered data by the first year value # filter rows whose &#39;matleave_95&#39; is 5, and assign to var m55 m55&lt;- m5[m5$&#39;matleave_95&#39;==5,] # filter rows whose &#39;matleave_95&#39; is not 5, and assign to var m05 m05&lt;- m5[m5$&#39;matleave_95&#39;!=5,] 4.5.5 Plotting Plotting the second rows and all columns except 1st column Question ç‚ºä½•è¦unlist()ï¼Ÿè«‹è©¦è‘—åŸ·è¡Œbarplot(matleave[2, -1])é€™å€‹æ²’æœ‰unlist()çš„ç‰ˆæœ¬ï¼Œçœ‹çœ‹æœƒæœ‰ä»€éº¼éŒ¯èª¤è¨Šæ¯ã€‚è³‡æ–™çµæ§‹æœ‰ä½•å·®ç•°å‘¢ï¼Ÿ å˜—è©¦ç”¨class()æˆ–str()å˜—è©¦è§€å¯Ÿæ²’æœ‰unlist()ç‰ˆæœ¬çš„è³‡æ–™ï¼Œçœ‹çœ‹è³‡æ–™å‹æ…‹å’Œæœ‰unlist()çš„æœƒæœ‰ä½•ä¸åŒï¼Ÿ 4.5.5.1 Plotting one line # barplot() the second row of m55 # barplot(m55[2, ]) # raise error # barplot() the second row when neglecting the first column # barplot(m55[2, -1]) # raise error # Take a look at the data type of matleave[2, ] class(matleave[2, -1]) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(unlist(matleave[2, -1])) ## [1] &quot;numeric&quot; # unlist() to convert a single row data.frame to a vector for barplot() barplot(unlist(m55[2, -1])) Testing # View(matleave[1]) # select the 1st variable # View(matleave[ ,1]) # select the 1st column # View(matleave[1, ]) # select the 1st row class(m55[1]) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(m55[ ,1]) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(m55[1, ]) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(m55$iso3) # character (vector) ## [1] &quot;character&quot; 4.5.5.2 More arguments (args) # barplot() the unlisted second row (neglecting the first col) barplot(unlist(m55[2, -1])) # use ?barplot to know more argument of the function. ?barplot barplot R Documentation Bar Plots Description Creates a bar plot with vertical or horizontal bars. Usage barplot(height, ...) ## Default S3 method: barplot(height, width = 1, space = NULL, names.arg = NULL, legend.text = NULL, beside = FALSE, horiz = FALSE, density = NULL, angle = 45, col = NULL, border = par(\"fg\"), main = NULL, sub = NULL, xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL, xpd = TRUE, log = \"\", axes = TRUE, axisnames = TRUE, cex.axis = par(\"cex.axis\"), cex.names = par(\"cex.axis\"), inside = TRUE, plot = TRUE, axis.lty = 0, offset = 0, add = FALSE, ann = !add &amp;&amp; par(\"ann\"), args.legend = NULL, ...) ## S3 method for class 'formula' barplot(formula, data, subset, na.action, horiz = FALSE, xlab = NULL, ylab = NULL, ...) Arguments height either a vector or matrix of values describing the bars which make up the plot. If height is a vector, the plot consists of a sequence of rectangular bars with heights given by the values in the vector. If height is a matrix and beside is FALSE then each bar of the plot corresponds to a column of height, with the values in the column giving the heights of stacked sub-bars making up the bar. If height is a matrix and beside is TRUE, then the values in each column are juxtaposed rather than stacked. width optional vector of bar widths. Re-cycled to length the number of bars drawn. Specifying a single value will have no visible effect unless xlim is specified. space the amount of space (as a fraction of the average bar width) left before each bar. May be given as a single number or one number per bar. If height is a matrix and beside is TRUE, space may be specified by two numbers, where the first is the space between bars in the same group, and the second the space between the groups. If not given explicitly, it defaults to c(0,1) if height is a matrix and beside is TRUE, and to 0.2 otherwise. names.arg a vector of names to be plotted below each bar or group of bars. If this argument is omitted, then the names are taken from the names attribute of height if this is a vector, or the column names if it is a matrix. legend.text a vector of text used to construct a legend for the plot, or a logical indicating whether a legend should be included. This is only useful when height is a matrix. In that case given legend labels should correspond to the rows of height; if legend.text is true, the row names of height will be used as labels if they are non-null. beside a logical value. If FALSE, the columns of height are portrayed as stacked bars, and if TRUE the columns are portrayed as juxtaposed bars. horiz a logical value. If FALSE, the bars are drawn vertically with the first bar to the left. If TRUE, the bars are drawn horizontally with the first at the bottom. density a vector giving the density of shading lines, in lines per inch, for the bars or bar components. The default value of NULL means that no shading lines are drawn. Non-positive values of density also inhibit the drawing of shading lines. angle the slope of shading lines, given as an angle in degrees (counter-clockwise), for the bars or bar components. col a vector of colors for the bars or bar components. By default, grey is used if height is a vector, and a gamma-corrected grey palette if height is a matrix. border the color to be used for the border of the bars. Use border = NA to omit borders. If there are shading lines, border = TRUE means use the same colour for the border as for the shading lines. main,sub overall and sub title for the plot. xlab a label for the x axis. ylab a label for the y axis. xlim limits for the x axis. ylim limits for the y axis. xpd logical. Should bars be allowed to go outside region? log string specifying if axis scales should be logarithmic; see plot.default. axes logical. If TRUE, a vertical (or horizontal, if horiz is true) axis is drawn. axisnames logical. If TRUE, and if there are names.arg (see above), the other axis is drawn (with lty = 0) and labeled. cex.axis expansion factor for numeric axis labels (see par(â€˜cexâ€™)). cex.names expansion factor for axis names (bar labels). inside logical. If TRUE, the lines which divide adjacent (non-stacked!) bars will be drawn. Only applies when space = 0 (which it partly is when beside = TRUE). plot logical. If FALSE, nothing is plotted. axis.lty the graphics parameter lty (see par(â€˜ltyâ€™)) applied to the axis and tick marks of the categorical (default horizontal) axis. Note that by default the axis is suppressed. offset a vector indicating how much the bars should be shifted relative to the x axis. add logical specifying if bars should be added to an already existing plot; defaults to FALSE. ann logical specifying if the default annotation (main, sub, xlab, ylab) should appear on the plot, see title. args.legend list of additional arguments to pass to legend(); names of the list are used as argument names. Only used if legend.text is supplied. formula a formula where the y variables are numeric data to plot against the categorical x variables. The formula can have one of three forms: y ~ x y ~ x1 + x2 cbind(y1, y2) ~ x (see the examples). data a data frame (or list) from which the variables in formula should be taken. subset an optional vector specifying a subset of observations to be used. na.action a function which indicates what should happen when the data contain NA values. The default is to ignore missing values in the given variables. â€¦ arguments to be passed to/from other methods. For the default method these can include further arguments (such as axes, asp and main) and graphical parameters (see par) which are passed to plot.window(), title() and axis. Value A numeric vector (or matrix, when beside = TRUE), say mp, giving the coordinates of all the bar midpoints drawn, useful for adding to the graph. If beside is true, use colMeans(mp) for the midpoints of each group of bars, see example. Author(s) R Core, with a contribution by Arni Magnusson. References Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language. Wadsworth &amp; Brooks/Cole. Murrell, P. (2005) R Graphics. Chapman &amp; Hall/CRC Press. See Also plot(â€¦, type = â€œhâ€), dotchart; hist for bars of a continuous variable. mosaicplot(), more sophisticated to visualize several categorical variables. Examples # Formula method barplot(GNP ~ Year, data = longley) barplot(cbind(Employed, Unemployed) ~ Year, data = longley) ## 3rd form of formula - 2 categories : op &lt;- par(mfrow = 2:1, mgp = c(3,1,0)/2, mar = .1+c(3,3:1)) summary(d.Titanic &lt;- as.data.frame(Titanic)) barplot(Freq ~ Class + Survived, data = d.Titanic, subset = Age == \"Adult\" &amp; Sex == \"Male\", main = \"barplot(Freq ~ Class + Survived, *)\", ylab = \"# {passengers}\", legend.text = TRUE) # Corresponding table : (xt &lt;- xtabs(Freq ~ Survived + Class + Sex, d.Titanic, subset = Age==\"Adult\")) # Alternatively, a mosaic plot : mosaicplot(xt[,,\"Male\"], main = \"mosaicplot(Freq ~ Class + Survived, *)\", color=TRUE) par(op) # Default method require(grDevices) # for colours tN &lt;- table(Ni &lt;- stats::rpois(100, lambda = 5)) r &lt;- barplot(tN, col = rainbow(20)) #- type = \"h\" plotting *is* 'bar'plot lines(r, tN, type = \"h\", col = \"red\", lwd = 2) barplot(tN, space = 1.5, axisnames = FALSE, sub = \"barplot(..., space= 1.5, axisnames = FALSE)\") barplot(VADeaths, plot = FALSE) barplot(VADeaths, plot = FALSE, beside = TRUE) mp &lt;- barplot(VADeaths) # default tot &lt;- colMeans(VADeaths) text(mp, tot + 3, format(tot), xpd = TRUE, col = \"blue\") barplot(VADeaths, beside = TRUE, col = c(\"lightblue\", \"mistyrose\", \"lightcyan\", \"lavender\", \"cornsilk\"), legend.text = rownames(VADeaths), ylim = c(0, 100)) title(main = \"Death Rates in Virginia\", font.main = 4) hh &lt;- t(VADeaths)[, 5:1] mybarcol &lt;- \"gray20\" mp &lt;- barplot(hh, beside = TRUE, col = c(\"lightblue\", \"mistyrose\", \"lightcyan\", \"lavender\"), legend.text = colnames(VADeaths), ylim = c(0,100), main = \"Death Rates in Virginia\", font.main = 4, sub = \"Faked upper 2*sigma error bars\", col.sub = mybarcol, cex.names = 1.5) segments(mp, hh, mp, hh + 2*sqrt(1000*hh/100), col = mybarcol, lwd = 1.5) stopifnot(dim(mp) == dim(hh)) # corresponding matrices mtext(side = 1, at = colMeans(mp), line = -2, text = paste(\"Mean\", formatC(colMeans(hh))), col = \"red\") # Bar shading example barplot(VADeaths, angle = 15+10*1:5, density = 20, col = \"black\", legend.text = rownames(VADeaths)) title(main = list(\"Death Rates in Virginia\", font = 4)) # Border color barplot(VADeaths, border = \"dark blue\") # Log scales (not much sense here) barplot(tN, col = heat.colors(12), log = \"y\") barplot(tN, col = gray.colors(20), log = \"xy\") # Legend location barplot(height = cbind(x = c(465, 91) / 465 * 100, y = c(840, 200) / 840 * 100, z = c(37, 17) / 37 * 100), beside = FALSE, width = c(465, 840, 37), col = c(1, 2), legend.text = c(\"A\", \"B\"), args.legend = list(x = \"topleft\")) # Add arguments ylim, space, border, and axat/yaxt one by one to barplot() barplot(unlist(m55[2, -1]), ylim=c(0, 5)) barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0) barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0, border=NA) barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) 4.5.5.3 Plotting multiple lines åº•ä¸‹å¯ä»¥çœ‹è¦‹æ¯ä¸€è¡Œéå¸¸ç›¸ä¼¼ä¸”ä¸€è‡´çš„ç‰¹å¾µï¼Œåƒ…æœ‰matleaveå…§çš„ç´¢å¼•ç”±1è¢«åˆ—å‡ºè‡³6ã€‚å› æ­¤ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯ç”¨è¿´åœˆï¼ˆfor-loopï¼‰çš„æ–¹å¼å°‡ç›¸åŒçš„ç¨‹å¼ç¢¼ï¼Œå¾1~6ä¹‹é–“åšå…­æ¬¡ã€‚ # plot the first row barplot(unlist(m55[1, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) # plot the second to 6th rows barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[3, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[4, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[5, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[6, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) 4.5.5.4 for-loop to plot multiple lines # use for loop and use i as index to barplot multiple subgraphs for(i in 1:6){ barplot(unlist(m55[i, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) } 4.5.5.5 Sub-plots Check ?par to get paremeters of plotting **mai**: A numerical vector of the form c(bottom, left, top, right) which gives the margin size specified in inches. **mfcol, mfrow**:A vector of the form c(nr, nc). Subsequent figures will be drawn in an nr-by-nc array on the device by columns (mfcol), or rows (mfrow), respectively. # use ?par to get more plotting parameters ?par par R Documentation Set or Query Graphical Parameters Description par can be used to set or query graphical parameters. Parameters can be set by specifying them as arguments to par in tag = value form, or by passing them as a list of tagged values. Usage par(..., no.readonly = FALSE) &lt;highlevel plot&gt; (..., &lt;tag&gt; = &lt;value&gt;) Arguments â€¦ arguments in tag = value form, or a list of tagged values. The tags must come from the names of graphical parameters described in the â€˜Graphical Parametersâ€™ section. no.readonly logical; if TRUE and there are no other arguments, only parameters are returned which can be set by a subsequent par() call on the same device. Details Each device has its own set of graphical parameters. If the current device is the null device, par will open a new device before querying/setting parameters. (What device is controlled by options(â€œdeviceâ€).) Parameters are queried by giving one or more character vectors of parameter names to par. par() (no arguments) or par(no.readonly = TRUE) is used to get all the graphical parameters (as a named list). Their names are currently taken from the unexported variable graphics:::.Pars. R.O. indicates read-only arguments: These may only be used in queries and cannot be set. (â€œcinâ€, â€œcraâ€, â€œcsiâ€, â€œcxyâ€, â€œdinâ€ and â€œpageâ€ are always read-only.) Several parameters can only be set by a call to par(): â€œaskâ€, â€œfigâ€, â€œfinâ€, â€œlheightâ€, â€œmaiâ€, â€œmarâ€, â€œmexâ€, â€œmfcolâ€, â€œmfrowâ€, â€œmfgâ€, â€œnewâ€, â€œomaâ€, â€œomdâ€, â€œomiâ€, â€œpinâ€, â€œpltâ€, â€œpsâ€, â€œptyâ€, â€œusrâ€, â€œxlogâ€, â€œylogâ€, â€œylbiasâ€ The remaining parameters can also be set as arguments (often via â€¦) to high-level plot functions such as plot.default, plot.window, points, lines, abline, axis, title, text, mtext, segments, symbols, arrows, polygon, rect, box, contour, filled.contour and image. Such settings will be active during the execution of the function, only. However, see the comments on bg, cex, col, lty, lwd and pch which may be taken as arguments to certain plot functions rather than as graphical parameters. The meaning of â€˜character sizeâ€™ is not well-defined: this is set up for the device taking pointsize into account but often not the actual font family in use. Internally the corresponding pars (cra, cin, cxy and csi) are used only to set the inter-line spacing used to convert mar and oma to physical margins. (The same inter-line spacing multiplied by lheight is used for multi-line strings in text and strheight.) Note that graphical parameters are suggestions: plotting functions and devices need not make use of them (and this is particularly true of non-default methods for e.g.Â plot). Value When parameters are set, their previous values are returned in an invisible named list. Such a list can be passed as an argument to par to restore the parameter values. Use par(no.readonly = TRUE) for the full list of parameters that can be restored. However, restoring all of these is not wise: see the â€˜Noteâ€™ section. When just one parameter is queried, the value of that parameter is returned as (atomic) vector. When two or more parameters are queried, their values are returned in a list, with the list names giving the parameters. Note the inconsistency: setting one parameter returns a list, but querying one parameter returns a vector. Graphical Parameters adj The value of adj determines the way in which text strings are justified in text, mtext and title. A value of 0 produces left-justified text, 0.5 (the default) centered text and 1 right-justified text. (Any value in [0, 1] is allowed, and on most devices values outside that interval will also work.) Note that the adj argument of text also allows adj = c(x, y) for different adjustment in x- and y- directions. Note that whereas for text it refers to positioning of text about a point, for mtext and title it controls placement within the plot or device region. ann If set to FALSE, high-level plotting functions calling plot.default do not annotate the plots they produce with axis titles and overall titles. The default is to do annotation. ask logical. If TRUE (and the R session is interactive) the user is asked for input, before a new figure is drawn. As this applies to the device, it also affects output by packages grid and lattice. It can be set even on non-screen devices but may have no effect there. This not really a graphics parameter, and its use is deprecated in favour of devAskNewPage. bg The color to be used for the background of the device region. When called from par() it also sets new = FALSE. See section â€˜Color Specificationâ€™ for suitable values. For many devices the initial value is set from the bg argument of the device, and for the rest it is normally â€œwhiteâ€. Note that some graphics functions such as plot.default and points have an argument of this name with a different meaning. bty A character string which determined the type of box which is drawn about plots. If bty is one of â€œoâ€ (the default), â€œlâ€, â€œ7â€, â€œcâ€, â€œuâ€, or â€œ]â€ the resulting box resembles the corresponding upper case letter. A value of â€œnâ€ suppresses the box. cex A numerical value giving the amount by which plotting text and symbols should be magnified relative to the default. This starts as 1 when a device is opened, and is reset when the layout is changed, e.g.Â by setting mfrow. Note that some graphics functions such as plot.default have an argument of this name which multiplies this graphical parameter, and some functions such as points and text accept a vector of values which are recycled. cex.axis The magnification to be used for axis annotation relative to the current setting of cex. cex.lab The magnification to be used for x and y labels relative to the current setting of cex. cex.main The magnification to be used for main titles relative to the current setting of cex. cex.sub The magnification to be used for sub-titles relative to the current setting of cex. cin R.O.; character size (width, height) in inches. These are the same measurements as cra, expressed in different units. col A specification for the default plotting color. See section â€˜Color Specificationâ€™. Some functions such as lines and text accept a vector of values which are recycled and may be interpreted slightly differently. col.axis The color to be used for axis annotation. Defaults to â€œblackâ€. col.lab The color to be used for x and y labels. Defaults to â€œblackâ€. col.main The color to be used for plot main titles. Defaults to â€œblackâ€. col.sub The color to be used for plot sub-titles. Defaults to â€œblackâ€. cra R.O.; size of default character (width, height) in â€˜rastersâ€™ (pixels). Some devices have no concept of pixels and so assume an arbitrary pixel size, usually 1/72 inch. These are the same measurements as cin, expressed in different units. crt A numerical value specifying (in degrees) how single characters should be rotated. It is unwise to expect values other than multiples of 90 to work. Compare with srt which does string rotation. csi R.O.; height of (default-sized) characters in inches. The same as par(â€œcinâ€)[2]. cxy R.O.; size of default character (width, height) in user coordinate units. par(â€œcxyâ€) is par(â€œcinâ€)/par(â€œpinâ€) scaled to user coordinates. Note that c(strwidth(ch), strheight(ch)) for a given string ch is usually much more precise. din R.O.; the device dimensions, (width, height), in inches. See also dev.size, which is updated immediately when an on-screen device windows is re-sized. err (Unimplemented; R is silent when points outside the plot region are not plotted.) The degree of error reporting desired. family The name of a font family for drawing text. The maximum allowed length is 200 bytes. This name gets mapped by each graphics device to a device-specific font description. The default value is â€œâ€œ which means that the default device fonts will be used (and what those are should be listed on the help page for the device). Standard values are â€serifâ€, â€œsansâ€ and â€œmonoâ€, and the Hershey font families are also available. (Devices may define others, and some devices will ignore this setting completely. Names starting with â€œHersheyâ€ are treated specially and should only be used for the built-in Hershey font families.) This can be specified inline for text. fg The color to be used for the foreground of plots. This is the default color used for things like axes and boxes around plots. When called from par() this also sets parameter col to the same value. See section â€˜Color Specificationâ€™. A few devices have an argument to set the initial value, which is otherwise â€œblackâ€. fig A numerical vector of the form c(x1, x2, y1, y2) which gives the (NDC) coordinates of the figure region in the display region of the device. If you set this, unlike S, you start a new plot, so to add to an existing plot use new = TRUE as well. fin The figure region dimensions, (width, height), in inches. If you set this, unlike S, you start a new plot. font An integer which specifies which font to use for text. If possible, device drivers arrange so that 1 corresponds to plain text (the default), 2 to bold face, 3 to italic and 4 to bold italic. Also, font 5 is expected to be the symbol font, in Adobe symbol encoding. On some devices font families can be selected by family to choose different sets of 5 fonts. font.axis The font to be used for axis annotation. font.lab The font to be used for x and y labels. font.main The font to be used for plot main titles. font.sub The font to be used for plot sub-titles. lab A numerical vector of the form c(x, y, len) which modifies the default way that axes are annotated. The values of x and y give the (approximate) number of tickmarks on the x and y axes and len specifies the label length. The default is c(5, 5, 7). Note that this only affects the way the parameters xaxp and yaxp are set when the user coordinate system is set up, and is not consulted when axes are drawn. len is unimplemented in R. las numeric in {0,1,2,3}; the style of axis labels. 0: always parallel to the axis [default], 1: always horizontal, 2: always perpendicular to the axis, 3: always vertical. Also supported by mtext. Note that string/character rotation via argument srt to par does not affect the axis labels. lend The line end style. This can be specified as an integer or string: 0 and â€œroundâ€ mean rounded line caps [default]; 1 and â€œbuttâ€ mean butt line caps; 2 and â€œsquareâ€ mean square line caps. lheight The line height multiplier. The height of a line of text (used to vertically space multi-line text) is found by multiplying the character height both by the current character expansion and by the line height multiplier. Default value is 1. Used in text and strheight. ljoin The line join style. This can be specified as an integer or string: 0 and â€œroundâ€ mean rounded line joins [default]; 1 and â€œmitreâ€ mean mitred line joins; 2 and â€œbevelâ€ mean bevelled line joins. lmitre The line mitre limit. This controls when mitred line joins are automatically converted into bevelled line joins. The value must be larger than 1 and the default is 10. Not all devices will honour this setting. lty The line type. Line types can either be specified as an integer (0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash) or as one of the character strings â€œblankâ€, â€œsolidâ€, â€œdashedâ€, â€œdottedâ€, â€œdotdashâ€, â€œlongdashâ€, or â€œtwodashâ€, where â€œblankâ€ uses â€˜invisible linesâ€™ (i.e., does not draw them). Alternatively, a string of up to 8 characters (from c(1:9, â€œAâ€:â€œFâ€)) may be given, giving the length of line segments which are alternatively drawn and skipped. See section â€˜Line Type Specificationâ€™. Functions such as lines and segments accept a vector of values which are recycled. lwd The line width, a positive number, defaulting to 1. The interpretation is device-specific, and some devices do not implement line widths less than one. (See the help on the device for details of the interpretation.) Functions such as lines and segments accept a vector of values which are recycled: in such uses lines corresponding to values NA or NaN are omitted. The interpretation of 0 is device-specific. mai A numerical vector of the form c(bottom, left, top, right) which gives the margin size specified in inches. mar A numerical vector of the form c(bottom, left, top, right) which gives the number of lines of margin to be specified on the four sides of the plot. The default is c(5, 4, 4, 2) + 0.1. mex mex is a character size expansion factor which is used to describe coordinates in the margins of plots. Note that this does not change the font size, rather specifies the size of font (as a multiple of csi) used to convert between mar and mai, and between oma and omi. This starts as 1 when the device is opened, and is reset when the layout is changed (alongside resetting cex). mfcol, mfrow A vector of the form c(nr, nc). Subsequent figures will be drawn in an nr-by-nc array on the device by columns (mfcol), or rows (mfrow), respectively. In a layout with exactly two rows and columns the base value of â€œcexâ€ is reduced by a factor of 0.83: if there are three or more of either rows or columns, the reduction factor is 0.66. Setting a layout resets the base value of cex and that of mex to 1. If either of these is queried it will give the current layout, so querying cannot tell you the order in which the array will be filled. Consider the alternatives, layout and split.screen. mfg A numerical vector of the form c(i, j) where i and j indicate which figure in an array of figures is to be drawn next (if setting) or is being drawn (if enquiring). The array must already have been set by mfcol or mfrow. For compatibility with S, the form c(i, j, nr, nc) is also accepted, when nr and nc should be the current number of rows and number of columns. Mismatches will be ignored, with a warning. mgp The margin line (in mex units) for the axis title, axis labels and axis line. Note that mgp[1] affects title whereas mgp[2:3] affect axis. The default is c(3, 1, 0). mkh The height in inches of symbols to be drawn when the value of pch is an integer. Completely ignored in R. new logical, defaulting to FALSE. If set to TRUE, the next high-level plotting command (actually plot.new) should not clean the frame before drawing as if it were on a new device. It is an error (ignored with a warning) to try to use new = TRUE on a device that does not currently contain a high-level plot. oma A vector of the form c(bottom, left, top, right) giving the size of the outer margins in lines of text. omd A vector of the form c(x1, x2, y1, y2) giving the region inside outer margins in NDC (= normalized device coordinates), i.e., as a fraction (in [0, 1]) of the device region. omi A vector of the form c(bottom, left, top, right) giving the size of the outer margins in inches. page R.O.; A boolean value indicating whether the next call to plot.new is going to start a new page. This value may be FALSE if there are multiple figures on the page. pch Either an integer specifying a symbol or a single character to be used as the default in plotting points. See points for possible values and their interpretation. Note that only integers and single-character strings can be set as a graphics parameter (and not NA nor NULL). Some functions such as points accept a vector of values which are recycled. pin The current plot dimensions, (width, height), in inches. plt A vector of the form c(x1, x2, y1, y2) giving the coordinates of the plot region as fractions of the current figure region. ps integer; the point size of text (but not symbols). Unlike the pointsize argument of most devices, this does not change the relationship between mar and mai (nor oma and omi). What is meant by â€˜point sizeâ€™ is device-specific, but most devices mean a multiple of 1bp, that is 1/72 of an inch. pty A character specifying the type of plot region to be used; â€œsâ€ generates a square plotting region and â€œmâ€ generates the maximal plotting region. smo (Unimplemented) a value which indicates how smooth circles and circular arcs should be. srt The string rotation in degrees. See the comment about crt. Only supported by text. tck The length of tick marks as a fraction of the smaller of the width or height of the plotting region. If tck &gt;= 0.5 it is interpreted as a fraction of the relevant side, so if tck = 1 grid lines are drawn. The default setting (tck = NA) is to use tcl = -0.5. tcl The length of tick marks as a fraction of the height of a line of text. The default value is -0.5; setting tcl = NA sets tck = -0.01 which is Sâ€™ default. usr A vector of the form c(x1, x2, y1, y2) giving the extremes of the user coordinates of the plotting region. When a logarithmic scale is in use (i.e., par(â€œxlogâ€) is true, see below), then the x-limits will be 10 ^ par(â€œusrâ€)[1:2]. Similarly for the y-axis. xaxp A vector of the form c(x1, x2, n) giving the coordinates of the extreme tick marks and the number of intervals between tick-marks when par(â€œxlogâ€) is false. Otherwise, when log coordinates are active, the three values have a different meaning: For a small range, n is negative, and the ticks are as in the linear case, otherwise, n is in 1:3, specifying a case number, and x1 and x2 are the lowest and highest power of 10 inside the user coordinates, 10 ^ par(â€œusrâ€)[1:2]. (The â€œusrâ€ coordinates are log10-transformed here!) n = 1 will produce tick marks at 10^j for integer j, n = 2 gives marks k 10^j with k in {1,5}, n = 3 gives marks k 10^j with k in {1,2,5}. See axTicks() for a pure R implementation of this. This parameter is reset when a user coordinate system is set up, for example by starting a new page or by calling plot.window or setting par(â€œusrâ€): n is taken from par(â€œlabâ€). It affects the default behaviour of subsequent calls to axis for sides 1 or 3. It is only relevant to default numeric axis systems, and not for example to dates. xaxs The style of axis interval calculation to be used for the x-axis. Possible values are â€œrâ€, â€œiâ€, â€œeâ€, â€œsâ€, â€œdâ€. The styles are generally controlled by the range of data or xlim, if given. Style â€œrâ€ (regular) first extends the data range by 4 percent at each end and then finds an axis with pretty labels that fits within the extended range. Style â€œiâ€ (internal) just finds an axis with pretty labels that fits within the original data range. Style â€œsâ€ (standard) finds an axis with pretty labels within which the original data range fits. Style â€œeâ€ (extended) is like style â€œsâ€, except that it is also ensures that there is room for plotting symbols within the bounding box. Style â€œdâ€ (direct) specifies that the current axis should be used on subsequent plots. (Only â€œrâ€ and â€œiâ€ styles have been implemented in R.) xaxt A character which specifies the x axis type. Specifying â€œnâ€ suppresses plotting of the axis. The standard value is â€œsâ€: for compatibility with S values â€œlâ€ and â€œtâ€ are accepted but are equivalent to â€œsâ€: any value other than â€œnâ€ implies plotting. xlog A logical value (see log in plot.default). If TRUE, a logarithmic scale is in use (e.g., after plot(*, log = â€œxâ€)). For a new device, it defaults to FALSE, i.e., linear scale. xpd A logical value or NA. If FALSE, all plotting is clipped to the plot region, if TRUE, all plotting is clipped to the figure region, and if NA, all plotting is clipped to the device region. See also clip. yaxp A vector of the form c(y1, y2, n) giving the coordinates of the extreme tick marks and the number of intervals between tick-marks unless for log coordinates, see xaxp above. yaxs The style of axis interval calculation to be used for the y-axis. See xaxs above. yaxt A character which specifies the y axis type. Specifying â€œnâ€ suppresses plotting. ylbias A positive real value used in the positioning of text in the margins by axis and mtext. The default is in principle device-specific, but currently 0.2 for all of Râ€™s own devices. Set this to 0.2 for compatibility with R &lt; 2.14.0 on x11 and windows() devices. ylog A logical value; see xlog above. Color Specification Colors can be specified in several different ways. The simplest way is with a character string giving the color name (e.g., â€œredâ€). A list of the possible colors can be obtained with the function colors. Alternatively, colors can be specified directly in terms of their RGB components with a string of the form â€œ#RRGGBBâ€ where each of the pairs RR, GG, BB consist of two hexadecimal digits giving a value in the range 00 to FF. Colors can also be specified by giving an index into a small table of colors, the palette: indices wrap round so with the default palette of size 8, 10 is the same as 2. This provides compatibility with S. Index 0 corresponds to the background color. Note that the palette (apart from 0 which is per-device) is a per-session setting. Negative integer colours are errors. Additionally, â€œtransparentâ€ is transparent, useful for filled areas (such as the background!), and just invisible for things like lines or text. In most circumstances (integer) NA is equivalent to â€œtransparentâ€ (but not for text and mtext). Semi-transparent colors are available for use on devices that support them. The functions rgb, hsv, hcl, gray and rainbow provide additional ways of generating colors. Line Type Specification Line types can either be specified by giving an index into a small built-in table of line types (1 = solid, 2 = dashed, etc, see lty above) or directly as the lengths of on/off stretches of line. This is done with a string of an even number (up to eight) of characters, namely non-zero (hexadecimal) digits which give the lengths in consecutive positions in the string. For example, the string â€œ33â€ specifies three units on followed by three off and â€œ3313â€ specifies three units on followed by three off followed by one on and finally three off. The â€˜unitsâ€™ here are (on most devices) proportional to lwd, and with lwd = 1 are in pixels or points or 1/96 inch. The five standard dash-dot line types (lty = 2:6) correspond to c(â€œ44â€, â€œ13â€, â€œ1343â€, â€œ73â€, â€œ2262â€). Note that NA is not a valid value for lty. Note The effect of restoring all the (settable) graphics parameters as in the examples is hard to predict if the device has been resized. Several of them are attempting to set the same things in different ways, and those last in the alphabet will win. In particular, the settings of mai, mar, pin, plt and pty interact, as do the outer margin settings, the figure layout and figure region size. References Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988) The New S Language. Wadsworth &amp; Brooks/Cole. Murrell, P. (2005) R Graphics. Chapman &amp; Hall/CRC Press. See Also plot.default for some high-level plotting parameters; colors; clip; options for other setup parameters; graphic devices x11, postscript and setting up device regions by layout and split.screen. Examples op &lt;- par(mfrow = c(2, 2), # 2 x 2 pictures on one plot pty = \"s\") # square plotting region, # independent of device size ## At end of plotting, reset to previous settings: par(op) ## Alternatively, op &lt;- par(no.readonly = TRUE) # the whole list of settable par's. ## do lots of plotting and par(.) calls, then reset: par(op) ## Note this is not in general good practice par(\"ylog\") # FALSE plot(1 : 12, log = \"y\") par(\"ylog\") # TRUE plot(1:2, xaxs = \"i\") # 'inner axis' w/o extra space par(c(\"usr\", \"xaxp\")) ( nr.prof &lt;- c(prof.pilots = 16, lawyers = 11, farmers = 10, salesmen = 9, physicians = 9, mechanics = 6, policemen = 6, managers = 6, engineers = 5, teachers = 4, housewives = 3, students = 3, armed.forces = 1)) par(las = 3) barplot(rbind(nr.prof)) # R 0.63.2: shows alignment problem par(las = 0) # reset to default require(grDevices) # for gray ## 'fg' use: plot(1:12, type = \"b\", main = \"'fg' : axes, ticks and box in gray\", fg = gray(0.7), bty = \"7\" , sub = R.version.string) ex &lt;- function() { old.par &lt;- par(no.readonly = TRUE) # all par settings which # could be changed. on.exit(par(old.par)) ## ... ## ... do lots of par() settings and plots ## ... invisible() #-- now, par(old.par) will be executed } ex() ## Line types showLty &lt;- function(ltys, xoff = 0, ...) { stopifnot((n &lt;- length(ltys)) &gt;= 1) op &lt;- par(mar = rep(.5,4)); on.exit(par(op)) plot(0:1, 0:1, type = \"n\", axes = FALSE, ann = FALSE) y &lt;- (n:1)/(n+1) clty &lt;- as.character(ltys) mytext &lt;- function(x, y, txt) text(x, y, txt, adj = c(0, -.3), cex = 0.8, ...) abline(h = y, lty = ltys, ...); mytext(xoff, y, clty) y &lt;- y - 1/(3*(n+1)) abline(h = y, lty = ltys, lwd = 2, ...) mytext(1/8+xoff, y, paste(clty,\" lwd = 2\")) } showLty(c(\"solid\", \"dashed\", \"dotted\", \"dotdash\", \"longdash\", \"twodash\")) par(new = TRUE) # the same: showLty(c(\"solid\", \"44\", \"13\", \"1343\", \"73\", \"2262\"), xoff = .2, col = 2) showLty(c(\"11\", \"22\", \"33\", \"44\", \"12\", \"13\", \"14\", \"21\", \"31\")) # use par() to set-up the layout of subgraphs # use the parameter main=c(0.2, 0.2, 0.2, 0.2) to thrink the padding of figures. par(mfrow=c(3,2), mai= c(0.2, 0.2, 0.2, 0.2)) for(i in 1:6){ barplot(unlist(m55[i, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) } # plot more rows to see what happens par(mfrow=c(3,2), mai= c(0.2, 0.2, 0.2, 0.2)) for(i in 1:10){ barplot(unlist(m55[i, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) } # plot all subplots in a figure # nrow() to check number of row of m55. nrow(m55) ## [1] 18 # use par() to set-up plotting parameters. par(mfrow=c(4, 6), mai= c(0.2, 0.2, 0.2, 0.2)) # use for-loop to plot all graph as subgraph for (i in 1:nrow(m55)){ barplot(unlist(m55[i, -1]), border=NA, space=0, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) } par(mfrow=c(4,6), mai= c(0.2, 0.2, 0.2, 0.2)) for (i in 1:nrow(m55)){ barplot(unlist(m55[i, -1]), border=NA, space=0,xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) title(m55[i,1], line = -4, cex.main=3) } 4.5.6 Practice02_1_1 Plotting more # plotting matleave_95 != 5 but matleve_13 == 5 # plotting for matleave_13 == 4 4.5.7 Practice02_2_2 selecting and filtering by dplyr I df &lt;- read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) # select columns by index # matleave &lt;- df[ , c(3, 6:24)] # select all NA cells and assign 0 to them # matleave[is.na(matleave)] &lt;- 0 # filter rows by condition # m5 &lt;- matleave[matleave$&#39;matleave_13&#39; == 5, ] # filter rows by condition # m55&lt;- m5[m5$&#39;matleave_95&#39; == 5,] # plot par(mfrow=c(4,6), mai= c(0.2, 0.2, 0.2, 0.2)) for (i in c(1:nrow(m55))){ barplot(unlist(m55[i,-1]), border=NA, space=0,xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) title(m55[i,1], line = -4, cex.main=3) } 4.5.8 (More) Clean version # readxl::read_excel() to import the xls file df &lt;- read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) # select iso3, and matleave columns by index matleave &lt;- df[ , c(3, 6:24)] # str() to inspect the data structure of str(matleave) ## tibble [197 Ã— 20] (S3: tbl_df/tbl/data.frame) ## $ iso3 : chr [1:197] &quot;AFG&quot; &quot;ALB&quot; &quot;DZA&quot; &quot;AND&quot; ... ## $ matleave_95: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_96: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_97: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_98: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_99: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_00: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_01: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_02: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_03: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_04: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_05: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_06: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_07: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_08: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_09: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_10: num [1:197] 2 5 3 3 2 2 2 5 NA 5 ... ## $ matleave_11: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_12: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_13: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... # select all NA cells and assign 0 to them matleave[is.na(matleave)] &lt;- 0 # filter rows by condition m5 &lt;- matleave[matleave$&#39;matleave_13&#39; == 5, ] # filter rows by condition m55&lt;- m5[m5$&#39;matleave_95&#39; == 5,] # plot par(mfrow=c(4,6), mai= c(0.2, 0.2, 0.2, 0.2)) for (i in c(1:nrow(m55))){ barplot(unlist(m55[i,-1]), border=NA, space=0,xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) title(m55[i,1], line = -4, cex.main=3) } library(tidyverse) options(stringsAsFactors = F) options(scipen = 999) library(readxl) read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) %&gt;% select(iso3, 6:24) %&gt;% filter(matleave_13 == 5, matleave_95 == 5) %&gt;% gather(&quot;year&quot;, &quot;degree&quot;, 2:20) %&gt;% # spread(year, degree, fill = 0) %&gt;% View replace_na(list(degree = 0)) %&gt;% mutate(year2 = as.POSIXct(strptime(year, &quot;matleave_%y&quot;))) %&gt;% mutate(year3 = lubridate::year(year2)) %&gt;% ggplot() + aes(year3, degree) + geom_col(color = &quot;royalblue&quot;, fill = &quot;royalblue&quot;) + facet_wrap(~ iso3) + theme_void() 4.5.9 (More) The fittest version to compute staySame # staySame version # staySame &lt;- apply(m5[,2:20], 1, function(x) length(unique(x[!is.na(x)]))) # m55 &lt;- m5[staySame, ] # m50 &lt;- m5[!staySame, ] "],["æ¨ç´åˆ†æå°åŒ—ä½å®…ç«Šç›œé»ä½.html", "4.6 æ¨ç´åˆ†æï¼šå°åŒ—ä½å®…ç«Šç›œé»ä½", " 4.6 æ¨ç´åˆ†æï¼šå°åŒ—ä½å®…ç«Šç›œé»ä½ 4.6.1 è®€å–æª”æ¡ˆ é¦–å…ˆè¦è‡³è‡ºåŒ—è³‡æ–™å¤§å¹³å°ä¸ŠæŸ¥è©¢ã€Œä½å®…ç«Šç›œã€ï¼Œå¯ä»¥æ‰¾åˆ°è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Šã€‚å°‡è©²CSVæª”ä¸‹è¼‰è‡³å€‹äººæœ¬æ©Ÿç«¯ï¼Œç½®å…¥data è³‡æ–™å¤¾ä¸­ï¼Œä¾¿å¯ä»¥ç”¨read.csv()è®€å–è©²æª”æ¡ˆã€‚ read.csv() to read csv and convert it to a data.frame df &lt;- read.csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) head(df) ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ str(df) # Checking the strcutrue of it ## &#39;data.frame&#39;: 3347 obs. of 5 variables: ## $ ç·¨è™Ÿ : int 1 2 3 4 5 6 7 8 9 10 ... ## $ æ¡ˆé¡ : chr &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; ... ## $ ç™¼ç”Ÿæ—¥æœŸ: int 1030623 1040101 1040101 1040101 1040101 1040102 1040102 1040102 1040102 1040104 ... ## $ ç™¼ç”Ÿæ™‚æ®µ: chr &quot;08~10&quot; &quot;00~02&quot; &quot;00~02&quot; &quot;06~08&quot; ... ## $ ç™¼ç”Ÿåœ°é»: chr &quot;è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ&quot; ... summary(df) # glimpse() is the tibble package&#39;s function. ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» Min. : 1.0 Length:3347 Min. :1030623 Length:3347 Length:3347 1st Qu.: 837.5 Class :character 1st Qu.:1050320 Class :character Class :character Median :1674.0 Mode :character Median :1060708 Mode :character Mode :character Mean :1674.0 NA Mean :1063954 NA NA 3rd Qu.:2510.5 NA 3rd Qu.:1080306 NA NA Max. :3347.0 NA Max. :1110328 NA NA ç”¨readr::read_csv()ä¾†è®€å–ã€‚ã€‚é™¤äº† baseå¥—ä»¶çš„read.csv()å¤–ï¼Œä¹Ÿå¯ä½¿ç”¨readrå¥—ä»¶çš„read_csv()å‡½å¼ä¾†è®€å–ï¼Œè©²å¥—ä»¶å±¬æ–¼tidyverseå¥—ä»¶ç³»çš„å…¶ä¸­ä¸€å€‹å¥—ä»¶ï¼Œå¦‚æœå·²ç¶“æœ‰ç”¨install.packages(\"tidyverse\")å®‰è£éï¼Œåªè¦ç”¨library(tidyverse)å°±å¯ä»¥ä½¿ç”¨read_csv()å‡½å¼ã€‚åœ¨æ­¤é¼“å‹µå„ä½ä½¿ç”¨tidyverseç³»åˆ—å¥—ä»¶ã€‚æ™®éä¾†èªªï¼Œread_csv() çš„åŠŸèƒ½å’Œæ•ˆæœéƒ½æœƒæ¯”read.csv()å¥½ï¼Œè©²å‡½å¼é‚„æœƒè‡ªå‹•çŒœæ¸¬æ¯å€‹è®Šæ•¸çš„è®Šæ•¸å‹æ…‹ä¸¦ç›´æ¥é€²è¡Œè½‰æ›ï¼ˆå°¤å…¶æ˜¯æœ‰æ™‚é–“æ¬„ä½çš„æ™‚å€™ï¼Œæœƒéå¸¸æ–¹ä¾¿ï¼‰ã€‚ é™¤éŒ¯ï¼šè¬ä¸€é‡åˆ°ä¸­æ–‡æª”æ¡ˆæœƒæœ‰è®€æª”ç·¨ç¢¼å•é¡Œæ™‚ï¼Œæœ‰å¯èƒ½è©²æª”æ¡ˆæ˜¯ç”¨big5ä¾†å„²å­˜çš„ï¼Œå¯ä»¥åœ¨read_csv()ä¸­è¨­å®šlocaleä¾†æŒ‡å®šè®€å–çš„ç·¨ç¢¼æ–¹æ³•ã€‚å¦‚read_csv(url, locale = locale(encoding = \"Big5\")) library(readr) df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) # df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;, locale = locale(encoding = &quot;Big5&quot;)) df %&gt;% head() ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ ç›´æ¥ä¾è³‡æ–™ç¶²å€è®€å–æª”æ¡ˆã€‚ç¾åœ¨çš„ç¨‹å¼èªè¨€æ‰€è¨­è¨ˆçš„è®€å–æª”æ¡ˆå‡½å¼é€šå¸¸æœƒå…è¨±ä½¿ç”¨è€…ç›´æ¥è®€å–è³‡æ–™æ‰€åœ¨çš„URLã€‚æ‰€ä»¥ï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥å¾ç¶²è·¯ä¸Šè¼‰å…¥å°åŒ—å¸‚ç«Šç›œæ¡ˆè³‡æ–™ã€‚é¦–å…ˆè¦è‡³è‡ºåŒ—è³‡æ–™å¤§å¹³å°ä¸ŠæŸ¥è©¢ã€Œä½å®…ç«Šç›œã€ï¼Œå¯ä»¥æ‰¾åˆ°è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Šï¼Œé»é¸å¾Œå°å³ä¸Šæ–¹çš„ä¸‹è¼‰æŒ‰å³éµå¯å–å¾—éˆçµåˆ°è©²è³‡æ–™çš„URLï¼ˆå¦‚https://data.taipei/api/getDatasetInfo/downloadResource?id=68785231-d6c5-47a1-b001-77eec70bec02&amp;rid=93d9bc2d-af08-4db7-a56b-9f0a49226fa3ï¼‰ã€‚ ç”±æ–¼è©²è³‡æ–™ç¶²å€ä¼¼éæ°¸ä¹…ç¶²å€ï¼Œæ•…æœ¬ç¯„ä¾‹ä¸¦æœªåŸ·è¡Œä»¥ä¸‹ç¨‹å¼ç¢¼ï¼Œåƒ…æä¾›ç¯„ä¾‹ç¨‹å¼ç¢¼è®“å€‹äººæ›¿æ›ç¶²å€ä¾†åšæ¸¬è©¦ã€‚ (åƒè€ƒ) ç”¨Rç¨‹å¼å°‡è©²ç¶²å€çš„æª”æ¡ˆæŠ“å›æœ¬æ©Ÿç«¯å„²å­˜ã€‚éƒ¨åˆ†Macé›»è…¦ç„¡æ³•ä½¿ç”¨read.csv()å¾ç¶²è·¯ä¸Šå–å¾—è³‡æ–™åˆè½‰ç‚ºdata.frameï¼Œä¸€å€‹å¯è¡Œçš„è¾¦æ³•æ˜¯å…ˆç”¨GET(url,write_disk(\"data/tptheft.csv\"))å°‡å…¶å–å›ä¸¦å‘½åç‚ºdata/tptheft.csvï¼Œä¹‹å¾Œå†ç”¨df &lt;- read.csv(\"data/tptheft.csv\")ç›´æ¥è®€å–è©²æª”æ¡ˆã€‚ 4.6.2 æŸ¥çœ‹è³‡æ–™å…§å®¹ View(df) ç”¨RStudioæ‰€æä¾›çš„GUIç›´æ¥è§€çœ‹è®Šæ•¸ã€‚è‡ªè¡Œç§»å»#è¨»è§£ç¬¦è™Ÿä¾†æ¸¬è©¦ï¼Œå› ç‚ºknitæˆhtmlæª”æ™‚ï¼Œæœ‰View()çš„æŒ‡ä»¤éƒ½æœƒé€ æˆknitç¨‹åºä¸­æ–·ã€‚ head(df) å–å‰é¢å…­ç­†è³‡æ–™ï¼ˆä¹Ÿå°±æ˜¯å…­åˆ—çš„è³‡æ–™ä¾†æ¦‚è§€è©²è³‡æ–™ï¼‰ class(df) å°å‡ºè©² str(df) # View(df) head(df) # get first part of the data.frame ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ class(df) ## [1] &quot;spec_tbl_df&quot; &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; str(df) ## spec_tbl_df [3,347 Ã— 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame) ## $ ç·¨è™Ÿ : num [1:3347] 1 2 3 4 5 6 7 8 9 10 ... ## $ æ¡ˆé¡ : chr [1:3347] &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; ... ## $ ç™¼ç”Ÿæ—¥æœŸ: num [1:3347] 1030623 1040101 1040101 1040101 1040101 ... ## $ ç™¼ç”Ÿæ™‚æ®µ: chr [1:3347] &quot;08~10&quot; &quot;00~02&quot; &quot;00~02&quot; &quot;06~08&quot; ... ## $ ç™¼ç”Ÿåœ°é»: chr [1:3347] &quot;è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ&quot; ... ## - attr(*, &quot;spec&quot;)= ## .. cols( ## .. ç·¨è™Ÿ = col_double(), ## .. æ¡ˆé¡ = col_character(), ## .. ç™¼ç”Ÿæ—¥æœŸ = col_double(), ## .. ç™¼ç”Ÿæ™‚æ®µ = col_character(), ## .. ç™¼ç”Ÿåœ°é» = col_character() ## .. ) ## - attr(*, &quot;problems&quot;)=&lt;externalptr&gt; summary(df) ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» Min. : 1.0 Length:3347 Min. :1030623 Length:3347 Length:3347 1st Qu.: 837.5 Class :character 1st Qu.:1050320 Class :character Class :character Median :1674.0 Mode :character Median :1060708 Mode :character Mode :character Mean :1674.0 NA Mean :1063954 NA NA 3rd Qu.:2510.5 NA 3rd Qu.:1080306 NA NA Max. :3347.0 NA Max. :1110328 NA NA # look up help 4.6.3 è§€å¯Ÿè³‡æ–™ç¶­åº¦ e.g., dim(), ncol(), nrow(),length() dim(df) ## [1] 3347 5 ncol(df) ## [1] 5 nrow(df) ## [1] 3347 length(df) ## [1] 5 4.6.4 è§€å¯Ÿè®Šæ•¸åç¨± names(df) åˆ—å‡ºè®Šæ•¸åç¨± df$ç™¼ç”Ÿåœ°é» é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ df$ç™¼ç”Ÿæ™‚æ®µ é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ length(df$ç™¼ç”Ÿæ™‚æ®µ) é¡¯ç¤ºè©²è®Šæ•¸çš„é•·åº¦ï¼ˆç›¸ç•¶æ–¼æœ‰å¹¾å€‹ï¼‰ names(df) ## [1] &quot;ç·¨è™Ÿ&quot; &quot;æ¡ˆé¡&quot; &quot;ç™¼ç”Ÿæ—¥æœŸ&quot; &quot;ç™¼ç”Ÿæ™‚æ®µ&quot; &quot;ç™¼ç”Ÿåœ°é»&quot; head(df$ç™¼ç”Ÿåœ°é») ## [1] &quot;è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ&quot; ## [2] &quot;è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ&quot; ## [3] &quot;è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ&quot; ## [4] &quot;è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ&quot; ## [5] &quot;è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ&quot; ## [6] &quot;è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ&quot; head(df$ç™¼ç”Ÿæ™‚æ®µ) ## [1] &quot;08~10&quot; &quot;00~02&quot; &quot;00~02&quot; &quot;06~08&quot; &quot;10~12&quot; &quot;00~02&quot; length(df$ç™¼ç”Ÿæ™‚æ®µ) ## [1] 3347 4.6.5 èƒå–æ‰€éœ€æ–°è®Šé … è©²data.frameåŒ…å«ç·¨è™Ÿã€æ¡ˆé¡ã€ç™¼ç”Ÿæ—¥æœŸã€ç™¼ç”Ÿæ™‚æ®µã€ç™¼ç”Ÿåœ°é»äº”å€‹è®Šé …ã€‚å…¶ä¸­æ¯”è¼ƒæœ‰æ„ç¾©çš„æ‡‰è©²æ˜¯ç™¼ç”Ÿæ—¥æœŸã€ç™¼ç”Ÿæ™‚æ®µå’Œç™¼ç”Ÿåœ°é»ã€‚ç„¶è€Œï¼Œç™¼ç”Ÿåœ°é»å¹¾ä¹æ˜¯å®Œæ•´åœ°å€ï¼Œé™¤éè¦ç¹ªè£½ç™¼ç”Ÿçš„åœ°åœ–é»ä½åœ°åœ–ï¼Œæ‰æœƒéœ€è¦è¿‘ä¹å®Œæ•´çš„åœ°å€ã€‚å‡è¨­æˆ‘å€‘çš„ç›®æ¨™æ˜¯æŠ½å–å‡ºå°åŒ—å¸‚çš„ã€Œè¡Œæ”¿å€ã€ï¼Œç™¼ç”Ÿåœ°é»çš„æ ¼å¼é‚„è »ä¸€è‡´çš„å¦‚ã€Œè‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91120è™Ÿã€ã€‚å› æ­¤ï¼Œæˆ‘å€‘åªè¦æŠ½å‡ºç™¼ç”Ÿåœ°é»çš„ç¬¬4åˆ°ç¬¬5å€‹å­—ï¼Œæˆ–è€…ç¬¬46å€‹å­—å³å¯ã€‚ å¾ä¸€å€‹å­—ä¸²ä¸­æŠ½å–å‡ºç¬¬nå€‹å­—åˆ°ç¬¬må€‹å­—ï¼Œè¦ç”¨substr()æˆ–stringrå¥—ä»¶çš„str_sub()ã€‚å¯ä»¥ç”¨?substræˆ–?str_subæŸ¥è©¢helpä¸­çš„ç›¸é—œç”¨æ³•ã€‚åœ¨æ­¤ æˆ‘å°‡ä¸­æ–‡è®Šæ•¸ç¾åœ¨æ™‚é–“çš„è³‡æ–™æŒ‡çµ¦ä¸€å€‹æ–°çš„è‹±æ–‡è®Šé …timeã€‚ å¾è®Šæ•¸ç™¼ç”Ÿåœ°é»ï¼Œç”¨substr()å–å‡ºè¡Œæ”¿å€ï¼ˆregionï¼‰ æˆ–ç”¨stringr::str_sub() ?substræŸ¥è©¢å…¶ç”¨æ³•å’Œæ„ç¾©ã€‚ç›¸ç•¶æ–¼getting sub string since x to yã€‚ # Get substring of var &quot;ç™¼ç”Ÿæ™‚æ®µ&quot; and assign to a new time var df$time &lt;- df$ç™¼ç”Ÿæ™‚æ®µ # Get substring of var &quot;ç™¼ç”Ÿåœ°é»&quot; and assign to a new region var df$region &lt;- substr(df$ç™¼ç”Ÿåœ°é», 4, 5) head(df) ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» time region 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ 08~10 ä¸­æ­£ 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ 00~02 æ–‡å±± 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ 00~02 ä¿¡ç¾© 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ 06~08 ä¸­å±± 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ 10~12 æ–‡å±± 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ 00~02 å£«æ— Practice. èƒå–æœˆä»½ä½œç‚ºæ–°è®Šé …month é™¤äº†æ™‚é–“å’Œåœ°å€å¯èƒ½æœƒæœ‰å·®åˆ¥å¤–ï¼Œé‚£æœˆä»½æœƒä¸æœƒç«Šç›œæ¡ˆçš„æ•¸é‡ä¹Ÿæœ‰å·®ç•°å‘¢ï¼Ÿæœƒä¸æœƒå†¬å¤©å°å·ä¹Ÿéƒ½åœ¨å®¶ä¼‘æ¯äº†ï¼Œå¤å¤©å¤šå‘¢ï¼Ÿè«‹å˜—è©¦å¾ç™¼ç”Ÿæ—¥æœŸèƒå–å‡ºç«Šç›œæ¡ˆç™¼ç”Ÿçš„æœˆä»½ï¼Œä¸¦å„²å­˜ç‚ºä¸€å€‹æ–°çš„è®Šé …monthã€‚ # YOUR CODE SHOULD BE HERE 4.6.6 IV. æ¨ç´åˆ†æï¼šè¨ˆæ•¸ã€åŠ ç¸½èˆ‡å½™æ•´ã€‚ Pivot analysis: Counting and Summarizing æ¸…ç†å®Œè³‡æ–™å¾Œï¼Œæˆ‘å€‘è¦å›ç­”çš„ç¬¬ä¸€å€‹æ•¸æ“šå•é¡Œé€šå¸¸æ˜¯ã€Œé‚£XXXçš„æ¡ˆä¾‹æœ‰å¹¾å€‹ï¼Ÿã€ä¾‹å¦‚ï¼šå¤§å®‰å€æœ‰å¤šå°‘ç«Šç›œæ¡ˆï¼Ÿ10~12é€™å€‹æ™‚æ®µæœ‰å¤šå°‘æ¡ˆä¾‹ã€‚ 4.6.7 æ–¹æ³•ä¸€ï¼šCounting by table() table()å‡½å¼å¯ä»¥å°Vectorä¸­çš„å€¼é€²è¡Œè¨ˆæ•¸ï¼ˆCountingï¼‰ã€‚table(df$time) ç›¸ç•¶æ–¼å»è¨ˆæ•¸ä¸åŒçš„æ™‚é–“å€é–“å‡ºç¾å¤šå°‘èµ·æ¡ˆä¾‹ï¼›table(df$region) ç›¸ç•¶æ–¼å»è¨ˆæ•¸ä¸åŒåœ°å€å„å‡ºç¾å¤šå°‘èµ·æ¡ˆä¾‹ã€‚ æç¤ºï¼šå¯ä»¥ç”¨class(tb_1) è§€å¯Ÿç”¨table() è¨ˆæ•¸å¾Œæ‰€ç”¢ç”Ÿçš„è³‡æ–™å‹æ…‹ï¼ˆtableï¼‰ã€‚ # counting the frequency of time variable (tb_1 &lt;- table(df$time)) 00~02 02~04 03~05 04~06 05~07 06~08 08~10 09~11 10~12 11~03 11~13 12~14 12~15 14~16 15~17 15~18 16~18 17~19 18~20 18~21 19~21 20~22 21~23 21~24 22~24 23~01 272 214 8 156 23 191 305 6 338 1 26 338 2 342 3 1 246 21 314 1 4 303 5 1 206 20 class(tb_1) # table ## [1] &quot;table&quot; # counting the frequency of region variable table(df$region) åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ 318 311 172 181 303 373 220 350 204 214 438 263 4.6.8 æ–¹æ³•äºŒï¼šCounting by tapply() æˆ‘å€‘ä¹Ÿå¯ç”¨tapply() å‡½å¼ä¾†é”åˆ°ä¸€æ¨£çš„ç›®çš„ã€‚Applyå®¶æ—çš„å‡½å¼éƒ½æ˜¯ï¼Œé‡å°æŸå€‹è³‡æ–™ï¼Œå°‡æŸå€‹å‡½å¼å¥—ç”¨åˆ°æŸå€‹ç‰©ä»¶ä¸Šã€‚tapply() å³æ˜¯ç”¨ä¾†åšè¨ˆæ•¸çš„ï¼Œtapply(df$ç·¨è™Ÿ, df$time, length)æœ‰ä¸‰å€‹è¼¸å…¥ï¼Œç¬¬ä¸€å€‹è¼¸å…¥ç‚ºæ•´é«”ç‰©ä»¶ï¼Œç¬¬äºŒå€‹è¼¸å…¥ç‚ºè¦æ“šä»¥å½™æ•´çš„è®Šé …ï¼Œåœ¨æ­¤ç‚ºdf$timeï¼Œç¬¬ä¸‰å€‹æ˜¯è¦ç”¨ä¾†å½™æ•´çš„å‡½å¼ï¼Œå› ç‚ºé€™è£¡è¦åšè¨ˆæ•¸ï¼Œæ‰€ä»¥è¦ç”¨lengthå‡½å¼ã€‚ è¨»ï¼šåŒæ¨£ç”¨class()ä¾†è§€å¯Ÿå½™æ•´å¾Œçš„è³‡æ–™å‹æ…‹ç‚ºarrayï¼Œå’Œå‰è€…çš„tableè³‡æ–™å‹æ…‹ä¸åŒã€‚ # tapply() one arbitrary var by var time with length() function (tb_2 &lt;- tapply(df$ç·¨è™Ÿ, df$time, length)) ## 00~02 02~04 03~05 04~06 05~07 06~08 08~10 09~11 10~12 11~03 11~13 12~14 12~15 ## 272 214 8 156 23 191 305 6 338 1 26 338 2 ## 14~16 15~17 15~18 16~18 17~19 18~20 18~21 19~21 20~22 21~23 21~24 22~24 23~01 ## 342 3 1 246 21 314 1 4 303 5 1 206 20 class(tb_2) ## [1] &quot;array&quot; # tapply() one arbitrary var by var region with length() function tapply(df$ç·¨è™Ÿ, df$region, length) ## åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ ## 318 311 172 181 303 373 220 350 204 214 438 263 4.6.9 V. ä¾ç…§è®Šæ•¸å€¼ç¯©é¸è³‡æ–™ è©²é …ç«Šç›œæ¡ˆè³‡æ–™æ•´ç†æ™‚ç¶“å¸¸ä¸æ…ç”¨ä¸åŒçš„æ™‚é–“å€é–“ä¾†æ¨™è¨˜ï¼Œæœ‰æ™‚å€™ä¹Ÿæœƒä¸å°å¿ƒæŠŠæ–°åŒ—å¸‚çš„è³‡æ–™çµ¦é‚£é€²ä¾†ï¼Œæ‰€ä»¥éœ€è¦åšè³‡æ–™ç¯©é¸ã€‚å¾å„å€‹æ™‚é–“å€é–“çš„ç«Šç›œæ¡ˆå‡ºç¾æ¬¡æ•¸ä¾†è§€å¯Ÿï¼Œæœ‰å°‘æ•¸çš„æ¡ˆä»¶å‡ºç¾åœ¨å¥‡æ•¸çš„æ™‚é–“å€é–“å¦‚09~11æˆ–12~15ç­‰ç­‰éœ€è¦ç¯©é™¤ï¼›å¾å„å€‹è¡Œæ”¿å€çš„ç«Šç›œæ¡ˆå‡ºç¾æ¬¡æ•¸ä¾†è§€å¯Ÿï¼Œç¢ºå¯¦éƒ½æ˜¯å°åŒ—å¸‚çš„ç«Šç›œæ¡ˆã€‚ æ¥ä¸‹ä¾†è¦ç”¨baseå¥—ä»¶çš„Rï¼Œæ ¹æ“šæŸå€‹è®Šæ•¸å€¼ï¼ˆä¾‹å¦‚ä¸Šè¿°çš„æ™‚é–“ï¼‰ä¾†ç¯©å‡ºç¬¦åˆæ¢ä»¶çš„è³‡æ–™ï¼Œæˆ–è€…ç¯©å»ä¸ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ã€‚å…¶èªæ³•æ˜¯è¦åœ¨df[ , ]é€—è™Ÿå‰åŠ ä¸Šç¯©é¸çš„æ¢ä»¶ï¼Œä¹Ÿå°±æ˜¯å°è³‡æ–™åˆ—é€²è¡Œç¯©é¸ï¼Œç¯©å‡ºæˆ–ç¯©é™¤éƒ½æ˜¯ä»¥æ•´åˆ—ç‚ºå–®ä½ã€‚åœ¨æ­¤çš„æ¢ä»¶æ˜¯df$timeåœ¨00~02ã€02~04ã€â€¦ä¹‹é–“ï¼›æˆ–è€…æ˜¯df$timeä¸åœ¨03~05ã€05~07ã€â€¦ä¹‹é–“ã€‚è¡¨ç¤ºæ³•åˆ†åˆ¥å¦‚ä¸‹ï¼š df$time %in% c(&quot;00~02&quot;, &quot;02~04&quot;, &quot;04~6&quot;,...) !df$time %in% c(&quot;03~05&quot;, &quot;05~07&quot;, ...) %in% è¡¨ç¤ºçš„æ˜¯å·¦æ–¹df$timeçš„å€¼æ˜¯å¦æ˜¯å³æ–¹Vectorä¸­çš„å…¶ä¸­ä¸€å€‹ å¦‚æœè¦è¡¨ç¤ºä¸åŒ…å«ï¼Œå°±åœ¨df%timeåŠ ä¸€å€‹NOTï¼Œä¹Ÿå°±æ˜¯!ã€‚ ä¾ç…§å„çµ„æ™‚é–“çš„æ¡ˆä¾‹å€‹æ•¸çµ±è¨ˆå¾Œï¼Œç¯©é™¤è³‡æ–™æœªè¶³100çš„æ™‚é–“å€é–“å¦‚ä¸‹ï¼Œæœ€å¾Œå†ç”¨table(df$time) è¨ˆç®—ä¸€æ¬¡ï¼Œç™¼ç¾æ¯å€‹æ™‚æ®µéƒ½å…©ä¸‰ã€ç™¾å€‹æ¡ˆä¾‹ï¼Œä¸”æ¶µè“‹æ•´æ—¥çš„æ™‚é–“ã€‚æ¸…ç†å¾Œæ²’æœ‰é‡ç–Šçš„æ™‚é–“å€é–“ï¼Œåšé¡åˆ¥è³‡æ–™åˆ†ææœƒæ¯”è¼ƒæº–ç¢ºã€‚ # filter out irrelevant timestamp df &lt;- df[!df$time %in% c(&quot;03~05&quot;, &quot;05~07&quot;, &quot;09~11&quot;, &quot;11~13&quot;, &quot;12~15&quot;, &quot;15~17&quot;, &quot;15~18&quot;, &quot;17~19&quot;, &quot; 18~21&quot;, &quot;19~21&quot;, &quot;21~23&quot;, &quot;21~24&quot;, &quot;23~01&quot;), ] table(df$time) 00~02 02~04 04~06 06~08 08~10 10~12 11~03 12~14 14~16 16~18 18~20 18~21 20~22 22~24 272 214 156 191 305 338 1 338 342 246 314 1 303 206 # filter out irrelevant region(area) # df &lt;- df[!df$region %in% c(&quot;ä¸‰é‡&quot;, &quot;ä¸­å’Œ&quot;, &quot;æ·¡æ°´&quot;, &quot;æ¿æ©‹&quot;), ] 4.6.10 VI. é›™è®Šæ•¸æ¨ç´åˆ†æ é¡åˆ¥è®Šé …åˆ†æé€šå¸¸æ˜¯è¦è€ƒé©—å…©å€‹è®Šé …é–“çš„é—œä¿‚ï¼Œå¾ä¸Šè¿°çš„è¨ˆæ•¸ä¸­ï¼Œæˆ‘å¯ä»¥çœ‹è¦‹ä¸åŒè¡Œæ”¿å€æˆ–è€…ä¸åŒæ™‚é–“çš„ç«Šç›œæ¡ˆæ•¸é‡ï¼Œä½†æˆ‘é€²ä¸€æ­¥æƒ³çŸ¥é“ï¼Œé‚£ä¸åŒè¡Œæ”¿å€çš„ç«Šç›œæ¡ˆå¸¸ç™¼ç”Ÿæ™‚é–“æ˜¯å¦ä¸åŒï¼Ÿé€™æ™‚å¾Œå°±è¦åšæ™‚é–“å’Œè¡Œæ”¿å€çš„äº¤å‰åˆ†æã€‚æˆ‘å€‘åŒæ¨£å¯ä»¥ç”¨table()å’Œtapply()ä¾†åšå…©å€‹è®Šé …çš„äº¤å‰åˆ†æï¼Œå¯«æ³•å¦‚ä¸‹ã€‚ 4.6.10.1 (1) by table() ç”¨table()ä¾†äº¤å‰åˆ†æçš„çµæœå¦‚ä¸‹ï¼Œæ‰€å¾—åˆ°çš„çµæœä¹‹è®Šæ•¸å‹æ…‹ä»æ˜¯tableå‹æ…‹ã€‚ # Tabulating time and region variables (res_table &lt;- table(df$time, df$region)) åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ 00~02 24 24 15 19 20 28 4 17 17 27 62 15 02~04 17 15 10 12 15 29 13 29 14 12 26 22 04~06 17 14 15 6 15 14 5 22 8 11 22 7 06~08 24 19 9 13 16 17 11 21 9 13 20 19 08~10 22 31 17 16 27 24 24 34 18 20 45 27 10~12 35 34 12 19 33 35 35 41 18 18 38 20 11~03 0 0 0 0 0 0 0 0 0 0 1 0 12~14 34 49 12 15 26 46 23 33 25 20 30 25 14~16 32 32 26 20 39 40 22 32 19 18 43 19 16~18 33 25 13 11 24 30 20 26 16 8 21 19 18~20 40 23 13 18 22 31 17 23 23 23 39 42 18~21 0 0 0 0 0 0 0 0 0 0 1 0 20~22 17 26 13 20 34 41 25 37 15 22 40 13 22~24 15 12 9 9 18 23 14 20 17 16 33 20 # Checking it class and its content class(res_table) ## [1] &quot;table&quot; 4.6.10.2 (2) by tapply() ç”¨tapply()ä¾†åšå…©å€‹è®Šæ•¸äº¤å‰åˆ†æçš„èªæ³•å¦‚ä¸‹ï¼Œå¿…é ˆè¦æŠŠå…©å€‹VectoråŒ…åœ¨ä¸€å€‹list()ä¸­ã€‚å…¶ä»–ä¸è®Šã€‚å…©å€‹è®Šé …ç”¨tapply()äº¤å‰åˆ†æå¾Œçš„çµæœï¼Œè®Šæ•¸å‹æ…‹æœƒè®Šæˆmatrixã€‚å‰è€…ç”¨table()ä¾†äº¤å‰åˆ†æçš„ä»æ˜¯tableå‹æ…‹ã€‚ res_tapply &lt;- tapply(df$ç·¨è™Ÿ, list(df$time, df$region), length) class(res_tapply) ## [1] &quot;matrix&quot; &quot;array&quot; res_tapply åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ 00~02 24 24 15 19 20 28 4 17 17 27 62 15 02~04 17 15 10 12 15 29 13 29 14 12 26 22 04~06 17 14 15 6 15 14 5 22 8 11 22 7 06~08 24 19 9 13 16 17 11 21 9 13 20 19 08~10 22 31 17 16 27 24 24 34 18 20 45 27 10~12 35 34 12 19 33 35 35 41 18 18 38 20 11~03 NA NA NA NA NA NA NA NA NA NA 1 NA 12~14 34 49 12 15 26 46 23 33 25 20 30 25 14~16 32 32 26 20 39 40 22 32 19 18 43 19 16~18 33 25 13 11 24 30 20 26 16 8 21 19 18~20 40 23 13 18 22 31 17 23 23 23 39 42 18~21 NA NA NA NA NA NA NA NA NA NA 1 NA 20~22 17 26 13 20 34 41 25 37 15 22 40 13 22~24 15 12 9 9 18 23 14 20 17 16 33 20 # View(res) 4.6.10.3 (3) by dplyr::count() é€™é‚Šå¤šä»‹ç´¹ä¸€å€‹ç”¨dplyrå¥—ä»¶çš„count()å‡½å¼ä¾†åšäº¤å‰åˆ†æçš„æ–¹æ³•ï¼ˆæœªä¾†æœƒå¸¸ç”¨é€™å€‹æ–¹æ³•ï¼Œå› ç‚ºdplyræ˜¯tidyverseç³»åˆ—å¥—ä»¶çš„æ ¸å¿ƒå¥—ä»¶ã€‚dplyrçš„å‡½å¼ç¬¬ä¸€å€‹åƒæ•¸æ°¸é æ˜¯è©²data.frameï¼Œ ä¾‹å¦‚count()ï¼›å¾Œé¢timeèˆ‡regionå‰‡æ˜¯é€™å€‹data.frameä¸­çš„å…©å€‹è®Šé …ã€‚ä¸åƒtapply()æˆ–table()çš„çµæœä¸€æ¨£ï¼Œæ¬„èˆ‡åˆ—åˆ†åˆ¥ç‚ºtimeèˆ‡regionï¼Œcount()å‡ºä¾†çš„çµæœæœƒæœ‰å…©å€‹è®Šé …åˆ†åˆ¥æ˜¯æŒ‡å®šè¦è¨ˆæ•¸çš„timeèˆ‡region ï¼Œä¸”æœƒæ–°å¢ä¸€å€‹è®Šé …nï¼Œä»£è¡¨é€™çµ„æ•¸æ“šï¼ˆtime x regionï¼‰å…±æœ‰å¹¾å€‹ã€‚é€™ç¨®è¡¨é”å‹æ…‹é€šå¸¸ç¨±ç‚ºlong-tableï¼ˆé•·è¡¨ï¼‰ã€è€Œtapply()æˆ–table() çš„çµæœé€šå¸¸ç¨±ç‚ºwide-tableï¼ˆå¯¬è¡¨ï¼‰ç‚ºå…¸å‹çš„äº¤å‰åˆ†æè¡¨ã€‚ ç›®å‰å¤§éƒ¨åˆ†çš„é¡åˆ¥è³‡æ–™åˆ†æé‚„æ˜¯æœƒæ¡ç”¨äº¤å‰åˆ†æè¡¨çš„å‹æ…‹ï¼Œä½†æœªä¾†æˆ‘å€‘è¦ç”¨tidyverseç³»åˆ—å¥—ä»¶åšå¤§é‡çš„æ•¸æ“šå½™æ•´æˆ–è¦–è¦ºåŒ–æ™‚ï¼Œéƒ½æœƒç›¡å¯èƒ½æƒ³è¾¦æ³•è½‰ç‚ºLong-tableå‹æ…‹ï¼Œè®“æ¯ä¸€æ¬„å‰›å¥½å°±æ˜¯ä¸€å€‹è®Šé …ã€‚åªè¦æ˜¯tidyverseç³»åˆ—å¥—ä»¶æ‰€è¨ˆç®—å‡ºä¾†çš„è³‡æ–™å‹æ…‹å¹¾ä¹éƒ½æ˜¯é¡ä¼¼data.frameçš„å‹æ…‹ï¼Œä¾‹å¦‚è§€å¯Ÿcountçš„çµæœä¾¿æ˜¯\"tbl_df\" \"tbl\" \"data.frame\"ã€‚ # counting by dplyr::count() library(dplyr) (res_count &lt;- count(df, time, region)) time region n 00~02 åŒ—æŠ• 24 00~02 å¤§å®‰ 24 00~02 å¤§åŒ 15 00~02 å—æ¸¯ 19 00~02 å…§æ¹– 20 00~02 å£«æ— 28 00~02 æ¾å±± 4 00~02 è¬è¯ 17 00~02 æ–‡å±± 17 00~02 ä¿¡ç¾© 27 00~02 ä¸­å±± 62 00~02 ä¸­æ­£ 15 02~04 åŒ—æŠ• 17 02~04 å¤§å®‰ 15 02~04 å¤§åŒ 10 02~04 å—æ¸¯ 12 02~04 å…§æ¹– 15 02~04 å£«æ— 29 02~04 æ¾å±± 13 02~04 è¬è¯ 29 02~04 æ–‡å±± 14 02~04 ä¿¡ç¾© 12 02~04 ä¸­å±± 26 02~04 ä¸­æ­£ 22 04~06 åŒ—æŠ• 17 04~06 å¤§å®‰ 14 04~06 å¤§åŒ 15 04~06 å—æ¸¯ 6 04~06 å…§æ¹– 15 04~06 å£«æ— 14 04~06 æ¾å±± 5 04~06 è¬è¯ 22 04~06 æ–‡å±± 8 04~06 ä¿¡ç¾© 11 04~06 ä¸­å±± 22 04~06 ä¸­æ­£ 7 06~08 åŒ—æŠ• 24 06~08 å¤§å®‰ 19 06~08 å¤§åŒ 9 06~08 å—æ¸¯ 13 06~08 å…§æ¹– 16 06~08 å£«æ— 17 06~08 æ¾å±± 11 06~08 è¬è¯ 21 06~08 æ–‡å±± 9 06~08 ä¿¡ç¾© 13 06~08 ä¸­å±± 20 06~08 ä¸­æ­£ 19 08~10 åŒ—æŠ• 22 08~10 å¤§å®‰ 31 08~10 å¤§åŒ 17 08~10 å—æ¸¯ 16 08~10 å…§æ¹– 27 08~10 å£«æ— 24 08~10 æ¾å±± 24 08~10 è¬è¯ 34 08~10 æ–‡å±± 18 08~10 ä¿¡ç¾© 20 08~10 ä¸­å±± 45 08~10 ä¸­æ­£ 27 10~12 åŒ—æŠ• 35 10~12 å¤§å®‰ 34 10~12 å¤§åŒ 12 10~12 å—æ¸¯ 19 10~12 å…§æ¹– 33 10~12 å£«æ— 35 10~12 æ¾å±± 35 10~12 è¬è¯ 41 10~12 æ–‡å±± 18 10~12 ä¿¡ç¾© 18 10~12 ä¸­å±± 38 10~12 ä¸­æ­£ 20 11~03 ä¸­å±± 1 12~14 åŒ—æŠ• 34 12~14 å¤§å®‰ 49 12~14 å¤§åŒ 12 12~14 å—æ¸¯ 15 12~14 å…§æ¹– 26 12~14 å£«æ— 46 12~14 æ¾å±± 23 12~14 è¬è¯ 33 12~14 æ–‡å±± 25 12~14 ä¿¡ç¾© 20 12~14 ä¸­å±± 30 12~14 ä¸­æ­£ 25 14~16 åŒ—æŠ• 32 14~16 å¤§å®‰ 32 14~16 å¤§åŒ 26 14~16 å—æ¸¯ 20 14~16 å…§æ¹– 39 14~16 å£«æ— 40 14~16 æ¾å±± 22 14~16 è¬è¯ 32 14~16 æ–‡å±± 19 14~16 ä¿¡ç¾© 18 14~16 ä¸­å±± 43 14~16 ä¸­æ­£ 19 16~18 åŒ—æŠ• 33 16~18 å¤§å®‰ 25 16~18 å¤§åŒ 13 16~18 å—æ¸¯ 11 16~18 å…§æ¹– 24 16~18 å£«æ— 30 16~18 æ¾å±± 20 16~18 è¬è¯ 26 16~18 æ–‡å±± 16 16~18 ä¿¡ç¾© 8 16~18 ä¸­å±± 21 16~18 ä¸­æ­£ 19 18~20 åŒ—æŠ• 40 18~20 å¤§å®‰ 23 18~20 å¤§åŒ 13 18~20 å—æ¸¯ 18 18~20 å…§æ¹– 22 18~20 å£«æ— 31 18~20 æ¾å±± 17 18~20 è¬è¯ 23 18~20 æ–‡å±± 23 18~20 ä¿¡ç¾© 23 18~20 ä¸­å±± 39 18~20 ä¸­æ­£ 42 18~21 ä¸­å±± 1 20~22 åŒ—æŠ• 17 20~22 å¤§å®‰ 26 20~22 å¤§åŒ 13 20~22 å—æ¸¯ 20 20~22 å…§æ¹– 34 20~22 å£«æ— 41 20~22 æ¾å±± 25 20~22 è¬è¯ 37 20~22 æ–‡å±± 15 20~22 ä¿¡ç¾© 22 20~22 ä¸­å±± 40 20~22 ä¸­æ­£ 13 22~24 åŒ—æŠ• 15 22~24 å¤§å®‰ 12 22~24 å¤§åŒ 9 22~24 å—æ¸¯ 9 22~24 å…§æ¹– 18 22~24 å£«æ— 23 22~24 æ¾å±± 14 22~24 è¬è¯ 20 22~24 æ–‡å±± 17 22~24 ä¿¡ç¾© 16 22~24 ä¸­å±± 33 22~24 ä¸­æ­£ 20 (res_count &lt;- count(df, time, region)) %&gt;% datatable() class(res_count) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; é‚£é•·è¡¨åˆ—å¯ä»¥è½‰ç‚ºå¯¬è¡¨å—ï¼Ÿå¯ä»¥ï¼Œtidyverseç³»åˆ—å¥—ä»¶ä¸­çš„tidyrå¥—ä»¶æœ‰å€‹å‡½å¼spread()å¯ä»¥æ¥è‘—æŠŠæŸå€‹è®Šé …å±•é–‹ç‚ºæ¬„ã€‚ä¾‹å¦‚åŸæœ¬ä¸Šè¿°çš„åˆ—æ˜¯æ™‚é–“èˆ‡è¡Œæ”¿å€çš„äº¤å‰çµ„åˆï¼Œä½†æˆ‘å¯ä»¥æŠŠè¡Œæ”¿å€å±•é–‹ç‚ºæ¬„ã€æˆ–è€…æŠŠæ™‚é–“å±•é–‹ç‚ºæ¬„ã€‚spread(res_count, region, n, fill = 0) æœ‰å››å€‹åƒæ•¸ï¼Œéµå¾ªtidyverseç³»åˆ—å¥—ä»¶çš„è¦å‰‡ï¼Œç¬¬ä¸€å€‹ä½ç½®ç‚ºdata.frameï¼Œç¬¬äºŒå€‹åƒæ•¸å‰‡æ˜¯è¦è¢«å±•é–‹è‡³æ¬„çš„è®Šé …é€™è£¡ç‚ºregionï¼Œç¬¬ä¸‰å€‹åƒæ•¸å‰‡æ˜¯å› æ‡‰regionè¢«å±•é–‹å¾Œï¼Œé‚£ä¸­é–“äº¤å‰åˆ†æçš„æ•¸å€¼å°±æ˜¯nï¼Œæœ€å¾Œä¸€å€‹åƒæ•¸æ˜¯é¿å…spreadæ™‚æœ‰äº›äº¤å‰çµ„æ˜¯æ²’æœ‰è³‡æ–™çš„ï¼Œå› æ­¤fill=0å¯ä»¥æŒ‡å®šï¼Œå¦‚æœæŸå€‹time x regionçš„äº¤å‰çµ„åˆ¥æ˜¯æ²’è³‡æ–™çš„ï¼Œå°±å¡«ä¸Š0ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç”¨fill=NAå¡«ä¸ŠNAã€‚ä»¥ä¸‹çš„ä¾‹å­ä¸­ä¹Ÿæä¾›äº†å°‡time å±•é–‹è‡³æ¬„çš„å¯«æ³•ä¾›åƒè€ƒã€‚ å±•é–‹å¾Œçš„è³‡æ–™å‹æ…‹å’Œå‰è€…è¨ˆæ•¸å¾Œçš„è³‡æ–™å‹æ…‹ä¸€æ¨£ï¼Œéƒ½æ˜¯\"tbl_df\" \"tbl\" \"data.frame\"ã€‚é€™æ˜¯ç‚ºä»€éº¼tidyverseç³»åˆ—çš„å¥—ä»¶é€æ¼¸è®ŠæˆRçš„é¡¯å­¸çš„åŸå› ä¹‹ä¸€ã€‚ library(tidyr) # spreading the region into columns (res_count_spread &lt;- spread(res_count, region, n, fill = 0)) time åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ 00~02 24 24 15 19 20 28 4 17 17 27 62 15 02~04 17 15 10 12 15 29 13 29 14 12 26 22 04~06 17 14 15 6 15 14 5 22 8 11 22 7 06~08 24 19 9 13 16 17 11 21 9 13 20 19 08~10 22 31 17 16 27 24 24 34 18 20 45 27 10~12 35 34 12 19 33 35 35 41 18 18 38 20 11~03 0 0 0 0 0 0 0 0 0 0 1 0 12~14 34 49 12 15 26 46 23 33 25 20 30 25 14~16 32 32 26 20 39 40 22 32 19 18 43 19 16~18 33 25 13 11 24 30 20 26 16 8 21 19 18~20 40 23 13 18 22 31 17 23 23 23 39 42 18~21 0 0 0 0 0 0 0 0 0 0 1 0 20~22 17 26 13 20 34 41 25 37 15 22 40 13 22~24 15 12 9 9 18 23 14 20 17 16 33 20 class(res_count_spread) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; # spreading the time into columns # res_count_spread &lt;- spread(res_count, time, n, fill = 0) res_count_spread time åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ 00~02 24 24 15 19 20 28 4 17 17 27 62 15 02~04 17 15 10 12 15 29 13 29 14 12 26 22 04~06 17 14 15 6 15 14 5 22 8 11 22 7 06~08 24 19 9 13 16 17 11 21 9 13 20 19 08~10 22 31 17 16 27 24 24 34 18 20 45 27 10~12 35 34 12 19 33 35 35 41 18 18 38 20 11~03 0 0 0 0 0 0 0 0 0 0 1 0 12~14 34 49 12 15 26 46 23 33 25 20 30 25 14~16 32 32 26 20 39 40 22 32 19 18 43 19 16~18 33 25 13 11 24 30 20 26 16 8 21 19 18~20 40 23 13 18 22 31 17 23 23 23 39 42 18~21 0 0 0 0 0 0 0 0 0 0 1 0 20~22 17 26 13 20 34 41 25 37 15 22 40 13 22~24 15 12 9 9 18 23 14 20 17 16 33 20 # ??dplyr::count å¯¬è¡¨æ ¼äº¦å¯ç”¨tidyrçš„gather()å‡½å¼è½‰å›é•·è¡¨æ ¼å‹æ…‹ï¼š (long_table &lt;- tidyr::gather(res_count_spread, region, n, -time)) time region n 00~02 åŒ—æŠ• 24 02~04 åŒ—æŠ• 17 04~06 åŒ—æŠ• 17 06~08 åŒ—æŠ• 24 08~10 åŒ—æŠ• 22 10~12 åŒ—æŠ• 35 11~03 åŒ—æŠ• 0 12~14 åŒ—æŠ• 34 14~16 åŒ—æŠ• 32 16~18 åŒ—æŠ• 33 18~20 åŒ—æŠ• 40 18~21 åŒ—æŠ• 0 20~22 åŒ—æŠ• 17 22~24 åŒ—æŠ• 15 00~02 å¤§å®‰ 24 02~04 å¤§å®‰ 15 04~06 å¤§å®‰ 14 06~08 å¤§å®‰ 19 08~10 å¤§å®‰ 31 10~12 å¤§å®‰ 34 11~03 å¤§å®‰ 0 12~14 å¤§å®‰ 49 14~16 å¤§å®‰ 32 16~18 å¤§å®‰ 25 18~20 å¤§å®‰ 23 18~21 å¤§å®‰ 0 20~22 å¤§å®‰ 26 22~24 å¤§å®‰ 12 00~02 å¤§åŒ 15 02~04 å¤§åŒ 10 04~06 å¤§åŒ 15 06~08 å¤§åŒ 9 08~10 å¤§åŒ 17 10~12 å¤§åŒ 12 11~03 å¤§åŒ 0 12~14 å¤§åŒ 12 14~16 å¤§åŒ 26 16~18 å¤§åŒ 13 18~20 å¤§åŒ 13 18~21 å¤§åŒ 0 20~22 å¤§åŒ 13 22~24 å¤§åŒ 9 00~02 å—æ¸¯ 19 02~04 å—æ¸¯ 12 04~06 å—æ¸¯ 6 06~08 å—æ¸¯ 13 08~10 å—æ¸¯ 16 10~12 å—æ¸¯ 19 11~03 å—æ¸¯ 0 12~14 å—æ¸¯ 15 14~16 å—æ¸¯ 20 16~18 å—æ¸¯ 11 18~20 å—æ¸¯ 18 18~21 å—æ¸¯ 0 20~22 å—æ¸¯ 20 22~24 å—æ¸¯ 9 00~02 å…§æ¹– 20 02~04 å…§æ¹– 15 04~06 å…§æ¹– 15 06~08 å…§æ¹– 16 08~10 å…§æ¹– 27 10~12 å…§æ¹– 33 11~03 å…§æ¹– 0 12~14 å…§æ¹– 26 14~16 å…§æ¹– 39 16~18 å…§æ¹– 24 18~20 å…§æ¹– 22 18~21 å…§æ¹– 0 20~22 å…§æ¹– 34 22~24 å…§æ¹– 18 00~02 å£«æ— 28 02~04 å£«æ— 29 04~06 å£«æ— 14 06~08 å£«æ— 17 08~10 å£«æ— 24 10~12 å£«æ— 35 11~03 å£«æ— 0 12~14 å£«æ— 46 14~16 å£«æ— 40 16~18 å£«æ— 30 18~20 å£«æ— 31 18~21 å£«æ— 0 20~22 å£«æ— 41 22~24 å£«æ— 23 00~02 æ¾å±± 4 02~04 æ¾å±± 13 04~06 æ¾å±± 5 06~08 æ¾å±± 11 08~10 æ¾å±± 24 10~12 æ¾å±± 35 11~03 æ¾å±± 0 12~14 æ¾å±± 23 14~16 æ¾å±± 22 16~18 æ¾å±± 20 18~20 æ¾å±± 17 18~21 æ¾å±± 0 20~22 æ¾å±± 25 22~24 æ¾å±± 14 00~02 è¬è¯ 17 02~04 è¬è¯ 29 04~06 è¬è¯ 22 06~08 è¬è¯ 21 08~10 è¬è¯ 34 10~12 è¬è¯ 41 11~03 è¬è¯ 0 12~14 è¬è¯ 33 14~16 è¬è¯ 32 16~18 è¬è¯ 26 18~20 è¬è¯ 23 18~21 è¬è¯ 0 20~22 è¬è¯ 37 22~24 è¬è¯ 20 00~02 æ–‡å±± 17 02~04 æ–‡å±± 14 04~06 æ–‡å±± 8 06~08 æ–‡å±± 9 08~10 æ–‡å±± 18 10~12 æ–‡å±± 18 11~03 æ–‡å±± 0 12~14 æ–‡å±± 25 14~16 æ–‡å±± 19 16~18 æ–‡å±± 16 18~20 æ–‡å±± 23 18~21 æ–‡å±± 0 20~22 æ–‡å±± 15 22~24 æ–‡å±± 17 00~02 ä¿¡ç¾© 27 02~04 ä¿¡ç¾© 12 04~06 ä¿¡ç¾© 11 06~08 ä¿¡ç¾© 13 08~10 ä¿¡ç¾© 20 10~12 ä¿¡ç¾© 18 11~03 ä¿¡ç¾© 0 12~14 ä¿¡ç¾© 20 14~16 ä¿¡ç¾© 18 16~18 ä¿¡ç¾© 8 18~20 ä¿¡ç¾© 23 18~21 ä¿¡ç¾© 0 20~22 ä¿¡ç¾© 22 22~24 ä¿¡ç¾© 16 00~02 ä¸­å±± 62 02~04 ä¸­å±± 26 04~06 ä¸­å±± 22 06~08 ä¸­å±± 20 08~10 ä¸­å±± 45 10~12 ä¸­å±± 38 11~03 ä¸­å±± 1 12~14 ä¸­å±± 30 14~16 ä¸­å±± 43 16~18 ä¸­å±± 21 18~20 ä¸­å±± 39 18~21 ä¸­å±± 1 20~22 ä¸­å±± 40 22~24 ä¸­å±± 33 00~02 ä¸­æ­£ 15 02~04 ä¸­æ­£ 22 04~06 ä¸­æ­£ 7 06~08 ä¸­æ­£ 19 08~10 ä¸­æ­£ 27 10~12 ä¸­æ­£ 20 11~03 ä¸­æ­£ 0 12~14 ä¸­æ­£ 25 14~16 ä¸­æ­£ 19 16~18 ä¸­æ­£ 19 18~20 ä¸­æ­£ 42 18~21 ä¸­æ­£ 0 20~22 ä¸­æ­£ 13 22~24 ä¸­æ­£ 20 Practice ä½¿ç”¨count()ä¾†è¨ˆæ•¸ è«‹ç·´ç¿’çœ‹çœ‹å¦‚æœç”¨count()ä¾†è¨ˆæ•¸å–®ä¸€è®Šé …ï¼Œå¦‚å‰è¿°çš„regionã€timeæˆ–å‰é¢ç·´ç¿’ä¸­æ–°ç”¢ç”Ÿçš„monthã€‚ # YOUR CODE SHOULD BE HERE 4.6.11 VII. ç¹ªåœ– Plotting é€šå¸¸é€™ç¨®é¡åˆ¥è³‡æ–™äº¤å‰åˆ†ææœ€å¸¸ç”¨çš„åœ–è¡¨å‹æ…‹ä¹‹ä¸€ä¾¿æ˜¯Mosaic Plotï¼ˆä½†äº‹å¯¦ä¸ŠMosaic Plotä¸è¦‹èƒ½å¤ è¢«ä¸€çœ¼å°±äº†è§£ï¼‰ã€‚æˆ‘å€‘å¯ä»¥æŠŠäº¤å‰åˆ†æå¾Œçš„è®Šé …res_tableç›´æ¥ç”¨MosaicPlotä¾†ç¹ªåœ–ã€‚ # mosaicplot() to plot 2-dim categorical vars. mosaicplot(res_table) # Add argument main (figure title) mosaicplot(res_table, main=&quot;mosaic plot&quot;) 4.6.11.1 (1) ç„¡æ³•é¡¯ç¤ºä¸­æ–‡ å¤§éƒ¨åˆ†çš„è¦–è¦ºåŒ–å¥—ä»¶éƒ½ç„¡æ³•é †åˆ©é¡¯ç¤ºä¸­æ–‡ï¼Œé™¤éç‰¹åˆ¥æŒ‡å®šæ‰€è¦ç”¨çš„ä¸­æ–‡å­—å‹ã€‚é€™æ–¹é¢ç¶²è·¯ä¸Šå¯ä»¥æ‰¾åˆ°å¾ˆå¤šçš„èªªæ˜ï¼Œä½†éå¸¸è¨å­çš„æ˜¯ï¼Œå¹¾ä¹æ¯æ›ä¸€å¥—è¦–è¦ºåŒ–å·¥å…·ï¼Œæ›ä¸€å¥—èªè¨€ï¼Œå°±æœ‰ä¸åŒçš„ä¸­æ–‡å­—é«”æŒ‡å®šæ–¹å¼ã€‚ä¾‹å¦‚ç”¨baseçš„plot()ä¾†ç¹ªåœ–æˆ–ç”¨ggplot()çš„ä¸­æ–‡å­—å‹æŒ‡å®šæ–¹æ³•ä¾¿ä¸åŒï¼Œä¸”è»¸ä¸Šé¢æœ‰ä¸­æ–‡ã€åœ–æ¨™æœ‰ä¸­æ–‡ã€æˆ–è€…åœ–å…§æœ‰ä¸­æ–‡éƒ½è¦åˆ†é–‹æŒ‡å®šï¼Œéå¸¸è¨äººå­ã€‚ Mosaic Plotå±¬æ–¼base Rçš„plot()ï¼Œå…¶ä¸­æ–‡æŒ‡å®šæ–¹æ³•è¦æŒ‡å®šåœ¨ç¹ªåœ–å‰çš„par()å‡½å¼ä¸­ï¼ˆparç‚ºparameterçš„æ„æ€ï¼‰ï¼ŒæŒ‡å®šæ–¹æ³•ç‚ºpar(family=('Heiti TC Light'))ï¼ŒHeiti TC Lightç‚ºå­—é«”åç¨±ï¼Œç‚ºOSXä¸Šåœ¨ç”¨çš„é»‘é«”ç´°å­—ï¼ŒSTKaitiå‰‡ç‚ºæ¨™æ¥·é«”ã€‚ç„¶å¾Œï¼Œpar()å’Œmosaicplot()å…©å€‹å‡½å¼è¦ã€ŒåŒæ™‚åŸ·è¡Œã€ï¼Œä¹Ÿå°±æ˜¯è«‹ä½ ç›´æ¥ç”¨shift-cmd(ctrl)-EnteråŸ·è¡Œæ•´å€‹code-cellï¼Œæˆ–è€…å°‡è©²å…©å€‹å‡½å¼é¸èµ·ä¾†ä¸€æ¬¡åŸ·è¡Œã€‚ par(family=(&#39;STKaiti&#39;)) # par(family=(&#39;Heiti TC Light&#39;)) mosaicplot(res_table, main=&quot;mosaic plot&quot;, color=T) 4.6.11.2 (2) è‡ªè¨‚é¡è‰² ç›®å‰é¡è‰²å¯¦åœ¨éé†œï¼Œä½ å¯ä»¥è‡ªè¨‚é¡è‰²æŒ‡çµ¦mosaicplot()ã€‚ä¾‹å¦‚æˆ‘åº•ä¸‹ä¾¿ç”¢è£½äº†12ç¨®é¡è‰²å¾Œï¼Œå°‡å…¶ä½œç‚ºmosaicplot()çš„åƒæ•¸ # Set up color by yourself. colors &lt;- c(&#39;#D0104C&#39;, &#39;#DB4D6D&#39;, &#39;#E83015&#39;, &#39;#F75C2F&#39;, &#39;#E79460&#39;, &#39;#E98B2A&#39;, &#39;#9B6E23&#39;, &#39;#F7C242&#39;, &#39;#BEC23F&#39;, &#39;#90B44B&#39;, &#39;#66BAB7&#39;, &#39;#1E88A8&#39;) # par(family=(&#39;STKaiti&#39;)) par(family=(&#39;Heiti TC Light&#39;)) mosaicplot(res_table, color=colors, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) 4.6.12 (Option) è¦–è¦ºåŒ–æ®˜å·®åˆ†æ # par(family=(&#39;STKaiti&#39;)) par(family=(&#39;Heiti TC Light&#39;)) mosaicplot(res_table, color=T, shade = T, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) "],["data-manipulation-wity-tidyverse.html", "Chapter 5 Data Manipulation wity tidyverse", " Chapter 5 Data Manipulation wity tidyverse "],["base-to-dplyr-tp-theft.html", "5.1 base to dplyr: TP Theft", " 5.1 base to dplyr: TP Theft library(tidyverse) # options(stringsAsFactors = F) # default options in R ver.&gt; 4.0 5.1.1 Reading data # Read by read_csv() # Will raise error # Error in make.names(x) : invalid multibyte string at &#39;&lt;bd&gt;s&lt;b8&gt;&lt;b9&gt;&#39; # df &lt;- read_csv(&quot;data/tp_theft.csv&quot;) # read_csv() with locale = locale(encoding = &quot;Big5&quot;) library(readr) df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) 5.1.2 Cleaning data I Renaming variables by select() Generating variable year Generating variable month Retrieving area selected_df &lt;- df %&gt;% select(id = ç·¨è™Ÿ, cat = æ¡ˆé¡, date = `ç™¼ç”Ÿæ—¥æœŸ`, time = `ç™¼ç”Ÿæ™‚æ®µ`, location = `ç™¼ç”Ÿåœ°é»`) %&gt;% mutate(year = date %/% 10000) %&gt;% mutate(month = date %/% 100 %% 100) %&gt;% mutate(area = stringr::str_sub(location, 4, 6)) %&gt;% mutate(county = stringr::str_sub(location, 1, 3)) 5.1.3 Cleaning data II Filtering out irrelevant data records # readr::guess_encoding(&quot;data/tp_theft.csv&quot;) filtered_df &lt;- selected_df %&gt;% # count(year) %&gt;% View filter(county == &quot;è‡ºåŒ—å¸‚&quot;) %&gt;% filter(year &gt;= 104) %&gt;% # count(time) %&gt;% View # count(location) %&gt;% filter(!area %in% c(&quot;ä¸­å’Œå¸‚&quot;, &quot;æ¿æ©‹å¸‚&quot;)) 5.1.4 Long to wide form count() two variables spread() spread one variable as columns to wide form # count() then spread() df.wide &lt;- filtered_df %&gt;% count(time, area) %&gt;% spread(area, n, fill=0) 5.1.5 Setting time as row.name for mosaicplot row.names(df.wide) &lt;- df.wide$time df.wide$time &lt;- NULL # Specify fonts for Chinese # par(family=(&#39;STKaiti&#39;)) par(family=(&#39;Heiti TC Light&#39;)) # for mac # Specify colors colors &lt;- c(&#39;#D0104C&#39;, &#39;#DB4D6D&#39;, &#39;#E83015&#39;, &#39;#F75C2F&#39;, &#39;#E79460&#39;, &#39;#E98B2A&#39;, &#39;#9B6E23&#39;, &#39;#F7C242&#39;, &#39;#BEC23F&#39;, &#39;#90B44B&#39;, &#39;#66BAB7&#39;, &#39;#1E88A8&#39;) # mosaicplot() mosaicplot(df.wide, color=colors, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) 5.1.6 Clean version library(readr) # options(stringsAsFactors = F) df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) selected_df &lt;- df %&gt;% select(id = ç·¨è™Ÿ, cat = æ¡ˆé¡, date = `ç™¼ç”Ÿæ—¥æœŸ`, time = `ç™¼ç”Ÿæ™‚æ®µ`, location = `ç™¼ç”Ÿåœ°é»`) %&gt;% mutate(year = date %/% 10000) %&gt;% mutate(month = date %/% 100 %% 100) %&gt;% mutate(area = stringr::str_sub(location, 4, 6)) %&gt;% mutate(county = stringr::str_sub(location, 1, 3)) selected_df %&gt;% count(year) year n 103 1 104 687 105 663 106 560 107 501 108 411 109 304 110 189 111 31 selected_df %&gt;% count(time) %&gt;% head(10) time n 00~02 272 02~04 214 03~05 8 04~06 156 05~07 23 06~08 191 08~10 305 09~11 6 10~12 338 11~03 1 selected_df %&gt;% arrange(time) %&gt;% head(10) id cat date time location year month area county 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ 104 1 æ–‡å±±å€ è‡ºåŒ—å¸‚ 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ 104 1 ä¿¡ç¾©å€ è‡ºåŒ—å¸‚ 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ 104 1 å£«æ—å€ è‡ºåŒ—å¸‚ 12 ä½å®…ç«Šç›œ 1040105 00~02 è‡ºåŒ—å¸‚ä¸­å±±å€å—äº¬æ±è·¯3æ®µ181~210è™Ÿ 104 1 ä¸­å±±å€ è‡ºåŒ—å¸‚ 33 ä½å®…ç«Šç›œ 1040115 00~02 è‡ºåŒ—å¸‚æ¾å±±å€é¥’æ²³è¡—181~210è™Ÿ 104 1 æ¾å±±å€ è‡ºåŒ—å¸‚ 74 ä½å®…ç«Šç›œ 1040131 00~02 è‡ºåŒ—å¸‚å—æ¸¯å€é‡é™½è·¯57å··1~30è™Ÿ 104 1 å—æ¸¯å€ è‡ºåŒ—å¸‚ 75 ä½å®…ç«Šç›œ 1040201 00~02 è‡ºåŒ—å¸‚åŒ—æŠ•å€ä¸­å¿ƒé‡Œä¸­å’Œè¡—31~60è™Ÿ 104 2 åŒ—æŠ•å€ è‡ºåŒ—å¸‚ 92 ä½å®…ç«Šç›œ 1040210 00~02 è‡ºåŒ—å¸‚åŒ—æŠ•å€å¤§åŒè·¯200å··1~30è™Ÿ 104 2 åŒ—æŠ•å€ è‡ºåŒ—å¸‚ 95 ä½å®…ç«Šç›œ 1040212 00~02 è‡ºåŒ—å¸‚è¬è¯å€è¬å¤§è·¯493å··48å¼„1~30è™Ÿ 104 2 è¬è¯å€ è‡ºåŒ—å¸‚ 106 ä½å®…ç«Šç›œ 1040216 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å³èˆˆè¡—269å··1~30è™Ÿ 104 2 ä¿¡ç¾©å€ è‡ºåŒ—å¸‚ filtered_df &lt;- selected_df %&gt;% # count(year) %&gt;% View filter(year &gt;= 104) %&gt;% filter(!time %in% c(&quot;03~05&quot;, &quot;05~07&quot;, &quot;09~11&quot;, &quot;11~13&quot;, &quot;15~17&quot;, &quot;17~19&quot;, &quot;18~21&quot;, &quot;21~23&quot;, &quot;23~01&quot;)) # count(time) %&gt;% View # count(location) %&gt;% # filter(!area %in% c(&quot;ä¸­å’Œå¸‚&quot;, &quot;æ¿æ©‹å¸‚&quot;)) df.wide &lt;- filtered_df %&gt;% count(time, area) %&gt;% spread(area, n, fill=0) %&gt;% as.data.frame() row.names(df.wide) &lt;- df.wide$time df.wide$time &lt;- NULL par(family=(&#39;Heiti TC Light&#39;)) # for mac # Specify colors colors &lt;- c(&#39;#D0104C&#39;, &#39;#DB4D6D&#39;, &#39;#E83015&#39;, &#39;#F75C2F&#39;, &#39;#E79460&#39;, &#39;#E98B2A&#39;, &#39;#9B6E23&#39;, &#39;#F7C242&#39;, &#39;#BEC23F&#39;, &#39;#90B44B&#39;, &#39;#66BAB7&#39;, &#39;#1E88A8&#39;) # mosaicplot() mosaicplot(df.wide, color=colors, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) "],["ç©ºå€¼naè™•ç†.html", "5.2 ç©ºå€¼ï¼ˆNAï¼‰è™•ç†", " 5.2 ç©ºå€¼ï¼ˆNAï¼‰è™•ç† è¨±å¤šçµ±è¨ˆè³‡æ–™éƒ½æœƒæœ‰ä¸åŒç¨‹åº¦çš„NAï¼ˆç¼ºå¤±å€¼ã€éºæ¼å€¼ï¼‰ã€‚ç¼ºå¤±å€¼ç”¢ç”Ÿçš„åŸå› ä¸ä¸€ï¼Œå¯èƒ½æœ‰ä»¥ä¸‹åŸå› ï¼š è³‡æ–™é‹ç®—çš„æ™‚å€™ç”¢ç”Ÿçš„å¡«ç©ºå€¼ã€‚ä¾‹å¦‚spread()å’Œpivot_wider()ç¶“å¸¸æœƒç”¢ç”ŸNAï¼Œä¹Ÿç¶“å¸¸æœƒæŒ‡å®šå€¼ï¼ˆä¾‹å¦‚0ï¼‰ä¾†å–ä»£å¯èƒ½ç”¢ç”Ÿçš„NAã€‚ è³‡æ–™ç´€éŒ„çš„æ™‚å€™éºæ¼æŸäº›æ™‚é–“é»çš„è³‡æ–™ã€‚ é–‹æ”¾è³‡æ–™åœ¨é–‹æ”¾æ™‚å·²ç¶“è¢«æ•´ç†æˆéšå±¤åŒ–ã€æ˜“æ–¼å±•ç¤ºã€ä¸€èˆ¬äººæ˜“æ‡‚çš„è¡¨æ ¼å‹æ…‹ã€‚æ­¤æ™‚ï¼Œè‹¥å°‡å…¶è®€å…¥ä¹Ÿæœƒç”¢ç”Ÿéå¸¸å¤§é‡çš„NAã€‚ä¾‹å¦‚æœ¬ç« ç¯€æ‰€è¦æåˆ°çš„æ”¿åºœå„éƒ¨æœƒé ç®—æ¯”ä¾‹ã€‚ ç´€éŒ„è³‡æ–™ç­†æ•¸éå¸¸é¾å¤§ã€ä¾†æºçœ¾å¤šã€ç´€éŒ„æ™‚é–“ä¸ä¸€æ™‚ï¼Œé›–ç„¶æœ‰å¾ˆå¤šç´€éŒ„ï¼Œä½†é€™äº›ç´€éŒ„å¿…é ˆè¦è¢«å°é½Šã€åˆªæ¸›ï¼Œæ‰èƒ½å¤ ç²å¾—æœ‰æ„ç¾©çš„å¯è¨ˆç®—è³‡æ–™ã€‚ä¾‹å¦‚æœ¬ç« ç¯€æœƒæåˆ°çš„ä¸–ç•Œå„åœ‹ç–«è‹—æ³¨å°„è³‡æ–™ã€‚ 5.2.1 è¡¨æ ¼é‡æ•´ï¼šæ”¿åºœé ç®— raw &lt;- readxl::read_excel(&quot;data/111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—è¡¨.xls&quot;, skip=3, col_names = F) raw %&gt;% head(10) â€¦1 â€¦2 â€¦3 â€¦4 â€¦5 â€¦6 â€¦7 â€¦8 â€¦9 ç§‘ ç›® NA NA NA NA æœ¬å¹´åº¦é ç®—æ•¸ ä¸Šå¹´åº¦é ç®—æ•¸ å‰å¹´åº¦æ±ºç®—æ•¸ æœ¬å¹´åº¦èˆ‡ä¸Šå¹´åº¦ æ¯” è¼ƒ æ¬¾ é … ç›® ç¯€ å ç¨± åŠ ç·¨ è™Ÿ NA NA NA NA NA NA NA NA åˆ è¨ˆ 2262064189 2135896877 2039353355.829 126167312 NA NA NA NA (1.ä¸€èˆ¬æ”¿å‹™æ”¯å‡º) 210137299 202634617 190777048.02900001 7502682 1 NA NA NA 3100000000 åœ‹å‹™æ”¯å‡º 1210301 1186955 1176955.1259999999 23346 NA 1 NA NA 3102010000 ç¸½çµ±åºœ 1004797 978916 997305.54599999997 25881 NA NA 1 NA 3102010100 ä¸€èˆ¬è¡Œæ”¿ 920526 896334 882112.75600000005 24192 NA NA 2 NA 3102010200 åœ‹å‹™æ©Ÿè¦ 30000 30000 29993.006000000001 NA NA 3 NA 3102010300 åœ‹å®¶æ…¶å…¸ 15760 15760 45578.949000000001 NA NA 4 NA 3102010400 ç ”ç©¶ç™¼å±• 5332 5332 6720.1840000000002 åŸºæœ¬æ¸…ç† é‡æ–°å‘½åæ¬„ä½åç¨± åˆªå»è¢«ç•¶æˆè¡¨æ ¼æ¨™é¡Œçš„å¤šæ–¼åˆ—ï¼ˆé€šå¸¸æ˜¯å‰å…©ä¸‰åˆ—ï¼‰slice(-(1:2))ã€‚ è§€å¯Ÿè³‡æ–™ï¼Œã€Œæ¬¾ã€å¯ä»¥èªªæ˜¯æ”¯å‡ºå¤§é¡çš„ä»£è™Ÿï¼Œä¾‹å¦‚ç¸½çµ±åºœã€è¡Œæ”¿æ”¯å‡ºã€ç«‹æ³•æ”¯å‡ºã€è»äº‹æ”¯å‡ºã€æ•™è‚²æ”¯å‡ºç­‰ã€‚ã€Œç§‘ã€ç‚ºè©²å–®ä½åº•ä¸‹çš„éƒ¨é–€æˆ–è€…é …ç›®ï¼Œä¾‹å¦‚ã€Œè¡Œæ”¿æ”¯å‡ºã€ä¸‹æœ‰è¡Œæ”¿é™¢ã€ä¸»è¨ˆç¸½è™•æ”¯å‡ºç­‰ã€‚æ›´åº•ä¸‹çš„ç´°é¡ã€Œç›®ã€ä¸¦éæœ¬ä¾‹çš„åˆ†æå°è±¡ï¼Œæ‰€ä»¥å¯ä»¥åˆªé™¤ã€‚æ‰€ä»¥ï¼Œå¦‚æœæ¬¾ã€ç§‘å‡ç‚ºç©ºå€¼çš„è©±ï¼Œä»£è¡¨å…¶ç‚ºæ›´ç´°çš„ã€Œç›®ã€ã€‚å› æ­¤ç¯©å»æ¬¾ç§‘ç‚ºç©ºå€¼çš„æ‰€æœ‰é …ç›®ã€‚filter(!is.na(æ¬¾) | !is.na(ç§‘)) å°‡æ©Ÿæ§‹idå’Œæ©Ÿæ§‹åç¨±åˆ‡åˆ†é–‹ä¾†ï¼Œè¦–è¦ºåŒ–çš„æ™‚å€™åªæœƒç”¨åˆ°æ©Ÿæ§‹åç¨±ã€‚separate(æ©Ÿæ§‹, c(\"oid\", \"org\"), sep=\"\\n\") names(raw) &lt;- c(&quot;æ¬¾&quot;, &quot;ç§‘&quot;, &quot;ç›®&quot;, &quot;ç¯€&quot;, &quot;æ©Ÿæ§‹&quot;, &quot;æœ¬å¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦æ±ºç®—&quot;, &quot;é ç®—å·®&quot;) cleaned &lt;- raw %&gt;% slice(-(1:2)) %&gt;% filter(!is.na(æ¬¾) | !is.na(ç§‘)) %&gt;% select(-ç›®, -ç¯€) %&gt;% separate(æ©Ÿæ§‹, c(&quot;oid&quot;, &quot;org&quot;), sep=&quot;\\n&quot;) cleaned %&gt;% head(10) æ¬¾ ç§‘ oid org æœ¬å¹´åº¦é ç®— ä¸Šå¹´åº¦é ç®— ä¸Šå¹´åº¦æ±ºç®— é ç®—å·® 1 NA 3100000000 åœ‹å‹™æ”¯å‡º 1210301 1186955 1176955.1259999999 23346 NA 1 3102010000 ç¸½çµ±åºœ 1004797 978916 997305.54599999997 25881 NA 2 3102100000 åœ‹å®¶å®‰å…¨æœƒè­° 205504 208039 179649.57999999999 -2535 2 NA 3200000000 è¡Œæ”¿æ”¯å‡º 6134276 5836481 5477154.5810000002 297795 NA 1 3203010000 è¡Œæ”¿é™¢ 1256043 1286646 1268295.23 -30603 NA 2 3203100000 ä¸»è¨ˆç¸½è™• 1604967 1478173 1578781.8940000001 126794 NA 3 3203300000 äººäº‹è¡Œæ”¿ç¸½è™• 555363 573447 489516.17700000003 -18084 NA 4 3203340000 å…¬å‹™äººåŠ›ç™¼å±•å­¸é™¢ 244346 239453 229852.26199999999 4893 NA 5 3203420000 æª”æ¡ˆç®¡ç†å±€ 787429 646081 443133.20799999998 141348 NA 6 3203900000 å¤§é™¸å§”å“¡æœƒ 900896 900866 792491.22199999995 30 5.2.1.1 NAè™•ç† è§€å¯Ÿä¸€ä¸‹ç¾åœ¨çš„è³‡æ–™ï¼Œç™¼ç¾ï¼Œè¡Œæ”¿é™¢ã€ä¸»è¨ˆç¸½è™•ç­‰å‡å±¬æ–¼è¡Œæ”¿æ”¯å‡ºï¼Œä½†è¡Œæ”¿æ”¯å‡ºå»è‡ªæœ‰ä¸€åˆ—ã€‚ä¾ç…§é•·è¡¨æ ¼çš„æ ¼å¼ä¾†èªªï¼Œæ‡‰å˜—è©¦æŠŠã€Œæ¬¾ã€ä½œç‚ºæ©Ÿæ§‹çš„è®Šé …ã€‚æ‰€ä»¥å°‡æ¬¾çš„æ•¸å­—å–ä»£ç‚ºã€Œè¡Œæ”¿æ”¯å‡ºã€ç­‰æ”¯å‡ºé¡åˆ¥çš„åç¨±ã€‚ cleaned %&gt;% mutate(æ¬¾ = ifelse(!is.na(æ¬¾), org, æ¬¾)) %&gt;% head(10) æ¬¾ ç§‘ oid org æœ¬å¹´åº¦é ç®— ä¸Šå¹´åº¦é ç®— ä¸Šå¹´åº¦æ±ºç®— é ç®—å·® åœ‹å‹™æ”¯å‡º NA 3100000000 åœ‹å‹™æ”¯å‡º 1210301 1186955 1176955.1259999999 23346 NA 1 3102010000 ç¸½çµ±åºœ 1004797 978916 997305.54599999997 25881 NA 2 3102100000 åœ‹å®¶å®‰å…¨æœƒè­° 205504 208039 179649.57999999999 -2535 è¡Œæ”¿æ”¯å‡º NA 3200000000 è¡Œæ”¿æ”¯å‡º 6134276 5836481 5477154.5810000002 297795 NA 1 3203010000 è¡Œæ”¿é™¢ 1256043 1286646 1268295.23 -30603 NA 2 3203100000 ä¸»è¨ˆç¸½è™• 1604967 1478173 1578781.8940000001 126794 NA 3 3203300000 äººäº‹è¡Œæ”¿ç¸½è™• 555363 573447 489516.17700000003 -18084 NA 4 3203340000 å…¬å‹™äººåŠ›ç™¼å±•å­¸é™¢ 244346 239453 229852.26199999999 4893 NA 5 3203420000 æª”æ¡ˆç®¡ç†å±€ 787429 646081 443133.20799999998 141348 NA 6 3203900000 å¤§é™¸å§”å“¡æœƒ 900896 900866 792491.22199999995 30 æ¥ä¸‹ä¾†ï¼Œå¸Œæœ›èƒ½å¤ åœ¨ã€Œæ¬¾==NAã€çš„åœ°æ–¹å¡«å…¥è©²æ¬„çš„ã€Œå‰ä¸€å€‹å€¼ã€ä¾‹å¦‚è¡Œæ”¿æ”¯å‡ºã€‚æŸ¥è©¢ä¸€ä¸‹ï¼ˆé—œéµå­—å¦‚ã€ŒFill in NA column values with the last value that was not NAã€ï¼‰é‚„çœŸçš„æœ‰é€™æ¨£çš„å‡½å¼å¯ä»¥æ“ä½œã€‚ library(zoo) cleaned %&gt;% mutate(æ¬¾ = ifelse(!is.na(æ¬¾), org, æ¬¾)) %&gt;% mutate(æ¬¾ = zoo::na.locf(æ¬¾)) %&gt;% head(10) æ¬¾ ç§‘ oid org æœ¬å¹´åº¦é ç®— ä¸Šå¹´åº¦é ç®— ä¸Šå¹´åº¦æ±ºç®— é ç®—å·® åœ‹å‹™æ”¯å‡º NA 3100000000 åœ‹å‹™æ”¯å‡º 1210301 1186955 1176955.1259999999 23346 åœ‹å‹™æ”¯å‡º 1 3102010000 ç¸½çµ±åºœ 1004797 978916 997305.54599999997 25881 åœ‹å‹™æ”¯å‡º 2 3102100000 åœ‹å®¶å®‰å…¨æœƒè­° 205504 208039 179649.57999999999 -2535 è¡Œæ”¿æ”¯å‡º NA 3200000000 è¡Œæ”¿æ”¯å‡º 6134276 5836481 5477154.5810000002 297795 è¡Œæ”¿æ”¯å‡º 1 3203010000 è¡Œæ”¿é™¢ 1256043 1286646 1268295.23 -30603 è¡Œæ”¿æ”¯å‡º 2 3203100000 ä¸»è¨ˆç¸½è™• 1604967 1478173 1578781.8940000001 126794 è¡Œæ”¿æ”¯å‡º 3 3203300000 äººäº‹è¡Œæ”¿ç¸½è™• 555363 573447 489516.17700000003 -18084 è¡Œæ”¿æ”¯å‡º 4 3203340000 å…¬å‹™äººåŠ›ç™¼å±•å­¸é™¢ 244346 239453 229852.26199999999 4893 è¡Œæ”¿æ”¯å‡º 5 3203420000 æª”æ¡ˆç®¡ç†å±€ 787429 646081 443133.20799999998 141348 è¡Œæ”¿æ”¯å‡º 6 3203900000 å¤§é™¸å§”å“¡æœƒ 900896 900866 792491.22199999995 30 å¤ªç¥å¥‡äº†ï¼çœ‹è¦‹æ²’ï¼æ¥ä¸‹ä¾†åªè¦æŠŠã€Œç§‘ is NAã€çš„é‚£äº›è©²å¤§é¡æ”¯å‡ºç¸½æ•¸çš„ç´€éŒ„çµ¦åˆªé™¤ï¼Œè³‡æ–™å°±ä¹¾æ·¨äº†ã€‚æœ€å¾Œå°±åªæœƒå‰©ä¸‹ä¸€äº›è³‡æ–™æ¸…ç†çš„åŠŸä¼•ã€‚å®Œæ•´ç¨‹å¼ç¢¼å¯ä»¥çœ‹ä¸‹ä¸€ç¯€ã€‚ 5.2.1.2 å®Œæ•´ç¨‹å¼ç¢¼ library(zoo) # raw &lt;- readxl::read_excel(&quot;data/111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—ç¸½è¡¨.xls&quot;) raw &lt;- readxl::read_excel(&quot;data/111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—è¡¨.xls&quot;, skip=3, col_names = F) names(raw) &lt;- c(&quot;æ¬¾&quot;, &quot;ç§‘&quot;, &quot;ç›®&quot;, &quot;ç¯€&quot;, &quot;æ©Ÿæ§‹&quot;, &quot;æœ¬å¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦æ±ºç®—&quot;, &quot;é ç®—å·®&quot;) # raw$æ¬¾ &lt;- na.locf(raw$æ¬¾) cleaned &lt;- raw %&gt;% filter(!is.na(æ¬¾) | !is.na(ç§‘)) %&gt;% slice(-(1:2)) %&gt;% select(-ç›®, -ç¯€) %&gt;% separate(æ©Ÿæ§‹, c(&quot;oid&quot;, &quot;org&quot;), sep=&quot;\\n&quot;) %&gt;% mutate(æ¬¾ = ifelse(!is.na(æ¬¾), org, æ¬¾)) %&gt;% mutate(æ¬¾ = zoo::na.locf(æ¬¾)) %&gt;% filter(!is.na(ç§‘)) %&gt;% select(-ç§‘) %&gt;% type_convert() %&gt;% mutate(ä¸Šå¹´åº¦é ç®— = as.numeric(ä¸Šå¹´åº¦é ç®—), ä¸Šå¹´åº¦æ±ºç®— = as.integer(ä¸Šå¹´åº¦æ±ºç®—), é ç®—å·® = as.numeric(é ç®—å·®)) %&gt;% replace_na(list(ä¸Šå¹´åº¦é ç®— = 0, ä¸Šå¹´åº¦æ±ºç®— = 0)) %&gt;% mutate(é ç®—å·® = æœ¬å¹´åº¦é ç®— - ä¸Šå¹´åº¦é ç®—) 5.2.2 å°é½Šè³‡æ–™ã€‚ä¸–ç•Œå„åœ‹ç–«è‹—æ¥ç¨®æ¯”ä¾‹ https://ourworldindata.org/covid-vaccinations - https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations è©•ä¼°è³‡æ–™æ¦‚æ³å¾Œå¯ç™¼ç¾é€™å€‹è³‡æ–™é›†æ¯ä¸€åˆ—å°±æ˜¯æŸä¸€å€‹åœ‹å®¶æŸä¸€å¤©æ‰€ä¸Šå‚³çš„ç´€éŒ„ã€‚æ‰€ä»¥ï¼Œä¸€å€‹åœ‹å®¶æœƒæœ‰å¾ˆå¤šåˆ—ã€‚ä¹è½ä¹‹ä¸‹ä¸é›£è™•ç†ï¼Œä½†äº‹å¯¦ä¸Šæ¯å€‹åœ‹å®¶ä¸æœƒæ¯å¤©ä¸Šå‚³ã€ä¹Ÿä¸æœƒå›ºå®šæŸä¸€å¤©ä¸Šå‚³ã€å“ªä¸€é€±ã€å“ªä¸€å€‹æœˆé–‹å§‹ä¸Šå‚³ä¹Ÿä¸ä¸€å®šï¼Œä¹Ÿæœ‰å¯èƒ½æœƒæ¼æ‰ä¸€äº›æœˆä»½æˆ–é€±æ¬¡ã€‚æ‰€ä»¥ï¼Œåˆ¶å®šå‡ºä¸€å€‹æ™‚é–“å–®ä½ï¼ˆä¾‹å¦‚é€±ã€æœˆï¼‰ã€ç„¶å¾Œå»¶è‘—æ™‚é–“è»¸å°‡è³‡æ–™ã€Œå°é½Šã€ï¼Œè®“æ¯å€‹åœ‹å®¶åœ¨æ¯å€‹æ™‚é–“å–®ä½éƒ½æœ‰è³‡æ–™ã€‚ä½†æ¯å€‹åœ‹å®¶ç–«æƒ…ç™¼å±•ç¨‹åº¦ä¸ä¸€ï¼Œæ‰€ä»¥ä¹Ÿä¸å¯èƒ½æœ‰ä¸€å€‹å®Œç¾çš„å°é½Šï¼Œæ‰€ä»¥é€šå¸¸æœƒå»ºè­°å°±æ‰€è¦è§€å¯Ÿçš„åœ‹å®¶é€²è¡Œå°é½Šå³å¯ã€‚è‡³æ–¼æƒ³åˆªé™¤çš„é‚£äº›è³‡æ–™åˆ—ï¼Œå¹¾ä¹éƒ½å¯ä»¥ç•¶æˆæ˜¯æ‰€è¬‚çš„ç¼ºå¤±å€¼ã€‚ raw &lt;- read_csv(&quot;data/vaccinations.csv&quot;) dim(raw) ## [1] 99442 16 raw %&gt;% head(20) location iso_code date total_vaccinations people_vaccinated people_fully_vaccinated total_boosters daily_vaccinations_raw daily_vaccinations total_vaccinations_per_hundred people_vaccinated_per_hundred people_fully_vaccinated_per_hundred total_boosters_per_hundred daily_vaccinations_per_million daily_people_vaccinated daily_people_vaccinated_per_hundred Afghanistan AFG 2021-02-22 0 0 NA NA NA NA 0.00 0.00 NA NA NA NA NA Afghanistan AFG 2021-02-23 NA NA NA NA NA 1367 NA NA NA NA 34 1367 0.003 Afghanistan AFG 2021-02-24 NA NA NA NA NA 1367 NA NA NA NA 34 1367 0.003 Afghanistan AFG 2021-02-25 NA NA NA NA NA 1367 NA NA NA NA 34 1367 0.003 Afghanistan AFG 2021-02-26 NA NA NA NA NA 1367 NA NA NA NA 34 1367 0.003 Afghanistan AFG 2021-02-27 NA NA NA NA NA 1367 NA NA NA NA 34 1367 0.003 Afghanistan AFG 2021-02-28 8200 8200 NA NA NA 1367 0.02 0.02 NA NA 34 1367 0.003 Afghanistan AFG 2021-03-01 NA NA NA NA NA 1580 NA NA NA NA 40 1580 0.004 Afghanistan AFG 2021-03-02 NA NA NA NA NA 1794 NA NA NA NA 45 1794 0.005 Afghanistan AFG 2021-03-03 NA NA NA NA NA 2008 NA NA NA NA 50 2008 0.005 Afghanistan AFG 2021-03-04 NA NA NA NA NA 2221 NA NA NA NA 56 2221 0.006 Afghanistan AFG 2021-03-05 NA NA NA NA NA 2435 NA NA NA NA 61 2435 0.006 Afghanistan AFG 2021-03-06 NA NA NA NA NA 2649 NA NA NA NA 66 2649 0.007 Afghanistan AFG 2021-03-07 NA NA NA NA NA 2862 NA NA NA NA 72 2862 0.007 Afghanistan AFG 2021-03-08 NA NA NA NA NA 2862 NA NA NA NA 72 2862 0.007 Afghanistan AFG 2021-03-09 NA NA NA NA NA 2862 NA NA NA NA 72 2862 0.007 Afghanistan AFG 2021-03-10 NA NA NA NA NA 2862 NA NA NA NA 72 2862 0.007 Afghanistan AFG 2021-03-11 NA NA NA NA NA 2862 NA NA NA NA 72 2862 0.007 Afghanistan AFG 2021-03-12 NA NA NA NA NA 2862 NA NA NA NA 72 2862 0.007 Afghanistan AFG 2021-03-13 NA NA NA NA NA 2862 NA NA NA NA 72 2862 0.007 5.2.2.1 æŒ‰æœˆå°é½Šè³‡æ–™ é¦–å…ˆè¦æŒ‘é¸è¦æ‹¿ä¾†åšè¦–è¦ºåŒ–çš„è³‡æ–™æ¬„ä½ã€‚é€™é‚Šæ‰€é¸æ“‡çš„æ˜¯people_fully_vaccinated_per_hundredï¼Œä¹Ÿå°±æ˜¯æ¯ç™¾äººæ¥ç¨®äºŒåŠ‘ç–«è‹—çš„äººæ•¸ï¼Œç›¸ç•¶æ–¼æ¥ç¨®äºŒåŠ‘ç–«è‹—çš„ç™¾åˆ†æ¯”ã€‚ æ¥ä¸‹ä¾†ä¾¿æ˜¯ç©ºå€¼è™•ç†ï¼Œå¦‚æœé€™å€‹æ¬„ä½æ²’æœ‰æ•¸å€¼çš„å°±ç›´æ¥ç”¨drop_na()ç¯©é™¤å³å¯ã€‚ é€™å€‹ç¯„ä¾‹å¸Œæœ›æŠŠè©²è³‡æ–™è¦–è¦ºåŒ–ç‚ºYè»¸ç‚ºå¹´ã€Xè»¸ç‚ºæ™‚é–“çš„ç†±å€åœ–ã€‚ä½†æ•´å€‹ç–«æƒ…è³‡æ–™æ©«äº™äºŒå¹´å¤šï¼Œå¦‚æœä»¥é€±ç‚ºå½™æ•´å–®ä½çš„è©±ï¼Œé‚£å‹¢å¿…Xè»¸æœƒæœ‰è¿‘ç™¾å€‹è³‡æ–™é»ã€‚æ‰€ä»¥æ‰“ç®—ä»¥ã€Œæœˆã€ç‚ºå–®ä½ä¾†å½™æ•´é€™äº›è³‡æ–™ï¼Œå› ç‚ºä¸”è³‡æ–™ä¸­ä¹Ÿæœ‰ä¸å°‘åœ‹å®¶ç¼ºæ•¸é€±çš„è³‡æ–™ï¼Œæ‰€ä»¥ä»¥æœˆç‚ºå½™æ•´å–®ä½æ˜¯ä¸€å€‹æ¬Šè¡¡å¾Œçš„é¸æ“‡ï¼ˆä»å¯ä»¥å˜—è©¦ç”¨é€±ä½œç‚ºå½™æ•´å–®ä½è©¦è©¦çœ‹ï¼‰ã€‚æ‰€ä»¥ï¼Œé‹ç”¨äº†lubridate::floor_date()ä¾†å°‡æ—¥æœŸè³‡æ–™è½‰æ›ç‚ºæœˆï¼Œä¾‹å¦‚2022-03-12å’Œ2022-03-14éƒ½æœƒè¢«è½‰æ›ç‚º2022-03-01ã€‚ ä¾ç…§åœ‹å®¶èˆ‡æ™‚é–“ç¾¤çµ„å½™æ•´è³‡æ–™ã€‚æ¥ä¸‹ä¾†å°±ä¾ç…§å„åœ‹çš„æœˆä»½ä¾†åšå½™æ•´ï¼ˆæ³¨æ„ï¼Œæ­¤æ™‚æœƒæœ‰ä¸å°‘è³‡æ–™åŒå±¬æ–¼æŸå€‹æœˆçš„è³‡æ–™ï¼‰ã€‚å½™æ•´çš„æ–¹æ³•æ˜¯ï¼Œç¶“éå°ã€Œæ—¥æœŸã€ï¼ˆä¸æ˜¯å°æœˆï¼‰åšæ’åºå¾Œï¼Œåƒ…ç•™ä¸‹ç¬¬ä¸€ç­†è³‡æ–™ï¼Œä¹Ÿå°±æ˜¯åƒ…ç•™ä¸‹æœ€æ¥è¿‘æœˆä»½é–‹é ­çš„è³‡æ–™ã€‚ç¶“ç”±é€™æ¨£çš„æ“ä½œï¼Œæœƒä½¿å¾—å„åœ‹åœ¨æ¯å€‹æœˆå‰›å¥½ç•™ä¸‹ä¸€ç­†è³‡æ–™ï¼Œå¦‚ä¸‹é¢ç¨‹å¼çš„ç¯„ä¾‹è¼¸å‡ºã€‚ library(lubridate) fullvaccinated &lt;- raw %&gt;% select(country = location, date, people_fully_vaccinated_per_hundred) %&gt;% drop_na(people_fully_vaccinated_per_hundred) %&gt;% mutate(m = floor_date(date, unit = &quot;month&quot;)) %&gt;% group_by(country, m) %&gt;% arrange(date) %&gt;% slice(1) %&gt;% ungroup() %&gt;% select(-date) fullvaccinated %&gt;% head(10) country people_fully_vaccinated_per_hundred m Afghanistan 0.14 2021-05-01 Afghanistan 0.36 2021-06-01 Afghanistan 0.48 2021-07-01 Afghanistan 1.08 2021-08-01 Afghanistan 8.00 2021-11-01 Afghanistan 9.42 2021-12-01 Afghanistan 9.56 2022-01-01 Afghanistan 9.82 2022-02-01 Afghanistan 10.75 2022-03-01 Afghanistan 11.38 2022-04-01 5.2.2.2 è™•ç†éºæ¼è³‡æ–™çš„æœˆä»½ æ¥ä¸‹ä¾†è¦è™•ç†çš„æ˜¯è³‡æ–™ç´€éŒ„çš„ç¼ºæ¼å€¼ã€‚æ¯å€‹åœ‹å®¶ç™»éŒ„è³‡æ–™çš„æ™‚é–“æ˜¯å¾ˆä¸ä¸€è‡´çš„ï¼ŒæŸäº›åœ‹å®¶æœƒç¼ºæŸäº›æœˆä»½ï¼Œæˆ–è€…æŸäº›åœ‹å®¶æ˜¯åœ¨æŸå¹´æŸæœˆä»¥å¾Œæ‰é–‹å§‹ç™»è¨˜ï¼Œæˆ–è€…æœ€è¿‘æ²’åœ¨ç™»è¨˜ã€‚ä½†é€™å€‹ç¯„ä¾‹æ‰€è¦è¦–è¦ºåŒ–çš„è³‡æ–™æ˜¯æ¥ç¨®ç–«è‹—çš„æ¯”ä¾‹ï¼Œæ‰€ä»¥å³ä½¿æ˜¯ç¾åœ¨æ²’åœ¨ç™»è¨˜äº†ï¼Œä½†æ¥ç¨®æ¯”ä¾‹æ‡‰åˆ—è¨ˆæœ€å¾Œä¸€æ¬¡è³‡æ–™ç´€éŒ„çš„æ¥ç¨®æ¯”ä¾‹ã€‚ é¦–å…ˆæˆ‘è¦è®“æ¯å€‹åœ‹å®¶éƒ½æœ‰æ‰€æœ‰æœˆä»½ï¼Œé€™è£¡æ‡‰æœƒæœ‰æŸå€‹å‡½å¼å¯ä»¥åšåˆ°é€™ä»¶äº‹ï¼Œä½†æˆ‘æ²’æŸ¥åˆ°é€™å€‹å‡½å¼ã€‚ä¸éæˆ‘å¯ä»¥å¾ˆæŠ€å·§æ€§åœ°ç”¨pivot_wider()ï¼ˆspread()ï¼‰å’Œpivot_longer()ï¼ˆgather()ï¼‰ä¾†å®Œæˆé€™ä»¶äº‹ã€‚spread()åœ¨å±•é–‹æ™‚å°æ–¼ç¼ºå°‘çš„è³‡æ–™é …å¯ä»¥è‡ªå‹•è£œNAã€‚æ‰€ä»¥æˆ‘å°±åªè¦æŠŠè³‡æ–™çš„æœˆä»½å±•é–‹å¾Œå†gather()å›ä¾†å¾Œï¼Œå°±å¯ä»¥è‡ªå‹•è®“æ¯å€‹åœ‹å®¶æ‰€æ“æœ‰çš„æœˆä»½è³‡æ–™ä¸€è‡´ã€‚ä»¥ä¸‹ç‚ºspread()å¾Œçš„çµæœï¼Œå¯ä»¥è§€å¯Ÿåˆ°æ¯ä¸€åˆ—æ˜¯ä¸€å€‹åœ‹å®¶ï¼Œæ¯ä¸€æ¬„æ˜¯å€‹æœˆä»½ï¼Œå¦‚æœç•¶æœˆéƒ½æ²’è³‡æ–™ç´€éŒ„ï¼Œé‚£è©²æœˆçš„å€¼å°±æœƒæ˜¯ç©ºå€¼ã€‚å¯ä»¥çœ‹è¦‹ç©ºå€¼æ˜¯ç›¸ç•¶å¤šçš„ï¼Œä¹Ÿå°±æ˜¯åœ¨é‚£æ®µæ™‚é–“éƒ½æ²’æœ‰è³‡æ–™ç´€éŒ„ã€‚ fullvaccinated %&gt;% spread(m, people_fully_vaccinated_per_hundred, fill=NA) %&gt;% head(10) country 2020-12-01 2021-01-01 2021-02-01 2021-03-01 2021-04-01 2021-05-01 2021-06-01 2021-07-01 2021-08-01 2021-09-01 2021-10-01 2021-11-01 2021-12-01 2022-01-01 2022-02-01 2022-03-01 2022-04-01 2022-05-01 Afghanistan NA NA NA NA NA 0.14 0.36 0.48 1.08 NA NA 8.00 9.42 9.56 9.82 10.75 11.38 NA Africa NA NA 0.00 0.02 0.30 0.36 0.63 1.15 1.66 2.86 4.40 5.93 7.24 9.15 10.78 12.30 15.32 16.56 Albania NA NA 0.00 NA NA 6.32 10.21 14.18 18.46 22.58 27.87 31.04 33.62 36.53 40.26 41.73 42.47 NA Algeria NA NA NA NA NA NA NA NA 1.62 6.72 10.65 10.92 12.45 12.99 13.46 13.70 14.53 NA Andorra NA NA NA 1.52 5.80 6.07 14.14 34.92 45.99 61.69 62.45 NA 65.07 68.58 68.79 68.99 69.04 NA Angola NA NA NA NA NA 0.12 1.11 1.66 2.09 2.71 3.57 5.31 9.05 11.77 14.38 16.53 18.06 NA Anguilla NA NA NA NA 5.18 29.25 36.45 47.34 59.27 59.36 60.54 60.54 60.91 61.37 61.82 63.13 65.28 NA Antigua and Barbuda NA NA NA NA NA 2.61 18.41 28.23 31.33 35.51 43.54 51.60 57.72 59.81 61.27 62.12 NA NA Argentina 0 0 0.26 0.69 1.56 2.24 6.68 9.71 16.35 34.72 50.97 58.37 67.18 73.25 77.69 80.13 81.21 81.64 Armenia NA NA NA NA NA NA 0.40 1.03 1.74 3.64 5.73 9.33 17.42 24.08 28.94 31.97 33.02 NA åœ¨ä»¥ä¸‹çš„ç¯„ä¾‹è¼¸å‡ºå¯ä»¥çœ‹åˆ°gather()å¾Œçš„çµæœã€‚æ³¨æ„ï¼Œéœ€è¦ç…§åœ‹å®¶å’Œæœˆä»½ä¾†æ’åºå¾Œæ‰ä¾¿æ–¼è§€å¯Ÿã€‚ fullvaccinated %&gt;% spread(m, people_fully_vaccinated_per_hundred, fill=NA) %&gt;% gather(month, perc, -country) %&gt;% arrange(country, month) %&gt;% head(20) country month perc Afghanistan 2020-12-01 NA Afghanistan 2021-01-01 NA Afghanistan 2021-02-01 NA Afghanistan 2021-03-01 NA Afghanistan 2021-04-01 NA Afghanistan 2021-05-01 0.14 Afghanistan 2021-06-01 0.36 Afghanistan 2021-07-01 0.48 Afghanistan 2021-08-01 1.08 Afghanistan 2021-09-01 NA Afghanistan 2021-10-01 NA Afghanistan 2021-11-01 8.00 Afghanistan 2021-12-01 9.42 Afghanistan 2022-01-01 9.56 Afghanistan 2022-02-01 9.82 Afghanistan 2022-03-01 10.75 Afghanistan 2022-04-01 11.38 Afghanistan 2022-05-01 NA Africa 2020-12-01 NA Africa 2021-01-01 NA æ¥ä¸‹ä¾†æ˜¯æœ€æŠ€å·§æ€§çš„éƒ¨åˆ†ã€‚å°±æ¥ç¨®æ¯”ä¾‹è€Œè¨€æ˜¯å€‹éå¢æ•¸åˆ—ï¼Œæ‰€ä»¥å¦‚æœé€™å€‹æœˆæœ‰ç´€éŒ„ï¼Œä½†ä¸‹å€‹æœˆæ²’ç´€éŒ„ï¼ˆNAï¼‰ï¼Œé‚£ä¸‹å€‹æœˆçš„è³‡æ–™æ‡‰ä»¥é€™å€‹æœˆçš„è³‡æ–™ä¾†æ›¿ä»£ã€‚æ­¤æ™‚å¯ä»¥ç”¨zooå¥—ä»¶çš„na.locf()ä¾†å¡«NAå€¼ï¼Œå…¶å¡«NAå€¼çš„è¦å‰‡æ˜¯ç”¨æœ€å¾Œä¸€ç­†éNAå€¼çš„è³‡æ–™ä¾†æ›¿ä»£NAå€¼ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œå› ç‚ºè³‡æ–™ç´€éŒ„å¯èƒ½åˆ°ç¬¬å…­å€‹æœˆæˆ–ç¬¬ä¸ƒå€‹æœˆæ‰é–‹å§‹ç´€éŒ„ï¼Œä½†åœ¨å‰é¢çš„æœˆä»½éƒ½æ²’è³‡æ–™ç´€éŒ„ï¼Œä¹Ÿå°±æ˜¯èªªé‚£äº›NAå€¼æ²’æœ‰æ›´æ—©çš„è³‡æ–™ç´€éŒ„æ¬Šå……å¡«å……å€¼ã€‚åŸæœ¬na.locf()æœƒæŠŠé€™äº›æ‰¾ä¸åˆ°åƒè€ƒå°è±¡çš„NAå€¼ç›´æ¥åˆªé™¤ï¼Œä½†æˆ‘å€‘å¯ä»¥åœ¨è£¡é¢åŠ ä¸€å€‹åƒæ•¸ä½¿å…¶ä¸æœƒè¢«åˆªé™¤ï¼ˆna.locf(perc, na.rm = F)ï¼‰ã€‚ æœ€å¾Œï¼Œå°±æŠŠé€™äº›æ²’è¢«åˆªé™¤ä¹Ÿæ²’å¾—åƒè€ƒçš„æ—©æœŸè³‡æ–™é …ï¼Œç”¨replace_na()å¡«ä¸Š0å³å¯ã€‚ fullvaccinated %&gt;% spread(m, people_fully_vaccinated_per_hundred, fill=NA) %&gt;% gather(month, perc, -country) %&gt;% arrange(country, month) %&gt;% group_by(country) %&gt;% arrange(month) %&gt;% mutate(perc = zoo::na.locf(perc, na.rm = F)) %&gt;% ungroup() %&gt;% arrange(country, month) %&gt;% head(10) country month perc Afghanistan 2020-12-01 NA Afghanistan 2021-01-01 NA Afghanistan 2021-02-01 NA Afghanistan 2021-03-01 NA Afghanistan 2021-04-01 NA Afghanistan 2021-05-01 0.14 Afghanistan 2021-06-01 0.36 Afghanistan 2021-07-01 0.48 Afghanistan 2021-08-01 1.08 Afghanistan 2021-09-01 1.08 æœ€å¾Œï¼Œå°±æŠŠé€™äº›æ²’è¢«åˆªé™¤ä¹Ÿæ²’å¾—åƒè€ƒçš„æ—©æœŸè³‡æ–™é …ï¼Œç”¨replace_na()å¡«ä¸Š0å³å¯ã€‚å¤§åŠŸå‘Šæˆã€‚ fullvaccinated %&gt;% spread(m, people_fully_vaccinated_per_hundred, fill=NA) %&gt;% gather(month, perc, -country) %&gt;% arrange(country, month) %&gt;% group_by(country) %&gt;% arrange(month) %&gt;% mutate(perc = zoo::na.locf(perc, na.rm = F)) %&gt;% ungroup() %&gt;% arrange(country, month) %&gt;% replace_na(list(perc=0)) %&gt;% arrange(country, month) %&gt;% head(10) country month perc Afghanistan 2020-12-01 0.00 Afghanistan 2021-01-01 0.00 Afghanistan 2021-02-01 0.00 Afghanistan 2021-03-01 0.00 Afghanistan 2021-04-01 0.00 Afghanistan 2021-05-01 0.14 Afghanistan 2021-06-01 0.36 Afghanistan 2021-07-01 0.48 Afghanistan 2021-08-01 1.08 Afghanistan 2021-09-01 1.08 5.2.2.3 å®Œæ•´ç¨‹å¼ç¢¼ library(lubridate) raw &lt;- read_csv(&quot;data/vaccinations.csv&quot;) fullvaccinated &lt;- raw %&gt;% select(country = location, date, people_fully_vaccinated_per_hundred) %&gt;% drop_na(people_fully_vaccinated_per_hundred) %&gt;% mutate(m = floor_date(date, unit = &quot;month&quot;)) %&gt;% group_by(country, m) %&gt;% arrange(date) %&gt;% slice(1) %&gt;% ungroup() %&gt;% select(-date) vperc_by_month &lt;- fullvaccinated %&gt;% spread(m, people_fully_vaccinated_per_hundred, fill=NA) %&gt;% gather(month, perc, -country) %&gt;% arrange(country, month) %&gt;% group_by(country) %&gt;% arrange(month) %&gt;% mutate(perc = zoo::na.locf(perc, na.rm = F)) %&gt;% ungroup() %&gt;% arrange(country, month) %&gt;% replace_na(list(perc=0)) "],["categorical.html", "5.3 é¡åˆ¥è³‡æ–™åˆ†æ", " 5.3 é¡åˆ¥è³‡æ–™åˆ†æ é€™å€‹ç¯„ä¾‹æ¶µæ‹¬äº†åœ¨åšå•å·åˆ†ææ™‚å¸¸ç”¨çš„è™•ç†æ­¥é©Ÿã€‚æœ€æ ¸å¿ƒçš„æ­¥é©Ÿæ˜¯å°‡æ–‡å­—é™³è¿°çš„é¡åˆ¥è³‡æ–™è½‰æ›ç‚ºä¾¿æ–¼å¾ŒçºŒé‹ç®—çš„factoræˆ–æ•¸å€¼è³‡æ–™ã€‚å¦‚æœé¡åˆ¥æ•¸é‡éå¤šçš„æ™‚å€™ï¼Œåœ¨é€™å€‹éç¨‹æœƒé †ä¾¿é€²è¡Œé‡æ–°åˆ†çµ„ã€‚ä¾‹å¦‚ä¾ç…§å¹´é½¡çµ„æŠŠå¡«ç­”è€…åˆ†ç‚ºè€å¹´ã€ä¸­å£¯å¹´ã€é’å°‘å¹´ã€å…’ç«¥å››çµ„ã€‚ raw &lt;- read_rds(&quot;data/tfc_survey.rds&quot;) 5.3.1 æ¸…ç†è³‡æ–™ é€šå¸¸å•å·æœƒåˆ†ç‚ºå…©ç¨®é¡å‹çš„è³‡æ–™ï¼Œä¸€ç¨®æ˜¯äººå£çµ±è¨ˆç”¨çš„åŸºæœ¬è³‡æ–™ï¼ˆå¦‚æ€§åˆ¥ã€å¹´é½¡çµ„ã€æ•™è‚²ç¨‹åº¦ï¼‰ã€å¦ä¸€ç¨®æ˜¯å•å·æœ¬èº«è¦å•çš„é¡Œé …ã€‚ä»¥ä¸‹æ˜¯å¸¸è¦‹çš„å•å·å‹æ…‹ï¼ŒåŒ…å«æŠŠå¹´é½¡å¾20æ­²é–‹å§‹æ¯äº”å¹´ä½œç‚ºä¸€çµ„ï¼Œ70æ­²ä»¥ä¸Šå‰‡æ­¸é¡ç‚ºä¸€çµ„ï¼Œå…±æœƒæœ‰åä¸€çµ„ã€‚è€Œæ•™è‚²ç¨‹åº¦å‰‡å¸¸åˆ†ç‚ºäº”è‡³å…­çµ„ï¼Œä½†åœ¨å•å·è¨­è¨ˆçš„æ™‚å€™ï¼Œé€šå¸¸æœƒéœ€è¦å¢åŠ ã€Œæ‹’ç­”ã€çš„é¸é …ã€‚å¦‚æœå•å·ä¸­åŒ…å«æ”¿é»¨æ„è­˜å½¢æ…‹ï¼Œå°±å¿…é ˆè¦æ±ºå®šè¦ä»¥é»¨æ´¾ä½œç‚ºé¡åˆ¥è®Šé …ï¼Œæˆ–è€…ä»¥æ„è­˜å½¢æ…‹åšé †åºå°ºåº¦ã€‚ä»¥ä¸‹å³ç‚ºä¸€å€‹é †åºå°ºåº¦çš„æ¡ˆä¾‹ï¼Œå¾ã€Œéå¸¸æ¥è¿‘æ³›ç¶ ã€åˆ°ã€Œéå¸¸æ¥è¿‘æ³›è—ã€å…±äº”å€‹ç­‰ç¬¬ï¼Œä½†å¦å¢ã€Œæ‹’ç­”ã€é¸é …ã€‚ dt &lt;- raw %&gt;% mutate(QA3 = ordered(QA3, levels=c(&quot;20-24&quot;, &quot;25-29&quot;, &quot;30-34&quot;, &quot;35-39&quot;, &quot;40-44&quot;, &quot;45-49&quot;, &quot;50-54&quot;, &quot;55-59&quot;, &quot;60-64&quot;, &quot;65-69&quot;, &quot;70åŠä»¥ä¸Š&quot;))) %&gt;% mutate(QA3_lv = ordered(QA3, levels=c(&quot;20-24&quot;, &quot;25-29&quot;, &quot;30-34&quot;, &quot;35-39&quot;, &quot;40-44&quot;, &quot;45-49&quot;, &quot;50-54&quot;, &quot;55-59&quot;, &quot;60-64&quot;, &quot;65-69&quot;, &quot;70åŠä»¥ä¸Š&quot;), labels = c(&quot;é’å¹´&quot;, &quot;é’å¹´&quot;, &quot;å£¯å¹´&quot;, &quot;å£¯å¹´&quot;, &quot;å£¯å¹´&quot;, &quot;ä¸­å¹´&quot;, &quot;ä¸­å¹´&quot;, &quot;ä¸­å¹´&quot;, &quot;ä¸­å¹´&quot;, &quot;è€å¹´&quot;, &quot;è€å¹´&quot;))) %&gt;% mutate(QA4 = ordered(QA4, levels=c(&quot;æ‹’ç­”&quot;, &quot;åœ‹å°åŠä»¥ä¸‹&quot;, &quot;åˆä¸­ã€åœ‹ä¸­&quot;, &quot;é«˜ä¸­ã€é«˜è·&quot;, &quot;å¤§å°ˆï¼ˆå°ˆç§‘èˆ‡å¤§å­¸ï¼‰&quot;, &quot;ç ”ç©¶æ‰€åŠä»¥ä¸Š&quot;), labels=c(&quot;æ‹’ç­”&quot;, &quot;åœ‹å°ä»¥ä¸‹&quot;, &quot;åœ‹ä¸­&quot;, &quot;é«˜ä¸­è·&quot;, &quot;å¤§å°ˆ&quot;, &quot;ç ”ç©¶æ‰€ä»¥ä¸Š&quot;))) %&gt;% mutate(QASide=ordered(QASide, exclude=&quot;æ‹’ç­”&quot;, levels=c(&quot;éå¸¸æ¥è¿‘æ³›ç¶ &quot;, &quot;æ¥è¿‘æ³›ç¶ &quot;, &quot;éƒ½ä¸æ¥è¿‘&quot;, &quot;æ¥è¿‘æ³›è—&quot;, &quot;éå¸¸æ¥è¿‘æ³›è—&quot;))) 5.3.1.1 è½‰é¡åˆ¥è®Šé …ç‚ºfactor åœ¨ä¸€é–‹å§‹æ¸…ç†è³‡æ–™çš„æ™‚å€™ï¼Œæœƒå»ºè­°å…ˆæŠŠé¡åˆ¥è®Šæ•¸ï¼ˆé€šå¸¸æ˜¯æ–‡å­—å‹æ…‹ï¼‰è½‰ç‚ºfactorå‹æ…‹ã€‚å¸¸ç”¨çš„å‡½å¼æ˜¯ç”¨mutate()æ­é…ordered()ä¾†æ”¹è®Šè®Šæ•¸å‹æ…‹ã€‚ordered()æœƒç…§é¡åˆ¥é †åºä¾†æ¨™å®šè©²factoræ‰€å°æ‡‰åˆ°çš„æ•¸å­—ã€‚å¯ä»¥ç”¨as.integer()å°‡factorè½‰ç‚ºæ•´æ•¸å¾Œå°±å¯ä»¥çœ‹åˆ°å„é¡åˆ¥çš„é †åºã€‚ dt$QA3[1:10] ## [1] 25-29 35-39 35-39 20-24 45-49 25-29 30-34 20-24 20-24 55-59 ## 11 Levels: 20-24 &lt; 25-29 &lt; 30-34 &lt; 35-39 &lt; 40-44 &lt; 45-49 &lt; 50-54 &lt; ... &lt; 70åŠä»¥ä¸Š as.integer(dt$QA3[1:10]) ## [1] 2 4 4 1 6 2 3 1 1 8 5.3.1.2 æ’é™¤æŸäº›é¡åˆ¥å€¼ å¦‚æœæœ‰æŸäº›é¡åˆ¥è®Šæ•¸çš„å€¼ï¼ˆå¦‚ã€Œæ‹’ç­”ã€ï¼‰ä¸æƒ³è¢«ç·¨å…¥factorï¼Œå¯ä»¥åœ¨reorder()ä¸­åŠ å…¥excludeçš„åƒæ•¸æŒ‡å®šä¸æƒ³è¢«ç·¨å…¥é¡åˆ¥å€¼ã€‚ dt$QASide[1:10] ## [1] éå¸¸æ¥è¿‘æ³›ç¶  æ¥è¿‘æ³›è— æ¥è¿‘æ³›ç¶  æ¥è¿‘æ³›ç¶  éå¸¸æ¥è¿‘æ³›ç¶  ## [6] éå¸¸æ¥è¿‘æ³›è— æ¥è¿‘æ³›ç¶  æ¥è¿‘æ³›ç¶  æ¥è¿‘æ³›è— æ¥è¿‘æ³›ç¶  ## Levels: éå¸¸æ¥è¿‘æ³›ç¶  &lt; æ¥è¿‘æ³›ç¶  &lt; éƒ½ä¸æ¥è¿‘ &lt; æ¥è¿‘æ³›è— &lt; éå¸¸æ¥è¿‘æ³›è— as.integer(dt$QASide[1:10]) ## [1] 1 4 2 2 1 5 2 2 4 2 5.3.1.3 ç¾¤çµ„åŒ–é¡åˆ¥å€¼ å¦‚æœæœ‰æŸäº›é¡åˆ¥è®Šæ•¸çš„é¡åˆ¥éå¤šï¼Œå¸Œæœ›å†æ¬¡ç¾¤çµ„åŒ–ç‚ºè¼ƒå°‘çš„çµ„åˆ¥ï¼Œå¦‚é‡æ–°ç¾¤çµ„å„å¹´é½¡å±¤ç‚ºé’å¹´ã€å£¯å¹´ã€ä¸­å¹´èˆ‡è€å¹´å››å€‹å°ºåº¦ã€‚æ­¤æ™‚é™¤äº†levelsåƒæ•¸å¤–ï¼Œå¯ä»¥å¦å¤–åŠ å…¥labelsçš„åƒæ•¸ï¼ŒæŒ‡å®šæ¯å€‹é¡åˆ¥è®Šæ•¸å€¼æ‰€è¦å°æ‡‰åˆ°çš„ç¾¤çµ„ã€‚ä»¥ä¸‹ç‚ºç¾¤çµ„å¾Œçš„çµæœï¼Œä»”ç´°è§€å¯Ÿå‰©ä¸‹å¤šå°‘å€‹å°ºåº¦ã€‚ dt$QA3[1:10] ## [1] 25-29 35-39 35-39 20-24 45-49 25-29 30-34 20-24 20-24 55-59 ## 11 Levels: 20-24 &lt; 25-29 &lt; 30-34 &lt; 35-39 &lt; 40-44 &lt; 45-49 &lt; 50-54 &lt; ... &lt; 70åŠä»¥ä¸Š dt$QA3_lv[1:10] ## [1] é’å¹´ å£¯å¹´ å£¯å¹´ é’å¹´ ä¸­å¹´ é’å¹´ å£¯å¹´ é’å¹´ é’å¹´ ä¸­å¹´ ## Levels: é’å¹´ &lt; å£¯å¹´ &lt; ä¸­å¹´ &lt; è€å¹´ 5.3.2 å°ºåº¦è½‰é¡åˆ¥æŒ‡æ¨™ Q7 è«‹å•æ‚¨æœƒä¸æœƒå—åˆ°å‡æ¶ˆæ¯å½±éŸ¿ï¼Ÿ Q8 è«‹å•æ‚¨èªç‚ºå…¶ä»–äººæœƒä¸æœƒå—åˆ°å‡æ¶ˆæ¯çš„å½±éŸ¿ï¼Ÿ å°æ–¼Q7ã€Q8çš„å•é¡Œæ˜¯è©¢å•å¡«ç­”è€…èªç‚ºè‡ªå·±æˆ–ä»–äººæœƒä¸æœƒå—åˆ°å‡æ¶ˆæ¯å½±éŸ¿ï¼Œä¸¦å¾ã€Œä¸€é»ä¹Ÿä¸æœƒã€ã€ã€Œä¸æœƒã€ã€ã€Œæœƒã€åˆ°ã€Œçµ•å°æœƒã€å…±åˆ†å››å€‹ç­‰ç¬¬ã€‚Q7åˆ†åˆ¥æ˜¯ã€Œ81, 446, 650, 39ã€ã€Q8åˆ†åˆ¥æ˜¯ã€Œ5, 58, 803, 350ã€ã€‚ç›¸è¼ƒæ–¼Q7ï¼ŒQ8çš„åˆ†ä½ˆç•¥ç‚ºå·¦å‚¾ï¼Œäº¦å³å‚¾å‘æ–¼èªç‚ºå…¶ä»–äººè¼ƒå®¹æ˜“å—å½±éŸ¿ã€‚æ­¤æ™‚å¦‚æœæƒ³è¦åˆ†æQ7å’ŒQ8é–“çš„é—œä¿‚ï¼Œç”±æ–¼å„æœ‰å››å€‹ç­‰ç¬¬ï¼Œå…¶äº¤å‰åˆ†æè¡¨æœƒæœ‰16å€‹é …ç›®ï¼Œç›¸ç•¶é›£ä»¥åˆ†æã€‚ dt2 &lt;- dt %&gt;% mutate(Q7 = ordered(Q7, levels=c(&quot;ä¸€é»ä¹Ÿä¸æœƒ&quot;, &quot;ä¸æœƒ&quot;, &quot;æœƒ&quot;, &quot;çµ•å°æœƒ&quot;))) %&gt;% mutate(Q8 = ordered(Q8, levels=c(&quot;ä¸€é»ä¹Ÿä¸æœƒ&quot;, &quot;ä¸æœƒ&quot;, &quot;æœƒ&quot;, &quot;çµ•å°æœƒ&quot;))) %&gt;% mutate(Q7_3rd = as.numeric(Q8)-as.numeric(Q7)) %&gt;% mutate(Q7_3rd_lv = ifelse(Q7 %in% c(&quot;ä¸€é»ä¹Ÿä¸æœƒ&quot;, &quot;ä¸æœƒ&quot;) &amp; Q8 %in% c(&quot;æœƒ&quot;, &quot;çµ•å°æœƒ&quot;), &quot;é«˜&quot;, &quot;ä½&quot;)) %&gt;% mutate(Q7_3rd_lv = ordered(Q7_3rd_lv, levels=c(&quot;ä½&quot;, &quot;é«˜&quot;))) é€™æ™‚å€™ä¸€ç¨®ç­–ç•¥æ˜¯æŠŠé€™å…©é¡Œè¦–ç‚ºé †åºå°ºåº¦è®Šæ•¸ï¼Œç„¶å¾ŒæŠŠå…©é¡Œçš„åˆ†æ•¸ç›¸æ¸›ã€‚ç›¸æ¸›å¾Œçš„åˆ†æ•¸å¾ã€Œ-1, 0, 1, 2, 3ã€å„æœ‰ã€Œ12, 482, 600, 103, 19ã€ï¼Œä¸é›£çŒœåˆ°æœƒæ˜¯ä¸€å€‹è¼ƒç‚ºé›†ä¸­çš„åˆ†ä½ˆï¼Œå¾ŒçºŒåƒ…èƒ½ç•¶ä½œé †åºå°ºåº¦æˆ–é€£çºŒè®Šé …ä¾†åˆ†æï¼Œä¸é©åˆæ‰¾ä¸€å€‹é–¾å€¼è½‰é¡åˆ¥è®Šé …ã€‚ å¦ä¸€ç¨®ç­–ç•¥æ˜¯ï¼Œåˆ†åˆ¥å…ˆæŠŠQ7èˆ‡Q8çš„ã€Œä¸€é»ä¹Ÿä¸æœƒã€å’Œã€Œä¸æœƒã€ç¾¤çµ„ç‚ºã€Œä¸æœƒã€ã€å†æŠŠã€Œæœƒã€èˆ‡ã€Œçµ•å°æœƒã€ç¾¤çµ„ç‚ºã€Œæœƒã€ï¼Œé€™æ¨£Q7èˆ‡Q8çš„äº¤å‰åˆ†æè¡¨æœƒè®Šæˆ2X2çš„åˆ†æè¡¨ï¼Œé›–ç„¶ç¾¤çµ„æ•¸é‡æ¯”è¼ƒå°‘ï¼Œä½†åˆ¥å¿˜è¨˜Q7çš„å¡«ç­”çµæœé›†ä¸­åœ¨æœƒèˆ‡ä¸æœƒã€è€ŒQ8ç‚ºä¸€å€‹è¼ƒç‚ºåå³çš„åˆ†ä½ˆï¼Œé›†ä¸­åœ¨ã€Œæœƒã€å’Œã€Œçµ•å°æœƒã€ã€‚Q8å‹¢å¿…æœƒé€ æˆæ¯”ä¾‹ä¸å‡çš„åˆ†çµ„ã€‚ dt2 %&gt;% count(as.integer(Q8)-as.integer(Q7)) as.integer(Q8) - as.integer(Q7) n -1 12 0 482 1 600 2 103 3 19 æœ€å¾Œé€™é¡Œæ‰€æ¡è¡Œçš„ç­–ç•¥æ˜¯ï¼Œåšé«˜ã€ä½ç¬¬ä¸‰äººæ•ˆæœåˆ†çµ„ï¼Œä¹Ÿå°±æ˜¯æ ¹æ“šèªç‚ºè‡ªå·±ã€Œä¸€é»ä¹Ÿä¸æœƒã€ã€ã€Œä¸æœƒã€å—å½±éŸ¿ï¼Œè€Œä»–äººã€Œæœƒã€æˆ–ã€Œçµ•å°æœƒã€å—å½±éŸ¿çš„é‡æ–°ç¾¤çµ„ç‚ºã€Œé«˜ç¬¬ä¸‰äººæ•ˆæœçµ„ã€ï¼Œå…¶ä»–å‰‡ç‚ºã€Œä½ç¬¬ä¸‰äººæ•ˆæœçµ„ã€ã€‚äº¦å³ï¼Œåˆ†çµ„çš„ä¸€å¥æ˜¯åœ¨å°è‡ªå·±èˆ‡ä»–äººçš„èªçŸ¥ä¸Šï¼Œç„¡æ¨¡ç³Šç©ºé–“çš„åˆ†çµ„æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯èªç‚ºè‡ªå·±è‡³å°‘ä¸æœƒï¼Œå’Œèªç‚ºåˆ¥äººæ‡‰è©²æœƒï¼‰ã€‚ dt2 %&gt;% count(Q7_3rd_lv) Q7_3rd_lv n ä½ 746 é«˜ 470 5.3.3 Cross-tabulating (xtb &lt;- xtabs(~QA3_lv + Q7_3rd_lv, data=dt2)) ä½ é«˜ é’å¹´ 178 110 å£¯å¹´ 370 199 ä¸­å¹´ 157 134 è€å¹´ 41 27 (chi2 &lt;- chisq.test(xtb)) ## ## Pearson&#39;s Chi-squared test ## ## data: xtb ## X-squared = 10.017, df = 3, p-value = 0.01842 vcd::assocstats(xtb) ## X^2 df P(&gt; X^2) ## Likelihood Ratio 9.9301 3 0.01917 ## Pearson 10.0173 3 0.01842 ## ## Phi-Coefficient : NA ## Contingency Coeff.: 0.09 ## Cramer&#39;s V : 0.091 print(round(chi2$observed, 2)) ## Q7_3rd_lv ## QA3_lv ä½ é«˜ ## é’å¹´ 178 110 ## å£¯å¹´ 370 199 ## ä¸­å¹´ 157 134 ## è€å¹´ 41 27 print(round(chi2$expected, 2)) ## Q7_3rd_lv ## QA3_lv ä½ é«˜ ## é’å¹´ 176.68 111.32 ## å£¯å¹´ 349.07 219.93 ## ä¸­å¹´ 178.52 112.48 ## è€å¹´ 41.72 26.28 print(round(chi2$residuals, 2)) ## Q7_3rd_lv ## QA3_lv ä½ é«˜ ## é’å¹´ 0.10 -0.12 ## å£¯å¹´ 1.12 -1.41 ## ä¸­å¹´ -1.61 2.03 ## è€å¹´ -0.11 0.14 par(family=&quot;Heiti TC Light&quot;) gplots::balloonplot(t(xtb), xlab=&quot;ç¬¬ä¸‰äººæ•ˆæœ&quot;, ylab=&quot;å¹´é½¡çµ„&quot;, main=&quot;&quot;, dotsize=4/max(strwidth(40),strheight(40)), text.size=1.5,label.size=2, rowmar=1, colmar=1) par(family=&quot;Heiti TC Light&quot;) corrplot::corrplot(chi2$residuals, is.corr = F) xtb %&gt;% as_tibble() %&gt;% group_by(QA3_lv) %&gt;% mutate(fill = if_else(n == max(n), &quot;orangered&quot;, &quot;skyblue&quot;)) %&gt;% ungroup() %&gt;% mutate(QA3_lv = ordered(QA3_lv, levels=c(&quot;é’å¹´&quot;, &quot;å£¯å¹´&quot;, &quot;ä¸­å¹´&quot;, &quot;è€å¹´&quot;))) %&gt;% arrange(desc(QA3_lv)) %&gt;% ggplot() + aes(y = QA3_lv, x=Q7_3rd_lv, color = fill, size = n) + scale_size_area(max_size=70, guide = &quot;none&quot;) + geom_point(alpha=0.7) + scale_color_manual(values = c(&quot;orangered&quot;, &quot;skyblue&quot;), guide = &quot;none&quot;) + geom_text(aes( label=n, vjust=1.3, size=10 ), color=&quot;black&quot;,) + theme_minimal() + theme(text = element_text(size=36, family=&quot;Heiti TC Light&quot;), title = element_text(size=36, family=&quot;Heiti TC Light&quot;)) "],["æ™‚é–“è»¸çš„è¦–è¦ºåŒ–.html", "5.4 æ™‚é–“è»¸çš„è¦–è¦ºåŒ–", " 5.4 æ™‚é–“è»¸çš„è¦–è¦ºåŒ– library(tidyverse) library(lubridate) # options(stringsAsFactors = F) # default option in R &gt; 4.0 5.4.1 æ–‡å­—è½‰æ™‚é–“ Convert â€œcharacter timeâ€ to R date.time object (POSIXct) ptturl &lt;- &quot;https://github.com/P4CSS/R4CSSData/raw/main/ptt_hang_posts.csv&quot; raw &lt;- read.csv(url(ptturl)) clean &lt;- raw %&gt;% mutate(ptime = as.POSIXct(strptime(ptime, &quot;%Y-%m-%dT%H:%M:%SZ&quot;, tz = &quot;ASIA/Taipeiw&quot;))) raw &lt;- read_csv(url(ptturl)) ?read_csv read_delim R Documentation Read a delimited file (including CSV and TSV) into a tibble Description read_csv() and read_tsv() are special cases of the more general read_delim(). Theyâ€™re useful for reading the most common types of flat file data, comma separated values and tab separated values, respectively. read_csv2() uses ; for the field separator and , for the decimal point. This format is common in some European countries. Usage read_delim( file, delim = NULL, quote = \"\\\"\", escape_backslash = FALSE, escape_double = TRUE, col_names = TRUE, col_types = NULL, col_select = NULL, id = NULL, locale = default_locale(), na = c(\"\", \"NA\"), quoted_na = TRUE, comment = \"\", trim_ws = FALSE, skip = 0, n_max = Inf, guess_max = min(1000, n_max), name_repair = \"unique\", num_threads = readr_threads(), progress = show_progress(), show_col_types = should_show_types(), skip_empty_rows = TRUE, lazy = should_read_lazy() ) read_csv( file, col_names = TRUE, col_types = NULL, col_select = NULL, id = NULL, locale = default_locale(), na = c(\"\", \"NA\"), quoted_na = TRUE, quote = \"\\\"\", comment = \"\", trim_ws = TRUE, skip = 0, n_max = Inf, guess_max = min(1000, n_max), name_repair = \"unique\", num_threads = readr_threads(), progress = show_progress(), show_col_types = should_show_types(), skip_empty_rows = TRUE, lazy = should_read_lazy() ) read_csv2( file, col_names = TRUE, col_types = NULL, col_select = NULL, id = NULL, locale = default_locale(), na = c(\"\", \"NA\"), quoted_na = TRUE, quote = \"\\\"\", comment = \"\", trim_ws = TRUE, skip = 0, n_max = Inf, guess_max = min(1000, n_max), progress = show_progress(), name_repair = \"unique\", num_threads = readr_threads(), show_col_types = should_show_types(), skip_empty_rows = TRUE, lazy = should_read_lazy() ) read_tsv( file, col_names = TRUE, col_types = NULL, col_select = NULL, id = NULL, locale = default_locale(), na = c(\"\", \"NA\"), quoted_na = TRUE, quote = \"\\\"\", comment = \"\", trim_ws = TRUE, skip = 0, n_max = Inf, guess_max = min(1000, n_max), progress = show_progress(), name_repair = \"unique\", num_threads = readr_threads(), show_col_types = should_show_types(), skip_empty_rows = TRUE, lazy = should_read_lazy() ) Arguments file Either a path to a file, a connection, or literal data (either a single string or a raw vector). Files ending in .gz, .bz2, .xz, or .zip will be automatically uncompressed. Files starting with http://, https://, ftp://, or ftps:// will be automatically downloaded. Remote gz files can also be automatically downloaded and decompressed. Literal data is most useful for examples and tests. To be recognised as literal data, the input must be either wrapped with I(), be a string containing at least one new line, or be a vector containing at least one string with a new line. Using a value of clipboard() will read from the system clipboard. delim Single character used to separate fields within a record. quote Single character used to quote strings. escape_backslash Does the file use backslashes to escape special characters? This is more general than escape_double as backslashes can be used to escape the delimiter character, the quote character, or to add special characters like \\n. escape_double Does the file escape quotes by doubling them? i.e.Â If this option is TRUE, the value â€œâ€œâ€œâ€œ represents a single quote, \". col_names Either TRUE, FALSE or a character vector of column names. If TRUE, the first row of the input will be used as the column names, and will not be included in the data frame. If FALSE, column names will be generated automatically: X1, X2, X3 etc. If col_names is a character vector, the values will be used as the names of the columns, and the first row of the input will be read into the first row of the output data frame. Missing (NA) column names will generate a warning, and be filled in with dummy names â€¦1, â€¦2 etc. Duplicate column names will generate a warning and be made unique, see name_repair to control how this is done. col_types One of NULL, a cols() specification, or a string. See vignette(â€œreadrâ€) for more details. If NULL, all column types will be imputed from guess_max rows on the input interspersed throughout the file. This is convenient (and fast), but not robust. If the imputation fails, youâ€™ll need to increase the guess_max or supply the correct types yourself. Column specifications created by list() or cols() must contain one column specification for each column. If you only want to read a subset of the columns, use cols_only(). Alternatively, you can use a compact string representation where each character represents one column: c = character i = integer n = number d = double l = logical f = factor D = date T = date time t = time ? = guess _ or - = skip By default, reading a file without a column specification will print a message showing what readr guessed they were. To remove this message, set show_col_types = FALSE or set â€™options(readr.show_col_types = FALSE). col_select Columns to include in the results. You can use the same mini-language as dplyr::select() to refer to the columns by name. Use c() or list() to use more than one selection expression. Although this usage is less common, col_select also accepts a numeric column index. See ?tidyselect::language for full details on the selection language. id The name of a column in which to store the file path. This is useful when reading multiple input files and there is data in the file paths, such as the data collection date. If NULL (the default) no extra column is created. locale The locale controls defaults that vary from place to place. The default locale is US-centric (like R), but you can use locale() to create your own locale that controls things like the default time zone, encoding, decimal mark, big mark, and day/month names. na Character vector of strings to interpret as missing values. Set this option to character() to indicate no missing values. quoted_na Should missing values inside quotes be treated as missing values (the default) or strings. This parameter is soft deprecated as of readr 2.0.0. comment A string used to identify comments. Any text after the comment characters will be silently ignored. trim_ws Should leading and trailing whitespace (ASCII spaces and tabs) be trimmed from each field before parsing it? skip Number of lines to skip before reading data. If comment is supplied any commented lines are ignored after skipping. n_max Maximum number of lines to read. guess_max Maximum number of lines to use for guessing column types. See vignette(â€œcolumn-typesâ€, package = â€œreadrâ€) for more details. name_repair Handling of column names. The default behaviour is to ensure column names are â€œuniqueâ€. Various repair strategies are supported: â€œminimalâ€: No name repair or checks, beyond basic existence of names. â€œuniqueâ€ (default value): Make sure names are unique and not empty. â€œcheck_uniqueâ€: no name repair, but check they are unique. â€œuniversalâ€: Make the names unique and syntactic. A function: apply custom name repair (e.g., name_repair = make.names for names in the style of base R). A purrr-style anonymous function, see rlang::as_function(). This argument is passed on as repair to vctrs::vec_as_names(). See there for more details on these terms and the strategies used to enforce them. num_threads The number of processing threads to use for initial parsing and lazy reading of data. If your data contains newlines within fields the parser should automatically detect this and fall back to using one thread only. However if you know your file has newlines within quoted fields it is safest to set num_threads = 1 explicitly. progress Display a progress bar? By default it will only display in an interactive session and not while knitting a document. The automatic progress bar can be disabled by setting option readr.show_progress to FALSE. show_col_types If FALSE, do not show the guessed column types. If TRUE always show the column types, even if they are supplied. If NULL (the default) only show the column types if they are not explicitly supplied by the col_types argument. skip_empty_rows Should blank rows be ignored altogether? i.e.Â If this option is TRUE then blank rows will not be represented at all. If it is FALSE then they will be represented by NA values in all the columns. lazy Read values lazily? By default the file is initially only indexed and the values are read lazily when accessed. Lazy reading is useful interactively, particularly if you are only interested in a subset of the full dataset. Note, if you later write to the same file you read from you need to set lazy = FALSE. On Windows the file will be locked and on other systems the memory map will become invalid. Value A tibble(). If there are parsing problems, a warning will alert you. You can retrieve the full details by calling problems() on your dataset. Examples # Input sources ------------------------------------------------------------- # Read from a path read_csv(readr_example(\"mtcars.csv\")) read_csv(readr_example(\"mtcars.csv.zip\")) read_csv(readr_example(\"mtcars.csv.bz2\")) ## Not run: # Including remote paths read_csv(\"https://github.com/tidyverse/readr/raw/main/inst/extdata/mtcars.csv\") ## End(Not run) # Or directly from a string with `I()` read_csv(I(\"x,y\\n1,2\\n3,4\")) # Column types -------------------------------------------------------------- # By default, readr guesses the columns types, looking at `guess_max` rows. # You can override with a compact specification: read_csv(I(\"x,y\\n1,2\\n3,4\"), col_types = \"dc\") # Or with a list of column types: read_csv(I(\"x,y\\n1,2\\n3,4\"), col_types = list(col_double(), col_character())) # If there are parsing problems, you get a warning, and can extract # more details with problems() y &lt;- read_csv(I(\"x\\n1\\n2\\nb\"), col_types = list(col_double())) y problems(y) # File types ---------------------------------------------------------------- read_csv(I(\"a,b\\n1.0,2.0\")) read_csv2(I(\"a;b\\n1,0;2,0\")) read_tsv(I(\"a\\tb\\n1.0\\t2.0\")) read_delim(I(\"a|b\\n1.0|2.0\"), delim = \"|\") t &lt;- &quot;2019-04-12T00:48:19Z&quot; class(t) ## [1] &quot;character&quot; ?strptime strptime R Documentation Date-time Conversion Functions to and from Character Description Functions to convert between character representations and objects of classes â€œPOSIXltâ€ and â€œPOSIXctâ€ representing calendar dates and times. Usage ## S3 method for class 'POSIXct' format(x, format = \"\", tz = \"\", usetz = FALSE, ...) ## S3 method for class 'POSIXlt' format(x, format = \"\", usetz = FALSE, ...) ## S3 method for class 'POSIXt' as.character(x, ...) strftime(x, format = \"\", tz = \"\", usetz = FALSE, ...) strptime(x, format, tz = \"\") Arguments x An object to be converted: a character vector for strptime, an object which can be converted to â€œPOSIXltâ€ for strftime. tz A character string specifying the time zone to be used for the conversion. System-specific (see as.POSIXlt), but â€œâ€œ is the current time zone, and â€GMTâ€ is UTC. Invalid values are most commonly treated as UTC, on some platforms with a warning. format A character string. The default for the format methods is â€œ%Y-%m-%d %H:%M:%Sâ€ if any element has a time component which is not midnight, and â€œ%Y-%m-%dâ€ otherwise. If options(â€œdigits.secsâ€) is set, up to the specified number of digits will be printed for seconds. â€¦ Further arguments to be passed from or to other methods. usetz logical. Should the time zone abbreviation be appended to the output? This is used in printing times, and more reliable than using â€œ%Zâ€. Details The format and as.character methods and strftime convert objects from the classes â€œPOSIXltâ€ and â€œPOSIXctâ€ to character vectors. strptime converts character vectors to class â€œPOSIXltâ€: its input x is first converted by as.character. Each input string is processed as far as necessary for the format specified: any trailing characters are ignored. strftime is a wrapper for format.POSIXlt, and it and format.POSIXct first convert to class â€œPOSIXltâ€ by calling as.POSIXlt (so they also work for class â€œDateâ€). Note that only that conversion depends on the time zone. The usual vector re-cycling rules are applied to x and format so the answer will be of length of the longer of these vectors. Locale-specific conversions to and from character strings are used where appropriate and available. This affects the names of the days and months, the AM/PM indicator (if used) and the separators in output formats such as %x and %X, via the setting of the LC_TIME locale category. The â€˜current localeâ€™ of the descriptions might mean the locale in use at the start of the R session or when these functions are first used. (For input, the locale-specific conversions can be changed by calling Sys.setlocale with category LC_TIME (or LC_ALL). For output, what happens depends on the OS but usually works.) The details of the formats are platform-specific, but the following are likely to be widely available: most are defined by the POSIX standard. A conversion specification is introduced by %, usually followed by a single letter or O or E and then a single letter. Any character in the format string not part of a conversion specification is interpreted literally (and %% gives %). Widely implemented conversion specifications include %a Abbreviated weekday name in the current locale on this platform. (Also matches full name on input: in some locales there are no abbreviations of names.) %A Full weekday name in the current locale. (Also matches abbreviated name on input.) %b Abbreviated month name in the current locale on this platform. (Also matches full name on input: in some locales there are no abbreviations of names.) %B Full month name in the current locale. (Also matches abbreviated name on input.) %c Date and time. Locale-specific on output, â€œ%a %b %e %H:%M:%S %Yâ€ on input. %C Century (00â€“99): the integer part of the year divided by 100. %d Day of the month as decimal number (01â€“31). %D Date format such as %m/%d/%y: the C99 standard says it should be that exact format (but not all OSes comply). %e Day of the month as decimal number (1â€“31), with a leading space for a single-digit number. %F Equivalent to %Y-%m-%d (the ISO 8601 date format). %g The last two digits of the week-based year (see %V). (Accepted but ignored on input.) %G The week-based year (see %V) as a decimal number. (Accepted but ignored on input.) %h Equivalent to %b. %H Hours as decimal number (00â€“23). As a special exception strings such as 24:00:00 are accepted for input, since ISO 8601 allows these. %I Hours as decimal number (01â€“12). %j Day of year as decimal number (001â€“366): For input, 366 is only valid in a leap year. %m Month as decimal number (01â€“12). %M Minute as decimal number (00â€“59). %n Newline on output, arbitrary whitespace on input. %p AM/PM indicator in the locale. Used in conjunction with %I and not with %H. An empty string in some locales (for example on some OSes, non-English European locales including Russia). The behaviour is undefined if used for input in such a locale. Some platforms accept %P for output, which uses a lower-case version (%p may also use lower case): others will output P. %r For output, the 12-hour clock time (using the localeâ€™s AM or PM): only defined in some locales, and on some OSes misleading in locales which do not define an AM/PM indicator. For input, equivalent to %I:%M:%S %p. %R Equivalent to %H:%M. %S Second as integer (00â€“61), allowing for up to two leap-seconds (but POSIX-compliant implementations will ignore leap seconds). %t Tab on output, arbitrary whitespace on input. %T Equivalent to %H:%M:%S. %u Weekday as a decimal number (1â€“7, Monday is 1). %U Week of the year as decimal number (00â€“53) using Sunday as the first day 1 of the week (and typically with the first Sunday of the year as day 1 of week 1). The US convention. %V Week of the year as decimal number (01â€“53) as defined in ISO 8601. If the week (starting on Monday) containing 1 January has four or more days in the new year, then it is considered week 1. Otherwise, it is the last week of the previous year, and the next week is week 1. (Accepted but ignored on input.) %w Weekday as decimal number (0â€“6, Sunday is 0). %W Week of the year as decimal number (00â€“53) using Monday as the first day of week (and typically with the first Monday of the year as day 1 of week 1). The UK convention. %x Date. Locale-specific on output, â€œ%y/%m/%dâ€ on input. %X Time. Locale-specific on output, â€œ%H:%M:%Sâ€ on input. %y Year without century (00â€“99). On input, values 00 to 68 are prefixed by 20 and 69 to 99 by 19 â€“ that is the behaviour specified by the 2018 POSIX standard, but it does also say â€˜it is expected that in a future version the default century inferred from a 2-digit year will changeâ€™. %Y Year with century. Note that whereas there was no zero in the original Gregorian calendar, ISO 8601:2004 defines it to be valid (interpreted as 1BC): see https://en.wikipedia.org/wiki/0_(year). However, the standards also say that years before 1582 in its calendar should only be used with agreement of the parties involved. For input, only years 0:9999 are accepted. %z Signed offset in hours and minutes from UTC, so -0800 is 8 hours behind UTC. Values up to +1400 are accepted. (Standard only for output. For input R currently supports it on all platforms.) %Z (Output only.) Time zone abbreviation as a character string (empty if not available). This may not be reliable when a time zone has changed abbreviations over the years. Where leading zeros are shown they will be used on output but are optional on input. Names are matched case-insensitively on input: whether they are capitalized on output depends on the platform and the locale. Note that abbreviated names are platform-specific (although the standards specify that in the C locale they must be the first three letters of the capitalized English name: this convention is widely used in English-language locales but for example the French month abbreviations are not the same on any two of Linux, macOS, Solaris and Windows). Knowing what the abbreviations are is essential if you wish to use %a, %b or %h as part of an input format: see the examples for how to check. When %z or %Z is used for output with an object with an assigned time zone an attempt is made to use the values for that time zone â€” but it is not guaranteed to succeed. Not in the standards and less widely implemented are %k The 24-hour clock time with single digits preceded by a blank. %l The 12-hour clock time with single digits preceded by a blank. %s (Output only.) The number of seconds since the epoch. %+ (Output only.) Similar to %c, often â€œ%a %b %e %H:%M:%S %Z %Yâ€. May depend on the locale. For output there are also %O[dHImMUVwWy] which may emit numbers in an alternative locale-dependent format (e.g., roman numerals), and %E[cCyYxX] which can use an alternative â€˜eraâ€™ (e.g., a different religious calendar). Which of these are supported is OS-dependent. These are accepted for input, but with the standard interpretation. Specific to R is %OSn, which for output gives the seconds truncated to 0 &lt;= n &lt;= 6 decimal places (and if %OS is not followed by a digit, it uses the setting of getOption(â€œdigits.secsâ€), or if that is unset, n = 0). Further, for strptime %OS will input seconds including fractional seconds. Note that %S does not read fractional parts on output. The behaviour of other conversion specifications (and even if other character sequences commencing with % are conversion specifications) is system-specific. Some systems document that the use of multi-byte characters in format is unsupported: UTF-8 locales are unlikely to cause a problem. Value The format methods and strftime return character vectors representing the time. NA times are returned as NA_character_. The elements are restricted to 256 bytes, plus a time zone abbreviation if usetz is true. (On known platforms longer strings are truncated at 255 or 256 bytes, but this is not guaranteed by the C99 standard.) strptime turns character representations into an object of class â€œPOSIXltâ€. The time zone is used to set the isdst component and to set the â€œtzoneâ€ attribute if tz != â€œâ€œ. If the specified time is invalid (for example â€œ2010-02-30 08:00â€) all the components of the result are NA. (NB: this does means exactly what it says â€“ if it is an invalid time, not just a time that does not exist in some time zone.) Printing years Everyone agrees that years from 1000 to 9999 should be printed with 4 digits, but the standards do not define what is to be done outside that range. For years 0 to 999 most OSes pad with zeros or spaces to 4 characters, and Linux outputs just the number. OS facilities will probably not print years before 1 CE (aka 1 AD) â€˜correctlyâ€™ (they tend to assume the existence of a year 0: see https://en.wikipedia.org/wiki/0_(year), and some OSes get them completely wrong). Common formats are -45 and -045. Years after 9999 and before -999 are normally printed with five or more characters. Some platforms support modifiers from POSIX 2008 (and others). On Linux the format â€œ%04Yâ€ assures a minimum of four characters and zero-padding. The internal code (as used on Windows and by default on macOS) uses zero-padding by default, and formats %_4Y and %_Y can be used for space padding and no padding. Time zone offsets Offsets from GMT (also known as UTC) are part of the conversion between timezones and to/from class â€œPOSIXctâ€, but cause difficulties as they are often computed incorrectly. They conventionally have the opposite sign from time-zone specifications (see Sys.timezone): positive values are East of the meridian. Although there have been time zones with offsets like 00:09:21 (Paris in 1900), and 00:44:30 (Liberia until 1972), offsets are usually treated as whole numbers of minutes, and are most often seen in RFC 5322 email headers in forms like -0800 (e.g., used on the Pacific coast of the USA in winter). Format %z can be used for input or output: it is a character string, conventionally plus or minus followed by two digits for hours and two for minutes: the standards say that an empty string should be output if the offset is unknown, but some systems use the offsets for the time zone in use for the current year. Sources Input uses the POSIX function strptime and output the C99 function strftime. However, not all OSes (notably Windows) provided strptime and many issues were found for those which did, so since 2000 R has used a fork of code from glibc. The forked code uses the systemâ€™s strftime to find the locale-specific day and month names and any AM/PM indicator. On some platforms (including Windows and by default on macOS) the systemâ€™s strftime is replaced (along with most of the rest of the C-level datetime code) by code modified from IANAâ€™s tzcode distribution (https://www.iana.org/time-zones). Note The default formats follow the rules of the ISO 8601 international standard which expresses a day as â€œ2001-02-28â€ and a time as â€œ14:01:02â€ using leading zeroes as here. (The ISO form uses no space to separate dates and times: R does by default.) For strptime the input string need not specify the date completely: it is assumed that unspecified seconds, minutes or hours are zero, and an unspecified year, month or day is the current one. (However, if a month is specified, the day of that month has to be specified by %d or %e since the current day of the month need not be valid for the specified month.) Some components may be returned as NA (but an unknown tzone component is represented by an empty string). If the time zone specified is invalid on your system, what happens is system-specific but it will probably be ignored. Remember that in most time zones some times do not occur and some occur twice because of transitions to/from â€˜daylight savingâ€™ (also known as â€˜summerâ€™) time. strptime does not validate such times (it does not assume a specific time zone), but conversion by as.POSIXct will do so. Conversion by strftime and formatting/printing uses OS facilities and may return nonsensical results for non-existent times at DST transitions. In a C locale %c is required to be â€œ%a %b %e %H:%M:%S %Yâ€. As Windows does not comply (and uses a date format not understood outside N. America), that format is used by R on Windows in all locales. References International Organization for Standardization (2004, 2000, â€¦) â€˜ISO 8601. Data elements and interchange formats â€“ Information interchange â€“ Representation of dates and times.â€™, slightly updated to International Organization for Standardization (2019) â€˜ISO 8601-1:2019. Date and time â€“ Representations for information interchange â€“ Part 1: Basic rulesâ€™. For links to versions available on-line see (at the time of writing) https://dotat.at/tmp/ISO_8601-2004_E.pdf and https://www.qsl.net/g1smd/isopdf.htm; for information on the current official version, see https://www.iso.org/iso/iso8601. The POSIX 1003.1 standard, which is in some respects stricter than ISO 8601. See Also DateTimeClasses for details of the date-time classes; locales to query or set a locale. Your systemâ€™s help page on strftime to see how to specify their formats. (On some systems, including Windows, strftime is replaced by more comprehensive internal code.) Examples ## locale-specific version of date() format(Sys.time(), \"%a %b %d %X %Y %Z\") ## time to sub-second accuracy (if supported by the OS) format(Sys.time(), \"%H:%M:%OS3\") ## read in date info in format 'ddmmmyyyy' ## This will give NA(s) in some non-English locales; setting the C locale ## as in the commented lines will overcome this on most systems. ## lct &lt;- Sys.getlocale(\"LC_TIME\"); Sys.setlocale(\"LC_TIME\", \"C\") x &lt;- c(\"1jan1960\", \"2jan1960\", \"31mar1960\", \"30jul1960\") z &lt;- strptime(x, \"%d%b%Y\") ## Sys.setlocale(\"LC_TIME\", lct) z ## read in date/time info in format 'm/d/y h:m:s' dates &lt;- c(\"02/27/92\", \"02/27/92\", \"01/14/92\", \"02/28/92\", \"02/01/92\") times &lt;- c(\"23:03:20\", \"22:29:56\", \"01:03:30\", \"18:21:03\", \"16:56:26\") x &lt;- paste(dates, times) strptime(x, \"%m/%d/%y %H:%M:%S\") ## time with fractional seconds z &lt;- strptime(\"20/2/06 11:16:16.683\", \"%d/%m/%y %H:%M:%OS\") z # prints without fractional seconds op &lt;- options(digits.secs = 3) z options(op) ## time zone names are not portable, but 'EST5EDT' comes pretty close. (x &lt;- strptime(c(\"2006-01-08 10:07:52\", \"2006-08-07 19:33:02\"), \"%Y-%m-%d %H:%M:%S\", tz = \"EST5EDT\")) attr(x, \"tzone\") ## An RFC 5322 header (Eastern Canada, during DST) ## In a non-English locale the commented lines may be needed. ## prev &lt;- Sys.getlocale(\"LC_TIME\"); Sys.setlocale(\"LC_TIME\", \"C\") strptime(\"Tue, 23 Mar 2010 14:36:38 -0400\", \"%a, %d %b %Y %H:%M:%S %z\") ## Sys.setlocale(\"LC_TIME\", prev) ## Make sure you know what the abbreviated names are for you if you wish ## to use them for input (they are matched case-insensitively): format(seq.Date(as.Date('1978-01-01'), by = 'day', len = 7), \"%a\") format(seq.Date(as.Date('2000-01-01'), by = 'month', len = 12), \"%b\") t1 &lt;- strptime(t, &quot;%Y-%m-%dT%H:%M:%SZ&quot;) raw %&gt;% glimpse() ## Rows: 8,317 ## Columns: 7 ## $ plink &lt;chr&gt; &quot;https://www.ptt.cc/bbs/HatePolitics/M.1555035677.A.24B.html&quot;â€¦ ## $ board &lt;chr&gt; &quot;HatePolitics&quot;, &quot;HatePolitics&quot;, &quot;HatePolitics&quot;, &quot;HatePoliticsâ€¦ ## $ pcontent &lt;chr&gt; &quot;\\n\\néŸ“åœ‹ç‘œèµ´å“ˆä½›å¤§å­¸å‰å—è¨ªè¡¨ç¤ºï¼Œå°±æ˜¯ã€Œkeeping practiceã€ï¼Œç›¡â€¦ ## $ poster &lt;chr&gt; &quot;lovebxcx&quot;, &quot;ikr3699654&quot;, &quot;sunyeah&quot;, &quot;rock720429&quot;, &quot;btm978952â€¦ ## $ ptitle &lt;chr&gt; &quot;Re: [æ–°è] é‡ç”³åå°ä¸€åœ‹å…©åˆ¶ éŸ“åœ‹ç‘œï¼šçœ‹è‘—æˆ‘éˆé­‚æ·±&quot;, &quot;Re: [è¨â€¦ ## $ ptime &lt;dttm&gt; 2019-04-12 02:21:14, 2019-04-12 02:13:45, 2019-04-12 02:10:1â€¦ ## $ ipaddr &lt;chr&gt; &quot;83.221.204.163&quot;, &quot;114.43.176.110&quot;, &quot;118.163.130.181&quot;, &quot;118.1â€¦ 5.4.2 æ™‚é–“ä½œç‚ºæ©Ÿç‡åˆ†ä½ˆXè»¸ raw %&gt;% ggplot() + aes(ptime) + geom_density() 5.4.3 é€æœˆçµ±è¨ˆè³‡æ–™ ?lubridate lubridate-package R Documentation Dates and times made easy with lubridate Description Lubridate provides tools that make it easier to parse and manipulate dates. These tools are grouped below by common purpose. More information about each function can be found in its help documentation. Parsing dates Lubridateâ€™s parsing functions read strings into R as POSIXct date-time objects. Users should choose the function whose name models the order in which the year (â€˜yâ€™), month (â€˜mâ€™) and day (â€˜dâ€™) elements appear the string to be parsed: dmy(), myd(), ymd(), ydm(), dym(), mdy(), ymd_hms()). A very flexible and user friendly parser is provided by parse_date_time(). Lubridate can also parse partial dates from strings into Period objects with the functions hm(), hms() and ms(). Lubridate has an inbuilt very fast POSIX parser. Most of the strptime() formats and various extensions are supported for English locales. See parse_date_time() for more details. Manipulating dates Lubridate distinguishes between moments in time (known as instants()) and spans of time (known as time spans, see Timespan). Time spans are further separated into Duration, Period and Interval objects. Instants Instants are specific moments of time. Date, POSIXct, and POSIXlt are the three object classes Base R recognizes as instants. is.Date() tests whether an object inherits from the Date class. is.POSIXt() tests whether an object inherits from the POSIXlt or POSIXct classes. is.instant() tests whether an object inherits from any of the three classes. now() returns the current system time as a POSIXct object. today() returns the current system date. For convenience, 1970-01-01 00:00:00 is saved to origin. This is the instant from which POSIXct times are calculated. Try unclass(now()) to see the numeric structure that underlies POSIXct objects. Each POSIXct object is saved as the number of seconds it occurred after 1970-01-01 00:00:00. Conceptually, instants are a combination of measurements on different units (i.e, years, months, days, etc.). The individual values for these units can be extracted from an instant and set with the accessor functions second(), minute(), hour(), day(), yday(), mday(), wday(), week(), month(), year(), tz(), and dst(). Note: the accessor functions are named after the singular form of an element. They shouldnâ€™t be confused with the period helper functions that have the plural form of the units as a name (e.g, seconds()). Rounding dates Instants can be rounded to a convenient unit using the functions ceiling_date(), floor_date() and round_date(). Time zones Lubridate provides two helper functions for working with time zones. with_tz() changes the time zone in which an instant is displayed. The clock time displayed for the instant changes, but the moment of time described remains the same. force_tz() changes only the time zone element of an instant. The clock time displayed remains the same, but the resulting instant describes a new moment of time. Timespans A timespan is a length of time that may or may not be connected to a particular instant. For example, three months is a timespan. So is an hour and a half. Base R uses difftime class objects to record timespans. However, people are not always consistent in how they expect time to behave. Sometimes the passage of time is a monotone progression of instants that should be as mathematically reliable as the number line. On other occasions time must follow complex conventions and rules so that the clock times we see reflect what we expect to observe in terms of daylight, season, and congruence with the atomic clock. To better navigate the nuances of time, lubridate creates three additional timespan classes, each with its own specific and consistent behavior: Interval, Period and Duration. is.difftime() tests whether an object inherits from the difftime class. is.timespan() tests whether an object inherits from any of the four timespan classes. Durations Durations measure the exact amount of time that occurs between two instants. This can create unexpected results in relation to clock times if a leap second, leap year, or change in daylight savings time (DST) occurs in the interval. Functions for working with durations include is.duration(), as.duration() and duration(). dseconds(), dminutes(), dhours(), ddays(), dweeks() and dyears() convenient lengths. Periods Periods measure the change in clock time that occurs between two instants. Periods provide robust predictions of clock time in the presence of leap seconds, leap years, and changes in DST. Functions for working with periods include is.period(), as.period() and period(). seconds(), minutes(), hours(), days(), weeks(), months() and years() quickly create periods of convenient lengths. Intervals Intervals are timespans that begin at a specific instant and end at a specific instant. Intervals retain complete information about a timespan. They provide the only reliable way to convert between periods and durations. Functions for working with intervals include is.interval(), as.interval(), interval(), int_shift(), int_flip(), int_aligns(), int_overlaps(), and %within%. Intervals can also be manipulated with intersect, union, and setdiff(). Miscellaneous decimal_date() converts an instant to a decimal of its year. leap_year() tests whether an instant occurs during a leap year. pretty_dates() provides a method of making pretty breaks for date-times. lakers is a data set that contains information about the Los Angeles Lakers 2008-2009 basketball season. Author(s) Maintainer: Vitalie Spinu spinuvit@gmail.com Authors: Garrett Grolemund Hadley Wickham Other contributors: Davis Vaughan [contributor] Ian Lyttle [contributor] Imanuel Costigan [contributor] Jason Law [contributor] Doug Mitarotonda [contributor] Joseph Larmarange [contributor] Jonathan Boiser [contributor] Chel Hee Lee [contributor] Google Inc.Â [contributor, copyright holder] References Garrett Grolemund, Hadley Wickham (2011). Dates and Times Made Easy with lubridate. Journal of Statistical Software, 40(3), 1-25. https://www.jstatsoft.org/v40/i03/. See Also Useful links: https://lubridate.tidyverse.org https://github.com/tidyverse/lubridate Report bugs at https://github.com/tidyverse/lubridate/issues raw %&gt;% mutate(m = month(ptime)) %&gt;% count(m) %&gt;% ggplot() + aes(m, n) + geom_col() 5.4.4 é€æ—¥çµ±è¨ˆè³‡æ–™ï¼ˆä½³ï¼‰ raw %&gt;% filter(ptime &gt;= as_date(&quot;2019-03-18&quot;) &amp; ptime &lt; as_date(&quot;2019-04-01&quot;)) %&gt;% mutate(m = floor_date(ptime, unit = &quot;day&quot;)) %&gt;% count(m) %&gt;% ggplot() + aes(m, n) + geom_col() 5.4.5 æ¯æ—¥é€æ™‚è³‡æ–™ clean %&gt;% filter(ptime &gt;= as_datetime(&quot;2019-03-25&quot;) &amp; ptime &lt; as_datetime(&quot;2019-04-01&quot;)) %&gt;% mutate(d = floor_date(ptime, unit = &quot;day&quot;)) %&gt;% mutate(h = hour(ptime)) %&gt;% count(d, h) %&gt;% mutate(wd = wday(d, label = F, locale = Sys.getlocale(&quot;LC_TIME&quot;))) %&gt;% mutate(isweekend = ifelse(wd &gt;= 6, &quot;weekend&quot;, &quot;weekday&quot;)) %&gt;% ggplot() + aes(h, n, color = as.character(d)) + geom_line() + facet_wrap(~isweekend) ?ifelse ## Help on topic &#39;ifelse&#39; was found in the following packages: ## ## * base ## * data.table "],["text-processing.html", "Chapter 6 Text Processing", " Chapter 6 Text Processing "],["tweets-åˆ†æ.html", "6.1 Tweets åˆ†æ", " 6.1 Tweets åˆ†æ æ‡‰ç”¨dplyrå’Œggplotåšç¤¾ç¾¤è¼¿è«–è³‡æ–™ï¼ˆtweetsï¼‰çš„æ¢ç´¢æ€§åˆ†æï¼Œå…¶ä¸­é™¤äº†dplyrå’Œggplotå¤–ï¼Œå°šç”¨åˆ°æ–‡å­—è™•ç†ï¼ˆstringr, extract()ï¼‰ã€æ™‚é–“è™•ç†ï¼ˆlubridateï¼‰ï¼Œç”šè‡³åŒ…å«ä¸€é»keynessåˆ†æï¼Œç‚ºæ‰¾å‡ºå…©å€‹ç¾¤é«”æ–‡æœ¬ä¸­ï¼Œå°å½¼æ­¤ç›¸å°çªå‡ºé—œéµå­—çš„æ–‡æœ¬æ¢å‹˜æ–¹æ³•ã€‚ æœ¬ç¯„ä¾‹å–æè‡ªDavid Robinsonçš„blogæ–‡ç« ã€ŒText analysis of Trumpâ€™s tweets confirms he writes only the (angrier) Android halfã€ã€‚David Robinsonæ˜¯ã€ŒText Mining with Rã€çš„å…±åŒä½œè€…ï¼Œ å¯åƒè€ƒè©²æ›¸ç±ä¸Šçš„ç¯„ä¾‹ã€Œ7 Case study: comparing Twitter archives | Text Mining with R (tidytextmining.com)ã€ã€‚ 6.1.1 è¼‰å…¥ä¸¦æ¸…ç†è³‡æ–™ R4.0å¾ŒstringsAsFactors=Fè®Šç‚ºé è¨­å€¼ï¼Œä¾¿ä¸ç”¨å†å¦è¡Œç”¨options()è¨­ç‚ºå…¨åŸŸé©ç”¨çš„åƒæ•¸ã€‚ library(tidyverse) library(lubridate) options(scipen = 999) th &lt;- theme_minimal() + theme(plot.title = element_text(size=24, face=&quot;bold&quot;), legend.title = element_text(size=18, face=&quot;bold&quot;), legend.text = element_text(size=18), axis.title = element_text(hjust=0.5, size=18, face=&quot;italic&quot;), axis.text = element_text(size=18) ) new_style &lt;- function() { font &lt;- &quot;Helvetica&quot; theme( plot.title = element_text(family=font, size=28, face=&quot;bold&quot;), plot.subtitle = element_text(family=font, size=22, margin=margin(9,0,9,0)), plot.caption = element_blank(), legend.position = &quot;top&quot;, legend.text.align = 0, legend.background = element_blank(), # legend.title = element_blank(), legend.key = element_blank(), legend.text = element_text(family=font, size=18, color=&quot;#222222&quot;), axis.text = element_text(family=font, size=18, color=&quot;#222222&quot;), axis.text.x = element_text(margin=margin(5, b = 10)), axis.ticks = element_blank(), axis.line = element_blank(), panel.grid.minor = element_blank(), panel.grid.major.y = element_line(color=&quot;#cbcbcb&quot;), panel.grid.major.x = element_blank(), panel.background = element_blank(), strip.background = element_rect(fill=&quot;white&quot;), strip.text = element_text(size = 22, hjust = 0) ) } load(url(&quot;http://varianceexplained.org/files/trump_tweets_df.rda&quot;)) dim(trump_tweets_df) ## [1] 1512 16 names(trump_tweets_df) ## [1] &quot;text&quot; &quot;favorited&quot; &quot;favoriteCount&quot; &quot;replyToSN&quot; ## [5] &quot;created&quot; &quot;truncated&quot; &quot;replyToSID&quot; &quot;id&quot; ## [9] &quot;replyToUID&quot; &quot;statusSource&quot; &quot;screenName&quot; &quot;retweetCount&quot; ## [13] &quot;isRetweet&quot; &quot;retweeted&quot; &quot;longitude&quot; &quot;latitude&quot; trump_tweets_df %&gt;% select(id, text, created, favoriteCount, retweetCount, statusSource) %&gt;% head(20) ## # A tibble: 20 Ã— 6 ## id text created favoriteCount retweetCount statusSource ## &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 7626698825â€¦ &quot;My â€¦ 2016-08-08 15:20:44 9214 3107 &quot;&lt;a href=\\&quot;â€¦ ## 2 7626415954â€¦ &quot;Joiâ€¦ 2016-08-08 13:28:20 6981 2390 &quot;&lt;a href=\\&quot;â€¦ ## 3 7624396589â€¦ &quot;#ICâ€¦ 2016-08-08 00:05:54 15724 6691 &quot;&lt;a href=\\&quot;â€¦ ## 4 7624253718â€¦ &quot;Micâ€¦ 2016-08-07 23:09:08 19837 6402 &quot;&lt;a href=\\&quot;â€¦ ## 5 7624008698â€¦ &quot;Theâ€¦ 2016-08-07 21:31:46 34051 11717 &quot;&lt;a href=\\&quot;â€¦ ## 6 7622845333â€¦ &quot;I sâ€¦ 2016-08-07 13:49:29 29831 9892 &quot;&lt;a href=\\&quot;â€¦ ## 7 7621109187â€¦ &quot;Thaâ€¦ 2016-08-07 02:19:37 19223 5784 &quot;&lt;a href=\\&quot;â€¦ ## 8 7621069044â€¦ &quot;.@Lâ€¦ 2016-08-07 02:03:39 19543 7930 &quot;&lt;a href=\\&quot;â€¦ ## 9 7621044117â€¦ &quot;I aâ€¦ 2016-08-07 01:53:45 75488 24663 &quot;&lt;a href=\\&quot;â€¦ ## 10 7620164261â€¦ &quot;#Crâ€¦ 2016-08-06 20:04:08 23661 7903 &quot;&lt;a href=\\&quot;â€¦ ## 11 7619881643â€¦ &quot;Heaâ€¦ 2016-08-06 18:11:50 28069 8561 &quot;&lt;a href=\\&quot;â€¦ ## 12 7619369299â€¦ &quot;Anyâ€¦ 2016-08-06 14:48:14 35205 13129 &quot;&lt;a href=\\&quot;â€¦ ## 13 7619310105â€¦ &quot;Croâ€¦ 2016-08-06 14:24:43 36936 13250 &quot;&lt;a href=\\&quot;â€¦ ## 14 7618928294â€¦ &quot;Hilâ€¦ 2016-08-06 11:53:00 32716 9356 &quot;&lt;a href=\\&quot;â€¦ ## 15 7617735761â€¦ &quot;Gooâ€¦ 2016-08-06 03:59:08 34109 10385 &quot;&lt;a href=\\&quot;â€¦ ## 16 7617579885â€¦ &quot;&#39;Trâ€¦ 2016-08-06 02:57:11 19436 8066 &quot;&lt;a href=\\&quot;â€¦ ## 17 7617548986â€¦ &quot;Thaâ€¦ 2016-08-06 02:44:55 19330 5418 &quot;&lt;a href=\\&quot;â€¦ ## 18 7617118564â€¦ &quot;DONâ€¦ 2016-08-05 23:53:53 30869 16786 &quot;&lt;a href=\\&quot;â€¦ ## 19 7616938031â€¦ &quot;Thaâ€¦ 2016-08-05 22:42:08 19431 5681 &quot;&lt;a href=\\&quot;â€¦ ## 20 7616538754â€¦ &quot;#Maâ€¦ 2016-08-05 20:03:29 27568 13869 &quot;&lt;a href=\\&quot;â€¦ 6.1.2 èƒå–è³‡æ–™ Extracting publishing device of tweets # tidyr::extract() # stringr::str_replace trump_tweets_df$statusSource[1] ## [1] &quot;&lt;a href=\\&quot;http://twitter.com/download/android\\&quot; rel=\\&quot;nofollow\\&quot;&gt;Twitter for Android&lt;/a&gt;&quot; tweets &lt;- trump_tweets_df %&gt;% select(id, statusSource, text, created) %&gt;% # mutate(source = str_replace(statusSource, # &quot;.*Twitter for (.*?)&lt;.*&quot;, &quot;\\\\1&quot;)) %&gt;% # mutate(source = str_extract(statusSource, &#39;Twitter for (.*?)&lt;&#39;)) %&gt;% View extract(statusSource, &quot;source&quot;, &quot;Twitter for (.*?)&lt;&quot;) %&gt;% filter(source %in% c(&quot;iPhone&quot;, &quot;Android&quot;)) # Using stringr::str_replace() to mutate a new source variable, replacing tidyr:: # str(tweets) 6.1.3 è¦–è¦ºåŒ–æ¢ç´¢ 6.1.3.1 ç™¼æ–‡æ™‚é–“ Converting timezone lubridate::with_tz() Extracting hour of timestamp by lubridate::hour() Plotting number of tweets by hour Display y-axis as percentage by scales::percent_format() library(scales) # for percent_format() # lubridate::hour() # lubridate::with_tz() # scales::percent_format() toplot1 &lt;- tweets %&gt;% count(source, hour = hour(with_tz(created, &quot;EST&quot;))) %&gt;% # group_by(source) %&gt;% mutate(percent = n / sum(n)) # ungroup() %&gt;% toplot2 &lt;- tweets %&gt;% count(source, hour = hour(with_tz(created, &quot;EST&quot;))) %&gt;% group_by(source) %&gt;% mutate(percent = n / sum(n)) %&gt;% ungroup() p1 &lt;- toplot1 %&gt;% ggplot() + aes(hour, percent, color = source) + geom_line(size = 1) + scale_color_manual(name = &quot;Phone System&quot;, labels = c(&quot;Android&quot;, &quot;iPhone&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + scale_y_continuous(labels = percent_format()) + labs(x = &quot;Hour of day (EST)&quot;, y = &quot;% of tweets&quot;, color = &quot;&quot;) + theme_minimal() p2 &lt;- toplot2 %&gt;% ggplot() + aes(hour, percent, color = source) + geom_line(size = 1) + scale_color_manual(name = &quot;Phone System&quot;, labels = c(&quot;Android&quot;, &quot;iPhone&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + scale_y_continuous(labels = percent_format()) + labs(x = &quot;Hour of day (EST)&quot;, y = &quot;% of tweets&quot;, color = &quot;&quot;) + theme_minimal() cowplot::plot_grid( p1, NULL, p2, labels = c(&quot;(a) Normalized by all&quot;, &quot;&quot;, &quot;(b) Normalized in group&quot;), nrow = 1, rel_widths = c(1, 0.1, 1) ) 6.1.3.2 ç™¼æ–‡é™„åœ– Filtering out tweets starting with \" (those tweets mention #realdonaldtrump) Mutating new variable picture to indicate whether text has picture or not? Counting source by picture Plotting bar chart to compare difference between sources. # library(stringr) toplot &lt;- tweets %&gt;% filter(!str_detect(text, &#39;^&quot;&#39;)) %&gt;% mutate(picture = if_else(str_detect(text, &quot;t.co&quot;), &quot;Picture/link&quot;, &quot;No picture/link&quot;)) %&gt;% count(source, picture) p1 &lt;- toplot %&gt;% ggplot() + aes(source, n, fill = picture) + geom_col(position=&quot;stack&quot;, width = 0.5) + scale_fill_manual(name = &quot;With Picture/link?&quot;, labels = c(&quot;Yes&quot;, &quot;No&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + labs(x = &quot;&quot;, y = &quot;Number of tweets&quot;, fill = &quot;&quot;) + theme_minimal() p2 &lt;- toplot %&gt;% ggplot() + aes(source, n, fill = picture) + geom_col(position=&quot;dodge&quot;) + scale_fill_manual(name = &quot;With Picture/link?&quot;, labels = c(&quot;Yes&quot;, &quot;No&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + labs(x = &quot;&quot;, y = &quot;Number of tweets&quot;, fill = &quot;&quot;) + theme_minimal() cowplot::plot_grid( p1, NULL, p2, labels = c(&quot;(a) Stacked&quot;, &quot;&quot;, &quot;(b) Dodged&quot;), nrow = 1, rel_widths = c(1, 0.1, 1) ) 6.1.4 Keyness library(tidytext) # unnest_tokens() library(stringr) # str_detect(), str_replace_all() # View(test) # stop_words$word tweet_words &lt;- tweets %&gt;% filter(!str_detect(text, &#39;^&quot;&#39;)) %&gt;% mutate(text = str_replace_all(text, &quot;https://t.co/[A-Za-z\\\\d]+|&amp;amp;&quot;, &quot;&quot;)) %&gt;% # unnest_tokens(word, text) %&gt;% # unnest_tokens(word, text, token = &quot;regex&quot;, pattern = &quot;[^A-Za-z\\\\d#@&#39;]&quot;) %&gt;% mutate(word = str_split(text, &quot; &quot;)) %&gt;% select(id, text, word, everything()) %&gt;% unnest(word) %&gt;% filter(!word %in% stop_words$word, str_detect(word, &quot;[a-z]&quot;)) # View(tweet_words) tweet_words %&gt;% count(word, sort = TRUE) %&gt;% head(20) %&gt;% mutate(word = reorder(word, n)) %&gt;% ggplot(aes(word, n)) + geom_col(fill = &quot;royalblue&quot;) + ylab(&quot;Occurrences&quot;) + coord_flip() + theme_minimal() + theme(axis.text = element_text(size=10)) 6.1.4.1 è©é »å·®ç•° test &lt;- tweet_words %&gt;% count(word, source) %&gt;% filter(n &gt;= 5) %&gt;% pivot_wider(names_from = source, values_from = n, values_fill = 0) # View(test) word_by_source &lt;- tweet_words %&gt;% count(word, source) %&gt;% filter(n &gt;= 5) %&gt;% pivot_wider(names_from = source, values_from = n, values_fill = 0) %&gt;% # spread(source, n, fill = 0) %&gt;% ungroup() sum(word_by_source$iPhone) ## [1] 1383 sum(word_by_source$Android) ## [1] 2132 android_iphone_ratios &lt;- word_by_source %&gt;% mutate(iPhone = (iPhone+1)/sum(iPhone+1)) %&gt;% mutate(Android = (Android+1)/sum(Android+1)) %&gt;% # mutate_at(.cols = vars(iPhone, Android), # .funs = funs((. + 1) / sum(. + 1))) %&gt;% mutate(logratio = log2(Android / iPhone)) %&gt;% arrange(desc(logratio)) 6.1.4.2 è¦–è¦ºåŒ–log-ratio android_iphone_ratios %&gt;% group_by(logratio &gt; 0) %&gt;% top_n(15, abs(logratio)) %&gt;% ungroup() %&gt;% mutate(word = reorder(word, logratio)) %&gt;% ggplot(aes(word, logratio, fill = logratio &lt; 0)) + geom_col() + coord_flip() + ylab(&quot;Android / iPhone log ratio&quot;) + scale_fill_manual(name = &quot;&quot;, labels = c(&quot;Android&quot;, &quot;iPhone&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + theme_minimal() + theme(axis.text = element_text(size=14)) "],["crawler.html", "Chapter 7 Crawler", " Chapter 7 Crawler "],["scraping-104.html", "7.1 Scraping 104.com", " 7.1 Scraping 104.com 7.1.1 Complete Code library(tidyverse) library(httr) library(jsonlite) # options(stringsAsFactors = F) all.df &lt;- tibble() refer_url &lt;- &quot;https://www.104.com.tw&quot; for(p in 1:10){ url &lt;- str_c(&#39;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8&amp;order=12&amp;asc=0&amp;page=&#39;, p, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) print(p) res &lt;- GET(url, add_headers(&quot;referer&quot;=refer_url)) %&gt;% content(&quot;text&quot;) %&gt;% fromJSON() res$data$list$tags &lt;- NULL res$data$list$link &lt;- NULL all.df &lt;- bind_rows(all.df, res$data$list) } all.df$jobNo %&gt;% unique %&gt;% length 7.1.2 Step-by-Step 7.1.2.1 Get the first pages Must loading the second page url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Assigning the 2nd page data url to url2 url2 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8&amp;order=14&amp;asc=0&amp;page=2&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Assigning the 3rd page data url to url3 url3 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=3&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Getting back the url1 data, assigning to result1 res &lt;- GET(url2, config = add_headers(&quot;Referer&quot; = &quot;https://www.104.com.tw/&quot;)) res1 &lt;- content(res, &quot;text&quot;) %&gt;% fromJSON() result2 &lt;- fromJSON(content(GET(url2), &quot;text&quot;)) # Tracing variable result2 and finding the data.frame, assigning to df2 df2 &lt;- res1$data$list 7.1.2.2 Get the first page by modifying url # Guessing the 1st page data url to url1 url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Getting back the 1st page data url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; result1 &lt;- fromJSON(content(GET(url1), &quot;text&quot;)) df1 &lt;- result1$data$list 7.1.2.3 Combine two data with the same variables # all.df &lt;- bind_rows(df1, df2) # will raise error # Error in bind_rows_(x, .id) : # Argument 31 can&#39;t be a list containing data frames 7.1.2.4 Drop out hierarchical variables Preserving numeric or character, dropping list of data.frame by assigning NULL to the variable # Drop list and data.frame inside the data.frame df1$link &lt;- NULL df1$tags &lt;- NULL df2$link &lt;- NULL df2$tags &lt;- NULL # Re-binding two data.frame df1 and df2 all.df &lt;- bind_rows(df1, df2) 7.1.2.5 Dropping hierarchical variables by dplyr way # Getting the 1st page data and dropping variable tags and link # Assigning to df1 df1 &lt;- result1$data$list %&gt;% select(-tags, -link) # Getting the 2nd page data and dropping variable tags and link # Assigning to df2 df2 &lt;- result2$data$list %&gt;% select(-tags, -link) # binding df1 and df2 all.df &lt;- bind_rows(df1, df2) 7.1.2.6 Finding out the last page number # Tracing the number of pages in result1 last_page_num &lt;- result1$data$totalPage # Checking the availability of the last page # Examining if the last page data available by re-composing URL with paste0() url.last_page &lt;- paste0(&quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=&quot;, last_page_num, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) # Getting back and parsing the last page data result.last_page &lt;- fromJSON(content(GET(url.last_page), &quot;text&quot;)) 7.1.2.7 Using for-loop to get all pages for(p in 1:last_page_num){ url &lt;- paste0(&quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=&quot;, p, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) result &lt;- fromJSON(content(GET(url), &quot;text&quot;)) temp.df &lt;- select(result$data$list) print(paste(p, nrow(temp.df))) } 7.1.2.8 combine all data.frame # The 1st url of the query url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Getting back the 1st page data result1 &lt;- fromJSON(content(GET(url1), &quot;text&quot;)) # Tracing and getting total number of page last_page_num &lt;- result1$data$totalPage # Truncating hierarchical variables: link and tags all.df &lt;- select(result1$data$list, -link, -tags) # for-loop to getting back data and joining them for(p in 1:last_page_num){ url &lt;- paste0(&quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=&quot;, p, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) result &lt;- fromJSON(content(GET(url), &quot;text&quot;)) temp.df &lt;- select(result$data$list) all.df &lt;- bind_rows(all.df, temp.df) print(paste(p, nrow(all.df))) } "],["visualization.html", "Chapter 8 Visualization", " Chapter 8 Visualization "],["ggplot.html", "8.1 ggplotç°¡ä»‹", " 8.1 ggplotç°¡ä»‹ æœ¬ç¯€è‘—é‡åœ¨ä»‹ç´¹ggplotçš„åŸºæœ¬æ¦‚å¿µèˆ‡è¨­å®šã€‚ä¸åŒé¡å‹çš„åœ–è¡¨å‰‡åœ¨ä¸‹ä¸€ç¯€ã€Œggplotåœ–è¡¨é¡å‹(II)ã€ å¯åœ¨ä¸€é–‹å§‹ä¾¿é€éknitr::opts_chunk$set(echo = TRUE, fig.width = 2, fig.asp = 0.4)ä¾†ä¸€æ¬¡è¨­å®šæ‰€æœ‰åœ–ç‰‡ã€‚fig.width = 8èˆ‡fig.height = 6 æ˜¯ä»¥è‹±å‹ï¼ˆinchesï¼‰ç‚ºå–®ä½ï¼Œæˆ–ç”¨fig.dim = c(8, 6)ä¸€æ¬¡è¨­å®šé•·å¯¬1ã€‚echo = TRUEæ˜¯è¨­å®šknitå‡ºè¼¸å‡ºæ ¼å¼ï¼ˆå¦‚htmlï¼‰æ™‚ï¼Œä¹Ÿè¦åŒ…å«ç¨‹å¼ç¢¼ã€‚å¦‚æœecho = FALSEçš„è©±ï¼Œå°±åªæœƒè¼¸å‡ºæ–‡å­—å’Œåœ–å½¢ã€‚ åƒè€ƒè³‡æ–™ï¼š5.4 Control the size of plots/images | R Markdown Cookbook (bookdown.org)â†©ï¸ "],["ç¹ªåœ–åŸºç¤æŠ˜ç·šåœ–.html", "8.2 ç¹ªåœ–åŸºç¤ï¼šæŠ˜ç·šåœ–", " 8.2 ç¹ªåœ–åŸºç¤ï¼šæŠ˜ç·šåœ– 8.2.1 ç¹ªåœ–ä¸‰è¦ç´  ç”¨ggplotä¾†ç¹ªè£½åœ–å½¢æœ‰ä¸‰å€‹åŸºæœ¬å‡½å¼ggplot() + aes() + geom_åœ–è¡¨é¡å‹ã€‚ æŒ‡å®šè¦é€²è¡Œç¹ªåœ–ggplot()ï¼šç”¨%&gt;%å°‡è³‡æ–™ï¼ˆdataframeï¼‰pipeçµ¦ggplot()å¾Œï¼Œåº•ä¸‹å„å¢æ·»çš„ç¹ªåœ–é¸é …éƒ½ç”¨+çš„ç¬¦è™Ÿï¼Œé¡ä¼¼ä¸æ–·ä¿®æ­£ç¹ªåœ–çµæœçš„æ„æ€ã€‚ æŒ‡å®šXï¼Yè»¸èˆ‡ç¾¤çµ„å› å­aes()ï¼šæŒ‡å®šåœ–è¡¨çš„X/Yè»¸åˆ†åˆ¥æ˜¯ä»€éº¼è®Šæ•¸ï¼Œæœ‰äº›åœ–è¡¨åªéœ€è¦å–®ä¸€å€‹è®Šæ•¸ï¼ˆä¾‹å¦‚Density-chartå’ŒHistogramï¼‰ï¼Œæœ‰äº›éœ€è¦X/Yå…©å€‹è®Šæ•¸ï¼ˆä¾‹å¦‚Scatter-chartï¼‰ä»€éº¼çš„è®Šæ•¸è¦åšè¦–è¦ºåŒ–ï¼ŒBoxplotç”šè‡³å¯ä»¥ç›´æ¥æŒ‡å®šæœ€å¤§ã€æœ€å°ã€Q1ã€Q3å’ŒMedianç­‰å¤šå€‹è®Šæ•¸ã€‚ æŒ‡å®šè¦ç¹ªè£½çš„åœ–è¡¨é¡å‹ã€‚ä¾‹å¦‚Line-chartç‚ºgeom_line()ã€Scatter-chartç‚ºgeom_point()ã€Bar-chartç‚ºgeom_col()æˆ–geom_bar()ã€‚æŸ¥é–±ggplot cheat sheetå¯ä»¥å¿«é€Ÿç¿»é–±æœ‰å“ªäº›åœ–è¡¨é¡å‹ã€‚ ggplot-cheat-sheet ggplot() æœƒç§€å‡ºé å‚™è¦ç¹ªè£½çš„ç¹ªåœ–å€ tibble(a=1:5, b=5:1) %&gt;% ggplot() æŒ‡å®šXï¼Yè»¸èˆ‡ç¾¤çµ„å› å­aes()ï¼šaes()æœƒåœ¨ç¹ªåœ–å€ä¸Šç¹ªè£½Xèˆ‡Yè»¸ tibble(a=1:5, b=5:1) %&gt;% ggplot() + aes(x=a, y=b) æŒ‡å®šè¦ç¹ªè£½çš„åœ–è¡¨é¡å‹ã€‚ä¾‹å¦‚Line-chartç‚ºgeom_line()ã€ tibble(a=1:5, b=5:1) %&gt;% ggplot() + aes(x=a, y=b) + geom_line() æ­¤åœ–ç‚ºä¸€é›™è®Šæ•¸çš„åœ–ï¼ŒåŸºæ–¼é›™è®Šæ•¸ï¼Œå¯ä»¥å°‡ä¸åŒçš„åœ–åŒæ™‚ç¹ªè£½åœ¨åŒä¸€å€‹ç¹ªåœ–å€ä¸Šã€‚ä¾‹å¦‚ä»¥ä¸‹åŒæ™‚ç¹ªè£½äº†geom_line()èˆ‡geom_plot()ã€‚ tibble(a=1:5, b=5:1) %&gt;% ggplot() + aes(x=a, y=b) + geom_line() + geom_point() 8.2.2 ç¯„ä¾‹-ç´æ™‚ä¸–ä»£è²§å¯Œä¸å‡ Teach About Inequality With These 28 New York Times Graphs - The New York Times (nytimes.com) ggplotæ˜¯ä»¥è®Šæ•¸ç‚ºåŸºç¤çš„è¦–è¦ºåŒ–å¥—ä»¶ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œç•¶æº–å‚™å¥½dataframeå¾Œï¼Œå°±å¯ä»¥åœ¨ggplotä¸­æŒ‡å®šè¦ç”¨å“ªäº›è®Šæ•¸ä¾†ç¹ªåœ–ã€‚ä¹Ÿå› æ­¤ï¼Œå‹™å¿…æŠŠdataframeæ•´ç†ç‚ºtidyå‹æ…‹ï¼Œä¹Ÿå°±æ˜¯é•·è¡¨æ ¼ï¼ˆlong-formï¼‰çš„å‹æ…‹ã€‚æ•´ç†å®Œè³‡æ–™å¾Œï¼Œæˆ‘æœƒç¿’æ…£åœ°ç”¨names(plot)æˆ–glimpse(plot)ä¾†çœ‹ä¸€ä¸‹è©²è³‡æ–™æ‰€æœ‰çš„è®Šé …ï¼Œå¥½å¯ä»¥åœ¨ä¸‹ä¸€éšæ®µçš„ç¹ªåœ–åšåƒè€ƒã€‚ NW &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(Category, year, Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% ungroup() NW %&gt;% glimpse() é€™æ˜¯é æœŸè¦–è¦ºåŒ–çš„çµæœ å…ˆå°‡yearå’ŒNet_worthåˆ†åˆ¥ç¹ªè£½åœ¨Xèˆ‡Yè»¸ä¸Šï¼Œä¸¦ç”¨geom_line()ç¹ªè£½ç‚ºæŠ˜ç¾åœ–ã€‚çµæœåœ–è¡¨ä¸­å‘ˆç¾é‹¸é½’ç‹€çš„æŠ˜ç·šï¼Œçœ‹ä¼¼æœ‰å•é¡Œï¼Œä½†å…¶å¯¦æ˜¯åˆç†çš„ã€‚å› ç‚ºyearæ˜¯ä¸€å€‹é›¢æ•£è®Šæ•¸ï¼Œè€Œæˆ‘å€‘å¸Œæœ›æ¯å€‹å¹´é½¡å±¤ä¸€æ¢ç·šçš„è©±ï¼Œé‚£å°±è¦ç…§å¹´é½¡å±¤ä¾†åˆ†çµ„ã€‚ä¹Ÿå› æ­¤ï¼Œæ¯ä¸€å¹´éƒ½æœ‰æœ‰æ¯å€‹å¹´é½¡å±¤çš„è³‡æ–™ï¼Œç•¶æˆ‘å€‘æŠŠã€Œå¹´ã€ä½œç‚ºXè»¸æ™‚ï¼Œè‡ªç„¶åŒä¸€å¹´å°±æœƒæœ‰æ•¸ç­†ä¸åŒå¹´é½¡å±¤çš„è³‡æ–™ï¼Œå› æ­¤æ‰æœƒæ˜¯é‹¸é½’ç‹€çš„ã€‚ NW %&gt;% ggplot() + aes(x=year, y=Net_Worth) + geom_line() ä¸åŒçš„åœ–è¡¨é¡å‹æ˜¯å¯ä»¥ç–ŠåŠ åœ¨åŒä¸€å¼µåœ–ä¸Šçš„ã€‚æˆ‘å€‘ä¹Ÿå¯ä»¥æŠŠgeom_point() å¦ä¸€ç¨®åœ–è¡¨å‹æ…‹åŠ å…¥ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå…©è€…çš„Xèˆ‡Yä¸ç›¸è¡çªã€‚geom_line()ã€geom_point()ã€geom_text()ä¸‰è€…æœƒç¶“å¸¸ä¼´éš¨å‡ºç¾ã€‚ NW %&gt;% ggplot() + aes(x=year, y=Net_Worth) + geom_line() + geom_point() 8.2.3 åŠ å…¥è‡ªè®Šé …ç¾¤çµ„ ä¸Šåœ–æ˜¯æˆ‘å€‘æŠŠå¤šå€‹å¹´é½¡å±¤çš„é€å¹´è³‡æ–™ç•«åœ¨åŒä¸€æ¢æŠ˜ç·šä¸Šï¼Œæ‰€ä»¥æœƒå‘ˆç¾é‹¸é½’ç‹€æŠ˜ç¾çš„ç‹€æ³ã€‚ä½†é€™äº›å¹´é½¡å±¤ä¸¦éåœ¨åŒä¸€æ¢ç·šä¸Šå‘€ï¼Ÿå› æ­¤ï¼Œæˆ‘å€‘è¦æ ¹æ“šCategoryé€™å€‹è®Šæ•¸ä¾†åšåˆ†çµ„ã€‚ NW %&gt;% ggplot() + aes(x=year, y=Net_Worth, group=Category) + geom_line() + geom_point(stat=&quot;identity&quot;) å¦‚å¸Œæœ›ä¸åŒç·šæ¢ä¸Šä¸ä¸€æ¨£çš„è‰²å½©ï¼Œæ‡‰æŒ‡å®šcolor=Categoryã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() ç”¨colorã€fillæˆ–groupä¾†åšåˆ†çµ„ï¼Ÿ geom_line()çš„è‰²å½©æ˜¯åœ¨ç·šï¼Œè€Œä¸æ˜¯åœ¨é¢ä¸Šã€‚å¦‚æœè‰²å½©æ˜¯åœ¨é»ï¼ˆå¦‚geom_point()ï¼‰æˆ–ç·šï¼ˆgeom_line()ï¼‰ä¸Šï¼Œå°±æ˜¯ç”¨colorä¾†æŒ‡å®šé¡è‰²ã€‚ä½†å¦‚æœæ˜¯å¦‚é¡ä¼¼ä¸‹é¢çš„ä¾‹å­ï¼Œç”¨geom_area()ä¾†è¦–è¦ºåŒ–çš„è©±ï¼Œå› ç‚ºé¡è‰²å¡«çš„æ˜¯é¢ï¼Œæ‰€ä»¥è¦ç”¨fill=Categoryã€‚ä»¥ä¸‹ç¯„ä¾‹ç”šè‡³åŒæ™‚æŒ‡å®šcolor=Category, fill=Categoryã€‚ä½†æŠ˜ç·šåœ–å¦‚æœè¦ç”¨geom_area()ä¾†è¦–è¦ºåŒ–çš„è©±ï¼Œæœ€å¥½è¦ä¸Šé¡è‰²çš„ä¸è¦è¶…éäºŒå€‹ï¼Œä¸ç„¶å°±æœƒåƒåº•ä¸‹é€™å€‹ä¾‹å­ä¸€æ¨£ï¼Œå³ä½¿è¨­å®šalpha=0.2çš„åŠé€æ˜ï¼Œä»ç„¶æœƒçœ‹ä¸æ‡‚å“ªäº›é¡è‰²ç–Šåœ¨ä¸€èµ·ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category, fill=Category) + geom_area(position=&quot;dodge&quot;, alpha=0.2) "],["åœ–è¡¨èª¿æ•´.html", "8.3 åœ–è¡¨èª¿æ•´", " 8.3 åœ–è¡¨èª¿æ•´ 8.3.1 é»ç·šå‹æ…‹ ä¸‹é¢çš„ä¾‹å­åŒæ™‚ç”¨äº†geom_line()å’Œgeom_point()ï¼Œä¸”åˆ†åˆ¥è¨­å®šäº†ç·šå¯¬ï¼ˆsize=1ï¼‰ã€é»çš„å¤§å°(size=2)ï¼ŒæŠ˜ç·šå‹æ…‹ï¼ˆlinetype=\"dashed\"ï¼‰ã€åŠé€æ˜ç¨‹åº¦ï¼ˆalphaï¼‰ã€‚ ggplot2 line types : How to change line types of a graph in R software? - Easy Guides - Wiki - STHDA NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line(size=1, linetype = &quot;dashed&quot;, alpha=0.5) + geom_point(size=2, color=&quot;dimgrey&quot;, alpha=0.5) 8.3.2 æ¨™é¡Œã€æ¨™ç±¤èˆ‡åœ–èªª Titles, labels, and legend è¨­å®šæ¨™é¡Œèˆ‡Xï¼Yè»¸æ¨™é¡Œï¼ˆæ³•ä¸€ï¼‰ï¼šä»¥ä¸‹è¨­å®šäº†åœ–è¡¨çš„åœ–è¡¨æ¨™é¡Œã€å’ŒXè»¸èˆ‡Yè»¸çš„è»¸æ¨™é¡Œï¼ˆxlabèˆ‡ylabï¼‰ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + xlab(&quot;Year&quot;) + ylab(&quot;Net Worth&quot;) + ggtitle(&quot;Net Worth by year grouped by age groups&quot;) è¨­å®šæ¨™é¡Œèˆ‡Xï¼Yè»¸æ¨™é¡Œï¼ˆæ³•äºŒï¼‰ï¼šé€™æ˜¯ä¸€æ¬¡è¨­å®šåœ–è¡¨æ¨™é¡Œï¼ˆtitleï¼‰ã€æ¬¡æ¨™é¡Œï¼ˆsuttitleï¼‰ã€Xè»¸èˆ‡Yè»¸æ¨™é¡Œçš„æ–¹æ³•ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, subtitle = &quot;Source from: ...&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) èª¿æ•´Xè»¸èˆ‡Yè»¸æ¨™é¡Œä½ç½®çš„ï¼šå¿…é ˆè¦é€étheme()ä¾†è¨­å®šaxis.title.x = element_text(hjust=1)ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + theme(axis.title.x = element_text(hjust=1), axis.title.y = element_text(hjust=1)) å»é™¤Xï¼Yè»¸æ¨™é¡Œï¼ˆä¸ä½³ï¼‰ï¼šç›´æ¥å°‡ç©ºå­—ä¸²Assignçµ¦titleã€xã€èˆ‡yå³å¯ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;&quot;, x = &quot;&quot;, y = &quot;&quot;) å»é™¤Xï¼Yè»¸æ¨™é¡Œï¼ˆè¼ƒä½³ï¼‰ï¼šé€éè¨­å®štheme()ä¾†èª¿æ•´ã€‚å¯ç™¼ç¾é€éé€™ç¨®è¨­å®šæ–¹æ³•ï¼ŒåŸæœ¬æ¨™é¡Œå’ŒXï¼Yè»¸æ¨™é¡Œçš„é‚Šç•Œç©ºé–“å°±æœƒè¢«é‡‹æ”¾å‡ºä¾†ã€‚ # No extra space for xlab, ylab and title NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line(show.legend = F) + theme_minimal() + theme(plot.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank()) 8.3.3 å­—é«”æ¨£å¼ èª¿æ•´å­—å‹æœƒå»ºè­°éƒ½å¾theme()ä¾†åšèª¿æ•´ï¼Œæ‰€æœ‰åœ–é¢ä¸Šçœ‹å¾—åˆ°çš„å­—éƒ½æœ‰ç›¸å°æ‡‰çš„è®Šæ•¸å¯ä»¥èª¿æ•´å­—å‹ã€‚ä¾‹å¦‚ä»¥ä¸‹çš„ä¾‹å­ä¸­ï¼ŒæŠŠæ¨™é¡Œçš„å­—å‹å¤§å°èª¿æ•´ç‚º14ç²—é«”ã€Xèˆ‡Yè»¸çš„å­—å‹å‰‡èª¿æ•´äº†å‘å³å°é½Šã€10ç²—æ–œé«”ã€é¡è‰²ç‚ºdimgreyã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + theme(plot.title = element_text(size=14, face=&quot;bold&quot;), axis.title.x = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;), axis.title.y = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;) ) 8.3.4 åœ–è¡¨ä¸»é¡Œè‰²èª¿ ggplotä¹Ÿæœ‰å…¶åœ–è¡¨ä¸»é¡Œè‰²èª¿ã€‚ä¹‹å‰ç¯„ä¾‹çš„ç°è‰²åœ–è¡¨èƒŒæ™¯å°±æ˜¯é è¨­çš„ä¸»é¡Œï¼Œggplotä¸­é‚„æœ‰å¥½å¹¾å€‹é è¨­åœ–è¡¨ä¸»é¡Œå¯ä»¥é¸ï¼Œä¾‹å¦‚theme_minimal()æˆ–theme_tw()ç­‰ç­‰ã€‚ Modify components of a theme â€” theme â€¢ ggplot2 (tidyverse.org) bbplot/bbc_style.R at master Â· bbc/bbplot (github.com) NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() 8.3.5 é è¨­ä¸»é¡Œ å¦‚æœå¸Œæœ›æ‰€æœ‰çš„åœ–è¡¨éƒ½æœ‰ä¸€è‡´çš„é¡è‰²å’Œæ’ç‰ˆçš„èª¿æ€§ï¼Œå¯ä»¥åœ¨ä¸€é–‹å§‹ç·¨è¼¯Rmdçš„æ™‚å€™å°±è¨­è¨ˆå¥½ä¸€å¥—theme()ä¸¦æŒ‡çµ¦ä¸€å€‹è®Šæ•¸ï¼ˆä¾‹å¦‚ä»¥ä¸‹çš„thï¼‰ã€‚ th &lt;- theme(plot.title = element_text(size=14, face=&quot;bold&quot;), axis.title.x = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;), axis.title.y = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;) ) NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line(linetype = &quot;dashed&quot;, alpha=0.5) + geom_point(size=2, color=&quot;dimgrey&quot;, alpha=0.5) + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + th 8.3.6 é¡¯ç¤ºä¸­æ–‡å­—é«” Pythonå’ŒRé€™äº›ç¨‹å¼èªè¨€çš„é è¨­è¦–è¦ºåŒ–å¥—ä»¶éƒ½æ²’è¾¦æ³•é¡¯ç¤ºä¸­æ–‡ï¼Œæ‰€ä»¥å¦‚æœè¦é¡¯ç¤ºä¸­æ–‡çš„è©±ï¼Œå°±è¦æŒ‡å®šåœ–è¡¨æ¨™é¡Œã€Xã€Yè»¸æ¨™ç±¤ã€åœ–èªªå’Œå„å€‹éƒ¨ä»¶çš„å­—å‹ã€‚å› ç‚ºæˆ‘åœ¨Macä¸Šç¹ªåœ–ï¼Œæ‰€ä»¥æˆ‘å°‡å­—å‹æŒ‡å®šç‚ºHeiti TC Lightã€‚å¦‚æœæƒ³çŸ¥é“è‡ªå·±çš„é›»è…¦ä¸Šæœ‰ä»€éº¼å¯ä»¥ç”¨ï¼Œå¯ä»¥åˆ°é›»è…¦çš„å­—é«”ç°¿ä¸ŠæŸ¥æ‰¾ä¸­æ–‡å­—é«”åç¨±ï¼Œæˆ–è€…ä¸Šç¶²googleã€Œggplot ä¸­æ–‡å­—å‹é¸æ“‡ã€ã€‚ county &lt;- read_csv(&quot;data/tw_population_opendata110N010.csv&quot;) %&gt;% slice(-1, -(370:375)) %&gt;% type_convert() %&gt;% mutate(county = str_sub(site_id, 1, 3)) %&gt;% group_by(county) %&gt;% summarize( area = sum(area), people_total = sum(people_total) ) %&gt;% ungroup() ä¸‹é¢é€™æ˜¯ä¸€å€‹é•·æ¢åœ–çš„ç¯„ä¾‹ï¼ˆbarplotï¼Œä¸æ˜¯histogramï¼‰ã€‚Barplotå¯ä»¥ç›´æ¥æŒ‡å®šXè»¸ç‚ºç¸£å¸‚ï¼ˆcountyï¼‰å’ŒYè»¸ç‚ºç¸½äººå£æ•¸ï¼ˆpeople_totalï¼‰ï¼Œä½†æ˜¯è¦ç”¨geom_col()è€Œégeom_bar()ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒBarçš„é¡è‰²æœ‰ã€Œé¢ã€çš„ç‰¹å¾µï¼Œæ‰€ä»¥è‹¥è¦è‡ªè¨‚æ•´æ¢barçš„é¡è‰²ï¼Œè¦ç”¨fillè€Œécolorï¼Œcoloråªæœƒæ˜¯æ¯æ¢Barçš„å¤–æ¡†ã€‚ county %&gt;% arrange(desc(people_total)) %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;lightgrey&quot;, color=&quot;black&quot;) + theme_minimal() èˆ‰ä¾‹ä¾†èªªï¼Œä¸­æ–‡å­—å‹å¯ä»¥æ˜¯æ¨™æ¥·é«”ï¼ˆBiauKaiï¼‰ã€å®‹é«”ï¼ˆSongti TCï¼‰ã€é»‘é«”ï¼ˆHeiti TC Lightï¼‰ã€è˜‹æ–¹ï¼ˆPingFang TCï¼‰ã€Notoï¼ˆNoto Sans CJK TCï¼‰ th &lt;- theme(title = element_text(family=&quot;Heiti TC Light&quot;), text = element_text(family=&quot;Heiti TC Light&quot;), axis.text.y = element_text(family=&quot;PingFang TC&quot;), axis.text.x = element_text(family=&quot;Heiti TC Light&quot;), legend.text = element_text(family=&quot;Heiti TC Light&quot;), plot.title = element_text(family=&quot;Heiti TC Light&quot;) ) county %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;skyblue&quot;) + theme_minimal() + th + theme(axis.text.x = element_text(angle = 45)) 8.3.7 X/Yè»¸æ–¹å‘ èª¿æ•´åœ–è¡¨æ–¹å‘ county %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;skyblue&quot;) + coord_flip() + theme_minimal() + th + theme(axis.text.x = element_text(angle = 45)) é€šå¸¸coord_flip()å¾Œå¾€å¾€æœƒå¸Œæœ›é€™äº›baræœƒæ˜¯ç”±ä¸Šè€Œä¸‹æ’åºå¥½çš„ï¼Œä½†ç”¨arrange(desc(people_total)æ˜¯ç„¡æ³•è§£æ±ºå•é¡Œçš„ï¼Œå› ç‚ºYè»¸åŸæœ¬æœƒæ˜¯ç…§Yè»¸çš„åˆ»åº¦æ’åˆ—ï¼Œè€Œä¸æ˜¯Yè»¸çš„æ•¸å€¼ã€‚æ‰€ä»¥ï¼Œè¦è¢«æ’åºçš„æ‡‰è©²æ˜¯Yè»¸çš„ã€Œæ–‡å­—ã€ä¹Ÿå°±æ˜¯é‚£äº›ç¸£å¸‚ã€‚å› æ­¤ï¼Œæˆ‘å€‘éœ€è¦å°‡è©²ç¸£å¸‚è½‰ç‚ºfactorï¼ˆ1~nï¼‰ï¼Œä¸¦ä¸”è®“é€™äº›ç¸£å¸‚è¢«å®‰æ’çš„factoræ•¸å€¼ç…§people_totalæ’åˆ—ï¼Œå› æ­¤è¦ç”¨mutate(county = reorder(county, people_total))ã€‚reorder()æ˜¯ä¸€å€‹å°‡æ–‡å­—è½‰factorçš„å‡½å¼ï¼Œä½†åœ¨æ­¤ç‰¹åˆ¥æŒ‡å®šç…§people_totalçš„ç·¨æ’ã€‚ county %&gt;% # arrange(desc(people_total) %&gt;% mutate(county = reorder(county, people_total)) %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;skyblue&quot;) + coord_flip() + theme_minimal() + th "],["è¦–è¦ºåŒ–èªªæ•…äº‹çš„æŠ€å·§.html", "8.4 è¦–è¦ºåŒ–èªªæ•…äº‹çš„æŠ€å·§", " 8.4 è¦–è¦ºåŒ–èªªæ•…äº‹çš„æŠ€å·§ ã€Œèªªæ•…äº‹ã€æ‰æ˜¯æ•´å‰‡è³‡æ–™æ–°èçš„æ ¸å¿ƒï¼Œåœ¨é‹ç”¨åœ–è¡¨ä¾†è¼”åŠ©æ•˜äº‹æ™‚ï¼Œæ‡‰æ­é…èªªç†èªªæœçš„å…§å®¹ä¾†çªé¡¯ï¼ˆhighlightï¼‰åœ–é¢ä¸Šçš„ç‰¹å¾µï¼Œè€Œä¸æ˜¯ç•™å¾…è®€è€…è‡ªå·±è§€å¯Ÿã€‚ä»¥ä¸‹æœ‰ä¸‰ç¨®highlightåœ–è¡¨éƒ¨åˆ†è³‡æ–™çš„æ–¹æ³•ã€‚ç¬¬ä¸€å€‹æ–¹æ³•æ˜¯åœ¨ç¹ªåœ–æ™‚ç”¨+ scale_color_manual()æˆ–+ scale_fill_manual()æŒ‡å®šé¡è‰²çµ¦ä¸åŒç¾¤çµ„ï¼›æ–¹æ³•äºŒæ˜¯åˆ©ç”¨gghighlighté€™å€‹å¥—ä»¶ä¾†æŒ‡å®šè¦ä¸Šè‰²çš„ç¾¤çµ„ï¼Œè€Œä¸”gghighlightå¯ä»¥å’Œfillèˆ‡colorç›¸äº’æ­é…ï¼Œä»ç„¶å¯ä»¥ç”¨scale_fill_manualå’Œscale_color_manualä¾†æŒ‡å®šé¡è‰²ã€‚ä½†æœƒæœ‰å€‹ç‹€æ³æ˜¯ï¼Œå¦‚æœåŸæœ¬æ²’ç¾¤çµ„é‚£æ€éº¼è¾¦ï¼Ÿå°±è‡ªå·±ç”¨mutate()æ‰“é€ ç¾¤çµ„å°±å¥½ã€‚æ–¹æ³•å„æœ‰åˆ©å¼Šèˆ‡ä½¿ç”¨æ™‚æ©Ÿã€‚ 8.4.1 ä¾ç¾¤çµ„æŒ‡å®šé¡è‰² scale_color_manual() èˆ‡scale_fill_manual() NW %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line() + scale_color_manual( limits=c(&quot;65-74&quot;, &quot;35-44&quot;), # original chart group values=c(&quot;gold&quot;, &quot;skyblue&quot;), # map to color name=&quot;Age group&quot;, # legend title breaks=c(&quot;65-74&quot;, &quot;35-44&quot;), # original legend group labels labels=c(&quot;elder(65-74)&quot;,&quot;younger(35-44)&quot;), # map to new labels na.value = &quot;lightgrey&quot; # color for other groups ) + theme_minimal() 8.4.2 ä½¿ç”¨gghighlightå¥—ä»¶ library(gghighlight) NW %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;whitesmoke&quot;, colour = &quot;whitesmoke&quot;, size = 0.5, linetype = &quot;solid&quot;)) ä½¿ç”¨gghighlightä»èƒ½è‡ªå·±ä½¿ç”¨scale_color_manual()ä¾†æŒ‡å®šé¡è‰² NW %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + scale_color_manual( limits=c(&quot;65-74&quot;, &quot;35-44&quot;), # original chart group values=c(&quot;gold&quot;, &quot;skyblue&quot;)) + # map to color theme_minimal() 8.4.3 ç‚ºè¦–è¦ºåŒ–å»ºç«‹ç¾¤çµ„ é€™å€‹æ–¹æ³•æ˜¯åœ¨åŸæœ¬çš„è³‡æ–™ä¸¦æ²’æœ‰å¯ä»¥ä½œç‚ºcoloræˆ–fillçš„å› å­ï¼Œæ‰€ä»¥è‡ªè¡Œå‰µå»ºä¸€å€‹è¦çªé¡¯çš„ç¾¤çµ„ã€‚ county %&gt;% mutate(group = if_else(county %in% c(&quot;æ–°ç«¹ç¸£&quot;, &quot;æ–°ç«¹å¸‚&quot;), &quot;highlight&quot;, &quot;other&quot;)) %&gt;% mutate(county = reorder(county, people_total)) %&gt;% ggplot() + aes(county, people_total, fill=group) %&gt;% geom_col() + scale_fill_manual(values=c(&quot;highlight&quot;=&quot;Khaki&quot;, &quot;other&quot;=&quot;lightgrey&quot;)) + guides(fill=&quot;none&quot;) + coord_flip() + theme_minimal() + th ä½†äº‹å¯¦ä¸Šä¹Ÿå¯ä»¥ç”¨gghighlightç›´æ¥é”æˆ county %&gt;% mutate(county = reorder(county, people_total)) %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;deeppink&quot;) + gghighlight(county %in% c(&quot;æ–°ç«¹ç¸£&quot;, &quot;æ–°ç«¹å¸‚&quot;)) + guides(fill=&quot;none&quot;) + coord_flip() + theme_minimal() + th "],["colors.html", "8.5 COLORS", " 8.5 COLORS "],["chart-types.html", "Chapter 9 CHART TYPES", " Chapter 9 CHART TYPES "],["COORDINATE.html", "Chapter 10 COORDINATE", " Chapter 10 COORDINATE Chap3 Coordination &amp; Axis Fundamentals of Data Visualization (clauswilke.com) Chapter 8 Visualizing distributions: Empirical cumulative distribution functions and q-q plots "],["æ’åºä»¥å±•ç¤ºåˆ†ä½ˆ.html", "10.1 æ’åºä»¥å±•ç¤ºåˆ†ä½ˆ", " 10.1 æ’åºä»¥å±•ç¤ºåˆ†ä½ˆ å­¸è¡“è«–æ–‡è‹¥è¦å‘ˆç¾ä¸€ç¾¤æ•¸æ“šçš„åˆ†ä½ˆæ™‚ï¼Œæœ€å¸¸ç”¨çš„æ˜¯å¯†åº¦ï¼ˆåˆ†ä½ˆï¼‰å‡½æ•¸ã€ç´¯ç©åˆ†ä½ˆå‡½æ•¸ï¼Œæœ€å¸¸è¦–è¦ºåŒ–çš„æ–¹æ³•æ˜¯å¯†åº¦åˆ†ä½ˆåœ–ï¼ˆgeom_density()ï¼‰æˆ–ç›´æ–¹åœ–ï¼ˆgeom_histogram())ã€‚ç„¶è€Œï¼Œå°æ–°èç­‰å¼·èª¿ã€Œèªªæ•…äº‹ã€çš„æ–‡é«”è€Œè¨€ï¼Œèªªæ•…äº‹çš„æŠ€å·§å¾€å¾€ä¸æ˜¯ã€Œé‚£ä¸€ç¾¤è³‡æºå¤šæˆ–è³‡æºå°‘çš„å°è±¡ã€ï¼Œè€Œç¶“å¸¸è¦ç›´æŒ‡ã€Œé‚£å€‹å°è±¡ã€ï¼Œè¦èƒ½å¤ çœ‹å¾—è¦‹æ‰€æ•˜è¿°çš„å°è±¡åœ¨åœ–ä¸­çš„ä½ç½®ã€‚æ­¤æ™‚ï¼Œç”¨å¯†åº¦åˆ†ä½ˆä¾†å‘ˆç¾çš„è©±ï¼Œåªèƒ½çœ‹å‡ºï¼Œè©²å°è±¡åœ¨åˆ†ä½ˆçš„æŸå€‹ä½ç½®ï¼›ä½†å¯ä»¥æ”¹ç”¨å°‡è³‡æ–™å°è±¡æ ¹æ“šæŸå€‹æ•¸æ“šä¾†æ’åºå¾Œï¼Œç¹ªè£½æŠ˜ç¾åœ–çš„æ–¹å¼ä¾†è¡¨ç¾ã€‚ä¾‹å¦‚ï¼Œè‹¥è¦ç¹ªè£½ä¸€å€‹ç­ç´šçš„æˆç¸¾åˆ†ä½ˆï¼Œé€šå¸¸Xè»¸æ˜¯åˆ†æ•¸ï¼ˆçµ„ï¼‰ï¼ŒYè»¸æ˜¯ç²å¾—è©²åˆ†æ•¸ï¼ˆçµ„ï¼‰çš„äººæ•¸ï¼›ä½†å…¶å¯¦å¯ä»¥å°‡å€‹é«”ä¾ç…§åˆ†æ•¸ä¾†åšæ’åºï¼ŒYè»¸ä¸æ˜¯æŸå€‹åˆ†æ•¸ï¼ˆçµ„ï¼‰çš„å€‹æ•¸ï¼Œè€Œæ˜¯æ¯å€‹æ’åºå¾Œçš„å€‹é«”ï¼Œè€Œä¸”ä»¥æ’åºå¾Œçš„åºè™Ÿï¼ˆRankingï¼‰ä¾†è¡¨ç¤ºã€‚ç”¨æŠ˜ç·šåœ–ç¹ªè£½å¾Œï¼Œä¸€æ¨£å¯ä»¥çœ‹å‡ºåˆ†æ•¸çš„åˆ†ä½ˆï¼Œä½†å»èƒ½å¤ ç›´æ¥æ¨™è¨˜æ•˜äº‹ä¸­çš„æŸå€‹å°è±¡æ˜¯Yè»¸ä¸­å¾—å“ªå€‹é»ã€‚ 10.1.1 Figure 3.5: Population numbers of Texas counties relative to their median value. Select counties are highlighted by name. The dashed line indicates a ratio of 1, corresponding to a county with median population number. The most populous counties have approximately 100 times more inhabitants than the median county, and the least populous counties have approximately 100 times fewer inhabitants than the median county. Data source: 2010 Decennial U.S. Census. See Whatâ€™s Going On in This Graph? | Vaccination by Country fromWhat Data Shows About Vaccine Supply and Demand in the Most Vulnerable Places - The New York Times (nytimes.com) The original chart is animated along the timeline.What Data Shows About Vaccine Supply and Demand in the Most Vulnerable Places - The New York Times (nytimes.com) "],["ç”¨log-scaleæ”¾å¤§é•·å°¾é ­éƒ¨.html", "10.2 ç”¨Log-scaleæ”¾å¤§é•·å°¾é ­éƒ¨", " 10.2 ç”¨Log-scaleæ”¾å¤§é•·å°¾é ­éƒ¨ raw &lt;- read_csv(&quot;data/opendata107Y020.csv&quot;, show_col_types = FALSE) %&gt;% slice(-1) %&gt;% type_convert() toplot &lt;- raw %&gt;% select(site_id, village, edu_age_15up_total) %&gt;% arrange(desc(edu_age_15up_total)) %&gt;% mutate(index = row_number()) %&gt;% mutate(label = ifelse(index &lt;= 5 | index &gt; n()-5, paste0(site_id, village), &quot;&quot;)) library(ggrepel) p2 &lt;- toplot %&gt;% ggplot() + aes(index, edu_age_15up_total) + geom_point(alpha=0.5, color=&quot;royalblue&quot;) + geom_text_repel(aes(label = label), point.padding = .4, color = &quot;black&quot;, min.segment.length = 0, family = &quot;Heiti TC Light&quot;) + theme(axis.text.x=element_blank()) + scale_y_log10(breaks = c(0, 1, 10, 100, 1000, 10000)) + theme_minimal() p1 &lt;- toplot %&gt;% ggplot() + aes(index, edu_age_15up_total) + geom_point(alpha=0.5, color=&quot;royalblue&quot;) + theme(axis.text.x=element_blank()) + theme_minimal() cowplot::plot_grid( p2, NULL, p1, labels = c(&quot;a&quot;, &quot;&quot;, &quot;b&quot;), nrow = 1, rel_widths = c(1, 0.1, 1) ) "],["square-root-scale.html", "10.3 Square-root scale", " 10.3 Square-root scale Chap3 Coordination &amp; Axis Fundamentals of Data Visualization (clauswilke.com) Figure 3.8: Areas of Northeastern U.S. states. (a) Areas shown on a linear scale. (b) Areas shown on a square-root scale. Data source: Google. å‰é¢æ˜¯è¦–è¦ºåŒ–äº†å„æ‘é‡Œå¤§æ–¼åäº”æ­²ä»¥ä¸Šäººå£çš„äººå£æ•¸åˆ†ä½ˆï¼Œæ¡ç”¨å°æ•¸å°ºåº¦ï¼ˆlog-scaleï¼‰å¯ä»¥è§€å¯Ÿåˆ°æ¯”è¼ƒå°çš„æ‘é‡Œã€‚é‚£æœ‰ä»€éº¼æ˜¯é©åˆç”¨å¹³æ–¹æ ¹å°ºåº¦ï¼ˆsqrt-scaleï¼‰çš„å‘¢ï¼Ÿæ˜¯åœŸåœ°å—ï¼Ÿå¯†åº¦å—ï¼Ÿé‚„æ˜¯äººå£æ•¸ï¼Ÿæ˜¯æ‘é‡Œç­‰ç´šå—ï¼Ÿé„‰é®å¸‚å€ç­‰ç´šå—ï¼Ÿé‚„æ˜¯ç¸£å¸‚ç­‰ç´šï¼Ÿ town &lt;- read_csv(&quot;data/tw_population_opendata110N010.csv&quot;) %&gt;% slice(-1, -(370:375)) %&gt;% type_convert() town %&gt;% arrange(desc(area)) %&gt;% mutate(index = row_number()) %&gt;% ggplot() + aes(index, area) %&gt;% geom_col(fill=&quot;skyblue&quot;) + scale_y_sqrt() + theme_minimal() county &lt;- town %&gt;% mutate(county = str_sub(site_id, 1, 3)) %&gt;% group_by(county) %&gt;% summarize( area = sum(area), people_total = sum(people_total) ) %&gt;% ungroup() p1 &lt;- county %&gt;% arrange(desc(people_total)) %&gt;% mutate(index = row_number()) %&gt;% ggplot() + aes(index, people_total) %&gt;% geom_col(fill=&quot;lightgrey&quot;) + # scale_y_sqrt() + theme_minimal() p2 &lt;- county %&gt;% arrange(desc(people_total)) %&gt;% mutate(index = row_number()) %&gt;% ggplot() + aes(index, people_total) %&gt;% geom_col(fill=&quot;khaki&quot;) + scale_y_sqrt(breaks=c(0, 250000, 500000, 1000000, 2000000, 4000000)) + theme_minimal() cowplot::plot_grid( p1, p2, labels = c(&quot;a&quot;, &quot;b&quot;), nrow = 1 ) library(tidyverse) library(gghighlight) "],["åº§æ¨™è»¸å¾æ•¸å€¼åˆ°å¢åŠ å€¼.html", "10.4 åº§æ¨™è»¸å¾æ•¸å€¼åˆ°å¢åŠ å€¼", " 10.4 åº§æ¨™è»¸å¾æ•¸å€¼åˆ°å¢åŠ å€¼ 10.4.1 Net Worth by Age Group (WGOITG of NYTIMES) LEARNING NOTES Median for Inequality é€™å€‹æ•™å­¸æ¡ˆä¾‹ä¾†è‡ªç´ç´„æ™‚å ±çš„ã€ŒWhatâ€™s going on in this graghã€ç³»åˆ—è³‡æ–™è¦–è¦ºåŒ–æ•™å­¸ä¹‹Teach About Inequality With These 28 New York Times Graphs - The New York Times (nytimes.com) ã€‚è©²åœ–è¡¨å‘ˆç¾åœ¨ä¸åŒå¹´ä»£ã€ä¸åŒå¹´é½¡å±¤çš„äººæ‰€æ“æœ‰çš„æ·¨è³‡ç”¢ï¼ˆåŒ…å«åœŸåœ°ã€å­˜æ¬¾ã€æŠ•è³‡ç­‰æ¸›å»å‚µå‹™ï¼‰ã€‚è©²åœ–è¡¨çš„çµæœæŒ‡å‡ºï¼Œåœ¨ä¸åŒå¹´ä»£çš„è€å¹´äººæ˜¯è¶Šä¾†è¶Šæœ‰éŒ¢ï¼Œä½†å¹´è¼•äººå»è¶Šä¾†è¶Šçª®ï¼ˆè©²æ›²ç·šç‚ºæ¸›å»1989å¹´ 10.4.2 Read and sort data Sorted by arrange() function. p1 &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(year, Category, Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% ungroup() p1 %&gt;% filter(year &lt;= 1992) %&gt;% knitr::kable() p1 %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line(linetype=&quot;dotted&quot;) + geom_point() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;, size = 0.5, linetype = &quot;solid&quot;)) p2 &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(year, Category, NW = Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% mutate(increase = (NW-first(NW))/first(NW)) %&gt;% ungroup() p2 %&gt;% filter(year &lt;= 1992) %&gt;% knitr::kable() p2 %&gt;% ggplot() + aes(year, increase, color = Category) + geom_line(linetype=&quot;dotted&quot;) + geom_point() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_y_continuous(labels=scales::parse_format()) + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;, size = 0.5, linetype = &quot;solid&quot;)) "],["ç­‰æ¯”ä¾‹åº§æ¨™è»¸.html", "10.5 ç­‰æ¯”ä¾‹åº§æ¨™è»¸", " 10.5 ç­‰æ¯”ä¾‹åº§æ¨™è»¸ 10.5.1 UNICEF-Optimistic (WGOITH) https://www.nytimes.com/2021/11/17/upshot/global-survey-optimism.html https://changingchildhood.unicef.org/about plot.opt &lt;- read_csv(&quot;nytdata/unicef-changing-childhood-data.csv&quot;) %&gt;% select(country = WP5, age = WP22140, bw = WP22092) %&gt;% mutate(country = ordered(country, levels=c(1, 3, 4, 10, 11, 12, 13, 14, 17, 29, 31, 33, 35, 36, 60, 61, 77, 79, 81, 87, 165), labels=c(&quot;USA&quot;, &quot;Morocco&quot;, &quot;Lebanon&quot;, &quot;Indonesia&quot;, &quot;Bangladesh&quot;, &quot;UK&quot;, &quot;France&quot;, &quot;Germany&quot;, &quot;Spain&quot;, &quot;Japan&quot;, &quot;India&quot;, &quot;Brazil&quot;, &quot;Nigeria&quot;, &quot;Kenya&quot;, &quot;Ethiopia&quot;, &quot;Mali&quot;, &quot;Ukraine&quot;, &quot;Cameroon&quot;, &quot;Zimbabwe&quot;, &quot;Argentina&quot;, &quot;Peru&quot;))) %&gt;% count(country, age, bw) %&gt;% group_by(country, age) %&gt;% mutate(perc = n/sum(n)) %&gt;% ungroup() %&gt;% filter(bw == 1) %&gt;% select(country, age, perc) %&gt;% spread(age, perc) %&gt;% rename(`15-24y` = `1`, `40+y` = `2`) plot.opt %&gt;% head(10) %&gt;% knitr::kable() plot.opt %&gt;% ggplot() + aes(`40+y`, `15-24y`, label = country) + geom_point(color = &quot;skyblue&quot;, size = 2) + xlim(0, 1) + ylim(0,1) + geom_text(hjust = -0.1, vjust = -0.5) + geom_abline(intercept = 0, slop = 1, color=&quot;lightgrey&quot;, alpha=0.5, linetype=&quot;dashed&quot;) + theme_minimal() + theme(aspect.ratio=1) "],["amount.html", "Chapter 11 AMOUNT ", " Chapter 11 AMOUNT "],["bar-chart.html", "11.1 Bar chart", " 11.1 Bar chart "],["heatmap-vaccination.html", "11.2 Heatmap: Vaccination", " 11.2 Heatmap: Vaccination é€™å€‹ä¾‹å­åƒè€ƒ(Wilke 2019)åœ¨è¦–è¦ºåŒ–æ•¸é‡ï¼ˆAmountï¼‰æ™‚çš„ç†±åœ–ç¯„ä¾‹ï¼ˆHeatmapï¼‰ï¼Œä½†æ”¹ç”¨ç‚ºè¦–è¦ºåŒ–å„åœ‹æ¯ç™¾äººå®Œæ•´æ³¨å°„COVID-19ç–«è‹—äººæ•¸æ­·æ™‚è³‡æ–™ã€‚ - https://ourworldindata.org/covid-vaccinations - https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations é€™å€‹æ¡ˆä¾‹ä½¿ç”¨äº†ä¸‰å€‹ç¶­åº¦çš„è³‡æ–™ï¼Œåˆ†åˆ¥ç‚ºXè»¸çš„æ™‚é–“ï¼ˆæœˆï¼‰ã€Yè»¸çš„åœ‹å®¶ã€ä»¥åŠç”¨é¡è‰²ä¾†å‘ˆç¾å„åœ‹ç–«è‹—æ³¨å°„é‡ï¼ˆæ¯ç™¾äººï¼‰ã€‚ä¸¦ä½¿ç”¨geom_tile()ä¾†è£½ä½œç†±åœ–ã€‚ç„¶è€Œï¼ŒYè»¸çš„æ’åºå»æœƒå½±éŸ¿è®€åœ–ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¬¬ä¸€å€‹ä¾‹å­ä¸­ï¼ŒYè»¸çš„é †åºæ˜¯ç”¨æœ€å¾Œä¸€å€‹æ™‚é–“é»çš„ç–«è‹—æ³¨å°„æ¯”ä¾‹ä¾†æ’åºã€‚ä½†æ¯å€‹åœ‹å®¶æ”¿ç­–å’Œç–«è‹—å¯ç²é‡å‡ä¸åŒï¼Œæ•…é–‹å§‹æ³¨å°„å’Œè¦†è“‹é€Ÿåº¦ä¹Ÿå·®å¾ˆå¤šï¼Œæœ€çµ‚è¦†è“‹é‡ä¹Ÿæœƒå·®å¾ˆå¤šã€‚æ‰€ä»¥å¦‚æœä»¥æœ€çµ‚è¦†è“‹é‡ä¾†æ’åºçš„è©±ï¼Œåè€Œä¸æ˜“è§€å¯Ÿéç¨‹çš„è®ŠåŒ–ï¼Œä¸”ã€Œé¡è‰²ã€ä¸¦ä¸å®¹æ˜“ç”¨ä¾†æ¯”è¼ƒæœ€çµ‚è¦†è“‹é‡çš„å¤§å°ï¼Œå› è€Œæœƒç”¢ç”Ÿå¾ˆå¤šè®€åœ–ä¸Šçš„å›°æ“¾ã€‚ å¦ä¸€ç¨®ç¹ªåœ–ç­–ç•¥æ˜¯è©²æ›¸ä¸Šçš„åšæ³•ï¼Œå…¶Yè»¸çš„æ’åºæ˜¯ä¾ç…§ç–«è‹—è¦†è“‹ç‡é”åˆ°æŸå€‹æ•¸å€¼ï¼ˆä¾‹å¦‚æ¯ç™¾äººä¸­æœ‰20äººå®Œæ•´æ³¨å°„äºŒåŠ‘ç–«è‹—ï¼‰çš„æ™‚é–“æ—©æ™šä¾†æ’åºã€‚æœ‰æ­¤ä½œç‚ºåŸºæº–ï¼Œæ¯å€‹åœ‹å®¶åœ¨å¾ŒçºŒæ™‚é–“é»çš„è¦†è“‹é€Ÿåº¦çš„æ¯”è¼ƒä¾¿æ¯”è¼ƒå®¹æ˜“ã€‚ å¦å¤–éœ€è¦æ³¨æ„åˆ°ï¼Œé¡è‰²çš„å–æ¨ã€ä»¥åŠç›¸å°æ–¼å°ºåº¦çš„æ¼¸å±¤è¨­è¨ˆä¹Ÿæœƒå½±éŸ¿è®€åœ–ã€‚ æœ¬ä¾‹å­çš„è³‡æ–™å‰è™•ç†é›£åº¦è¼ƒé«˜ï¼ˆOSï¼šæƒ¡é­”ç´šï¼‰ã€‚å›°é›£ä¾†è‡ªæ–¼æ¯å€‹åœ‹å®¶ç™»è¨˜è³‡æ–™çš„æ™‚é–“ä¸åŒï¼Œå› æ­¤æœƒç”¢ç”Ÿå¤§é‡NAå€¼ã€‚ä½†åœ¨é€™æ¨£çš„ç‹€æ³ä¸‹ï¼Œåˆè¦æ‰¾åˆ°ä»¥æœˆç‚ºæ™‚é–“å–®ä½çš„å…±åŒæ•¸å€¼ï¼Œå°±æœƒæ›´æŒ‘æˆ°ç¨‹å¼ç·¨å¯«è€…çš„è³‡æ–™æ¸…ç†æŠ€è¡“ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚ä½•åµæ¸¬ã€Œæ¯å€‹åœ‹å®¶è¶…éæ¯ç™¾äººæœ‰äºŒåäººå®Œæ•´æ³¨å°„ç–«è‹—çš„æ™‚é–“é»ã€ï¼Œæ›´æ˜¯æŠ€å·§ä¸­çš„æŠ€å·§ã€‚æ˜¯å€‹ç£¨ç·´NAå€¼è™•ç†å’Œé«˜é›£åº¦è³‡æ–™å‰è™•ç†çš„å¥½ä¾‹å­ã€‚ library(lubridate) raw &lt;- read_csv(&quot;data/vaccinations.csv&quot;) fullvaccinated &lt;- raw %&gt;% select(country = location, date, people_fully_vaccinated_per_hundred) %&gt;% drop_na(people_fully_vaccinated_per_hundred) %&gt;% mutate(m = floor_date(date, unit = &quot;month&quot;)) %&gt;% group_by(country, m) %&gt;% arrange(date) %&gt;% slice(1) %&gt;% ungroup() %&gt;% select(-date) vperc_by_month &lt;- fullvaccinated %&gt;% spread(m, people_fully_vaccinated_per_hundred, fill=NA) %&gt;% gather(month, perc, -country) %&gt;% arrange(country, month) %&gt;% group_by(country) %&gt;% arrange(month) %&gt;% mutate(perc = zoo::na.locf(perc, na.rm = F)) %&gt;% ungroup() %&gt;% arrange(country, month) %&gt;% replace_na(list(perc=0)) https://clauswilke.com/dataviz/visualizing-amounts.html watched &lt;- c(&quot;United Arab Emirates&quot;, &quot;Japan&quot;, &quot;Singapore&quot;, &quot;South Korea&quot;, &quot;Taiwan&quot;, &quot;Malaysia&quot;, &quot;Hong Kong&quot;, &quot;New Zealand&quot;, &quot;Thailand&quot;, &quot;Netherlands&quot;, &quot;United States&quot;, &quot;Israel&quot;, &quot;United Kingdom&quot;, &quot;Indonesia&quot;, &quot;Thailand&quot;, &quot;Philippines&quot;) vperc_by_month %&gt;% spread(month, perc) %&gt;% filter(country %in% watched) %&gt;% mutate(country = reorder(country, -`2022-05-01`)) %&gt;% gather(month, perc, -country) %&gt;% ggplot() + aes(month, country, fill=perc) + geom_tile() + theme_minimal() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) https://clauswilke.com/dataviz/visualizing-amounts.html vperc_by_month %&gt;% filter(country %in% watched) %&gt;% mutate(month = lubridate::as_date(month)) %&gt;% group_by(country) %&gt;% mutate(month1 = min((month[perc &gt; 20]))) %&gt;% ungroup() %&gt;% spread(month, perc) %&gt;% mutate(country = reorder(country, -as.numeric(month1))) %&gt;% select(-month1) %&gt;% gather(month, perc, -country) %&gt;% ggplot() + aes(month, country, fill=perc) + geom_tile() + theme_minimal() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) References "],["distribution-histogram-density.html", "Chapter 12 DISTRIBUTION: Histogram &amp; Density", " Chapter 12 DISTRIBUTION: Histogram &amp; Density Most of contet in the chapter comes from the book Claus o. Wilkeâ€™s â€œFoundamentals of Data Visualizationâ€ vilmaster &lt;- readr::read_csv(&quot;data/tw_vil2018_elccand.csv&quot;) %&gt;% drop_na(ç•¶é¸è¨»è¨˜) "],["density-plot.html", "12.1 Density plot", " 12.1 Density plot p1 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density() + th p2 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_density(alpha=0.5) + th + scale_fill_manual( limits=c(&#39;1&#39;, &#39;2&#39;), # original chart group values=c(&quot;gold&quot;, &quot;skyblue&quot;), # map to color name=&quot;æ€§åˆ¥&quot;, # legend title breaks=c(1, 2), # original legend group labels labels=c(&quot;Male&quot;,&quot;Female&quot;), # map to new labels na.value = &quot;lightgrey&quot; # color for other groups ) cowplot::plot_grid( p1, p2, labels = c(&quot;(a) Overall&quot;, &quot;(b) Group by gender&quot;), nrow = 1, rel_widths = c(1, 1) ) 12.1.1 Density with different bandwidth library(ggridges) # for geom_density_line() p.b05 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=0.5, kernel=&#39;gaussian&#39;) + th p.b1 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=1, kernel=&#39;gaussian&#39;) + th p.b5 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=5, kernel=&#39;gaussian&#39;) + th p.rect &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=8, kernel=&#39;rectangular&#39;) + th cowplot::plot_grid( p.b05, p.b1, p.b5, p.rect, labels = c(&quot;(a) bw=.5&quot;, &quot;(b) bw=1&quot;, &quot;(c) bw=2&quot;, &quot;(b) rect&quot;), nrow = 2, rel_widths = c(1, 1) ) "],["histogram.html", "12.2 Histogram", " 12.2 Histogram 12.2.1 Histogram with different number of bins p10 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=10, fill=&#39;royalblue&#39;) + th p20 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=20, fill=&#39;royalblue&#39;) + th p30 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=30, fill=&#39;royalblue&#39;) + th p40 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=40, fill=&#39;royalblue&#39;) + th cowplot::plot_grid( p10, p20, p30, p40, labels = c(&quot;(a) bins=10&quot;, &quot;(b) bins=20&quot;, &quot;(c) bins=30&quot;, &quot;(b) bins=40&quot;), nrow = 2, rel_widths = c(1, 1) ) 12.2.2 Density vs histogram pd &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_density(alpha=0.5) + th + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue&quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) ph &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;dodge&quot;) + th + scale_fill_manual(values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;)) + theme(legend.position=&quot;none&quot;) cowplot::plot_grid( pd, ph, labels = c(&quot;(a) geom_density()&quot;, &quot;(b) geom_histogram()&quot;), nrow = 1, rel_widths = c(6, 4) ) 12.2.3 Positions of bar chart p.hist.dodge &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;dodge&quot;) + th + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) p.hist.stack &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;stack&quot;) + th + scale_fill_manual(values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;)) + theme(legend.position=&quot;none&quot;) cowplot::plot_grid( p.hist.dodge, p.hist.stack, labels = c(&quot;(a) position:dodge&quot;, &quot;(b) position:stack&quot;), nrow = 1, rel_widths = c(6, 4) ) 12.2.4 Display two groups histogram by facet_wrap() vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;dodge&quot;) + th + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) + facet_wrap(.~æ€§åˆ¥, nrow=1) "],["pyramid-plot.html", "12.3 Pyramid Plot", " 12.3 Pyramid Plot 12.3.1 Modify geom_col() to pyramid plot vilmaster %&gt;% group_by(æ€§åˆ¥) %&gt;% mutate(age_group = cut(å¹´é½¡, 0:20*5+.01)) %&gt;% count(age_group) %&gt;% ungroup() %&gt;% ggplot() + aes(x=age_group, y=ifelse(æ€§åˆ¥==&#39;1&#39;, -1, 1)*n, fill=factor(æ€§åˆ¥)) + geom_col() + scale_y_continuous(name = &quot;Count&quot;, breaks = 250*(-6:2), labels = c(&quot;1500&quot;, &quot;1250&quot;, &quot;1000&quot;, &quot;750&quot;, &quot;500&quot;, &quot;250&quot;, &quot;0&quot;, &quot;250&quot;, &quot;500&quot;)) + coord_flip() + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) + th + labs(y=&quot;Count&quot;, x=&quot;Age Group&quot;) "],["box-plot-muitiple-distrubution.html", "12.4 Box plot: Muitiple Distrubution", " 12.4 Box plot: Muitiple Distrubution 12.4.1 TW-Salary (boxplot) Inspired by Six Myths About Choosing a College Major - The New York Times (nytimes.com) and Whatâ€™s Going On in This Graph? | Jan.Â 9, 2018 - The New York Times (nytimes.com) library(readxl) raw &lt;- read_excel(&quot;data/tw_salary109.xlsx&quot;, sheet=1, trim_ws = T) raw raw %&gt;% slice(-(1:12)) %&gt;% mutate(Category = reorder(Category, desc(Median))) %&gt;% ggplot() + aes(y = Category, xlower=Q1, xmiddle=Median, xupper=Q3, xmin=0, xmax=150) + geom_boxplot(stat = &quot;identity&quot;, color=&quot;white&quot;, fill=&quot;skyblue&quot;) + geom_point(aes(x = Mean)) + th + theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank()) 12.4.2 TW-Income (boxplot) library(gghighlight) toplot &lt;- read_csv(&quot;data/tw_income_107.csv&quot;, ) %&gt;% filter(!`æ‘é‡Œ` %in% c(&quot;åˆè¨ˆ&quot;, &quot;å…¶ä»–&quot;, &quot;ç¦ä½é‡Œ&quot;)) %&gt;% filter(é„‰é®å¸‚å€ %in% c(&quot;ä¿¡ç¾©å€&quot;)) %&gt;% mutate(æ‘é‡Œ = reorder(æ‘é‡Œ, desc(ä¸­ä½æ•¸))) toplot %&gt;% mutate(group = if_else((å¹³å‡æ•¸&gt;ç¬¬ä¸‰åˆ†ä½æ•¸), &quot;highlight&quot;, &quot;none&quot;)) %&gt;% ggplot() + aes(y = æ‘é‡Œ, xlower=ç¬¬ä¸€åˆ†ä½æ•¸, xmiddle=ä¸­ä½æ•¸, xupper=ç¬¬ä¸‰åˆ†ä½æ•¸, xmin= min(ç¬¬ä¸€åˆ†ä½æ•¸), xmax=max(ç¬¬ä¸‰åˆ†ä½æ•¸), fill=group) + geom_boxplot(stat = &quot;identity&quot;, color=&quot;white&quot;) + scale_fill_manual(values = c(&quot;highlight&quot;=&quot;orangered&quot;, &quot;none&quot;=&quot;skyblue&quot;)) + guides(fill=FALSE) + geom_point(aes(x = å¹³å‡æ•¸)) + xlab(&quot;å¹´æ‰€å¾—ï¼ˆå–®ä½ï¼šåƒå…ƒï¼‰&quot;) + th + theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank()) "],["proportion.html", "Chapter 13 PROPORTION ", " Chapter 13 PROPORTION "],["pie-chart.html", "13.1 Pie Chart", " 13.1 Pie Chart "],["dodged-bar-chart.html", "13.2 Dodged Bar Chart", " 13.2 Dodged Bar Chart "],["treemap-nested-proportion.html", "13.3 Treemap: Nested Proportion", " 13.3 Treemap: Nested Proportion 13.3.1 Global Carbon Projects (WGOITH-NYTIMES) Who Has The Most Historical Responsibility for Climate Change? - The New York Times (nytimes.com) totreemap &lt;- read_csv(&quot;nytdata/GCB2021v34_MtCO2_flat.csv&quot;) %&gt;% drop_na(`Total`) %&gt;% filter(!Country %in% c(&quot;Global&quot;, &quot;International Transport&quot;)) %&gt;% filter(Year==2020) %&gt;% arrange(desc(`Total`)) %&gt;% mutate(perc = Total/sum(Total)) %&gt;% slice(1:20) library(treemapify) totreemap %&gt;% ggplot() + aes(area = perc, fill=`Per Capita`, label=Country) + geom_treemap() + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=TRUE ) 13.3.2 TW Budget library(zoo) # raw &lt;- readxl::read_excel(&quot;data/111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—ç¸½è¡¨.xls&quot;) raw &lt;- readxl::read_excel(&quot;data/111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—è¡¨.xls&quot;, skip=3, col_names = F) names(raw) &lt;- c(&quot;æ¬¾&quot;, &quot;ç§‘&quot;, &quot;ç›®&quot;, &quot;ç¯€&quot;, &quot;æ©Ÿæ§‹&quot;, &quot;æœ¬å¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦æ±ºç®—&quot;, &quot;é ç®—å·®&quot;) # raw$æ¬¾ &lt;- na.locf(raw$æ¬¾) cleand &lt;- raw %&gt;% filter(!is.na(æ¬¾) | !is.na(ç§‘)) %&gt;% slice(-(1:2)) %&gt;% select(-ç›®, -ç¯€) %&gt;% mutate(org = purrr::map(æ©Ÿæ§‹, function(x){str_split(x, &quot;\\n&quot;)[[1]][2]})) %&gt;% mutate(æ¬¾ = ifelse(!is.na(æ¬¾), unlist(org), unlist(æ¬¾))) %&gt;% mutate(æ¬¾ = zoo::na.locf(æ¬¾)) %&gt;% filter(!is.na(ç§‘)) %&gt;% select(-ç§‘) %&gt;% type_convert() %&gt;% mutate(ä¸Šå¹´åº¦é ç®— = as.numeric(ä¸Šå¹´åº¦é ç®—), ä¸Šå¹´åº¦æ±ºç®— = as.integer(ä¸Šå¹´åº¦æ±ºç®—), é ç®—å·® = as.numeric(é ç®—å·®)) %&gt;% replace_na(list(ä¸Šå¹´åº¦é ç®— = 0, ä¸Šå¹´åº¦æ±ºç®— = 0)) %&gt;% mutate(é ç®—å·® = æœ¬å¹´åº¦é ç®— - ä¸Šå¹´åº¦é ç®—) cleand %&gt;% filter(æ¬¾ %in% c(&quot;ç§‘å­¸æ”¯å‡º&quot;)) %&gt;% ggplot() + aes(area = æœ¬å¹´åº¦é ç®—, fill=`æœ¬å¹´åº¦é ç®—`, label=org) + geom_treemap() + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=TRUE, family = &quot;Heiti TC Light&quot; ) + theme(title = element_text(family = &quot;Heiti TC Light&quot;), text = element_text(family = &quot;Heiti TC Light&quot;)) library(treemapify) cleand %&gt;% # filter(æ¬¾ %in% c(&quot;ç§‘å­¸æ”¯å‡º&quot;, &quot;æ•™è‚²æ”¯å‡º&quot;, &quot;åœ‹é˜²æ”¯å‡º&quot;, &quot;å¸æ³•æ”¯å‡º&quot;)) %&gt;% ggplot() + aes(area = æœ¬å¹´åº¦é ç®—, fill=`æœ¬å¹´åº¦é ç®—`, label=org, subgroup = æ¬¾) + geom_treemap() + geom_treemap_subgroup_border(color=&quot;gold&quot;) + geom_treemap_subgroup_text(place = &quot;centre&quot;, grow = T, alpha = 0.5, colour = &quot;gold&quot;, min.size = 0, family = &quot;Heiti TC Light&quot;) + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=F, family = &quot;Heiti TC Light&quot; ) + theme(title = element_text(family = &quot;Heiti TC Light&quot;), text = element_text(family = &quot;Heiti TC Light&quot;), legend.position = &quot;none&quot;) "],["association.html", "Chapter 14 ASSOCIATION ", " Chapter 14 ASSOCIATION "],["ç­‰æ¯”ä¾‹åº§æ¨™è»¸-1.html", "14.1 ç­‰æ¯”ä¾‹åº§æ¨™è»¸", " 14.1 ç­‰æ¯”ä¾‹åº§æ¨™è»¸ 14.1.1 UNICEF-Optimistic (WGOITH) https://www.nytimes.com/2021/11/17/upshot/global-survey-optimism.html https://changingchildhood.unicef.org/about plot.opt &lt;- read_csv(&quot;nytdata/unicef-changing-childhood-data.csv&quot;) %&gt;% select(country = WP5, age = WP22140, bw = WP22092) %&gt;% mutate(country = ordered(country, levels=c(1, 3, 4, 10, 11, 12, 13, 14, 17, 29, 31, 33, 35, 36, 60, 61, 77, 79, 81, 87, 165), labels=c(&quot;USA&quot;, &quot;Morocco&quot;, &quot;Lebanon&quot;, &quot;Indonesia&quot;, &quot;Bangladesh&quot;, &quot;UK&quot;, &quot;France&quot;, &quot;Germany&quot;, &quot;Spain&quot;, &quot;Japan&quot;, &quot;India&quot;, &quot;Brazil&quot;, &quot;Nigeria&quot;, &quot;Kenya&quot;, &quot;Ethiopia&quot;, &quot;Mali&quot;, &quot;Ukraine&quot;, &quot;Cameroon&quot;, &quot;Zimbabwe&quot;, &quot;Argentina&quot;, &quot;Peru&quot;))) %&gt;% count(country, age, bw) %&gt;% group_by(country, age) %&gt;% mutate(perc = n/sum(n)) %&gt;% ungroup() %&gt;% filter(bw == 1) %&gt;% select(country, age, perc) %&gt;% spread(age, perc) %&gt;% rename(`15-24y` = `1`, `40+y` = `2`) plot.opt %&gt;% head(10) %&gt;% knitr::kable() plot.opt %&gt;% ggplot() + aes(`40+y`, `15-24y`, label = country) + geom_point(color = &quot;skyblue&quot;, size = 2) + xlim(0, 1) + ylim(0,1) + geom_text(hjust = -0.1, vjust = -0.5) + geom_abline(intercept = 0, slop = 1, color=&quot;lightgrey&quot;, alpha=0.5, linetype=&quot;dashed&quot;) + theme_minimal() + theme(aspect.ratio=1) "],["time-trends.html", "Chapter 15 TIME &amp; TRENDS", " Chapter 15 TIME &amp; TRENDS "],["geospatial.html", "Chapter 16 GEOSPATIAL", " Chapter 16 GEOSPATIAL "],["interactivity.html", "Chapter 17 Interactivity", " Chapter 17 Interactivity "],["ggplotly.html", "17.1 ggplotly", " 17.1 ggplotly Scatter plots with ggplot2 (plotly.com) 17.1.1 LINE CHART Line plots with R (plotly.com) NW &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(Category, year, Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% ungroup() å¦‚æœå¸Œæœ›æ»‘é¼ åœ¨ç§»åˆ°æŠ˜ç·šä¸Šæ™‚å°±æœƒæœ‰æµ®å‡ºçš„è³‡è¨Šï¼ˆtipsï¼‰é¡¯ç¤ºè©²è³‡æ–™é»çš„å±¬æ€§ç‰¹å¾µï¼Œå¯ä»¥æ¡ç”¨plotly()é€™å€‹å¥—ä»¶ã€‚é€™å€‹å¥—ä»¶åŸæœ¬å°±æ˜¯åšç·šä¸Šäº’å‹•åœ–è¡¨çš„ï¼Œä½†ä»–é–‹ç™¼äº†R clientè®“Rçš„ä½¿ç”¨è€…å¯ä»¥å¾ˆè¼•æ˜“åœ°æŠŠggplot2çš„çµæœè½‰ç‚ºäº’å‹•åœ–è¡¨ã€‚ä½†é€™æ‰€è¬‚çš„äº’å‹•ä¹Ÿåƒ…é™æ–¼æ»‘é¼ ç§»éå»æ‰€æµ®å‡ºçš„è³‡è¨Šç½·äº†ï¼Œä¸éå·²ç¶“èƒ½å¤ é”åˆ°å¸å¼•éƒ¨åˆ†è®€è€…ç›®å…‰ã€æä¾›è¨Šæ¯çš„æ•ˆæœã€‚ è€Œplotlyçš„è¨­è¨ˆéå¸¸ç°¡å–®ï¼Œå°±æ˜¯æŠŠggplotçš„çµæœæŒ‡çµ¦ä¸€å€‹è®Šæ•¸å¾Œï¼Œç„¶å¾Œç”¨ggplotly(NW.plot)å°‡å…¶è½‰ç‚ºplotlyå³å¯ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œä¸¦ä¸æ˜¯æ¯ä¸€å€‹åœ–éƒ½å¯ä»¥é †åˆ©è½‰æ›ã€‚ä¾‹å¦‚æœ¬ç¯€æœ€å¾Œä¸€å€‹ä¾‹å­Treemapä¾¿ç„¡æ³•æˆåŠŸè½‰æ›ã€‚ è¨­å®šï¼šåŸæœ¬plotlyæœƒå¸¶ä¸€å€‹æ“æ§åˆ—ï¼Œå¯ä»¥åœ¨ggplotly()æŒ‡ä»¤å¾ŒåŠ å…¥config()ä¾¿å¯å°‡å…¶éš±è—ã€‚ NW.plot &lt;- NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + th library(plotly) ggplotly(NW.plot) %&gt;% config(displayModeBar = FALSE) å¯ä»¥åœ¨aes()è¨­å®šè¦å¸¶å…¥åœ–çš„è®Šæ•¸æ™‚ï¼Œæ–°å¢ä¸€å€‹textè®Šæ•¸ï¼Œæ‰‹å‹•è¨­å®šè¦å‘ˆç¾çš„å‹•æ…‹å‘ˆç¾æ–¹å¡Šã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œè¦å¤šåŠ å…¥ä¸€å€‹group=1æ‰èƒ½å¤ ä½œç”¨ï¼ˆWHYï¼Ÿï¼‰ã€‚ä½†å‰ä¾‹æµ®å‡ºè¦–çª—çš„åŸå§‹å…§å®¹æ‰€é¡¯ç¤ºçš„æ˜¯åŸæœ¬çš„è®Šæ•¸åç¨±å’Œå€¼ï¼Œå¾€å¾€ä¸æ˜“è§€å¯Ÿã€‚æ¯”è¼ƒå¥½çš„æ–¹å¼æ˜¯åœ¨ä¸‹ggplot() + aes()æŒ‡ä»¤æ™‚ï¼Œåœ¨aes()ä¸­æŒ‡å®štextä¾†ä½œç‚ºå¾ŒçºŒæµ®å‡ºè¦–çª—å…§å®¹ã€‚æŒ‡å®šæ–¹æ³•å¦‚ä¸‹ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œè©²æµ®å‡ºè¦–çª—çš„èªæ³•æ˜¯HTMLï¼Œæ‰€ä»¥å¦‚æœè¦æ”¹å¯«æµ®å‡ºè¦–çª—å…§å®¹ï¼Œè¦ç”¨paste0()å°‡è®Šæ•¸å’ŒHTMLçš„æ¨™ç±¤çµ¦éŠœæ¥èµ·ä¾†ã€‚ä»¥ä¸‹ä¾‹å­ä¸­çš„&lt;b&gt;ä»£è¡¨ç²—é«”çš„æ„æ€ï¼Œ&lt;br&gt;å‰‡æ˜¯æ›è¡Œç¬¦è™Ÿã€‚ NW.plot &lt;- NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category, text = paste0(&quot;&lt;b&gt;å¹´(X): &lt;/b&gt;&quot;, year, &quot;&lt;br&gt;&quot;, &quot;&lt;b&gt;æ·¨è³‡ç”¢(Y): &lt;/b&gt;&quot;, Net_Worth,&quot;&lt;br&gt;&quot;, &quot;&lt;b&gt;å¹´é½¡çµ„: &lt;/b&gt;&quot;, Category), group=1) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + th ggplotly(NW.plot, tooltip = &quot;text&quot;) %&gt;% config(displayModeBar = FALSE) å…¶ä»–ä¾‹å­ä¸­ä½¿ç”¨ggplotly()éƒ½æ˜¯ç›´æ¥ç…§å‰é¢çš„æ–¹æ³•å¥—ç”¨å³å¯ã€‚å”¯ç¨åœ¨Treemapä¸­ç„¡æ³•ç”¨é€™æ¨£çš„æ–¹æ³•ä¾†åšäº’å‹•çš„è¦–è¦ºåŒ–ã€‚æƒ³æƒ³é€™ä¹Ÿæ­£å¸¸ï¼Œç•¢ç«ŸTreemapæ˜¯ç”¨éggplotçš„ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼ˆlibrary(treemapify)ï¼‰ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå¯ä»¥æŠŠR Markdownä¸­Code Cellçš„çš„è¨­å®šåŠ å…¥include=FALSEï¼Œé€™æ¨£å¯ä»¥è®“RMDåœ¨ç·¨è£½ç‚ºHTMLæª”æ™‚ï¼Œä¸è¦é¡¯ç¤ºç¨‹å¼ç¢¼ï¼Œè€Œç›´æ¥é¡¯ç¤ºäº’å‹•çš„è¦–è¦ºåŒ–ä»‹é¢ã€‚ 17.1.2 SCATTER bw &lt;- read_csv(&quot;nytdata/unicef-changing-childhood-data.csv&quot;) %&gt;% select(country = WP5, age = WP22140, bw = WP22092) %&gt;% mutate(country = ordered(country, levels=c(1, 3, 4, 10, 11, 12, 13, 14, 17, 29, 31, 33, 35, 36, 60, 61, 77, 79, 81, 87, 165), labels=c(&quot;USA&quot;, &quot;Morocco&quot;, &quot;Lebanon&quot;, &quot;Indonesia&quot;,&quot;Bangladesh&quot;, &quot;UK&quot;, &quot;France&quot;, &quot;Germany&quot;, &quot;Spain&quot;, &quot;Japan&quot;, &quot;India&quot;, &quot;Brazil&quot;, &quot;Nigeria&quot;, &quot;Kenya&quot;, &quot;Ethiopia&quot;, &quot;Mali&quot;, &quot;Ukraine&quot;, &quot;Cameroon&quot;, &quot;Zimbabwe&quot;,&quot;Argentina&quot;, &quot;Peru&quot;))) %&gt;% count(country, age, bw) %&gt;% group_by(country, age) %&gt;% mutate(perc = n/sum(n)) %&gt;% ungroup() %&gt;% filter(bw == 1) %&gt;% select(country, age, perc) %&gt;% spread(age, perc) %&gt;% rename(`15-24y` = `1`, `40+y` = `2`) bw.p &lt;- bw %&gt;% ggplot() + aes(`40+y`, `15-24y`, label = country) + geom_point(color = &quot;skyblue&quot;, size = 2) + xlim(0.2, 0.85) + ylim(0.2, 0.85) + geom_text(hjust = -0.1, vjust = -0.5) + geom_abline(intercept = 0, slop = 1, color=&quot;lightgrey&quot;, alpha=0.5, linetype=&quot;dashed&quot;) + th + theme(aspect.ratio=1) bw.p %&gt;% ggplotly() 17.1.3 Barplot Bar charts with R (plotly.com) county &lt;- read_csv(&quot;data/tw_population_opendata110N010.csv&quot;) %&gt;% slice(-1, -(370:375)) %&gt;% type_convert() %&gt;% mutate(county = str_sub(site_id, 1, 3)) %&gt;% group_by(county) %&gt;% summarize( area = sum(area), people_total = sum(people_total) ) %&gt;% ungroup() population.p &lt;- county %&gt;% mutate(county = reorder(county, people_total)) %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;skyblue&quot;) + coord_flip() + th population.p %&gt;% ggplotly() 17.1.4 Boxplot Box plots with ggplot2 (plotly.com) aqi.toplot &lt;- read_rds(&quot;https://github.com/p4css/R4CSS/raw/master/data/AQI_Chaozhou.rds&quot;) %&gt;% arrange(æ—¥æœŸ)%&gt;% filter(æ¸¬é …==&quot;PM2.5&quot;) %&gt;% gather(&quot;hour&quot;, &quot;PM25&quot;, 4:28) %&gt;% mutate(PM25 = as.numeric(PM25)) %&gt;% drop_na() %&gt;% mutate(year = lubridate::year(æ—¥æœŸ), month = lubridate::month(æ—¥æœŸ)) %&gt;% filter(month %in% c(11, 12, 1, 2, 3)) aqi.plot &lt;- aqi.toplot %&gt;% mutate(year = as.character(year)) %&gt;% ggplot() + aes(x=year, y=PM25) + geom_boxplot(fill=&quot;skyblue&quot;, alpha=0.2) + ylim(0, 200) + coord_flip() + theme_minimal() aqi.plot %&gt;% ggplotly 17.1.5 Treemap (Global Carbon) å…¶ä»–ä¾‹å­ä¸­ä½¿ç”¨ggplotly()éƒ½æ˜¯ç›´æ¥ç…§å‰é¢çš„æ–¹æ³•å¥—ç”¨å³å¯ã€‚å”¯ç¨åœ¨Treemapä¸­ç„¡æ³•ç”¨é€™æ¨£çš„æ–¹æ³•ä¾†åšäº’å‹•çš„è¦–è¦ºåŒ–ã€‚æƒ³æƒ³é€™ä¹Ÿæ­£å¸¸ï¼Œç•¢ç«ŸTreemapæ˜¯ç”¨éggplotçš„ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼ˆlibrary(treemapify)ï¼‰ã€‚ totreemap &lt;- read_csv(&quot;nytdata/GCB2021v34_MtCO2_flat.csv&quot;) %&gt;% drop_na(`Total`) %&gt;% filter(!Country %in% c(&quot;Global&quot;, &quot;International Transport&quot;)) %&gt;% filter(Year==2020) %&gt;% arrange(desc(`Total`)) %&gt;% mutate(perc = Total/sum(Total)) %&gt;% slice(1:20) library(treemapify) carbon.p &lt;- totreemap %&gt;% ggplot() + aes(area = perc, fill=`Per Capita`, label=Country) + geom_treemap() + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=TRUE ) # carbon.p %&gt;% ggplotly "],["ç”¢è£½åœ–è¡¨å‹•ç•«.html", "17.2 ç”¢è£½åœ–è¡¨å‹•ç•«", " 17.2 ç”¢è£½åœ–è¡¨å‹•ç•« https://gist.github.com/rafapereirabr/0d68f7ccfc3af1680c4c8353cf9ab345 Rä¹Ÿæœ‰å¥—å·¥å…·å¯ä»¥ç”¢è£½åœ–è¡¨å‹•ç•«ï¼Œæ¦‚å¿µä¸Šå°±æ˜¯æ²¿è‘—ä¸€æ¢è³‡æ–™ç¶­åº¦ï¼ŒæŠŠå¤šå¼µåœ–çµ¦ç–Šåœ¨ä¸€èµ·è®Šæˆä¸€å€‹gifå‹•ç•«ã€‚æœ¬ä¾‹å­å³æ˜¯æŠŠç”¢å‡ä¹‹è–ªçš„ç¯„ä¾‹æ²¿è‘—æ™‚é–“è»¸åšå‹•ç•«ã€‚æ¯å€‹æ™‚é–“é»éƒ½æ˜¯ç•¶å¹´å„åœ‹ç”¢å‡æ”¯è–ªçµ¦ä»˜ç¨‹åº¦çš„åœ°åœ–ï¼Œä½†ç”±æ–¼æœ‰19å¹´çš„è³‡æ–™ï¼Œæ‰€ä»¥å¯ä»¥æŠŠå¹´ä»£ç•¶æˆå‹•ç•«çš„æ™‚é–“è»¸ã€‚ ä»¥ä¸‹æ˜¯æ¸…ç†è³‡æ–™çš„æ­¥é©Ÿï¼Œæœƒå½™æ•´å‡ºåœ‹åã€åœ‹å®¶ä»£ç¢¼ï¼ˆISO3ï¼‰ã€å¹´ã€å’Œçµ¦ä»˜ç­‰ç´šå››å€‹è®Šé …ã€‚é æœŸåˆ©ç”¨åœ‹åã€åœ‹å®¶ä»£ç¢¼å’Œçµ¦ä»˜ç­‰ç´šå°±å¯ä»¥ç•«å‡ºæ¯å¹´çš„åœ–ã€‚ç„¶å¾Œå°‡å¹´ä½œç‚ºå‹•ç•«çš„æ™‚é–“è»¸ï¼Œä¾¿å¯ç”¢ç”Ÿåœ°åœ–å‹•ç•«ã€‚ pml &lt;- read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) %&gt;% select(country, iso3, contains(&quot;matleave&quot;), -contains(&quot;wrr&quot;)) %&gt;% gather(&quot;year&quot;, &quot;degree&quot;, 3:21) %&gt;% replace_na(list(degree=0)) %&gt;% mutate(year2=as.POSIXct(strptime(year, &quot;matleave_%y&quot;))) %&gt;% mutate(year3 = strftime(year2, &quot;%Y&quot;)) %&gt;% select(country, ISO3=iso3, year=year3, degree) 17.2.1 åœ°åœ–ä¸‹è¼‰èˆ‡è½‰æ›æŠ•å½±æ–¹æ³• æ­¤ç‚ºä¸‹è¼‰åœ°åœ–ä¸¦è™•ç†åœ°åœ–æˆç‚ºå¯ä»¥ç”¨geom_polygom()ç¹ªåœ–çš„å¤šé‚Šå½¢è³‡æ–™é»ã€‚ library(rworldmap) wmap &lt;- getMap(resolution=&quot;low&quot;) wmap &lt;- spTransform(wmap, CRS(&quot;+proj=robin&quot;)) # reproject wmap &lt;- fortify(wmap) wmap %&gt;% filter(!duplicated(id)) %&gt;% head(10) pml_map &lt;- wmap %&gt;% left_join(pml, by=c(&quot;id&quot;=&quot;country&quot;)) %&gt;% filter(!is.na(ISO3)) %&gt;% mutate(year = as.integer(year)) # devtools::install_github(&quot;thomasp85/transformr&quot;) pml_map %&gt;% select(id) %&gt;% filter(!duplicated(.)) %&gt;% head(10) 17.2.2 éœæ…‹ç¹ªåœ–æ¸¬è©¦ pml_map %&gt;% filter(year==1995) %&gt;% ggplot() + aes(x = long, y = lat, group=group, fill=factor(degree)) + geom_polygon(color=&quot;grey&quot;) + theme_void() + scale_fill_manual(values=c(&quot;1&quot;=&quot;red&quot;, &quot;2&quot;=&quot;LightCyan&quot;, &quot;3&quot;=&quot;lightskyblue&quot;, &quot;4&quot;=&quot;DodgerBlue&quot;, &quot;5&quot;=&quot;MediumBlue&quot;)) + coord_cartesian(xlim = c(-11807982, 14807978)) åœ¨æ¡ç”¨gganimateç¹ªåœ–æ™‚ï¼Œåƒ…éœ€è¦å¤šåŠ ä¸€å€‹å‹•ç•«ç¹ªåœ–å‡½å¼+ transition_time(year)å³å¯ï¼Œå…¶ä»–ç¹ªåœ–éƒ¨åˆ†ä¸¦ç„¡ä¿®æ”¹ã€‚æœ€å¾Œæ‰ç”¨animate()å‡½å¼æŠŠé€™æ•´å€‹ç¹ªåœ–æŒ‡ä»¤è½‰è£½ç‚ºå‹•ç•«ï¼ŒåŒ…å«æŒ‡å®šfpsï¼ˆframe per secondï¼‰å’Œé•·å¯¬ç­‰åƒæ•¸ã€‚ library(gganimate) pml.ani &lt;- pml_map %&gt;% ggplot() + aes(x = long, y = lat, group=group, fill=factor(degree)) + geom_polygon(color=&quot;grey&quot;) + theme_void() + scale_fill_manual(values=c(&quot;1&quot;=&quot;red&quot;, &quot;2&quot;=&quot;LightCyan&quot;, &quot;3&quot;=&quot;lightskyblue&quot;, &quot;4&quot;=&quot;DodgerBlue&quot;, &quot;5&quot;=&quot;MediumBlue&quot;)) + coord_cartesian(xlim = c(-11807982, 14807978)) + transition_time(year) # + # ease_aes(&quot;linear&quot;) + # enter_fade() + # exit_fade() animate(pml.ani, fps = 10, end_pause = 30, width = 750, height = 450, renderer = gifski_renderer()) anim_save(&quot;jour5014/pml2.gif&quot;, animation = last_animation()) knitr::include_graphics(&quot;jour5014/pml2.gif&quot;) "],["appendix.html", "Chapter 18 Appendix ", " Chapter 18 Appendix "],["dataset.html", "18.1 Dataset", " 18.1 Dataset 111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—è¡¨.xls - 111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—ç¸½è¡¨.xls è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv opendata107Y020.csv opendata110Y060.csv tptheft.csv tw_income_107.csv tw_population_opendata110N010.csv tw_salary109.xlsx villmast_excel.xls WORLD-MACHE_Gender_6.8.15.xls "],["wgoitg.html", "Chapter 19 WGOITG of NyTimes", " Chapter 19 WGOITG of NyTimes library(tidyverse) library(gghighlight) "],["inequality-net-worth-by-age-group.html", "19.1 Inequality: Net Worth by Age Group", " 19.1 Inequality: Net Worth by Age Group LEARNING NOTES åº§æ¨™è»¸å¾æ•¸å€¼åˆ°å¢åŠ å€¼ é€™å€‹æ•™å­¸æ¡ˆä¾‹ä¾†è‡ªç´ç´„æ™‚å ±çš„ã€ŒWhatâ€™s going on in this graghã€ç³»åˆ—è³‡æ–™è¦–è¦ºåŒ–æ•™å­¸ä¹‹Teach About Inequality With These 28 New York Times Graphs - The New York Times (nytimes.com) ã€‚è©²åœ–è¡¨å‘ˆç¾åœ¨ä¸åŒå¹´ä»£ã€ä¸åŒå¹´é½¡å±¤çš„äººæ‰€æ“æœ‰çš„æ·¨è³‡ç”¢ï¼ˆåŒ…å«åœŸåœ°ã€å­˜æ¬¾ã€æŠ•è³‡ç­‰æ¸›å»å‚µå‹™ï¼‰ã€‚è©²åœ–è¡¨çš„çµæœæŒ‡å‡ºï¼Œåœ¨ä¸åŒå¹´ä»£çš„è€å¹´äººæ˜¯è¶Šä¾†è¶Šæœ‰éŒ¢ï¼Œä½†å¹´è¼•äººå»è¶Šä¾†è¶Šçª®ï¼ˆè©²æ›²ç·šç‚ºæ¸›å»1989å¹´ Sorted by arrange() function. p1 &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(year, Category, Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% ungroup() p1 %&gt;% filter(year &lt;= 1992) %&gt;% knitr::kable() p1 %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line(linetype=&quot;dotted&quot;) + geom_point() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;, size = 0.5, linetype = &quot;solid&quot;)) p2 &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(year, Category, NW = Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% mutate(increase = (NW-first(NW))/first(NW)) %&gt;% ungroup() p2 %&gt;% filter(year &lt;= 1992) %&gt;% knitr::kable() p2 %&gt;% ggplot() + aes(year, increase, color = Category) + geom_line(linetype=&quot;dotted&quot;) + geom_point() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_y_continuous(labels=scales::parse_format()) + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;, size = 0.5, linetype = &quot;solid&quot;)) "],["unicef-global-survey-optimism.html", "19.2 UNICEF-Global Survey Optimism", " 19.2 UNICEF-Global Survey Optimism é‹ç”¨ç­‰æ¯”ä¾‹ä¹‹åº§æ¨™è»¸ https://www.nytimes.com/2021/11/17/upshot/global-survey-optimism.html https://changingchildhood.unicef.org/about plot.opt &lt;- read_csv(&quot;nytdata/unicef-changing-childhood-data.csv&quot;) %&gt;% select(country = WP5, age = WP22140, bw = WP22092) %&gt;% mutate(country = ordered(country, levels=c(1, 3, 4, 10, 11, 12, 13, 14, 17, 29, 31, 33, 35, 36, 60, 61, 77, 79, 81, 87, 165), labels=c(&quot;USA&quot;, &quot;Morocco&quot;, &quot;Lebanon&quot;, &quot;Indonesia&quot;, &quot;Bangladesh&quot;, &quot;UK&quot;, &quot;France&quot;, &quot;Germany&quot;, &quot;Spain&quot;, &quot;Japan&quot;, &quot;India&quot;, &quot;Brazil&quot;, &quot;Nigeria&quot;, &quot;Kenya&quot;, &quot;Ethiopia&quot;, &quot;Mali&quot;, &quot;Ukraine&quot;, &quot;Cameroon&quot;, &quot;Zimbabwe&quot;, &quot;Argentina&quot;, &quot;Peru&quot;))) %&gt;% count(country, age, bw) %&gt;% group_by(country, age) %&gt;% mutate(perc = n/sum(n)) %&gt;% ungroup() %&gt;% filter(bw == 1) %&gt;% select(country, age, perc) %&gt;% spread(age, perc) %&gt;% rename(`15-24y` = `1`, `40+y` = `2`) plot.opt %&gt;% head(10) %&gt;% knitr::kable() plot.opt %&gt;% ggplot() + aes(`40+y`, `15-24y`, label = country) + geom_point(color = &quot;skyblue&quot;, size = 2) + xlim(0, 1) + ylim(0,1) + geom_text(hjust = -0.1, vjust = -0.5) + geom_abline(intercept = 0, slop = 1, color=&quot;lightgrey&quot;, alpha=0.5, linetype=&quot;dashed&quot;) + theme_minimal() + theme(aspect.ratio=1) "],["global-carbon-projects.html", "19.3 Global Carbon Projects", " 19.3 Global Carbon Projects Who Has The Most Historical Responsibility for Climate Change? - The New York Times (nytimes.com) totreemap &lt;- read_csv(&quot;nytdata/GCB2021v34_MtCO2_flat.csv&quot;) %&gt;% drop_na(`Total`) %&gt;% filter(!Country %in% c(&quot;Global&quot;, &quot;International Transport&quot;)) %&gt;% filter(Year==2020) %&gt;% arrange(desc(`Total`)) %&gt;% mutate(perc = Total/sum(Total)) %&gt;% slice(1:20) library(treemapify) totreemap %&gt;% ggplot() + aes(area = perc, fill=`Per Capita`, label=Country) + geom_treemap() + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=TRUE ) "],["taiwan.html", "Chapter 20 Case Studies (Taiwan) ", " Chapter 20 Case Studies (Taiwan) "],["tw-aqi-visual-studies.html", "20.1 TW AQI Visual Studies", " 20.1 TW AQI Visual Studies library(tidyverse) library(readxl) # options(stringsAsFactors = F) aqi_data &lt;- read_rds(&quot;https://github.com/p4css/R4CSS/raw/master/data/AQI_Chaozhou.rds&quot;) 20.1.1 Trending: Central tendency toplot &lt;- aqi_data %&gt;% arrange(æ—¥æœŸ)%&gt;% filter(æ¸¬é …==&quot;PM2.5&quot;) %&gt;% gather(&quot;hour&quot;, &quot;PM25&quot;, 4:28) %&gt;% mutate(PM25 = as.numeric(PM25)) %&gt;% drop_na() %&gt;% group_by(æ—¥æœŸ) %&gt;% summarize(avg = mean(PM25)) %&gt;% ungroup() %&gt;% mutate(year = lubridate::year(æ—¥æœŸ), month = lubridate::month(æ—¥æœŸ)) %&gt;% group_by(year, month) %&gt;% summarize(avg = mean(avg)) %&gt;% ungroup() Counting data by month and plotting to ensure the degree of data loss. aqi_data %&gt;% filter(æ¸¬é …==&quot;PM2.5&quot;) %&gt;% arrange(æ—¥æœŸ)%&gt;% gather(&quot;hour&quot;, &quot;PM25&quot;, 4:28) %&gt;% mutate(PM25 = as.numeric(PM25)) %&gt;% drop_na() %&gt;% group_by(æ—¥æœŸ) %&gt;% summarize(avg = mean(PM25)) %&gt;% ungroup() %&gt;% arrange(æ—¥æœŸ) %&gt;% mutate(year = lubridate::year(æ—¥æœŸ), month = lubridate::month(æ—¥æœŸ)) %&gt;% count(year, month) %&gt;% mutate(rn = row_number()) %&gt;% ggplot() + aes(rn, n) + geom_line() + theme_minimal() ç§‘æ™®å°å­¸å ‚-ç©ºæ°£ä¸­çš„æ‡¸æµ®ç²’å­ å°ç£PM2.5ä¸‰å¤§é¢å‘ï¼šç©ºæ±™ç¾æ³å¤šåš´é‡ï¼Ÿè¦æ€ªä¸­åœ‹é‚„æ˜¯æ€ªè‡ªå·±ï¼Ÿ - ç¬¬ 1 é  - The News Lens é—œéµè©•è«–ç¶² library(gghighlight) toplot %&gt;% mutate(month = as.character(month)) %&gt;% group_by(month) %&gt;% arrange(year) %&gt;% # mutate(diff = avg -first(avg), # month = as.character(month)) %&gt;% # ungroup() %&gt;% ggplot() + aes(year, avg, color = month) + geom_line() + # geom_point() + gghighlight(month %in% c(&quot;11&quot;, &quot;12&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;)) + theme_minimal() 20.1.2 Trending: Extreme value toplot2 &lt;- aqi_data %&gt;% arrange(æ—¥æœŸ)%&gt;% filter(æ¸¬é …==&quot;PM2.5&quot;) %&gt;% gather(&quot;hour&quot;, &quot;PM25&quot;, 4:28) %&gt;% mutate(PM25 = as.numeric(PM25)) %&gt;% drop_na() %&gt;% group_by(æ—¥æœŸ) %&gt;% summarize(avg = sum(PM25)/24) %&gt;% ungroup() %&gt;% mutate(year = lubridate::year(æ—¥æœŸ), month = lubridate::month(æ—¥æœŸ)) %&gt;% group_by(year, month) %&gt;% summarize(purple = sum(avg&gt;150), red = sum(avg&gt;54), orange = sum(avg&gt;35)) %&gt;% ungroup() toplot2 %&gt;% mutate(month = as.character(month)) %&gt;% group_by(month) %&gt;% arrange(year) %&gt;% ggplot() + aes(year, orange, color = month) + geom_line() + # geom_point() + gghighlight(month %in% c(&quot;11&quot;, &quot;12&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;)) + ylab(&quot;Days (PM25 &gt; 35) in one month&quot;) + theme_minimal() toplot3 &lt;- aqi_data %&gt;% arrange(æ—¥æœŸ)%&gt;% filter(æ¸¬é …==&quot;PM2.5&quot;) %&gt;% gather(&quot;hour&quot;, &quot;PM25&quot;, 4:28) %&gt;% mutate(PM25 = as.numeric(PM25)) %&gt;% drop_na() %&gt;% mutate(year = lubridate::year(æ—¥æœŸ), month = lubridate::month(æ—¥æœŸ)) %&gt;% filter(month %in% c(11, 12, 1, 2, 3)) toplot3 %&gt;% mutate(year = as.character(year)) %&gt;% ggplot() + aes(y=year, x=PM25) + geom_boxplot(fill=&quot;skyblue&quot;, alpha=0.2) + xlim(0, 200) + theme_minimal() "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
