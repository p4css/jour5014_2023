[["amount.html", "Chapter 19 AMOUNT 19.1 Heatmap: Vaccination", " Chapter 19 AMOUNT 19.1 Heatmap: Vaccination https://ourworldindata.org/covid-vaccinations https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations library(lubridate) raw &lt;- read_csv(&quot;data/vaccinations.csv&quot;) fullvaccinated &lt;- raw %&gt;% select(country = location, date, people_fully_vaccinated_per_hundred) %&gt;% drop_na(people_fully_vaccinated_per_hundred) %&gt;% mutate(m = floor_date(date, unit = &quot;month&quot;)) %&gt;% group_by(country, m) %&gt;% arrange(date) %&gt;% slice(1) %&gt;% ungroup() %&gt;% select(-date) vperc_by_month &lt;- fullvaccinated %&gt;% spread(m, people_fully_vaccinated_per_hundred, fill=NA) %&gt;% gather(month, perc, -country) %&gt;% arrange(country, month) %&gt;% group_by(country) %&gt;% arrange(month) %&gt;% mutate(perc = zoo::na.locf(perc, na.rm = F)) %&gt;% ungroup() %&gt;% arrange(country, month) %&gt;% replace_na(list(perc=0)) https://clauswilke.com/dataviz/visualizing-amounts.html watched &lt;- c(&quot;United Arab Emirates&quot;, &quot;Japan&quot;, &quot;Singapore&quot;, &quot;South Korea&quot;, &quot;Taiwan&quot;, &quot;Malaysia&quot;, &quot;Hong Kong&quot;, &quot;New Zealand&quot;, &quot;Thailand&quot;, &quot;Netherlands&quot;, &quot;United States&quot;, &quot;Israel&quot;, &quot;United Kingdom&quot;, &quot;Indonesia&quot;, &quot;Thailand&quot;, &quot;Philippines&quot;) vperc_by_month %&gt;% spread(month, perc) %&gt;% filter(country %in% watched) %&gt;% mutate(country = reorder(country, -`2022-05-01`)) %&gt;% gather(month, perc, -country) %&gt;% ggplot() + aes(month, country, fill=perc) + geom_tile() + theme_minimal() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) https://clauswilke.com/dataviz/visualizing-amounts.html vperc_by_month %&gt;% filter(country %in% watched) %&gt;% mutate(month = lubridate::as_date(month)) %&gt;% group_by(country) %&gt;% mutate(month1 = min((month[perc &gt; 20]))) %&gt;% ungroup() %&gt;% spread(month, perc) %&gt;% mutate(country = reorder(country, -as.numeric(month1))) %&gt;% select(-month1) %&gt;% gather(month, perc, -country) %&gt;% ggplot() + aes(month, country, fill=perc) + geom_tile() + theme_minimal() + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
