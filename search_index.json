[["index.html", "R for Data Journalism About", " R for Data Journalism HSIEH, JI-LUNG 2022-05-03 About This is a sample book written in Markdown. You can use anything that Pandocâ€™s Markdown supports, e.g., a math equation \\(a^2 + b^2 = c^2\\). The bookdown package can be installed from CRAN or Github: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Remember each Rmd file contains one and only one chapter, and a chapter is defined by the first-level heading #. To compile this example to PDF, you need XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): https://yihui.name/tinytex/. "],["basic.html", "Chapter 1 R Basic", " Chapter 1 R Basic "],["playing-r-with-r-markdown.html", "Chapter 2 Playing R with R Markdown 2.1 Loading dcard data 2.2 Getting Taipei theft report data", " Chapter 2 Playing R with R Markdown Using Cmd+Enter (Ctrl+Enter in Window) to excute the line where your cursor is located. Using Cmd(Ctrl)+Shift+Enter to run all code in a cell Using mouse to select multiple lines, then Cmd(Ctrl)+Shift+c to comment/uncomment multiple lines. a &lt;- c(1, 2, 3, 4, 5) b &lt;- 4 a*b ## [1] 4 8 12 16 20 2.0.1 Inserting a new code cell Using Cmd(Ctrl)+Option(Alt)+i to insert a new cell 2.0.2 Installing and loading packages å¥—ä»¶çš„ä½¿ç”¨åˆ†ç‚ºå®‰è£å’Œè¼‰å…¥å…©å€‹å‹•ä½œã€‚é€šå¸¸å®‰è£å¥½Rçš„æ™‚å€™å°±å·²ç¶“å®‰è£å¥½åŸºæœ¬baseå¥—ä»¶ã€‚ç•¶åŸ·è¡ŒRæ™‚ä¾¿æœƒå°‡baseå¥—ä»¶é è¼‰å…¥ç¨‹å¼çš„åŸ·è¡Œç’°å¢ƒä¸­ã€‚ éå¸¸å¤šçš„Rä½¿ç”¨è€…æœƒç·¨å¯«ç¬¬ä¸‰æ–¹å¥—ä»¶ï¼Œä¸¦ä¸”å°‡é€™äº›å¥—ä»¶é–‹æ”¾çµ¦ç¾¤çœ¾ä½¿ç”¨ã€‚é€šå¸¸é€™äº›å¥—ä»¶å·²ç¶“è¢«ä¸Šè¼‰åˆ°R cranæä¾›ä¸‹è¼‰ã€‚è€ŒR cranä¸Šçš„å¥—ä»¶æˆ‘å€‘å¯ä»¥ä½¿ç”¨install.packages(\"package_name\")ä¾†è‡ªå‹•å®‰è£åˆ°æˆ‘å€‘çš„é›»è…¦ä¸­ã€‚ 2.0.3 Install following packages at home Remove comment # symbol to install new package # install.packages(&quot;jsonlite&quot;) # install.packages(&quot;httr&quot;) # install.packages(&quot;tidyverse&quot;) # install.packages(&quot;caret&quot;) # install.packages(&quot;jiebaR&quot;) # install.packages(&quot;topicmodels&quot;) # install.packages(&quot;stm&quot;) 2.0.4 Loading third-party packages é€™äº›ç¬¬ä¸‰æ–¹å¥—ä»¶è¢«å®‰è£å¥½å¾Œï¼Œé‚„éœ€è¦è¢«åŠ è¼‰åˆ°ç¨‹å¼çš„åŸ·è¡Œç’°å¢ƒä¸­æ‰å¯ä»¥ä½¿ç”¨ã€‚å› æ­¤è¦ç”¨library(package_name)å°‡å…¶è¼‰å…¥ã€‚ # loading jsonlite and httr library library(jsonlite) library(httr) 2.0.5 è¨»è§£ ä¸‹åˆ—ç¨‹å¼ç¢¼ä¸­é–‹é ­æœ‰#ç¬¦è™Ÿè€…ç‚ºè¨»è§£ï¼Œç¨‹å¼åœ¨åŸ·è¡Œæ™‚æœƒè‡ªå‹•å¿½ç•¥å‰é¢æœ‰#ç¬¦è™Ÿçš„ç¨‹å¼ç¢¼ã€‚ ç•¶ä½¿ç”¨RMarkdownæ ¼å¼æ’°å¯«æ™‚ï¼Œå› ç‚ºRMarkdownæ˜¯åœ¨äº‹å¾Œæ‰ç”Ÿæˆæ–‡ä»¶ï¼Œæ‰€ä»¥ç•¶é‡åˆ°è¦å®‰è£è©²å¥—ä»¶çš„æŒ‡ä»¤æ™‚ï¼Œä¾¿æœƒè·³å‡ºéŒ¯èª¤è¨Šæ¯ã€‚ # a &lt;- c(1, 2, 3, 4, 5) # b &lt;- 4 # a*b 2.1 Loading dcard data å…ˆä¸è¦å»ç®¡fromJSON(content(GET(url), \"text\"))æ˜¯ä»€éº¼æ„æ€ï¼Œå…ˆè‘—é‡åœ¨èªè¨€çš„å½¢å¼ã€‚é€šå¸¸ä¸€å€‹å‡½å¼æœƒå¯«ç‚ºfunc_name()ï¼Œæ‰€ä»¥ä¸Šè¿°å…¶å¯¦æ˜¯ä¸‰å€‹å‡½å¼ç”±å…§è€Œå¤–ä¸€å±¤å¥—ä¸€å±¤ï¼Œå¾æœ€å…§å±¤é–‹å§‹å¾€å¤–åšã€‚ é€™å…¶å¯¦å¾ˆmake-senseï¼Œå› ç‚ºå¦‚æœä½ æœ‰ä¸€å€‹æ•¸å­¸å¼(1 + (3-3)/2)/8ï¼Œä¹Ÿæ˜¯æœƒå¾æœ€è£¡é¢é‚£å±¤åšå‡ºä¾†ã€‚ library(jsonlite) library(httr) url &lt;- &quot;https://www.dcard.tw/_api/forums/relationship/posts?popular=true&quot; res &lt;- fromJSON(content(GET(url), &quot;text&quot;)) dplyr::glimpse(res) ## Rows: 30 ## Columns: 51 ## $ id &lt;int&gt; 235931948, 238771761, 238779545, 238778979, 23877â€¦ ## $ title &lt;chr&gt; &quot;#å…¬å‘Š é—œæ–¼æ„Ÿæƒ…æ¿çš„å¾®è¥¿æ–¯å…§å®¹&quot;, &quot;å®¹æ˜“é‡åˆ°æ¸£ç”·æ¸£å¥³â€¦ ## $ excerpt &lt;chr&gt; &quot;å„ä½å¡å‹å€‘å¥½ï¼Œå°å¤©ä½¿è¿‘æœŸæ”¶åˆ°è¨±å¤šé—œæ–¼æ„Ÿæƒ…æ¿è¥¿æ–¯å…§â€¦ ## $ anonymousSchool &lt;lgl&gt; FALSE, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE,â€¦ ## $ anonymousDepartment &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, Tâ€¦ ## $ pinned &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, Fâ€¦ ## $ forumId &lt;chr&gt; &quot;42851318-b9e2-4a75-8a05-9fe180becefe&quot;, &quot;42851318â€¦ ## $ replyId &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ createdAt &lt;chr&gt; &quot;2021-05-07T06:11:32.413Z&quot;, &quot;2022-05-02T03:11:52.â€¦ ## $ updatedAt &lt;chr&gt; &quot;2021-05-07T18:00:24.726Z&quot;, &quot;2022-05-02T03:12:12.â€¦ ## $ commentCount &lt;int&gt; 34, 149, 141, 116, 11, 228, 41, 43, 99, 71, 48, 3â€¦ ## $ likeCount &lt;int&gt; 321, 660, 477, 452, 288, 278, 267, 152, 140, 140,â€¦ ## $ withNickname &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FAâ€¦ ## $ tags &lt;list&gt; &quot;HIDE_THUMBNAIL&quot;, &lt;&gt;, &lt;&gt;, &quot;HIDE_THUMBNAIL&quot;, &quot;HIDâ€¦ ## $ topics &lt;list&gt; &lt;&gt;, &lt;&quot;MBTI&quot;, &quot;æ¸£ç”·&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ¸£å¥³&quot;, &quot;äººæ ¼&quot;&gt;, &lt;&quot;â€¦ ## $ meta &lt;df[,3]&gt; &lt;data.frame[26 x 3]&gt; ## $ forumName &lt;chr&gt; &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;, &quot;æ„Ÿæƒ…&quot;â€¦ ## $ forumAlias &lt;chr&gt; &quot;relationship&quot;, &quot;relationship&quot;, &quot;relationship&quot;, &quot;â€¦ ## $ nsfw &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ gender &lt;chr&gt; &quot;D&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;,â€¦ ## $ school &lt;chr&gt; &quot;å®¢æœå°å¤©ä½¿&quot;, NA, NA, NA, &quot;æŠ¹èŒ¶æ§çš„è²“å¥´&quot;, NA, NA,â€¦ ## $ department &lt;chr&gt; &quot;dcard_support_1&quot;, NA, NA, NA, &quot;fish0227&quot;, NA, NAâ€¦ ## $ replyTitle &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ mediaMeta &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[5 x 10]&gt;], [&lt;â€¦ ## $ reactions &lt;list&gt; [&lt;data.frame[4 x 2]&gt;], [&lt;data.frame[4 x 2]&gt;], [&lt;â€¦ ## $ hidden &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,â€¦ ## $ customStyle &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ isSuspiciousAccount &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ isModerator &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ layout &lt;chr&gt; &quot;classic&quot;, &quot;classic&quot;, &quot;classic&quot;, &quot;classic&quot;, &quot;clasâ€¦ ## $ pinnedType &lt;chr&gt; &quot;dcard&quot;, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, â€¦ ## $ pinnedPriority &lt;dbl&gt; 1.620368e+12, NA, NA, NA, NA, NA, NA, NA, NA, NA,â€¦ ## $ spoilerAlert &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ categories &lt;list&gt; &quot;å…¬å‘Š&quot;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;â€¦ ## $ isSelectedPost &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,â€¦ ## $ unsafe &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ totalCommentCount &lt;int&gt; 34, 268, 200, 225, 23, 349, 65, 115, 277, 120, 66â€¦ ## $ withImages &lt;lgl&gt; FALSE, TRUE, TRUE, FALSE, FALSE, TRUE, FALSE, FALâ€¦ ## $ withVideos &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, â€¦ ## $ media &lt;list&gt; [&lt;data.frame[0 x 0]&gt;], [&lt;data.frame[4 x 1]&gt;], [&lt;dâ€¦ ## $ reportReasonText &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, â€¦ ## $ supportedReactions &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, Nâ€¦ ## $ excerptComments &lt;list&gt; [], [], [], [], [], [], [], [], [], [], [], [], [â€¦ ## $ edited &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,â€¦ ## $ collectionCount &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0â€¦ ## $ postAvatar &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;â€¦ ## $ activityAvatar &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;â€¦ ## $ verifiedBadge &lt;lgl&gt; TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, Fâ€¦ ## $ memberType &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;â€¦ ## $ enablePrivateMessage &lt;lgl&gt; NA, FALSE, FALSE, FALSE, FALSE, NA, NA, NA, FALSEâ€¦ ## $ enableNestedComment &lt;lgl&gt; NA, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUâ€¦ head(res) id title excerpt anonymousSchool anonymousDepartment pinned forumId replyId createdAt updatedAt commentCount likeCount withNickname tags topics meta forumName forumAlias nsfw gender school department replyTitle mediaMeta reactions hidden customStyle isSuspiciousAccount isModerator layout pinnedType pinnedPriority spoilerAlert categories isSelectedPost unsafe totalCommentCount withImages withVideos media reportReasonText supportedReactions excerptComments edited collectionCount postAvatar activityAvatar verifiedBadge memberType enablePrivateMessage enableNestedComment 235931948 #å…¬å‘Š é—œæ–¼æ„Ÿæƒ…æ¿çš„å¾®è¥¿æ–¯å…§å®¹ å„ä½å¡å‹å€‘å¥½ï¼Œå°å¤©ä½¿è¿‘æœŸæ”¶åˆ°è¨±å¤šé—œæ–¼æ„Ÿæƒ…æ¿è¥¿æ–¯å…§å®¹çš„æª¢èˆ‰ä»¥åŠç›¸é—œè©¢å•ï¼Œæˆ‘å€‘äº†è§£æ„Ÿæƒ…æ¿æ˜¯ç‚ºè¨è«–æƒ…æ„Ÿé—œä¿‚æ‰€è¨­ç«‹ï¼Œè€Œã€Œæ€§ã€ä¹Ÿæ˜¯æ„Ÿæƒ…ä¸­çš„ä¸€éƒ¨ä»½ï¼Œå› æ­¤ä¸æœƒç¦æ­¢è¨è«–é€™äº›å…§å®¹ã€‚ä½†æœ‰éƒ¨åˆ†æ–‡ç« å…§å®¹æè¿°éæ–¼éœ²éª¨ï¼Œæˆ–æ˜¯é™¤äº† FALSE TRUE TRUE 42851318-b9e2-4a75-8a05-9fe180becefe NA 2021-05-07T06:11:32.413Z 2021-05-07T18:00:24.726Z 34 321 TRUE HIDE_THUMBNAIL classic æ„Ÿæƒ… relationship FALSE D å®¢æœå°å¤©ä½¿ dcard_support_1 NA NULL 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, aa0d425f-d530-4478-9a77-fe3aedc79eea, 4b018f48-e184-445f-adf1-fc8e04ba09b9, 314 , 4 , 2 , 1 FALSE NA FALSE FALSE classic dcard 1.620368e+12 FALSE å…¬å‘Š FALSE FALSE 34 FALSE FALSE NULL NA NULL FALSE 0 TRUE NA NA 238771761 å®¹æ˜“é‡åˆ°æ¸£ç”·æ¸£å¥³çš„å…©ç¨®äººæ ¼ï¼šINFP å’Œ ISFJ ä¸çŸ¥é“å¤§å®¶æœ‰æ²’æœ‰æ¸¬é MBTIï¼Œæœ€è¿‘å¹´è¼•äººå¥½åƒæ¯”è¼ƒä¸æœƒå•ï¼šæ˜Ÿåº§ï¼Œè€Œæ˜¯å•ï¼šã€Œä½ çš„ MBTI æ˜¯ä»€éº¼ï¼Ÿã€å°å°è§£é‡‹ä¸€ä¸‹MBTIï¼ŒMBTI åˆç¨±ç‚ºã€Œåå…­å‹äººæ ¼æ¸¬é©—ã€ï¼ˆMyers-Briggs Type Ind TRUE TRUE FALSE 42851318-b9e2-4a75-8a05-9fe180becefe NA 2022-05-02T03:11:52.025Z 2022-05-02T03:12:12.442Z 149 660 FALSE MBTI, æ¸£ç”·, æ„Ÿæƒ…, æ¸£å¥³, äººæ ¼ classic æ„Ÿæƒ… relationship FALSE F NA NA NA 3b2426d9-6f57-44ab-a383-074c09e587e4, 3b2426d9-6f57-44ab-a383-074c09e587e4, eb002d74-76a2-47b2-b180-de7877741d13, 1cdde21e-7d2e-40cd-9560-01026dce92d8, 51d7f213-29fd-41e2-82ed-5cabdf4de118, https://i.imgur.com/T0cxbWLl.jpg , https://i.imgur.com/T0cxbWL.png , https://i.imgur.com/4yyPsKf.png , https://i.imgur.com/yrdnvz6.png , https://i.imgur.com/G975UPR.png , https://i.imgur.com/T0cxbWLl.jpg , https://imgur.com/T0cxbWL , https://imgur.com/4yyPsKf , https://imgur.com/yrdnvz6 , https://imgur.com/G975UPR , https://i.imgur.com/T0cxbWLl.jpg , https://i.imgur.com/T0cxbWLl.jpg , https://i.imgur.com/4yyPsKfl.jpg , https://i.imgur.com/yrdnvz6l.jpg , https://i.imgur.com/G975UPRl.jpg , image/thumbnail , image/imgur , image/imgur , image/imgur , image/imgur , ANNOTATED , ANNOTATED , ANNOTATED , ANNOTATED , ANNOTATED , 2022-05-02T03:11:52.025Z , 2022-05-02T03:11:52.025Z , 2022-05-02T03:11:52.025Z , 2022-05-02T03:11:52.025Z , 2022-05-02T03:11:52.025Z , 2022-05-02T03:12:12.442Z , 2022-05-02T03:12:12.442Z , 2022-05-02T03:12:12.442Z , 2022-05-02T03:12:12.442Z , 2022-05-02T03:12:12.442Z , 1024 , 1024 , 816 , 816 , 310 , 768 , 768 , 680 , 680 , 307 286f599c-f86a-4932-82f0-f5a06f1eca03, 514c2569-fd53-4d9d-a415-bf0f88e7329f, e8e6bc5d-41b0-4129-b134-97507523d7ff, 4b018f48-e184-445f-adf1-fc8e04ba09b9, 638 , 14 , 6 , 2 FALSE NA FALSE FALSE classic NA NA FALSE NULL FALSE FALSE 268 TRUE FALSE https://i.imgur.com/T0cxbWL.png, https://i.imgur.com/4yyPsKf.png, https://i.imgur.com/yrdnvz6.png, https://i.imgur.com/G975UPR.png NA NULL FALSE 0 FALSE FALSE TRUE 238779545 ç¬¬ä¸€æ¬¡è¦‹é¢ç¶²å‹èªªæˆ‘è¶…é†œ æˆ‘æœ¬èº«å°±æœ‰ç•°ä½æ€§çš®è†šç‚ï¼ˆçœŸçš„ç®—è »åš´é‡çš„é‚£ç¨®ï¼‰å¾ˆå¸¸éæ•ä»€éº¼ã„‰ ä¹Ÿæœ‰åœ¨åƒè—¥ åŠ ä¸Šé€™å¹¾å¤©å¤©æ°£è®ŠåŒ–å¾ˆå¤§ éæ•åˆæ›´åš´é‡ è‡‰éƒ½æ˜¯ç´…ã„‰ æˆ‘æ‰¿èªæˆ‘çš„çš®è†šçœŸçš„å¾ˆå·®à²¥_à²¥ ç„¶å¾Œå› ç‚ºéæ•é»‘çœ¼åœˆé‚„è¶…é‡à²¥_à²¥ï¼Œå¥½ å°±æ˜¯å‘¢ï¼æ˜¨å¤© TRUE TRUE FALSE 42851318-b9e2-4a75-8a05-9fe180becefe NA 2022-05-02T19:07:26.738Z 2022-05-03T08:25:08.143Z 141 477 FALSE è¦‹é¢, ç¶²å‹ classic æ„Ÿæƒ… relationship FALSE F NA NA NA 64757979-69f9-40ac-a8f4-a23c82535882 , https://sticker-assets.dcard.tw/images/6af40cc5-9b57-4fa2-923f-40af82949f62/orig.png, https://megapx.dcard.tw/v1/images/6af40cc5-9b57-4fa2-923f-40af82949f62 , , image/sticker , IMAGE_NOT_AVAILABLE , 2022-05-02T19:07:26.738Z , 2022-05-03T08:25:08.143Z , 512 , 512 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, 514c2569-fd53-4d9d-a415-bf0f88e7329f, 4b018f48-e184-445f-adf1-fc8e04ba09b9, aa0d425f-d530-4478-9a77-fe3aedc79eea, 416 , 40 , 14 , 5 , 2 FALSE NA FALSE FALSE classic NA NA FALSE NULL FALSE FALSE 200 TRUE FALSE https://sticker-assets.dcard.tw/images/6af40cc5-9b57-4fa2-923f-40af82949f62/orig.png NA NULL FALSE 0 FALSE FALSE TRUE 238778979 ç”·å‹è¦ºå¾—æˆ‘è·Ÿä»–åœ¨ä¸€èµ·å°±åªæ˜¯æƒ³æ‰“ç ²è€Œå·² èªªçœŸçš„æˆ‘å€‘ç›¸è™•æ°¸é éƒ½æ˜¯åœ¨å®¶ï¼ˆçœ‹ä»–ç¡è¦ºï¼Œä¸ç„¶å°±æ˜¯é¨è‘—è»Šå¸¶è‘—æˆ‘åˆ°è™•äº‚é¨æ²’æœ‰ç›®çš„==ï¼Œä¹Ÿå¾ˆå°‘å¸¶æˆ‘å‡ºå»ç©ï¼Œæœ€è¿‘ä¹Ÿå¾ˆå°‘è¦‹é¢ï¼Œå‰é™£å­æœˆç¶“å‰›èµ°å®Œè·Ÿä»–èªªï¼Œä»–å»è¦ºå¾—æˆ‘åœ¨æš—ç¤ºä»–åªæŠŠä»–ç•¶ç ²å‹ï¼Ÿï¼Ÿæˆ‘èªç‚ºæ€§ç”Ÿæ´»å¯ä»¥è®“æ„Ÿæƒ…å‡æº«ä½† TRUE TRUE FALSE 42851318-b9e2-4a75-8a05-9fe180becefe NA 2022-05-02T17:20:46.591Z 2022-05-03T07:00:23.375Z 116 452 FALSE HIDE_THUMBNAIL ç”·å‹ , å¾®è¥¿æ–¯, åœ¨ä¸€èµ·, æ„Ÿæƒ… classic æ„Ÿæƒ… relationship FALSE F NA NA NA NULL 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, 514c2569-fd53-4d9d-a415-bf0f88e7329f, 4b018f48-e184-445f-adf1-fc8e04ba09b9, 410 , 37 , 3 , 2 FALSE NA FALSE FALSE classic NA NA FALSE NULL FALSE FALSE 225 FALSE FALSE NULL NA NULL FALSE 0 FALSE FALSE TRUE 238773580 çœŸçš„æ„›å°±æœƒä¿®è£œæ„›ğŸ˜Š å…©å€‹è§€å¿µï¼Œ1.å¦‚æœå½¼æ­¤æ˜¯é©åˆçš„äººï¼Œè‹¥ç™¼ç”Ÿåµæ¶å°±æ˜¯ä½ å€‘ç£¨åˆçš„éç¨‹ã€‚2.ä¸è¦å®³æ€•åµæ¶ï¼Œæœ‰è¨±å¤šäººæœƒè¦ºå¾—åµæ¶å¾ˆå‚·æ„Ÿæƒ…ï¼Œå¾ˆå®¹æ˜“æŠŠä¹‹å‰é‚£ç¨®ç”œèœœçš„æ„Ÿè¦ºæ¯€æ»…äº†ï¼Œæ–¼æ˜¯å°±ä¸€ç›´å¿è‘—ä¸åµï¼Œå¿è‘—ä¸åµå°±ä¸æœƒåµå—ï¼Ÿå¿åˆ°æœ€å¾Œä¸€å€‹é»ä¸Š FALSE TRUE FALSE 42851318-b9e2-4a75-8a05-9fe180becefe NA 2022-05-02T07:13:41.278Z 2022-05-02T07:24:57.772Z 11 288 TRUE HIDE_THUMBNAIL æ„› , æ„Ÿæƒ… classic æ„Ÿæƒ… relationship FALSE F æŠ¹èŒ¶æ§çš„è²“å¥´ fish0227 NA NULL 286f599c-f86a-4932-82f0-f5a06f1eca03, 011ead16-9b83-4729-9fde-c588920c6c2d, 287 , 1 FALSE NA FALSE FALSE classic NA NA FALSE NULL FALSE FALSE 23 FALSE FALSE NULL NA NULL FALSE 0 FALSE FALSE TRUE 238773422 æˆ‘æ‡·å­•äº† ç”·å‹ä¸è¦å°å­© ä»–åª½åª½èªªæˆ‘ç„¡æ³•èå…¥ä»–å€‘å®¶ é‚„èªªæˆ‘æ…‹åº¦ä¸ä½³ ä»¥å‰æˆ‘ç”·å‹å¸¸èªª æœ‰äº†å°±ç”Ÿ ä¸ç„¶æ€éº¼è¾¦ï¼Œæˆ‘ç›¸ä¿¡ä»–äº†ï¼Œæœˆç¶“æ²’ä¾† é©—å­•æ²’æœ‰ ä»¥ç‚ºæ˜¯èº«é«”å•é¡Œ å»çœ‹äº†å©¦ç”¢ç§‘ ç•¶æ™‚é©—åˆ°äº† æˆ‘æ‡·å­•äº† æˆ‘æ˜¯é–‹å¿ƒçš„ æœŸå¾…çš„ å°æˆ‘ä¾†èªªå¹¸ç¦çš„ï¼Œæˆ‘å€‘éƒ½æ²’ä»€éº¼å­˜æ¬¾ æ‰€ä»¥æˆ‘æƒ³ è©²æ€éº¼è¾¦å‘¢ ä½† TRUE TRUE FALSE 42851318-b9e2-4a75-8a05-9fe180becefe NA 2022-05-02T06:55:55.329Z 2022-05-02T06:55:55.329Z 228 278 FALSE æ‡·å­• , ç”·å‹ , å°å­© , å©†åª³å•é¡Œ, æ„Ÿæƒ… classic æ„Ÿæƒ… relationship FALSE F NA NA NA d6c633bb-959c-4644-b5b2-9cf8db18245d, d6c633bb-959c-4644-b5b2-9cf8db18245d, https://i.imgur.com/MDH8hcHl.jpg , https://i.imgur.com/MDH8hcH.jpg , https://i.imgur.com/MDH8hcHl.jpg , https://imgur.com/MDH8hcH , https://i.imgur.com/MDH8hcHl.jpg , https://i.imgur.com/MDH8hcHl.jpg , image/thumbnail , image/imgur , 2022-05-02T06:55:55.329Z , 2022-05-02T06:55:55.329Z , 2022-05-02T06:55:55.329Z , 2022-05-02T06:55:55.329Z , 828 , 828 , 1402 , 1402 286f599c-f86a-4932-82f0-f5a06f1eca03, e8e6bc5d-41b0-4129-b134-97507523d7ff, 514c2569-fd53-4d9d-a415-bf0f88e7329f, aa0d425f-d530-4478-9a77-fe3aedc79eea, 4b018f48-e184-445f-adf1-fc8e04ba09b9, 232 , 28 , 12 , 4 , 2 FALSE NA FALSE FALSE classic NA NA FALSE NULL FALSE FALSE 349 TRUE FALSE https://i.imgur.com/MDH8hcH.jpg NA NULL FALSE 0 FALSE NA TRUE # View(res) 2.2 Getting Taipei theft report data 2.2.1 Getting from the web directly Go to data.taipei Make a query â€œä½å®…ç«Šç›œâ€ Open â€œä½å®…ç«Šç›œé»ä½è³‡è¨Šâ€ Click â€œAPIâ€ Copy the API address and assign to url url &lt;- &quot;https://data.taipei/api/v1/dataset/93d9bc2d-af08-4db7-a56b-9f0a49226fa3?scope=resourceAquire&quot; df &lt;- read_json(url, simplifyVector = T) head(df) ## $result ## $result$limit ## [1] 20 ## ## $result$offset ## [1] 0 ## ## $result$count ## [1] 3347 ## ## $result$sort ## [1] &quot;&quot; ## ## $result$results ## _id _importdate.date _importdate.timezone_type ## 1 1 2022-04-27 15:38:42.398977 3 ## 2 2 2022-04-27 15:38:42.400421 3 ## 3 3 2022-04-27 15:38:42.401629 3 ## 4 4 2022-04-27 15:38:42.402828 3 ## 5 5 2022-04-27 15:38:42.403923 3 ## 6 6 2022-04-27 15:38:42.405148 3 ## 7 7 2022-04-27 15:38:42.406415 3 ## 8 8 2022-04-27 15:38:42.407379 3 ## 9 9 2022-04-27 15:38:42.408420 3 ## 10 10 2022-04-27 15:38:42.409470 3 ## 11 11 2022-04-27 15:38:42.410759 3 ## 12 12 2022-04-27 15:38:42.411885 3 ## 13 13 2022-04-27 15:38:42.413268 3 ## 14 14 2022-04-27 15:38:42.414625 3 ## 15 15 2022-04-27 15:38:42.415755 3 ## 16 16 2022-04-27 15:38:42.417049 3 ## 17 17 2022-04-27 15:38:42.418276 3 ## 18 18 2022-04-27 15:38:42.419437 3 ## 19 19 2022-04-27 15:38:42.420582 3 ## 20 20 2022-04-27 15:38:42.421694 3 ## _importdate.timezone ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ## 1 Asia/Taipei 1 ä½å®…ç«Šç›œ 1030623 08~10 ## 2 Asia/Taipei 2 ä½å®…ç«Šç›œ 1040101 00~02 ## 3 Asia/Taipei 3 ä½å®…ç«Šç›œ 1040101 00~02 ## 4 Asia/Taipei 4 ä½å®…ç«Šç›œ 1040101 06~08 ## 5 Asia/Taipei 5 ä½å®…ç«Šç›œ 1040101 10~12 ## 6 Asia/Taipei 6 ä½å®…ç«Šç›œ 1040102 00~02 ## 7 Asia/Taipei 7 ä½å®…ç«Šç›œ 1040102 06~08 ## 8 Asia/Taipei 8 ä½å®…ç«Šç›œ 1040102 06~08 ## 9 Asia/Taipei 9 ä½å®…ç«Šç›œ 1040102 10~12 ## 10 Asia/Taipei 10 ä½å®…ç«Šç›œ 1040104 10~12 ## 11 Asia/Taipei 11 ä½å®…ç«Šç›œ 1040104 12~14 ## 12 Asia/Taipei 12 ä½å®…ç«Šç›œ 1040105 00~02 ## 13 Asia/Taipei 13 ä½å®…ç«Šç›œ 1040105 04~06 ## 14 Asia/Taipei 14 ä½å®…ç«Šç›œ 1040105 04~06 ## 15 Asia/Taipei 15 ä½å®…ç«Šç›œ 1040105 12~14 ## 16 Asia/Taipei 16 ä½å®…ç«Šç›œ 1040105 16~18 ## 17 Asia/Taipei 17 ä½å®…ç«Šç›œ 1040105 18~20 ## 18 Asia/Taipei 18 ä½å®…ç«Šç›œ 1040106 04~06 ## 19 Asia/Taipei 19 ä½å®…ç«Šç›œ 1040106 16~18 ## 20 Asia/Taipei 20 ä½å®…ç«Šç›œ 1040107 16~18 ## ç™¼ç”Ÿåœ°é» ## 1 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ ## 2 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ ## 3 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ ## 4 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ ## 5 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ ## 6 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ ## 7 è‡ºåŒ—å¸‚è¬è¯å€ç³–?é‡Œå¤§ç†è¡—159å··1~30è™Ÿ ## 8 è‡ºåŒ—å¸‚è¬è¯å€ç³–?é‡Œå¤§ç†è¡—159å··1~30è™Ÿ ## 9 è‡ºåŒ—å¸‚ä¸­å±±å€å‰æ—è·¯121~150è™Ÿ ## 10 è‡ºåŒ—å¸‚ä¿¡ç¾©å€äº”å¸¸é‡Œæ°¸å‰è·¯225å··32å¼„1~30è™Ÿ ## 11 è‡ºåŒ—å¸‚å£«æ—å€æ˜å‹é‡Œé€šæ²³è¡—31~60è™Ÿ ## 12 è‡ºåŒ—å¸‚ä¸­å±±å€å—äº¬æ±è·¯3æ®µ181~210è™Ÿ ## 13 è‡ºåŒ—å¸‚è¬è¯å€å¤§ç†è¡—159å··1~30è™Ÿ ## 14 è‡ºåŒ—å¸‚è¬è¯å€ç³–?é‡Œå¤§ç†è¡—159å··1~30è™Ÿ ## 15 è‡ºåŒ—å¸‚åŒ—æŠ•å€å‰æ…¶é‡Œå¯¦è¸è¡—56å··1~30è™Ÿ ## 16 è‡ºåŒ—å¸‚ä¸­æ­£å€å¿ å‹¤é‡Œä¸­è¯è·¯2æ®µ311å··1~30è™Ÿ ## 17 è‡ºåŒ—å¸‚æ–‡å±±å€èˆˆç¦é‡Œ12é„°æ™¯è¯è¡—61~90è™Ÿ ## 18 è‡ºåŒ—å¸‚ä¿¡ç¾©å€é›…ç¥¥é‡ŒåŸºéš†è·¯1æ®µ1~30è™Ÿ ## 19 è‡ºåŒ—å¸‚ä¸­æ­£å€æ°´æºé‡Œæ±€å·è·¯3æ®µ91~120è™Ÿ ## 20 è‡ºåŒ—å¸‚æ–‡å±±å€è¬èŠ³é‡Œè¬èŠ³è·¯31~60è™Ÿ dplyr::glimpse(df) ## List of 1 ## $ result:List of 5 ## ..$ limit : int 20 ## ..$ offset : int 0 ## ..$ count : int 3347 ## ..$ sort : chr &quot;&quot; ## ..$ results:&#39;data.frame&#39;: 20 obs. of 7 variables: ## .. ..$ _id : int [1:20] 1 2 3 4 5 6 7 8 9 10 ... ## .. ..$ _importdate:&#39;data.frame&#39;: 20 obs. of 3 variables: ## .. ..$ ç·¨è™Ÿ : chr [1:20] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ... ## .. ..$ æ¡ˆé¡ : chr [1:20] &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; ... ## .. ..$ ç™¼ç”Ÿæ—¥æœŸ : chr [1:20] &quot;1030623&quot; &quot;1040101&quot; &quot;1040101&quot; &quot;1040101&quot; ... ## .. ..$ ç™¼ç”Ÿæ™‚æ®µ : chr [1:20] &quot;08~10&quot; &quot;00~02&quot; &quot;00~02&quot; &quot;06~08&quot; ... ## .. ..$ ç™¼ç”Ÿåœ°é» : chr [1:20] &quot;è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ&quot; ... 2.2.2 Loading a csv file in data directory # if mac cannot read data GET(url, write_disk(&quot;data/tptheft.csv&quot;, overwrite = TRUE)) ## Response [https://data.taipei/api/v1/dataset/93d9bc2d-af08-4db7-a56b-9f0a49226fa3?scope=resourceAquire] ## Date: 2022-05-03 10:07 ## Status: 200 ## Content-Type: application/json ## Size: 5.21 kB ## &lt;ON DISK&gt; /Users/jirlong/Dropbox/Programming/JOUR5014/data/tptheft.csv df &lt;- read.csv(&quot;data/tptheft.csv&quot;, fileEncoding = &quot;big5&quot;) head(df) X.result..limit.20 offset.0 count.3347 sort. resultsâ€¦_id.1 X_importdate..date.2022.04.27.15.38.42.398977 timezone_type.3 timezone.Asia..Taipei. èºåˆ»..result..limit.20.offset.0.count.3347.sortâ€¦resultsâ€¦_id.1._importdate..date.2022.04.27.15.38.42.398977.timezone_type.3.timezone.Asia..Taipei..èºåˆ» 2.2.3 Loading MOI data through API library(httr) library(jsonlite) url &lt;- &quot;https://www.ris.gov.tw/rs-opendata/api/v1/datastore/ODRP024/107?page=1&quot; first_page &lt;- fromJSON(content(GET(url), &quot;text&quot;)) head(first_page$responseData) statistic_yyy district_code site_id village edu sex headhousehold_count 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ åšç•¢ ç”· 3 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ ç¢©ç•¢ ç”· 26 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ å¤§ç•¢ ç”· 71 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ å°ˆç•¢ ç”· 52 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ é«˜ä¸­ç•¢ ç”· 122 107 65000010001 æ–°åŒ—å¸‚æ¿æ©‹å€ ç•™ä¾¯é‡Œ åœ‹ä¸­ç•¢ ç”· 40 2.2.4 (deprecated) Getting 104 query data deprecated due to blocked by new cookie or referer url &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8&amp;order=15&amp;asc=0&amp;page=4&amp;mode=s&amp;jobsource=2018indexpoc&quot; browseURL(url) txt &lt;- content(GET(url), &quot;text&quot;) res &lt;- fromJSON(content(GET(url), &quot;text&quot;)) df &lt;- res$data$list head(df) 2.2.5 Getting ubike https://taipeicity.github.io/traffic_realtime/ url &lt;- &quot;https://tcgbusfs.blob.core.windows.net/blobyoubike/YouBikeTP.json&quot; ubike.list &lt;- fromJSON(content(GET(url),&quot;text&quot;, encoding = &quot;utf-8&quot;)) ubike.v &lt;- unlist(ubike.list$retVal) ubike.m &lt;- matrix(ubike.v, byrow = T, ncol = 14) ubike.df &lt;- as.data.frame(ubike.m) names(ubike.df) &lt;- names(ubike.list$retVal$`0001`) head(ubike.df) sno sna tot sbi sarea mday lat lng ar sareaen snaen aren bemp act 0001 æ·é‹å¸‚æ”¿åºœç«™(3è™Ÿå‡ºå£) 88 66 ä¿¡ç¾©å€ 20220503180643 25.0408578889 121.567904444 å¿ å­æ±è·¯/æ¾ä»è·¯(æ±å—å´) Xinyi Dist. MRT Taipei City Hall Stataion(Exit 3)-2 The S.W. side of Road Zhongxiao East Road &amp; Road Chung Yan. 20 1 0002 æ·é‹åœ‹çˆ¶ç´€å¿µé¤¨ç«™(2è™Ÿå‡ºå£) 16 10 å¤§å®‰å€ 20220503180639 25.041254 121.55742 å¿ å­æ±è·¯å››æ®µ/å…‰å¾©å—è·¯å£(è¥¿å—å´) Daan Dist. MRT S.Y.S Memorial Hall Stataion(Exit 2.) Sec,4. Zhongxiao E.Rd/GuangFu S. Rd 6 1 0004 å¸‚æ°‘å»£å ´ 32 12 ä¿¡ç¾©å€ 20220503180620 25.0360361111 121.562325 å¸‚åºœè·¯/æ¾å£½è·¯(è¥¿åŒ—å´)(é„°è¿‘å°åŒ—101/å°åŒ—ä¸–ç•Œè²¿æ˜“ä¸­å¿ƒ/å°åŒ—æ¢ç´¢é¤¨) Xinyi Dist. Citizen Square The N.W. side of Road Shifu &amp; Road Song Shou. 18 1 0005 èˆˆé›…åœ‹ä¸­ 32 17 ä¿¡ç¾©å€ 20220503180629 25.0365638889 121.5686639 æ¾ä»è·¯/æ¾ä»è·¯95å··(æ±å—å´)(é„°è¿‘ä¿¡ç¾©å•†åœˆ/å°åŒ—ä¿¡ç¾©å¨ç§€å½±åŸ) Xinyi Dist. Xingya Jr.Â High School The S.E. side of Road Songren &amp; Ln. 95, Songren Rd.. 14 1 0006 è‡ºåŒ—å—å±±å»£å ´ 54 20 ä¿¡ç¾©å€ 20220503180626 25.034047 121.565973 æ¾æ™ºè·¯/æ¾å»‰è·¯(æ±åŒ—å´) (é„°è¿‘å°åŒ—101/ä¿¡ç¾©å•†åœˆ/å°åŒ—ä¿¡ç¾©å¨ç§€å½±åŸ) Xinyi Dist. NAN SHAN PLAZA The N.E. side of Road Song Zhi &amp; Road Song Lian. 29 1 0007 ä¿¡ç¾©å»£å ´(å°åŒ—101) 80 41 ä¿¡ç¾©å€ 20220503180616 25.0330388889 121.565619444 æ¾æ™ºè·¯/ä¿¡ç¾©è·¯(æ±åŒ—å´) (é„°è¿‘å°åŒ—101) Xinyi Dist. Xinyi Square(Taipei 101) The N.E. side of Road Song Zhi &amp; Road Xinyi. 39 1 "],["vectors.html", "Chapter 3 Vectors 3.1 R Syntax 3.2 Basic operations 3.3 Calculating with vectors 3.4 Data types 3.5 Character operations", " Chapter 3 Vectors 3.1 R Syntax 3.1.1 Assignment &lt;- å°‡å³é‚Šçš„ç®—å¼æˆ–æ•¸å€¼æŒ‡æ´¾çµ¦å·¦é‚Šçš„è®Šæ•¸ã€‚å³é‚Šå¦‚æœæ˜¯numericï¼Œé‚£å·¦é‚Šçš„è®Šæ•¸å°±æ˜¯numeric variableï¼›å³é‚Šå¦‚æœæ˜¯characterï¼Œå·¦é‚Šçš„è®Šæ•¸å°±æ˜¯character variableã€‚ åœ¨å¹¾ä¹æ‰€æœ‰ç¨‹å¼èªè¨€ä¸­ï¼Œå–®ç­‰è™Ÿ=æŒ‡çš„æ˜¯assignmentï¼ŒæŠŠå³æ–¹çš„ç®—å¼ã€å€¼æˆ–ç‰©ä»¶æŒ‡çµ¦å·¦æ–¹çš„è®Šæ•¸ã€‚è€Œæ¯”è¼ƒå…©è€…ç›¸ä¸ç›¸ç­‰ï¼Œå‰‡ç”¨é›™ç­‰è™Ÿ==ï¼Œä¾‹å¦‚1==3-2ã€‚ a &lt;- 1 b &lt;- c(1, 2, 3, 4) c &lt;- c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;) d &lt;- c(b, a) e &lt;- &quot;abcd&quot; 3.1.2 comments è¨»è§£ è¨»è§£ï¼šåœ¨ç¨‹å¼ç¢¼å€å¡Šè‹¥å‰é¢æœ‰#å­—è™Ÿå¾Œé¢è·Ÿè‘—ç©ºç™½çš„è©±ï¼Œé‚£ä»£è¡¨é‚£è¡Œè¢«æ¨™ç¤ºç‚ºè¨»è§£ï¼Œç¨‹å¼åŸ·è¡Œæ™‚æœƒè‡ªå‹•è·³éè¨»è§£ä¸åŸ·è¡Œã€‚ å¿«é€Ÿéµï¼šç•¶æ¸¸æ¨™åœ¨æŸä¸€è¡Œç¨‹å¼ç¢¼æ™‚æ‰“cmd(ctrl)-shift-cï¼Œå°±å¯ä»¥ç”¢ç”Ÿè¨»è§£ã€‚ # df &lt;- data.frame(a = c(1, 2, 3), b = c(3, 4, 5)) 3.2 Basic operations å„ç¸£å¸‚å¹³å‡æ¯æœˆè–ªè³‡æ‰€å¾— å„ç¸£å¸‚äººå£æ•¸ 3.2.1 Creating åœ¨ç¨‹å¼ç¢¼ä¸­ï¼Œåªè¦æ˜¯æ–‡å­—å¿…ç”¨æˆå°çš„é›™å¼•è™Ÿæˆ–å–®å¼•è™ŸåŒ…å«å…¶ä¸­ï¼Œä»¥å€éš”ã€Œè®Šæ•¸ã€å’Œã€Œæ•¸å­—ã€ã€‚ä¾‹å¦‚å¦‚æœçœ‹åˆ°æ²’æœ‰é›™å¼•è™Ÿçš„ã€Œè‹±æ–‡å­—æ¯ã€å¿…å®šæ˜¯è®Šæ•¸åç¨±ï¼Œæˆ–å‡½å¼åç¨±ã€‚ å¦‚æœçœ‹åˆ°æœ‰é›™å¼•è™Ÿçš„æ•¸å­—ï¼Œé‚£ä¹Ÿæ˜¯æ–‡å­—ã€‚ income &lt;- c(70100, 51300, 51100, 48400, 47600, 43000) county &lt;- c(&quot;å°åŒ—&quot;, &quot;æ–°åŒ—&quot;, &quot;æ¡ƒåœ’&quot;, &quot;é«˜é›„&quot;, &quot;å°ä¸­&quot;, &quot;å°å—&quot;) population &lt;- c(2.6, 3.9, 2.2, 2.7, 2.8, 1.8) area &lt;- c(271.8, 2052.5, 1221, 2951.9, 2214.9, 2191.7) income ## [1] 70100 51300 51100 48400 47600 43000 county[c(5, 3, 1)] ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; county &lt;- county[c(5, 3, 1)] county ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; area ## [1] 271.8 2052.5 1221.0 2951.9 2214.9 2191.7 population ## [1] 2.6 3.9 2.2 2.7 2.8 1.8 3.2.1.1 Creating a sequence a &lt;- seq(11, 99, 11) a ## [1] 11 22 33 44 55 66 77 88 99 b &lt;- 11:20 b ## [1] 11 12 13 14 15 16 17 18 19 20 3.2.1.2 Creating sequences by distribution x &lt;- runif(10000000, 1, 10) # uniform dist, n=1000 plot(density(x)) x &lt;- rnorm(1000, 1, 10) # uniform dist, n=1000 plot(density(x)) x &lt;- rnorm(10000000, 1, 10) # normal dist, n=1000 plot(density(x)) 3.2.2 Viewing county ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; income ## [1] 70100 51300 51100 48400 47600 43000 head(county) ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; tail(county) ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; length(county) ## [1] 3 mode(county) ## [1] &quot;character&quot; class(county) ## [1] &quot;character&quot; # View(county) length(county) ## [1] 3 length(income) ## [1] 6 3.2.3 Subsetting, filtering It is important to know how to neglect first n or last n elements. For example, a[1:(length(a)-2)] will neglect the last two elements. Thinking why I need parentheses for length(a)-2 here. county ## [1] &quot;å°ä¸­&quot; &quot;æ¡ƒåœ’&quot; &quot;å°åŒ—&quot; county[c(5, 3, 1)] # how about country[c(1, 3, 5)] ## [1] NA &quot;å°åŒ—&quot; &quot;å°ä¸­&quot; county[3:6] # is it equal to country[c(3, 4, 5, 6)] ## [1] &quot;å°åŒ—&quot; NA NA NA a &lt;- 11:19 a[3:length(a)] ## [1] 13 14 15 16 17 18 19 a[length(a):3] ## [1] 19 18 17 16 15 14 13 3.2.4 Deleting Without assignment, deletion wonâ€™t change original vectors b &lt;- 11:20 b[-(3:5)] ## [1] 11 12 16 17 18 19 20 b[-c(1, 3, 5)] ## [1] 12 14 16 17 18 19 20 b ## [1] 11 12 13 14 15 16 17 18 19 20 Correct deleting operations with assignment to replace original vector b &lt;- b[-(3:5)] b ## [1] 11 12 16 17 18 19 20 a &lt;- seq(11, 99, 11) a &lt;- a[-c(1, 3, 5)] a ## [1] 22 44 66 77 88 99 3.2.5 Concatinating Concatinating is quite useful for web crawling when you crawl article links page by page. You may be not sure the number of page you need to crawl. So you need to append entire new vector to old vector. It is concatinating. (â€œAppendingâ€ often means adding one new element at the end of data.) a &lt;- 1:10 a &lt;- c(a, 11) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 b ## [1] 11 12 16 17 18 19 20 a &lt;- c(a, b) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 11 12 16 17 18 19 20 a &lt;- c(a, a, b) a ## [1] 1 2 3 4 5 6 7 8 9 10 11 11 12 16 17 18 19 20 1 2 3 4 5 6 7 ## [26] 8 9 10 11 11 12 16 17 18 19 20 11 12 16 17 18 19 20 3.3 Calculating with vectors 3.3.1 Arithmetic operations a &lt;- 11:19 a + 3 ## [1] 14 15 16 17 18 19 20 21 22 a / 2 ## [1] 5.5 6.0 6.5 7.0 7.5 8.0 8.5 9.0 9.5 a %% 2 ## [1] 1 0 1 0 1 0 1 0 1 a %/% 2 ## [1] 5 6 6 7 7 8 8 9 9 a %% 2== 0 ## [1] FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE FALSE which(a %% 2== 0) ## [1] 2 4 6 8 a[which(a%% 2 == 0)] ## [1] 12 14 16 18 a[c(2, 4, 6, 8)] ## [1] 12 14 16 18 a %% 2 != 0 ## [1] TRUE FALSE TRUE FALSE TRUE FALSE TRUE FALSE TRUE a[a%% 2 == 0] ## [1] 12 14 16 18 a[a%%2 != 0] ## [1] 11 13 15 17 19 a &lt;- a %% 2 # modular arithmetic, get the reminder a &lt;- a %/% 2 # Quotient 3.3.2 Logic comparisons a %% 2 == 0 # deteting odd/even number ## [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE a %% 2 != 0 ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE a[a%%2==0] ## [1] 0 0 0 0 0 0 0 0 0 a &gt; b ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE income &gt; mean(income) ## [1] TRUE FALSE FALSE FALSE FALSE FALSE TRUE == T # == equal to, ## [1] TRUE TRUE != F # != Not equal to ## [1] TRUE any(a&gt;11) # is there any element larger than 1 ## [1] FALSE all(a&gt;11) # are all elements larger than 1 ## [1] FALSE 3.3.3 Subsetting by logic comparisons two methods to filter data from vectors, by index vector or a logical vector with equal length. a &lt;- seq(11, 55, 11) a[c(T, F, T, F, T)] ## [1] 11 33 55 a[a%%2==1] ## [1] 11 33 55 a%%2 ## [1] 1 0 1 0 1 a%%2==1 ## [1] TRUE FALSE TRUE FALSE TRUE a &lt;- c(&quot;ä½ å¥½&quot;,&quot;ä½ å¥½æ£’æ£’&quot;,&quot;ä½ å¥½æ£’&quot;,&quot;ä½ çœŸçš„å¥½æ£’&quot;) a[nchar(a)&gt;3] ## [1] &quot;ä½ å¥½æ£’æ£’&quot; &quot;ä½ çœŸçš„å¥½æ£’&quot; # which will return &quot;index-of&quot; a &lt;- seq(11, 55, 11) a[which(a%%2==1)] ## [1] 11 33 55 which(a%%2==1) ## [1] 1 3 5 3.3.4 Sorting and ordering sort(x)çš„çµæœå¿…é ˆç”¨&lt;-è¦†è“‹åŸæœ¬çš„xï¼Œæ­¤æ™‚çš„xæ‰ç®—è¢«æ’åºçš„çµæœã€‚ order(x)å‡½å¼æœƒå‚³å›xæ•¸å€¼ç”±å°åˆ°å¤§çš„ç´¢å¼•ã€‚é€™å€‹ä¾‹å­çš„çµæœæ˜¯5, 4, 3, 6, 1, 2ï¼Œä¹Ÿå°±æ˜¯5ä½ç½®çš„é‚£å€‹æ•¸æœ€å°ã€4é‚£å€‹ä½ç½®çš„æ•¸æ¬¡å°ã€æ¥ä¸‹ä¾†3, 6, 1, 2ã€‚ x[order(x)]æŠŠorder(x)çµæœï¼ˆä¹Ÿå°±æ˜¯c(5, 4, 3, 6, 1, 2)ï¼‰å‚³çµ¦åŸæœ¬çš„xä¾¿æœƒä½¿å¾—åŸæœ¬çš„xé‡æ–°æ’åºã€‚é€šå¸¸order()çš„ç”¨é€”æ˜¯ï¼Œæˆ‘å€‘å¯ä»¥å°‡å…©å€‹ç­‰é•·çš„variablesä¾‹å¦‚var1å’Œvar2ï¼Œä¾æ“švar2ä¾†é‡æ–°æ’åºvar1ï¼Œä¾‹å¦‚var1[order(var2)]ã€‚ x &lt;- c(33, 55, 22, 13, 4, 24) mode(x) ## [1] &quot;numeric&quot; class(x) ## [1] &quot;numeric&quot; sort(x) ## [1] 4 13 22 24 33 55 # x &lt;- sort(x) # assign to replace original x order(x) ## [1] 5 4 3 6 1 2 x[order(x)] ## [1] 4 13 22 24 33 55 x[c(5, 4, 3, 6, 1, 2)] ## [1] 4 13 22 24 33 55 3.3.5 Built-in math functions a &lt;- 11:19 min(a); max(a); mean(a); median(a); sd(a) ## [1] 11 ## [1] 19 ## [1] 15 ## [1] 15 ## [1] 2.738613 log2(a) ## [1] 3.459432 3.584963 3.700440 3.807355 3.906891 4.000000 4.087463 4.169925 ## [9] 4.247928 log1p(a) ## [1] 2.484907 2.564949 2.639057 2.708050 2.772589 2.833213 2.890372 2.944439 ## [9] 2.995732 ?log1p 3.4 Data types 3.4.1 Checking data type mode(county) # character ## [1] &quot;character&quot; mode(income) # numeric ## [1] &quot;numeric&quot; mode(income &gt; mean(income)) # logical ## [1] &quot;logical&quot; testing &lt;- c(&quot;26.142&quot;, &quot;12.008&quot;, &quot;7.032&quot;, &quot;13.646&quot;, &quot;4.589&quot;) mode(testing) # character ## [1] &quot;character&quot; 3.4.2 Converting data type numeric vectorå¯ä»¥ç”¨as.character(x)è½‰æˆcharcterï¼›logical vectorå¯ä»¥ç”¨as.numeric(x)è½‰ç‚ºnumericã€‚æ¦‚å¿µä¸Šå¯ä»¥èªªæ˜¯character &gt; numeric &gt; logicalã€‚ å¦‚æœç¡¬æ˜¯åœ¨logical vectorå¾Œé™„åŠ ä¸€å€‹numeric elementçš„è©±ï¼Œé‚£å°±æœƒæ•´å€‹vectorè¢«è½‰ç‚ºnumeric vectorï¼›ç›¸ä»¿åœ°ï¼Œå¦‚æœnumeric vectorå¾Œé™„åŠ ä¸€å€‹character elementçš„è©±é‚£æ•´å€‹vectorå°±æœƒè¢«è½‰ç‚ºcharacter vectorã€‚ å¯ä»¥ç”¨sum()å‡½å¼ä¾†è¨ˆç®—logical vectoræœ‰å¹¾å€‹TRUEå€¼ã€‚ä¾‹å¦‚sum(a%%2==1)å°±æ˜¯è¨ˆç®—aä¸­æœ‰å¹¾å€‹å¥‡æ•¸ã€‚TRUEå¯è¦–ç‚º1ã€FALSEå¯è¦–ç‚º0ï¼Œæ‰€ä»¥åŠ ç¸½èµ·ä¾†å°±æ˜¯TRUEæœ‰å¹¾å€‹ã€‚ income.c &lt;- as.character(income) population.c &lt;- as.numeric(population) a &lt;- seq(11, 99, 11) a &lt;- c(a, &quot;100&quot;) a &lt;- seq(11, 99, 11) sum(a%%2==1) ## [1] 5 max(a) ## [1] 99 3.5 Character operations a &lt;- seq(11, 55, 11) paste(&quot;A&quot;, a) # concatenate ## [1] &quot;A 11&quot; &quot;A 22&quot; &quot;A 33&quot; &quot;A 44&quot; &quot;A 55&quot; paste0(&quot;A&quot;, a) # concatenate ## [1] &quot;A11&quot; &quot;A22&quot; &quot;A33&quot; &quot;A44&quot; &quot;A55&quot; "],["dataframe.html", "Chapter 4 Dataframe 4.1 åŸºæœ¬æ“ä½œ 4.2 ç°¡æ˜“ç¹ªåœ– 4.3 åŸºæœ¬æ“ä½œï¼šä½¿ç”¨dplyr 4.4 tibble, data_frame, data.frame", " Chapter 4 Dataframe 4.1 åŸºæœ¬æ“ä½œ 4.1.1 ç”¢ç”Ÿæ–°çš„Dataframe 4.1.1.1 è¤‡è£½è³‡æ–™è‡³vector ç›´æ¥è¤‡è£½Wikipediaä¸Šçš„å°åŒ—å¸‚æŸäº”å€äººå£è³‡æ–™ population &lt;- c(158228, 126687, 228075, 204903, 308383, 187920) town &lt;- c(&quot;ä¸­æ­£&quot;, &quot;å¤§åŒ&quot;, &quot;ä¸­å±±&quot;, &quot;æ¾å±±&quot;, &quot;å¤§å®‰&quot;, &quot;è¬è¯&quot;) area &lt;- c(7.6071, 5.6815, 13.6821, 9.2878, 11.3614, 8.8522) 4.1.1.2 åˆä½µç­‰é•·vectorç‚ºdataframe df &lt;- data.frame(town, population, area) df$density = df$population / df$area str(df) ## &#39;data.frame&#39;: 6 obs. of 4 variables: ## $ town : chr &quot;ä¸­æ­£&quot; &quot;å¤§åŒ&quot; &quot;ä¸­å±±&quot; &quot;æ¾å±±&quot; ... ## $ population: num 158228 126687 228075 204903 308383 ... ## $ area : num 7.61 5.68 13.68 9.29 11.36 ... ## $ density : num 20800 22298 16670 22062 27143 ... summary(df) ## town population area density ## Length:6 Min. :126687 Min. : 5.681 Min. :16670 ## Class :character 1st Qu.:165651 1st Qu.: 7.918 1st Qu.:20907 ## Mode :character Median :196412 Median : 9.070 Median :21645 ## Mean :202366 Mean : 9.412 Mean :21700 ## 3rd Qu.:222282 3rd Qu.:10.843 3rd Qu.:22239 ## Max. :308383 Max. :13.682 Max. :27143 # View(df) 4.1.1.3 å­˜æ”¾å°ç£è²¿æ˜“å„åœ‹é€²å‡ºå£é‡ é‹ç”¨å°ç£å‡ºå£é€²å£è³‡æ–™ å°ç£å‡ºå£é€²å£è²¿æ˜“è³‡æ–™æŸ¥è©¢ country &lt;- c(&quot;CN&quot;, &quot;US&quot;, &quot;JP&quot;, &quot;HK&quot;, &quot;KR&quot;, &quot;SG&quot;, &quot;DE&quot;, &quot;MY&quot;, &quot;VN&quot;, &quot;PH&quot;, &quot;TH&quot;, &quot;AU&quot;, &quot;NL&quot;, &quot;SA&quot;, &quot;ID&quot;, &quot;GB&quot;, &quot;IN&quot;, &quot;FR&quot;, &quot;IT&quot;, &quot;AE&quot;) import &lt;- c(26.142, 12.008, 7.032, 13.646, 4.589, 5.768, 2.131, 2.802, 3.428, 3.019, 1.976, 1.118, 1.624, 0.449, 0.983, 1.302, 1.027, 0.553, 0.670, 0.455) export &lt;- c(22.987, 12.204, 11.837, 7.739, 5.381, 4.610, 2.866, 2.784, 2.414, 2.092, 1.839, 1.788, 1.665, 1.409, 1.391, 1.075, 0.974, 0.899, 0.800, 0.728) 4.1.1.4 åˆä½µvectorç‚ºdata.frame é€™æ™‚å€™æˆ‘å€‘è‹¥ä»¥str(df)è§€å¯Ÿè©²dfçš„çµæ§‹æœƒç™¼ç¾ï¼Œæ–‡å­—å‹æ…‹çš„è³‡æ–™è¢«è½‰ç‚ºFactorsï¼Œé€™æ˜¯æˆ‘å€‘æ‰€ä¸æ¨‚è¦‹çš„ã€‚éå»çµ±è¨ˆé€šå¸¸æœƒæŠŠæ–‡å­—å‹æ…‹ç•¶æˆé¡åˆ¥è®Šæ•¸ï¼Œæ–¼æ˜¯ç”¨Factorsä½œç‚ºè³‡æ–™å‹æ…‹ï¼Œä½†è³‡æ–™ç§‘å­¸ä¸­ç¶“å¸¸è¦è™•ç†å¤§é‡çš„æ–‡å­—è³‡æ–™ï¼Œæ­¤æ™‚ï¼Œæˆ‘å€‘å¯ä»¥æŠŠread.csvçš„ä¸€å€‹åƒæ•¸stringsAsFactorsè¨­ç‚ºFALSEï¼Œæ„å‘³è‘—é è¨­ä¸è¦å°‡æ–‡å­—çš„è³‡æ–™è½‰ç‚ºFactorè€Œæ˜¯ç›´æ¥ä»¥æ–‡å­—è®Šé …ä¾†è™•ç†ã€‚* stringsAsFactors = FALSEä¹Ÿæ˜¯read.csv()çš„åƒæ•¸ï¼ˆparameterã€argumentï¼‰ã€‚å› ç‚ºä¸€èˆ¬è®€æª”æœƒé è¨­æŠŠæ–‡å­—è®€ç‚ºé¡åˆ¥è®Šé …ä¹Ÿå°±æ˜¯Factorï¼Œä½†è³‡æ–™åˆ†æç¶“å¸¸è¦è™•ç†æ–‡å­—è³‡æ–™è€Œä¸æ˜¯é¡åˆ¥è®Šé …ï¼Œæ‰€ä»¥æœƒå¸Œæœ›é è¨­ä¸è¦æŠŠæ–‡å­—è®€å–ç‚ºé¡åˆ¥è®Šé …ï¼Œå› æ­¤è¦è¨­å®šstringsAsFactors = FALSEã€‚ ç‚ºäº†é¿å…æ¯æ¬¡éƒ½è¦æ‰“é€™ä¸²åƒæ•¸ï¼Œå¯ä»¥æŠŠå®ƒè¨­å®šç‚ºå…¨åŸŸåƒæ•¸ï¼Œå¯ä»¥åœ¨ç¨‹å¼ä¸€é–‹å§‹æ™‚ä¾¿åŠ ä¸Šoptions(stringsAsFactors = FASLE)ï¼Œæ„å‘³è‘—åº•ä¸‹æ‰€æœ‰çš„å‡½å¼å¦‚æœæœ‰stringsAsFactorsé€™å€‹åƒæ•¸ï¼Œä¸€å¾‹è‡ªå‹•è¨­ç‚ºFALSEã€‚ df &lt;- data.frame(country, import, export) str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... df &lt;- data.frame(country, import, export, stringsAsFactors = FALSE) str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... ç”šè‡³ä¹Ÿå¯ä»¥å»ºç«‹ä¸€å€‹æ–°çš„ã€ç©ºçš„data.frameã€‚ df.testå°±Rçš„ç”¨æ³•å°±æ˜¯ä¸€å€‹è®Šæ•¸ï¼Œä¸¦ä¸æ˜¯dfå’Œtestå„è‡ªæ˜¯ä¸€å€‹è®Šæ•¸ã€‚ df.test &lt;- data.frame() 4.1.2 è§€å¯Ÿdataframe View(df) ç”¨RStudioæ‰€æä¾›çš„GUIç›´æ¥è§€çœ‹è®Šæ•¸ head(df) å–å‰é¢å…­ç­†è³‡æ–™ï¼ˆä¹Ÿå°±æ˜¯å…­åˆ—çš„è³‡æ–™ä¾†æ¦‚è§€è©²è³‡æ–™ï¼‰ class(df) str(df) summary(df) # View(df) head(df) # get first part of the data.frame ## country import export ## 1 CN 26.142 22.987 ## 2 US 12.008 12.204 ## 3 JP 7.032 11.837 ## 4 HK 13.646 7.739 ## 5 KR 4.589 5.381 ## 6 SG 5.768 4.610 class(df) ## [1] &quot;data.frame&quot; str(df) ## &#39;data.frame&#39;: 20 obs. of 3 variables: ## $ country: chr &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; ... ## $ import : num 26.14 12.01 7.03 13.65 4.59 ... ## $ export : num 22.99 12.2 11.84 7.74 5.38 ... summary(df) ## country import export ## Length:20 Min. : 0.449 Min. : 0.728 ## Class :character 1st Qu.: 1.016 1st Qu.: 1.312 ## Mode :character Median : 2.054 Median : 1.966 ## Mean : 4.536 Mean : 4.374 ## 3rd Qu.: 4.884 3rd Qu.: 4.803 ## Max. :26.142 Max. :22.987 # look up help help(summary) ?summary 4.1.2.1 è§€å¯Ÿè³‡æ–™ç¶­åº¦ dim(df) ## [1] 20 3 ncol(df) ## [1] 3 nrow(df) ## [1] 20 length(df) ## [1] 3 4.1.3 æ“ä½œdataframe 4.1.3.1 å–å‡ºä¸€å€‹è®Šé … names(df) åˆ—å‡ºè®Šæ•¸åç¨± df$ç™¼ç”Ÿ.ç¾.åœ°é» é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ df$ç™¼ç”Ÿæ™‚æ®µ é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ length(df$ç™¼ç”Ÿæ™‚æ®µ) é¡¯ç¤ºè©²è®Šæ•¸çš„é•·åº¦ï¼ˆç›¸ç•¶æ–¼æœ‰å¹¾å€‹ï¼‰ names(df) ## [1] &quot;country&quot; &quot;import&quot; &quot;export&quot; head(df$ç™¼ç”Ÿ.ç¾.åœ°é») ## NULL head(df$ç™¼ç”Ÿæ™‚æ®µ) ## NULL length(df$ç™¼ç”Ÿæ™‚æ®µ) ## [1] 0 summary(df) ## country import export ## Length:20 Min. : 0.449 Min. : 0.728 ## Class :character 1st Qu.: 1.016 1st Qu.: 1.312 ## Mode :character Median : 2.054 Median : 1.966 ## Mean : 4.536 Mean : 4.374 ## 3rd Qu.: 4.884 3rd Qu.: 4.803 ## Max. :26.142 Max. :22.987 4.1.3.2 (mutate)é€éé‹ç®—ç”¢ç”Ÿæ–°è®Šæ•¸ é€™è£¡å®¹æ˜“çŠ¯éŒ¯çš„æ˜¯ï¼Œè¦è¨˜å¾—è·Ÿç¨‹å¼è¬›èªªä½ è¦åŠ ç¸½æˆ–å››å‰‡é‹ç®—çš„æ˜¯å“ªå€‹dfçš„variableã€‚ å¾ä¸‹é¢çš„é€™å€‹æ“ä½œä¸­ï¼Œè©²data.frameæœƒç”¢ç”Ÿä¸€å€‹æ–°çš„è®Šæ•¸subï¼Œé€™å°±ç›¸ç•¶æ–¼Excelä¸­çš„æŸä¸€è¡Œæ¸›å»æŸä¸€è¡Œï¼Œç„¶å¾ŒæŠŠè³‡æ–™æ”¾åœ¨æ–°çš„ä¸€è¡Œã€‚ df$sub &lt;- df$import - df$export 4.1.3.3 (filter)ç¯©é¸è³‡æ–™ã€é¸å–è®Šæ•¸ æ³¨æ„ï¼Œè¦å‘Šè¨´ç¨‹å¼importå’Œexportæ˜¯å“ªå€‹data.frameçš„ã€‚ df[,]ç‚ºå­˜å–dfä¸­æŸå€‹å€æ®µçš„æ•¸å€¼æˆ–æŸå€‹æ•¸å€¼çš„æ–¹æ³•ã€‚å› æ­¤df[1, 1]æœƒå–å‡ºç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ç­†è³‡æ–™çš„ç¬¬ä¸€å€‹vectorã€‚df[2, 3]å‰‡æœƒå–å‡ºç¬¬äºŒç­†è³‡æ–™çš„ç¬¬ä¸‰å€‹variableã€‚ ä¸‹é¢çš„ä¾‹å­nrow(df)ç‚º1894ï¼Œæœ‰1894ç­†è³‡æ–™ï¼Œæ‰€ä»¥è‡ªç„¶df\\(importèˆ‡df\\)exportçš„é•·åº¦éƒ½æ˜¯1894ã€‚å› æ­¤ï¼Œæ¯”è¼ƒé€™å…©å€‹è®Šæ•¸çš„å¤§å°æœƒå¾—åˆ°ä¸€å€‹é•·åº¦ç‚º1894çš„boolean (logical) variableã€‚å› æ­¤æŠŠé€™å€‹é•·åº¦ç‚º1894ã€å……æ»¿TRUEå’ŒFALSEçš„logical vectorä¸Ÿé€²dfçš„rowä¹‹è™•ï¼Œå› ç‚ºå–è‡ªdfï¼Œå¤§å°åˆ¤æ–·å¼çµæœçš„é•·åº¦è‡ªç„¶å’ŒåŸæœ¬çš„dfçš„åˆ—æ•¸ç›¸åŒã€‚å› æ­¤ç•¶é€™å€‹TRUE/FALSEè¢«ä¸Ÿåœ¨dfçš„åˆ—ä¹‹è™•ï¼Œä¾¿æœƒç¯©é¸å‡ºimportå¤§æ–¼p.xportçš„æ•¸å€¼ã€‚ åŸæœ¬çš„dfæœ‰äº”å€‹variableï¼Œè€Œä¸Šè¿°çš„æ“ä½œæ˜¯ç¯©é¸è³‡æ–™ï¼Œæ‰€ä»¥è¢«ç¯©é¸çš„æ˜¯åˆ—ï¼Œå› æ­¤è¡Œçš„æ•¸é‡ã€åç¨±éƒ½ä¸æœƒè®Šã€‚å› æ­¤ï¼Œæˆ‘ç¯©é¸å®Œå¾Œï¼Œç›´æ¥å­˜å–é€™å€‹è¢«ç¯©é¸éçš„data.frameçš„country variableï¼Œè‡ªç„¶æ˜¯å¯ä»¥çš„ã€‚ df ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 2 US 12.008 12.204 -0.196 ## 3 JP 7.032 11.837 -4.805 ## 4 HK 13.646 7.739 5.907 ## 5 KR 4.589 5.381 -0.792 ## 6 SG 5.768 4.610 1.158 ## 7 DE 2.131 2.866 -0.735 ## 8 MY 2.802 2.784 0.018 ## 9 VN 3.428 2.414 1.014 ## 10 PH 3.019 2.092 0.927 ## 11 TH 1.976 1.839 0.137 ## 12 AU 1.118 1.788 -0.670 ## 13 NL 1.624 1.665 -0.041 ## 14 SA 0.449 1.409 -0.960 ## 15 ID 0.983 1.391 -0.408 ## 16 GB 1.302 1.075 0.227 ## 17 IN 1.027 0.974 0.053 ## 18 FR 0.553 0.899 -0.346 ## 19 IT 0.670 0.800 -0.130 ## 20 AE 0.455 0.728 -0.273 names(df) ## [1] &quot;country&quot; &quot;import&quot; &quot;export&quot; &quot;sub&quot; nrow(df) ## [1] 20 # filter row data by column value df[df$import &gt; df$export,] ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 4 HK 13.646 7.739 5.907 ## 6 SG 5.768 4.610 1.158 ## 8 MY 2.802 2.784 0.018 ## 9 VN 3.428 2.414 1.014 ## 10 PH 3.019 2.092 0.927 ## 11 TH 1.976 1.839 0.137 ## 16 GB 1.302 1.075 0.227 ## 17 IN 1.027 0.974 0.053 df[df$import &gt; df$export,]$country ## [1] &quot;CN&quot; &quot;HK&quot; &quot;SG&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;GB&quot; &quot;IN&quot; df[df$import &gt; df$export,1] ## [1] &quot;CN&quot; &quot;HK&quot; &quot;SG&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;GB&quot; &quot;IN&quot; # 1 row == a data.frame with only one data entry class(df[df$import &gt; df$export,1]) ## [1] &quot;character&quot; class(df[,1]) # character vector ## [1] &quot;character&quot; class(df[1,]) # data.frame ## [1] &quot;data.frame&quot; class(unlist(df[1, -1])) # filter the 1st row and select all columns except 1 ## [1] &quot;numeric&quot; 4.1.3.4 (arrange) æŒ‰æŸå€‹è®Šæ•¸æ’åº df.sorted &lt;- df[order(df$import),]æœƒä½¿å¾—æ•´å€‹dfç…§importçš„å¤§å°æ’åºé‡æ–°åšæ’åˆ—ã€‚å› ç‚ºorder(df$import)æœƒæŠŠè³‡æ–™ç…§æŒ‡å®šé †åºæ’åˆ—å¾Œçš„ä½ç½®å‚³å›ä¾†ï¼Œæ‰€ä»¥æŠŠä»–ä¸Ÿçµ¦dfçš„åˆ—çš„ä½ç½®ï¼Œä¾¿æœƒä½¿å¾—dfçš„è³‡æ–™ç…§æŒ‡å®šçš„é †åºæ’åˆ—ã€‚ é è¨­æ˜¯ç”±å°åˆ°å¤§ï¼ŒåŠ ä¸Šdecreasing = Té€™å€‹åƒæ•¸å¾Œè®Šæˆç”±å¤§è€Œå°ã€‚ # sort rows by df$import column df.sorted &lt;- df[order(df$import),] # View(df.sorted) # sort rows in decreasing order df.sorted &lt;- df[order(df$import, decreasing = T),] # add - to column in order() can sort in decreasing order df.sorted &lt;- df[order(-df$import),] head(df.sorted) ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 4 HK 13.646 7.739 5.907 ## 2 US 12.008 12.204 -0.196 ## 3 JP 7.032 11.837 -4.805 ## 6 SG 5.768 4.610 1.158 ## 5 KR 4.589 5.381 -0.792 4.2 ç°¡æ˜“ç¹ªåœ– graphics::plot()ç‚ºæœƒé è¼‰å…¥Rçš„ç¹ªåœ–å¥—ä»¶ï¼Œå¦‚æœå¸Œæœ›ç¹ªåœ–çš„åŒæ™‚åŠ ä¸Šå›æ­¸ç·šå’Œè³‡æ–™é»æ¨™ç±¤çš„è©±ï¼Œå¿…é ˆè¦ä¸‰è¡Œä¸€èµ·åŸ·è¡Œã€‚ # plot(df) # raise error, 1st column is a character vector plot(df[, 2:3]) plot(df[1:10, 2:3]) text(import, export, labels=country, cex= 0.5, pos=3) lines(1:25, 1:25, col=&#39;red&#39;) ?plot ## Help on topic &#39;plot&#39; was found in the following packages: ## ## Package Library ## graphics /Library/Frameworks/R.framework/Versions/4.1/Resources/library ## base /Library/Frameworks/R.framework/Resources/library ## ## ## ç”¨ç¬¬ä¸€å€‹ç¬¦åˆâ€¦ 4.3 åŸºæœ¬æ“ä½œï¼šä½¿ç”¨dplyr library(dplyr) df &lt;- data.frame(country, import, export, stringsAsFactors = F) df &lt;- mutate(df, sub = import - export) filter(df, import &gt; export) ## country import export sub ## 1 CN 26.142 22.987 3.155 ## 2 HK 13.646 7.739 5.907 ## 3 SG 5.768 4.610 1.158 ## 4 MY 2.802 2.784 0.018 ## 5 VN 3.428 2.414 1.014 ## 6 PH 3.019 2.092 0.927 ## 7 TH 1.976 1.839 0.137 ## 8 GB 1.302 1.075 0.227 ## 9 IN 1.027 0.974 0.053 select(df, c(1, 3)) ## country export ## 1 CN 22.987 ## 2 US 12.204 ## 3 JP 11.837 ## 4 HK 7.739 ## 5 KR 5.381 ## 6 SG 4.610 ## 7 DE 2.866 ## 8 MY 2.784 ## 9 VN 2.414 ## 10 PH 2.092 ## 11 TH 1.839 ## 12 AU 1.788 ## 13 NL 1.665 ## 14 SA 1.409 ## 15 ID 1.391 ## 16 GB 1.075 ## 17 IN 0.974 ## 18 FR 0.899 ## 19 IT 0.800 ## 20 AE 0.728 message(df$country) print(df$country) ## [1] &quot;CN&quot; &quot;US&quot; &quot;JP&quot; &quot;HK&quot; &quot;KR&quot; &quot;SG&quot; &quot;DE&quot; &quot;MY&quot; &quot;VN&quot; &quot;PH&quot; &quot;TH&quot; &quot;AU&quot; &quot;NL&quot; &quot;SA&quot; &quot;ID&quot; ## [16] &quot;GB&quot; &quot;IN&quot; &quot;FR&quot; &quot;IT&quot; &quot;AE&quot; 4.4 tibble, data_frame, data.frame è­¦å‘Šï¼š \"data_frame()\" was deprecated in tibble 1.1.0. Please use \"tibble()\" instead. df &lt;- data.frame(a=1:2, b=3:4, c=5:6) class(df) ## [1] &quot;data.frame&quot; df &lt;- data_frame(a=1:2, b=3:4, c=5:6) class(df) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; df &lt;- tibble(a=1:2, b=3:4, c=5:6) class(df) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; "],["data-analysis-with-r.html", "Chapter 5 Data Analysis with R 5.1 Case: Paid Maternal Leave 5.2 Pivot Analysis on TP Theft", " Chapter 5 Data Analysis with R 5.1 Case: Paid Maternal Leave æœ¬æ¡ˆä¾‹å°‡åˆ©ç”¨Rä¾†é‡è£½è¯ç››é “éƒµå ±åœ¨2016/08/13çš„ä¸€ç¯‡è«‡è«–ç¾åœ‹å©¦å¥³ç”¢å‡æ”¯è–ªæƒ…å½¢çš„å ±å°ã€‚é€™å€‹æ¡ˆä¾‹ä¸­å°‡æœƒæ‡‰ç”¨åˆ°data.frameå’ŒåŸºæœ¬çš„ç¹ªåœ–èˆ‡è³‡æ–™æ‘˜è¦æ–¹æ³•ã€‚The case adaped Washington Postâ€™s paid maternity leave as an exmaple to introduce basic skill of data.frame, plotting, and data mamipulation. åŸå§‹æ–°èä¾†æºï¼šhttps://www.washingtonpost.com/news/worldviews/wp/2016/08/13/the-world-is-getting-better-at-paid-maternity-leave-the-u-s-is-not/?tid=sm_tw&amp;utm_term=.f8cd50280326#comments 5.1.1 Reading .xlsx by readxl package readxlä¹ŸåŒ…å«åœ¨tidyverseçš„å¥—ä»¶é›†ä¸­ï¼Œæ‰€ä»¥æ‡‰è©²å·²ç¶“åœ¨å‰æ¬¡å®‰è£éï¼Œä¸ç”¨ç‰¹åˆ¥å®‰è£ã€‚ # Import readxl package library(readxl) options(stringsAsFactors = FALSE) # Use read_excel() to convert excel sheet to data.frame df &lt;- read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) 5.1.2 Previewing data by View(), class(), dim(), str(), summary() and names() # View(df) class(df) # [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; dim(df) ## [1] 197 156 # Show names of variables (vectors, columns) by names() names(df) ## [1] &quot;country&quot; &quot;iso2&quot; &quot;iso3&quot; ## [4] &quot;region&quot; &quot;wb_econ&quot; &quot;matleave_95&quot; ## [7] &quot;matleave_96&quot; &quot;matleave_97&quot; &quot;matleave_98&quot; ## [10] &quot;matleave_99&quot; &quot;matleave_00&quot; &quot;matleave_01&quot; ## [13] &quot;matleave_02&quot; &quot;matleave_03&quot; &quot;matleave_04&quot; ## [16] &quot;matleave_05&quot; &quot;matleave_06&quot; &quot;matleave_07&quot; ## [19] &quot;matleave_08&quot; &quot;matleave_09&quot; &quot;matleave_10&quot; ## [22] &quot;matleave_11&quot; &quot;matleave_12&quot; &quot;matleave_13&quot; ## [25] &quot;matleave_wrr_95&quot; &quot;matleave_wrr_96&quot; &quot;matleave_wrr_97&quot; ## [28] &quot;matleave_wrr_98&quot; &quot;matleave_wrr_99&quot; &quot;matleave_wrr_00&quot; ## [31] &quot;matleave_wrr_01&quot; &quot;matleave_wrr_02&quot; &quot;matleave_wrr_03&quot; ## [34] &quot;matleave_wrr_04&quot; &quot;matleave_wrr_05&quot; &quot;matleave_wrr_06&quot; ## [37] &quot;matleave_wrr_07&quot; &quot;matleave_wrr_08&quot; &quot;matleave_wrr_09&quot; ## [40] &quot;matleave_wrr_10&quot; &quot;matleave_wrr_11&quot; &quot;matleave_wrr_12&quot; ## [43] &quot;matleave_wrr_13&quot; &quot;bf_dur_95&quot; &quot;bf_dur_96&quot; ## [46] &quot;bf_dur_97&quot; &quot;bf_dur_98&quot; &quot;bf_dur_99&quot; ## [49] &quot;bf_dur_00&quot; &quot;bf_dur_01&quot; &quot;bf_dur_02&quot; ## [52] &quot;bf_dur_03&quot; &quot;bf_dur_04&quot; &quot;bf_dur_05&quot; ## [55] &quot;bf_dur_06&quot; &quot;bf_dur_07&quot; &quot;bf_dur_08&quot; ## [58] &quot;bf_dur_09&quot; &quot;bf_dur_10&quot; &quot;bf_dur_11&quot; ## [61] &quot;bf_dur_12&quot; &quot;bf_dur_13&quot; &quot;mat_bfeed_6mon_95&quot; ## [64] &quot;mat_bfeed_6mon_96&quot; &quot;mat_bfeed_6mon_97&quot; &quot;mat_bfeed_6mon_98&quot; ## [67] &quot;mat_bfeed_6mon_99&quot; &quot;mat_bfeed_6mon_00&quot; &quot;mat_bfeed_6mon_01&quot; ## [70] &quot;mat_bfeed_6mon_02&quot; &quot;mat_bfeed_6mon_03&quot; &quot;mat_bfeed_6mon_04&quot; ## [73] &quot;mat_bfeed_6mon_05&quot; &quot;mat_bfeed_6mon_06&quot; &quot;mat_bfeed_6mon_07&quot; ## [76] &quot;mat_bfeed_6mon_08&quot; &quot;mat_bfeed_6mon_09&quot; &quot;mat_bfeed_6mon_10&quot; ## [79] &quot;mat_bfeed_6mon_11&quot; &quot;mat_bfeed_6mon_12&quot; &quot;mat_bfeed_6mon_13&quot; ## [82] &quot;minage_fem_leg_95&quot; &quot;minage_fem_leg_96&quot; &quot;minage_fem_leg_97&quot; ## [85] &quot;minage_fem_leg_98&quot; &quot;minage_fem_leg_99&quot; &quot;minage_fem_leg_00&quot; ## [88] &quot;minage_fem_leg_01&quot; &quot;minage_fem_leg_02&quot; &quot;minage_fem_leg_03&quot; ## [91] &quot;minage_fem_leg_04&quot; &quot;minage_fem_leg_05&quot; &quot;minage_fem_leg_06&quot; ## [94] &quot;minage_fem_leg_07&quot; &quot;minage_fem_leg_08&quot; &quot;minage_fem_leg_09&quot; ## [97] &quot;minage_fem_leg_10&quot; &quot;minage_fem_leg_11&quot; &quot;minage_fem_leg_12&quot; ## [100] &quot;legal_diff_leg_95&quot; &quot;legal_diff_leg_96&quot; &quot;legal_diff_leg_97&quot; ## [103] &quot;legal_diff_leg_98&quot; &quot;legal_diff_leg_99&quot; &quot;legal_diff_leg_00&quot; ## [106] &quot;legal_diff_leg_01&quot; &quot;legal_diff_leg_02&quot; &quot;legal_diff_leg_03&quot; ## [109] &quot;legal_diff_leg_04&quot; &quot;legal_diff_leg_05&quot; &quot;legal_diff_leg_06&quot; ## [112] &quot;legal_diff_leg_07&quot; &quot;legal_diff_leg_08&quot; &quot;legal_diff_leg_09&quot; ## [115] &quot;legal_diff_leg_10&quot; &quot;legal_diff_leg_11&quot; &quot;legal_diff_leg_12&quot; ## [118] &quot;minage_fem_pc_95&quot; &quot;minage_fem_pc_96&quot; &quot;minage_fem_pc_97&quot; ## [121] &quot;minage_fem_pc_98&quot; &quot;minage_fem_pc_99&quot; &quot;minage_fem_pc_00&quot; ## [124] &quot;minage_fem_pc_01&quot; &quot;minage_fem_pc_02&quot; &quot;minage_fem_pc_03&quot; ## [127] &quot;minage_fem_pc_04&quot; &quot;minage_fem_pc_05&quot; &quot;minage_fem_pc_06&quot; ## [130] &quot;minage_fem_pc_07&quot; &quot;minage_fem_pc_08&quot; &quot;minage_fem_pc_09&quot; ## [133] &quot;minage_fem_pc_10&quot; &quot;minage_fem_pc_11&quot; &quot;minage_fem_pc_12&quot; ## [136] &quot;legal_diff_pc_95&quot; &quot;legal_diff_pc_96&quot; &quot;legal_diff_pc_97&quot; ## [139] &quot;legal_diff_pc_98&quot; &quot;legal_diff_pc_99&quot; &quot;legal_diff_pc_00&quot; ## [142] &quot;legal_diff_pc_01&quot; &quot;legal_diff_pc_02&quot; &quot;legal_diff_pc_03&quot; ## [145] &quot;legal_diff_pc_04&quot; &quot;legal_diff_pc_05&quot; &quot;legal_diff_pc_06&quot; ## [148] &quot;legal_diff_pc_07&quot; &quot;legal_diff_pc_08&quot; &quot;legal_diff_pc_09&quot; ## [151] &quot;legal_diff_pc_10&quot; &quot;legal_diff_pc_11&quot; &quot;legal_diff_pc_12&quot; ## [154] &quot;minwage_ppp_2013&quot; &quot;mw_overtime&quot; &quot;oecd&quot; 5.1.3 Select variables # Select the 3rd and 6th to 24th columns matleave &lt;- df[ , c(3, 6:24)] # Use class(), dim(), and str() to inspect the data class(matleave) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; dim(matleave) ## [1] 197 20 str(matleave) ## tibble [197 Ã— 20] (S3: tbl_df/tbl/data.frame) ## $ iso3 : chr [1:197] &quot;AFG&quot; &quot;ALB&quot; &quot;DZA&quot; &quot;AND&quot; ... ## $ matleave_95: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_96: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_97: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_98: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_99: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_00: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_01: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_02: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_03: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_04: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_05: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_06: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_07: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_08: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_09: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_10: num [1:197] 2 5 3 3 2 2 2 5 NA 5 ... ## $ matleave_11: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_12: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_13: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... 5.1.4 Check &amp; Replace NAs NA: Not Available v[is.na(v)] will select all NA cells ä»¥0å–ä»£NAçš„è³‡æ–™æ ¼ã€‚é¿å…ç¹ªåœ–ç”¢ç”ŸéŒ¯èª¤ sum(is.na(matleave))çš„ç›®çš„æ˜¯æª¢æ¸¬é‚„æœ‰æ²’æœ‰NAå€¼ã€‚å¦‚æœæœ‰çš„è©±is.na()å°±æœƒæ˜¯TRUEï¼Œé‚£éº¼åŠ ç¸½å¾Œï¼Œå¦‚æœä¸æ˜¯0ï¼Œé‚£å°±ä»£è¡¨é‚„æœ‰NAã€‚ # is.na() to indicate each element is NA or NOT(TRUE/FALSE) head(is.na(matleave), n=20) ## iso3 matleave_95 matleave_96 matleave_97 matleave_98 matleave_99 ## [1,] FALSE FALSE FALSE FALSE FALSE FALSE ## [2,] FALSE FALSE FALSE FALSE FALSE FALSE ## [3,] FALSE FALSE FALSE FALSE FALSE FALSE ## [4,] FALSE FALSE FALSE FALSE FALSE FALSE ## [5,] FALSE FALSE FALSE FALSE FALSE FALSE ## [6,] FALSE FALSE FALSE FALSE FALSE FALSE ## [7,] FALSE FALSE FALSE FALSE FALSE FALSE ## [8,] FALSE FALSE FALSE FALSE FALSE FALSE ## [9,] FALSE FALSE FALSE FALSE FALSE FALSE ## [10,] FALSE FALSE FALSE FALSE FALSE FALSE ## [11,] FALSE FALSE FALSE FALSE FALSE FALSE ## [12,] FALSE FALSE FALSE FALSE FALSE FALSE ## [13,] FALSE FALSE FALSE FALSE FALSE FALSE ## [14,] FALSE FALSE FALSE FALSE FALSE FALSE ## [15,] FALSE FALSE FALSE FALSE FALSE FALSE ## [16,] FALSE FALSE FALSE FALSE FALSE FALSE ## [17,] FALSE FALSE FALSE FALSE FALSE FALSE ## [18,] FALSE FALSE FALSE FALSE FALSE FALSE ## [19,] FALSE FALSE FALSE FALSE FALSE FALSE ## [20,] FALSE FALSE FALSE FALSE FALSE FALSE ## matleave_00 matleave_01 matleave_02 matleave_03 matleave_04 matleave_05 ## [1,] FALSE FALSE FALSE FALSE FALSE FALSE ## [2,] FALSE FALSE FALSE FALSE FALSE FALSE ## [3,] FALSE FALSE FALSE FALSE FALSE FALSE ## [4,] FALSE FALSE FALSE FALSE FALSE FALSE ## [5,] FALSE FALSE FALSE FALSE FALSE FALSE ## [6,] FALSE FALSE FALSE FALSE FALSE FALSE ## [7,] FALSE FALSE FALSE FALSE FALSE FALSE ## [8,] FALSE FALSE FALSE FALSE FALSE FALSE ## [9,] FALSE FALSE FALSE FALSE FALSE FALSE ## [10,] FALSE FALSE FALSE FALSE FALSE FALSE ## [11,] FALSE FALSE FALSE FALSE FALSE FALSE ## [12,] FALSE FALSE FALSE FALSE FALSE FALSE ## [13,] FALSE FALSE FALSE FALSE FALSE FALSE ## [14,] FALSE FALSE FALSE FALSE FALSE FALSE ## [15,] FALSE FALSE FALSE FALSE FALSE FALSE ## [16,] FALSE FALSE FALSE FALSE FALSE FALSE ## [17,] FALSE FALSE FALSE FALSE FALSE FALSE ## [18,] FALSE FALSE FALSE FALSE FALSE FALSE ## [19,] FALSE FALSE FALSE FALSE FALSE FALSE ## [20,] FALSE FALSE FALSE FALSE FALSE FALSE ## matleave_06 matleave_07 matleave_08 matleave_09 matleave_10 matleave_11 ## [1,] FALSE FALSE FALSE FALSE FALSE FALSE ## [2,] FALSE FALSE FALSE FALSE FALSE FALSE ## [3,] FALSE FALSE FALSE FALSE FALSE FALSE ## [4,] FALSE FALSE FALSE FALSE FALSE FALSE ## [5,] FALSE FALSE FALSE FALSE FALSE FALSE ## [6,] FALSE FALSE FALSE FALSE FALSE FALSE ## [7,] FALSE FALSE FALSE FALSE FALSE FALSE ## [8,] FALSE FALSE FALSE FALSE FALSE FALSE ## [9,] FALSE FALSE FALSE FALSE TRUE FALSE ## [10,] FALSE FALSE FALSE FALSE FALSE FALSE ## [11,] FALSE FALSE FALSE FALSE FALSE FALSE ## [12,] FALSE FALSE FALSE FALSE FALSE FALSE ## [13,] FALSE FALSE FALSE FALSE FALSE FALSE ## [14,] FALSE FALSE FALSE FALSE FALSE FALSE ## [15,] FALSE FALSE FALSE FALSE FALSE FALSE ## [16,] FALSE FALSE FALSE FALSE FALSE FALSE ## [17,] FALSE FALSE FALSE FALSE FALSE FALSE ## [18,] FALSE FALSE FALSE FALSE FALSE FALSE ## [19,] FALSE FALSE FALSE FALSE FALSE FALSE ## [20,] FALSE TRUE TRUE FALSE FALSE FALSE ## matleave_12 matleave_13 ## [1,] FALSE FALSE ## [2,] FALSE FALSE ## [3,] FALSE FALSE ## [4,] FALSE FALSE ## [5,] FALSE FALSE ## [6,] FALSE FALSE ## [7,] FALSE FALSE ## [8,] FALSE FALSE ## [9,] FALSE FALSE ## [10,] FALSE FALSE ## [11,] FALSE FALSE ## [12,] FALSE FALSE ## [13,] FALSE FALSE ## [14,] FALSE FALSE ## [15,] FALSE FALSE ## [16,] FALSE FALSE ## [17,] FALSE FALSE ## [18,] FALSE FALSE ## [19,] FALSE FALSE ## [20,] FALSE FALSE # Assign 0 to those NA data matleave[is.na(matleave)] &lt;- 0 # anyNA() to check if there are still NA cells. anyNA(matleave) ## [1] FALSE # sum(is.na()) to count the number of NA sum(is.na(matleave)) ## [1] 0 5.1.5 Filtering data 5.1.5.1 Filtered by the last year value # Use logical comparison to see if the last year equals to 5 # Assign matching data to var m5 m5 &lt;- matleave[matleave$&#39;matleave_13&#39;==5, ] # nrow() to count matching data nrow(m5) ## [1] 34 # Is it possible to use length() to check the data length? # matleave$&#39;matleave_13&#39; # matleave$&#39;matleave_13&#39;==5 # length(matleave$&#39;matleave_13&#39;==5) 5.1.5.2 Filtered data by the first year value # filter rows whose &#39;matleave_95&#39; is 5, and assign to var m55 m55&lt;- m5[m5$&#39;matleave_95&#39;==5,] # filter rows whose &#39;matleave_95&#39; is not 5, and assign to var m05 m05&lt;- m5[m5$&#39;matleave_95&#39;!=5,] 5.1.6 Plotting Plotting the second rows and all columns except 1st column Question ç‚ºä½•è¦unlist()ï¼Ÿè«‹è©¦è‘—åŸ·è¡Œbarplot(matleave[2, -1])é€™å€‹æ²’æœ‰unlist()çš„ç‰ˆæœ¬ï¼Œçœ‹çœ‹æœƒæœ‰ä»€éº¼éŒ¯èª¤è¨Šæ¯ã€‚è³‡æ–™çµæ§‹æœ‰ä½•å·®ç•°å‘¢ï¼Ÿ å˜—è©¦ç”¨class()æˆ–str()å˜—è©¦è§€å¯Ÿæ²’æœ‰unlist()ç‰ˆæœ¬çš„è³‡æ–™ï¼Œçœ‹çœ‹è³‡æ–™å‹æ…‹å’Œæœ‰unlist()çš„æœƒæœ‰ä½•ä¸åŒï¼Ÿ 5.1.6.1 Plotting one line # barplot() the second row of m55 # barplot(m55[2, ]) # raise error # barplot() the second row when neglecting the first column # barplot(m55[2, -1]) # raise error # Take a look at the data type of matleave[2, ] class(matleave[2, -1]) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(unlist(matleave[2, -1])) ## [1] &quot;numeric&quot; # unlist() to convert a single row data.frame to a vector for barplot() barplot(unlist(m55[2, -1])) Testing # View(matleave[1]) # select the 1st variable # View(matleave[ ,1]) # select the 1st column # View(matleave[1, ]) # select the 1st row class(m55[1]) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(m55[ ,1]) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(m55[1, ]) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; class(m55$iso3) # character (vector) ## [1] &quot;character&quot; 5.1.6.2 More arguments (args) # barplot() the unlisted second row (neglecting the first col) barplot(unlist(m55[2, -1])) # use ?barplot to know more argument of the function. ?barplot # Add arguments ylim, space, border, and axat/yaxt one by one to barplot() barplot(unlist(m55[2, -1]), ylim=c(0, 5)) barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0) barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0, border=NA) barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) 5.1.6.3 Plotting multiple lines åº•ä¸‹å¯ä»¥çœ‹è¦‹æ¯ä¸€è¡Œéå¸¸ç›¸ä¼¼ä¸”ä¸€è‡´çš„ç‰¹å¾µï¼Œåƒ…æœ‰matleaveå…§çš„ç´¢å¼•ç”±1è¢«åˆ—å‡ºè‡³6ã€‚å› æ­¤ï¼Œæœ€å¥½çš„æ–¹æ³•æ˜¯ç”¨è¿´åœˆï¼ˆfor-loopï¼‰çš„æ–¹å¼å°‡ç›¸åŒçš„ç¨‹å¼ç¢¼ï¼Œå¾1~6ä¹‹é–“åšå…­æ¬¡ã€‚ # plot the first row barplot(unlist(m55[1, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) # plot the second to 6th rows barplot(unlist(m55[2, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[3, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[4, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[5, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) barplot(unlist(m55[6, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) 5.1.6.4 for-loop to plot multiple lines # use for loop and use i as index to barplot multiple subgraphs for(i in 1:6){ barplot(unlist(m55[i, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) } 5.1.6.5 Sub-plots Check ?par to get paremeters of plotting **mai**: A numerical vector of the form c(bottom, left, top, right) which gives the margin size specified in inches. **mfcol, mfrow**:A vector of the form c(nr, nc). Subsequent figures will be drawn in an nr-by-nc array on the device by columns (mfcol), or rows (mfrow), respectively. # use ?par to get more plotting parameters ?par # use par() to set-up the layout of subgraphs # use the parameter main=c(0.2, 0.2, 0.2, 0.2) to thrink the padding of figures. par(mfrow=c(3,2), mai= c(0.2, 0.2, 0.2, 0.2)) for(i in 1:6){ barplot(unlist(m55[i, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) } # plot more rows to see what happens par(mfrow=c(3,2), mai= c(0.2, 0.2, 0.2, 0.2)) for(i in 1:10){ barplot(unlist(m55[i, -1]), ylim=c(0, 5), space=0, border=NA, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;) } # plot all subplots in a figure # nrow() to check number of row of m55. nrow(m55) ## [1] 18 # use par() to set-up plotting parameters. par(mfrow=c(4, 6), mai= c(0.2, 0.2, 0.2, 0.2)) # use for-loop to plot all graph as subgraph for (i in 1:nrow(m55)){ barplot(unlist(m55[i, -1]), border=NA, space=0, xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) } par(mfrow=c(4,6), mai= c(0.2, 0.2, 0.2, 0.2)) for (i in 1:nrow(m55)){ barplot(unlist(m55[i, -1]), border=NA, space=0,xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) title(m55[i,1], line = -4, cex.main=3) } 5.1.7 Practice02_1_1 Plotting more # plotting matleave_95 != 5 but matleve_13 == 5 # plotting for matleave_13 == 4 5.1.8 Practice02_2_2 selecting and filtering by dplyr I df &lt;- read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) # select columns by index # matleave &lt;- df[ , c(3, 6:24)] # select all NA cells and assign 0 to them # matleave[is.na(matleave)] &lt;- 0 # filter rows by condition # m5 &lt;- matleave[matleave$&#39;matleave_13&#39; == 5, ] # filter rows by condition # m55&lt;- m5[m5$&#39;matleave_95&#39; == 5,] # plot par(mfrow=c(4,6), mai= c(0.2, 0.2, 0.2, 0.2)) for (i in c(1:nrow(m55))){ barplot(unlist(m55[i,-1]), border=NA, space=0,xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) title(m55[i,1], line = -4, cex.main=3) } 5.1.9 (More) Clean version # readxl::read_excel() to import the xls file df &lt;- read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) # select iso3, and matleave columns by index matleave &lt;- df[ , c(3, 6:24)] # str() to inspect the data structure of str(matleave) ## tibble [197 Ã— 20] (S3: tbl_df/tbl/data.frame) ## $ iso3 : chr [1:197] &quot;AFG&quot; &quot;ALB&quot; &quot;DZA&quot; &quot;AND&quot; ... ## $ matleave_95: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_96: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_97: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_98: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_99: num [1:197] 2 5 3 2 2 2 2 3 1 5 ... ## $ matleave_00: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_01: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_02: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_03: num [1:197] 2 5 3 3 2 2 2 3 1 5 ... ## $ matleave_04: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_05: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_06: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_07: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_08: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_09: num [1:197] 2 5 3 3 2 2 2 5 1 5 ... ## $ matleave_10: num [1:197] 2 5 3 3 2 2 2 5 NA 5 ... ## $ matleave_11: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_12: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... ## $ matleave_13: num [1:197] 2 5 3 3 2 2 2 5 3 5 ... # select all NA cells and assign 0 to them matleave[is.na(matleave)] &lt;- 0 # filter rows by condition m5 &lt;- matleave[matleave$&#39;matleave_13&#39; == 5, ] # filter rows by condition m55&lt;- m5[m5$&#39;matleave_95&#39; == 5,] # plot par(mfrow=c(4,6), mai= c(0.2, 0.2, 0.2, 0.2)) for (i in c(1:nrow(m55))){ barplot(unlist(m55[i,-1]), border=NA, space=0,xaxt=&quot;n&quot;, yaxt=&quot;n&quot;, ylim = c(0,5)) title(m55[i,1], line = -4, cex.main=3) } library(tidyverse) options(stringsAsFactors = F) options(scipen = 999) library(readxl) read_excel(&quot;data/WORLD-MACHE_Gender_6.8.15.xls&quot;, &quot;Sheet1&quot;, col_names=T) %&gt;% select(iso3, 6:24) %&gt;% filter(matleave_13 == 5, matleave_95 == 5) %&gt;% gather(&quot;year&quot;, &quot;degree&quot;, 2:20) %&gt;% # spread(year, degree, fill = 0) %&gt;% View replace_na(list(degree = 0)) %&gt;% mutate(year2 = as.POSIXct(strptime(year, &quot;matleave_%y&quot;))) %&gt;% mutate(year3 = lubridate::year(year2)) %&gt;% ggplot() + aes(year3, degree) + geom_col(color = &quot;royalblue&quot;, fill = &quot;royalblue&quot;) + facet_wrap(~ iso3) + theme_void() 5.1.10 (More) The fittest version to compute staySame # staySame version # staySame &lt;- apply(m5[,2:20], 1, function(x) length(unique(x[!is.na(x)]))) # m55 &lt;- m5[staySame, ] # m50 &lt;- m5[!staySame, ] 5.2 Pivot Analysis on TP Theft 5.2.1 è®€å–æª”æ¡ˆ é¦–å…ˆè¦è‡³è‡ºåŒ—è³‡æ–™å¤§å¹³å°ä¸ŠæŸ¥è©¢ã€Œä½å®…ç«Šç›œã€ï¼Œå¯ä»¥æ‰¾åˆ°è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Šã€‚å°‡è©²CSVæª”ä¸‹è¼‰è‡³å€‹äººæœ¬æ©Ÿç«¯ï¼Œç½®å…¥data è³‡æ–™å¤¾ä¸­ï¼Œä¾¿å¯ä»¥ç”¨read.csv()è®€å–è©²æª”æ¡ˆã€‚ read.csv() to read csv and convert it to a data.frame df &lt;- read.csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) head(df) ## ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» ## 1 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ ## 2 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ ## 3 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ ## 4 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ ## 5 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ ## 6 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ str(df) # Checking the strcutrue of it ## &#39;data.frame&#39;: 3347 obs. of 5 variables: ## $ ç·¨è™Ÿ : int 1 2 3 4 5 6 7 8 9 10 ... ## $ æ¡ˆé¡ : chr &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; ... ## $ ç™¼ç”Ÿæ—¥æœŸ: int 1030623 1040101 1040101 1040101 1040101 1040102 1040102 1040102 1040102 1040104 ... ## $ ç™¼ç”Ÿæ™‚æ®µ: chr &quot;08~10&quot; &quot;00~02&quot; &quot;00~02&quot; &quot;06~08&quot; ... ## $ ç™¼ç”Ÿåœ°é»: chr &quot;è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ&quot; ... summary(df) # glimpse() is the tibble package&#39;s function. ## ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ## Min. : 1.0 Length:3347 Min. :1030623 Length:3347 ## 1st Qu.: 837.5 Class :character 1st Qu.:1050320 Class :character ## Median :1674.0 Mode :character Median :1060708 Mode :character ## Mean :1674.0 Mean :1063954 ## 3rd Qu.:2510.5 3rd Qu.:1080306 ## Max. :3347.0 Max. :1110328 ## ç™¼ç”Ÿåœ°é» ## Length:3347 ## Class :character ## Mode :character ## ## ## ç”¨readr::read_csv()ä¾†è®€å–ã€‚ã€‚é™¤äº† baseå¥—ä»¶çš„read.csv()å¤–ï¼Œä¹Ÿå¯ä½¿ç”¨readrå¥—ä»¶çš„read_csv()å‡½å¼ä¾†è®€å–ï¼Œè©²å¥—ä»¶å±¬æ–¼tidyverseå¥—ä»¶ç³»çš„å…¶ä¸­ä¸€å€‹å¥—ä»¶ï¼Œå¦‚æœå·²ç¶“æœ‰ç”¨install.packages(\"tidyverse\")å®‰è£éï¼Œåªè¦ç”¨library(tidyverse)å°±å¯ä»¥ä½¿ç”¨read_csv()å‡½å¼ã€‚åœ¨æ­¤é¼“å‹µå„ä½ä½¿ç”¨tidyverseç³»åˆ—å¥—ä»¶ã€‚æ™®éä¾†èªªï¼Œread_csv() çš„åŠŸèƒ½å’Œæ•ˆæœéƒ½æœƒæ¯”read.csv()å¥½ï¼Œè©²å‡½å¼é‚„æœƒè‡ªå‹•çŒœæ¸¬æ¯å€‹è®Šæ•¸çš„è®Šæ•¸å‹æ…‹ä¸¦ç›´æ¥é€²è¡Œè½‰æ›ï¼ˆå°¤å…¶æ˜¯æœ‰æ™‚é–“æ¬„ä½çš„æ™‚å€™ï¼Œæœƒéå¸¸æ–¹ä¾¿ï¼‰ã€‚ é™¤éŒ¯ï¼šè¬ä¸€é‡åˆ°ä¸­æ–‡æª”æ¡ˆæœƒæœ‰è®€æª”ç·¨ç¢¼å•é¡Œæ™‚ï¼Œæœ‰å¯èƒ½è©²æª”æ¡ˆæ˜¯ç”¨big5ä¾†å„²å­˜çš„ï¼Œå¯ä»¥åœ¨read_csv()ä¸­è¨­å®šlocaleä¾†æŒ‡å®šè®€å–çš„ç·¨ç¢¼æ–¹æ³•ã€‚å¦‚read_csv(url, locale = locale(encoding = \"Big5\")) library(readr) df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) # df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;, locale = locale(encoding = &quot;Big5&quot;)) df ## # A tibble: 3,347 Ã— 5 ## ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» ## &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; ## 1 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ ## 2 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ ## 3 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ ## 4 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ ## 5 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ ## 6 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ ## 7 7 ä½å®…ç«Šç›œ 1040102 06~08 è‡ºåŒ—å¸‚è¬è¯å€ç³–?é‡Œå¤§ç†è¡—159å··1~30è™Ÿ ## 8 8 ä½å®…ç«Šç›œ 1040102 06~08 è‡ºåŒ—å¸‚è¬è¯å€ç³–?é‡Œå¤§ç†è¡—159å··1~30è™Ÿ ## 9 9 ä½å®…ç«Šç›œ 1040102 10~12 è‡ºåŒ—å¸‚ä¸­å±±å€å‰æ—è·¯121~150è™Ÿ ## 10 10 ä½å®…ç«Šç›œ 1040104 10~12 è‡ºåŒ—å¸‚ä¿¡ç¾©å€äº”å¸¸é‡Œæ°¸å‰è·¯225å··32å¼„1~30è™Ÿ ## # â€¦ with 3,337 more rows ç›´æ¥ä¾è³‡æ–™ç¶²å€è®€å–æª”æ¡ˆã€‚ç¾åœ¨çš„ç¨‹å¼èªè¨€æ‰€è¨­è¨ˆçš„è®€å–æª”æ¡ˆå‡½å¼é€šå¸¸æœƒå…è¨±ä½¿ç”¨è€…ç›´æ¥è®€å–è³‡æ–™æ‰€åœ¨çš„URLã€‚æ‰€ä»¥ï¼Œæˆ‘å€‘å¯ä»¥ç›´æ¥å¾ç¶²è·¯ä¸Šè¼‰å…¥å°åŒ—å¸‚ç«Šç›œæ¡ˆè³‡æ–™ã€‚é¦–å…ˆè¦è‡³è‡ºåŒ—è³‡æ–™å¤§å¹³å°ä¸ŠæŸ¥è©¢ã€Œä½å®…ç«Šç›œã€ï¼Œå¯ä»¥æ‰¾åˆ°è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Šï¼Œé»é¸å¾Œå°å³ä¸Šæ–¹çš„ä¸‹è¼‰æŒ‰å³éµå¯å–å¾—éˆçµåˆ°è©²è³‡æ–™çš„URLï¼ˆå¦‚https://data.taipei/api/getDatasetInfo/downloadResource?id=68785231-d6c5-47a1-b001-77eec70bec02&amp;rid=93d9bc2d-af08-4db7-a56b-9f0a49226fa3ï¼‰ã€‚ ç”±æ–¼è©²è³‡æ–™ç¶²å€ä¼¼éæ°¸ä¹…ç¶²å€ï¼Œæ•…æœ¬ç¯„ä¾‹ä¸¦æœªåŸ·è¡Œä»¥ä¸‹ç¨‹å¼ç¢¼ï¼Œåƒ…æä¾›ç¯„ä¾‹ç¨‹å¼ç¢¼è®“å€‹äººæ›¿æ›ç¶²å€ä¾†åšæ¸¬è©¦ã€‚ (åƒè€ƒ) ç”¨Rç¨‹å¼å°‡è©²ç¶²å€çš„æª”æ¡ˆæŠ“å›æœ¬æ©Ÿç«¯å„²å­˜ã€‚éƒ¨åˆ†Macé›»è…¦ç„¡æ³•ä½¿ç”¨read.csv()å¾ç¶²è·¯ä¸Šå–å¾—è³‡æ–™åˆè½‰ç‚ºdata.frameï¼Œä¸€å€‹å¯è¡Œçš„è¾¦æ³•æ˜¯å…ˆç”¨GET(url,write_disk(\"data/tptheft.csv\"))å°‡å…¶å–å›ä¸¦å‘½åç‚ºdata/tptheft.csvï¼Œä¹‹å¾Œå†ç”¨df &lt;- read.csv(\"data/tptheft.csv\")ç›´æ¥è®€å–è©²æª”æ¡ˆã€‚ 5.2.2 æŸ¥çœ‹è³‡æ–™å…§å®¹ View(df) ç”¨RStudioæ‰€æä¾›çš„GUIç›´æ¥è§€çœ‹è®Šæ•¸ã€‚è‡ªè¡Œç§»å»#è¨»è§£ç¬¦è™Ÿä¾†æ¸¬è©¦ï¼Œå› ç‚ºknitæˆhtmlæª”æ™‚ï¼Œæœ‰View()çš„æŒ‡ä»¤éƒ½æœƒé€ æˆknitç¨‹åºä¸­æ–·ã€‚ head(df) å–å‰é¢å…­ç­†è³‡æ–™ï¼ˆä¹Ÿå°±æ˜¯å…­åˆ—çš„è³‡æ–™ä¾†æ¦‚è§€è©²è³‡æ–™ï¼‰ class(df) å°å‡ºè©² str(df) # View(df) head(df) # get first part of the data.frame ## # A tibble: 6 Ã— 5 ## ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» ## &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; ## 1 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ ## 2 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ ## 3 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ ## 4 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ ## 5 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ ## 6 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ class(df) ## [1] &quot;spec_tbl_df&quot; &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; str(df) ## spec_tbl_df [3,347 Ã— 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame) ## $ ç·¨è™Ÿ : num [1:3347] 1 2 3 4 5 6 7 8 9 10 ... ## $ æ¡ˆé¡ : chr [1:3347] &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; &quot;ä½å®…ç«Šç›œ&quot; ... ## $ ç™¼ç”Ÿæ—¥æœŸ: num [1:3347] 1030623 1040101 1040101 1040101 1040101 ... ## $ ç™¼ç”Ÿæ™‚æ®µ: chr [1:3347] &quot;08~10&quot; &quot;00~02&quot; &quot;00~02&quot; &quot;06~08&quot; ... ## $ ç™¼ç”Ÿåœ°é»: chr [1:3347] &quot;è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ&quot; &quot;è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ&quot; ... ## - attr(*, &quot;spec&quot;)= ## .. cols( ## .. ç·¨è™Ÿ = col_double(), ## .. æ¡ˆé¡ = col_character(), ## .. ç™¼ç”Ÿæ—¥æœŸ = col_double(), ## .. ç™¼ç”Ÿæ™‚æ®µ = col_character(), ## .. ç™¼ç”Ÿåœ°é» = col_character() ## .. ) ## - attr(*, &quot;problems&quot;)=&lt;externalptr&gt; summary(df) ## ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ## Min. : 1.0 Length:3347 Min. :1030623 Length:3347 ## 1st Qu.: 837.5 Class :character 1st Qu.:1050320 Class :character ## Median :1674.0 Mode :character Median :1060708 Mode :character ## Mean :1674.0 Mean :1063954 ## 3rd Qu.:2510.5 3rd Qu.:1080306 ## Max. :3347.0 Max. :1110328 ## ç™¼ç”Ÿåœ°é» ## Length:3347 ## Class :character ## Mode :character ## ## ## # look up help help(summary) ?summary 5.2.3 è§€å¯Ÿè³‡æ–™ç¶­åº¦ e.g., dim(), ncol(), nrow(),length() dim(df) ## [1] 3347 5 ncol(df) ## [1] 5 nrow(df) ## [1] 3347 length(df) ## [1] 5 5.2.4 è§€å¯Ÿè®Šæ•¸åç¨± names(df) åˆ—å‡ºè®Šæ•¸åç¨± df$ç™¼ç”Ÿåœ°é» é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ df$ç™¼ç”Ÿæ™‚æ®µ é¡¯ç¤ºè©²è®Šæ•¸å…§å®¹ length(df$ç™¼ç”Ÿæ™‚æ®µ) é¡¯ç¤ºè©²è®Šæ•¸çš„é•·åº¦ï¼ˆç›¸ç•¶æ–¼æœ‰å¹¾å€‹ï¼‰ names(df) ## [1] &quot;ç·¨è™Ÿ&quot; &quot;æ¡ˆé¡&quot; &quot;ç™¼ç”Ÿæ—¥æœŸ&quot; &quot;ç™¼ç”Ÿæ™‚æ®µ&quot; &quot;ç™¼ç”Ÿåœ°é»&quot; head(df$ç™¼ç”Ÿåœ°é») ## [1] &quot;è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ&quot; ## [2] &quot;è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ&quot; ## [3] &quot;è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ&quot; ## [4] &quot;è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ&quot; ## [5] &quot;è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ&quot; ## [6] &quot;è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ&quot; head(df$ç™¼ç”Ÿæ™‚æ®µ) ## [1] &quot;08~10&quot; &quot;00~02&quot; &quot;00~02&quot; &quot;06~08&quot; &quot;10~12&quot; &quot;00~02&quot; length(df$ç™¼ç”Ÿæ™‚æ®µ) ## [1] 3347 5.2.5 èƒå–æ‰€éœ€æ–°è®Šé … è©²data.frameåŒ…å«ç·¨è™Ÿã€æ¡ˆé¡ã€ç™¼ç”Ÿæ—¥æœŸã€ç™¼ç”Ÿæ™‚æ®µã€ç™¼ç”Ÿåœ°é»äº”å€‹è®Šé …ã€‚å…¶ä¸­æ¯”è¼ƒæœ‰æ„ç¾©çš„æ‡‰è©²æ˜¯ç™¼ç”Ÿæ—¥æœŸã€ç™¼ç”Ÿæ™‚æ®µå’Œç™¼ç”Ÿåœ°é»ã€‚ç„¶è€Œï¼Œç™¼ç”Ÿåœ°é»å¹¾ä¹æ˜¯å®Œæ•´åœ°å€ï¼Œé™¤éè¦ç¹ªè£½ç™¼ç”Ÿçš„åœ°åœ–é»ä½åœ°åœ–ï¼Œæ‰æœƒéœ€è¦è¿‘ä¹å®Œæ•´çš„åœ°å€ã€‚å‡è¨­æˆ‘å€‘çš„ç›®æ¨™æ˜¯æŠ½å–å‡ºå°åŒ—å¸‚çš„ã€Œè¡Œæ”¿å€ã€ï¼Œç™¼ç”Ÿåœ°é»çš„æ ¼å¼é‚„è »ä¸€è‡´çš„å¦‚ã€Œè‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91120è™Ÿã€ã€‚å› æ­¤ï¼Œæˆ‘å€‘åªè¦æŠ½å‡ºç™¼ç”Ÿåœ°é»çš„ç¬¬4åˆ°ç¬¬5å€‹å­—ï¼Œæˆ–è€…ç¬¬46å€‹å­—å³å¯ã€‚ å¾ä¸€å€‹å­—ä¸²ä¸­æŠ½å–å‡ºç¬¬nå€‹å­—åˆ°ç¬¬må€‹å­—ï¼Œè¦ç”¨substr()æˆ–stringrå¥—ä»¶çš„str_sub()ã€‚å¯ä»¥ç”¨?substræˆ–?str_subæŸ¥è©¢helpä¸­çš„ç›¸é—œç”¨æ³•ã€‚åœ¨æ­¤ æˆ‘å°‡ä¸­æ–‡è®Šæ•¸ç¾åœ¨æ™‚é–“çš„è³‡æ–™æŒ‡çµ¦ä¸€å€‹æ–°çš„è‹±æ–‡è®Šé …timeã€‚ å¾è®Šæ•¸ç™¼ç”Ÿåœ°é»ï¼Œç”¨substr()å–å‡ºè¡Œæ”¿å€ï¼ˆregionï¼‰ æˆ–ç”¨stringr::str_sub() ?substræŸ¥è©¢å…¶ç”¨æ³•å’Œæ„ç¾©ã€‚ç›¸ç•¶æ–¼getting sub string since x to yã€‚ # Get substring of var &quot;ç™¼ç”Ÿæ™‚æ®µ&quot; and assign to a new time var df$time &lt;- df$ç™¼ç”Ÿæ™‚æ®µ # Get substring of var &quot;ç™¼ç”Ÿåœ°é»&quot; and assign to a new region var df$region &lt;- substr(df$ç™¼ç”Ÿåœ°é», 4, 5) df %&gt;% head() %&gt;% knitr::kable() ç·¨è™Ÿ æ¡ˆé¡ ç™¼ç”Ÿæ—¥æœŸ ç™¼ç”Ÿæ™‚æ®µ ç™¼ç”Ÿåœ°é» time region 1 ä½å®…ç«Šç›œ 1030623 08~10 è‡ºåŒ—å¸‚ä¸­æ­£å€å»ˆé–€è¡—91~120è™Ÿ 08~10 ä¸­æ­£ 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§è¡—1~30è™Ÿ 00~02 æ–‡å±± 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­æ±è·¯5æ®µ295å··6å¼„1~30è™Ÿ 00~02 ä¿¡ç¾© 4 ä½å®…ç«Šç›œ 1040101 06~08 è‡ºåŒ—å¸‚ä¸­å±±å€æ–°ç”ŸåŒ—è·¯1æ®µ91~120è™Ÿ 06~08 ä¸­å±± 5 ä½å®…ç«Šç›œ 1040101 10~12 è‡ºåŒ—å¸‚æ–‡å±±å€æ˜èˆˆé‡Œèˆˆéš†è·¯4æ®µ1~30è™Ÿ 10~12 æ–‡å±± 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°å¿ èª è·¯2æ®µ130å··1~30è™Ÿ 00~02 å£«æ— 5.2.6 (ç·´ç¿’) èƒå–monthè®Šé … é™¤äº†æ™‚é–“å’Œåœ°å€å¯èƒ½æœƒæœ‰å·®åˆ¥å¤–ï¼Œé‚£æœˆä»½æœƒä¸æœƒç«Šç›œæ¡ˆçš„æ•¸é‡ä¹Ÿæœ‰å·®ç•°å‘¢ï¼Ÿæœƒä¸æœƒå†¬å¤©å°å·ä¹Ÿéƒ½åœ¨å®¶ä¼‘æ¯äº†ï¼Œå¤å¤©å¤šå‘¢ï¼Ÿè«‹å˜—è©¦å¾ç™¼ç”Ÿæ—¥æœŸèƒå–å‡ºç«Šç›œæ¡ˆç™¼ç”Ÿçš„æœˆä»½ï¼Œä¸¦å„²å­˜ç‚ºä¸€å€‹æ–°çš„è®Šé …monthã€‚ # YOUR CODE SHOULD BE HERE 5.2.7 IV. æ¨ç´åˆ†æï¼šè¨ˆæ•¸ã€åŠ ç¸½èˆ‡å½™æ•´ã€‚ Pivot analysis: Counting and Summarizing æ¸…ç†å®Œè³‡æ–™å¾Œï¼Œæˆ‘å€‘è¦å›ç­”çš„ç¬¬ä¸€å€‹æ•¸æ“šå•é¡Œé€šå¸¸æ˜¯ã€Œé‚£XXXçš„æ¡ˆä¾‹æœ‰å¹¾å€‹ï¼Ÿã€ä¾‹å¦‚ï¼šå¤§å®‰å€æœ‰å¤šå°‘ç«Šç›œæ¡ˆï¼Ÿ10~12é€™å€‹æ™‚æ®µæœ‰å¤šå°‘æ¡ˆä¾‹ã€‚ 5.2.8 æ–¹æ³•ä¸€ï¼šCounting by table() table()å‡½å¼å¯ä»¥å°Vectorä¸­çš„å€¼é€²è¡Œè¨ˆæ•¸ï¼ˆCountingï¼‰ã€‚table(df$time) ç›¸ç•¶æ–¼å»è¨ˆæ•¸ä¸åŒçš„æ™‚é–“å€é–“å‡ºç¾å¤šå°‘èµ·æ¡ˆä¾‹ï¼›table(df$region) ç›¸ç•¶æ–¼å»è¨ˆæ•¸ä¸åŒåœ°å€å„å‡ºç¾å¤šå°‘èµ·æ¡ˆä¾‹ã€‚ æç¤ºï¼šå¯ä»¥ç”¨class(tb_1) è§€å¯Ÿç”¨table() è¨ˆæ•¸å¾Œæ‰€ç”¢ç”Ÿçš„è³‡æ–™å‹æ…‹ï¼ˆtableï¼‰ã€‚ # counting the frequency of time variable (tb_1 &lt;- table(df$time)) ## ## 00~02 02~04 03~05 04~06 05~07 06~08 08~10 09~11 10~12 11~03 11~13 12~14 12~15 ## 272 214 8 156 23 191 305 6 338 1 26 338 2 ## 14~16 15~17 15~18 16~18 17~19 18~20 18~21 19~21 20~22 21~23 21~24 22~24 23~01 ## 342 3 1 246 21 314 1 4 303 5 1 206 20 class(tb_1) # table ## [1] &quot;table&quot; # counting the frequency of region variable table(df$region) ## ## åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ ## 318 311 172 181 303 373 220 350 204 214 438 263 5.2.9 æ–¹æ³•äºŒï¼šCounting by tapply() æˆ‘å€‘ä¹Ÿå¯ç”¨tapply() å‡½å¼ä¾†é”åˆ°ä¸€æ¨£çš„ç›®çš„ã€‚Applyå®¶æ—çš„å‡½å¼éƒ½æ˜¯ï¼Œé‡å°æŸå€‹è³‡æ–™ï¼Œå°‡æŸå€‹å‡½å¼å¥—ç”¨åˆ°æŸå€‹ç‰©ä»¶ä¸Šã€‚tapply() å³æ˜¯ç”¨ä¾†åšè¨ˆæ•¸çš„ï¼Œtapply(df$ç·¨è™Ÿ, df$time, length)æœ‰ä¸‰å€‹è¼¸å…¥ï¼Œç¬¬ä¸€å€‹è¼¸å…¥ç‚ºæ•´é«”ç‰©ä»¶ï¼Œç¬¬äºŒå€‹è¼¸å…¥ç‚ºè¦æ“šä»¥å½™æ•´çš„è®Šé …ï¼Œåœ¨æ­¤ç‚ºdf$timeï¼Œç¬¬ä¸‰å€‹æ˜¯è¦ç”¨ä¾†å½™æ•´çš„å‡½å¼ï¼Œå› ç‚ºé€™è£¡è¦åšè¨ˆæ•¸ï¼Œæ‰€ä»¥è¦ç”¨lengthå‡½å¼ã€‚ è¨»ï¼šåŒæ¨£ç”¨class()ä¾†è§€å¯Ÿå½™æ•´å¾Œçš„è³‡æ–™å‹æ…‹ç‚ºarrayï¼Œå’Œå‰è€…çš„tableè³‡æ–™å‹æ…‹ä¸åŒã€‚ # tapply() one arbitrary var by var time with length() function (tb_2 &lt;- tapply(df$ç·¨è™Ÿ, df$time, length)) ## 00~02 02~04 03~05 04~06 05~07 06~08 08~10 09~11 10~12 11~03 11~13 12~14 12~15 ## 272 214 8 156 23 191 305 6 338 1 26 338 2 ## 14~16 15~17 15~18 16~18 17~19 18~20 18~21 19~21 20~22 21~23 21~24 22~24 23~01 ## 342 3 1 246 21 314 1 4 303 5 1 206 20 class(tb_2) ## [1] &quot;array&quot; # tapply() one arbitrary var by var region with length() function tapply(df$ç·¨è™Ÿ, df$region, length) ## åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ ## 318 311 172 181 303 373 220 350 204 214 438 263 5.2.10 V. ä¾ç…§è®Šæ•¸å€¼ç¯©é¸è³‡æ–™ è©²é …ç«Šç›œæ¡ˆè³‡æ–™æ•´ç†æ™‚ç¶“å¸¸ä¸æ…ç”¨ä¸åŒçš„æ™‚é–“å€é–“ä¾†æ¨™è¨˜ï¼Œæœ‰æ™‚å€™ä¹Ÿæœƒä¸å°å¿ƒæŠŠæ–°åŒ—å¸‚çš„è³‡æ–™çµ¦é‚£é€²ä¾†ï¼Œæ‰€ä»¥éœ€è¦åšè³‡æ–™ç¯©é¸ã€‚å¾å„å€‹æ™‚é–“å€é–“çš„ç«Šç›œæ¡ˆå‡ºç¾æ¬¡æ•¸ä¾†è§€å¯Ÿï¼Œæœ‰å°‘æ•¸çš„æ¡ˆä»¶å‡ºç¾åœ¨å¥‡æ•¸çš„æ™‚é–“å€é–“å¦‚09~11æˆ–12~15ç­‰ç­‰éœ€è¦ç¯©é™¤ï¼›å¾å„å€‹è¡Œæ”¿å€çš„ç«Šç›œæ¡ˆå‡ºç¾æ¬¡æ•¸ä¾†è§€å¯Ÿï¼Œç¢ºå¯¦éƒ½æ˜¯å°åŒ—å¸‚çš„ç«Šç›œæ¡ˆã€‚ æ¥ä¸‹ä¾†è¦ç”¨baseå¥—ä»¶çš„Rï¼Œæ ¹æ“šæŸå€‹è®Šæ•¸å€¼ï¼ˆä¾‹å¦‚ä¸Šè¿°çš„æ™‚é–“ï¼‰ä¾†ç¯©å‡ºç¬¦åˆæ¢ä»¶çš„è³‡æ–™ï¼Œæˆ–è€…ç¯©å»ä¸ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ã€‚å…¶èªæ³•æ˜¯è¦åœ¨df[ , ]é€—è™Ÿå‰åŠ ä¸Šç¯©é¸çš„æ¢ä»¶ï¼Œä¹Ÿå°±æ˜¯å°è³‡æ–™åˆ—é€²è¡Œç¯©é¸ï¼Œç¯©å‡ºæˆ–ç¯©é™¤éƒ½æ˜¯ä»¥æ•´åˆ—ç‚ºå–®ä½ã€‚åœ¨æ­¤çš„æ¢ä»¶æ˜¯df$timeåœ¨00~02ã€02~04ã€â€¦ä¹‹é–“ï¼›æˆ–è€…æ˜¯df$timeä¸åœ¨03~05ã€05~07ã€â€¦ä¹‹é–“ã€‚è¡¨ç¤ºæ³•åˆ†åˆ¥å¦‚ä¸‹ï¼š df$time %in% c(&quot;00~02&quot;, &quot;02~04&quot;, &quot;04~6&quot;,...) !df$time %in% c(&quot;03~05&quot;, &quot;05~07&quot;, ...) %in% è¡¨ç¤ºçš„æ˜¯å·¦æ–¹df$timeçš„å€¼æ˜¯å¦æ˜¯å³æ–¹Vectorä¸­çš„å…¶ä¸­ä¸€å€‹ å¦‚æœè¦è¡¨ç¤ºä¸åŒ…å«ï¼Œå°±åœ¨df%timeåŠ ä¸€å€‹NOTï¼Œä¹Ÿå°±æ˜¯!ã€‚ ä¾ç…§å„çµ„æ™‚é–“çš„æ¡ˆä¾‹å€‹æ•¸çµ±è¨ˆå¾Œï¼Œç¯©é™¤è³‡æ–™æœªè¶³100çš„æ™‚é–“å€é–“å¦‚ä¸‹ï¼Œæœ€å¾Œå†ç”¨table(df$time) è¨ˆç®—ä¸€æ¬¡ï¼Œç™¼ç¾æ¯å€‹æ™‚æ®µéƒ½å…©ä¸‰ã€ç™¾å€‹æ¡ˆä¾‹ï¼Œä¸”æ¶µè“‹æ•´æ—¥çš„æ™‚é–“ã€‚æ¸…ç†å¾Œæ²’æœ‰é‡ç–Šçš„æ™‚é–“å€é–“ï¼Œåšé¡åˆ¥è³‡æ–™åˆ†ææœƒæ¯”è¼ƒæº–ç¢ºã€‚ # filter out irrelevant timestamp df &lt;- df[!df$time %in% c(&quot;03~05&quot;, &quot;05~07&quot;, &quot;09~11&quot;, &quot;11~13&quot;, &quot;12~15&quot;, &quot;15~17&quot;, &quot;15~18&quot;, &quot;17~19&quot;, &quot; 18~21&quot;, &quot;19~21&quot;, &quot;21~23&quot;, &quot;21~24&quot;, &quot;23~01&quot;), ] table(df$time) ## ## 00~02 02~04 04~06 06~08 08~10 10~12 11~03 12~14 14~16 16~18 18~20 18~21 20~22 ## 272 214 156 191 305 338 1 338 342 246 314 1 303 ## 22~24 ## 206 # filter out irrelevant region(area) # df &lt;- df[!df$region %in% c(&quot;ä¸‰é‡&quot;, &quot;ä¸­å’Œ&quot;, &quot;æ·¡æ°´&quot;, &quot;æ¿æ©‹&quot;), ] 5.2.11 VI. é›™è®Šæ•¸æ¨ç´åˆ†æ é¡åˆ¥è®Šé …åˆ†æé€šå¸¸æ˜¯è¦è€ƒé©—å…©å€‹è®Šé …é–“çš„é—œä¿‚ï¼Œå¾ä¸Šè¿°çš„è¨ˆæ•¸ä¸­ï¼Œæˆ‘å¯ä»¥çœ‹è¦‹ä¸åŒè¡Œæ”¿å€æˆ–è€…ä¸åŒæ™‚é–“çš„ç«Šç›œæ¡ˆæ•¸é‡ï¼Œä½†æˆ‘é€²ä¸€æ­¥æƒ³çŸ¥é“ï¼Œé‚£ä¸åŒè¡Œæ”¿å€çš„ç«Šç›œæ¡ˆå¸¸ç™¼ç”Ÿæ™‚é–“æ˜¯å¦ä¸åŒï¼Ÿé€™æ™‚å¾Œå°±è¦åšæ™‚é–“å’Œè¡Œæ”¿å€çš„äº¤å‰åˆ†æã€‚æˆ‘å€‘åŒæ¨£å¯ä»¥ç”¨table()å’Œtapply()ä¾†åšå…©å€‹è®Šé …çš„äº¤å‰åˆ†æï¼Œå¯«æ³•å¦‚ä¸‹ã€‚ 5.2.11.1 (1) by table() ç”¨table()ä¾†äº¤å‰åˆ†æçš„çµæœå¦‚ä¸‹ï¼Œæ‰€å¾—åˆ°çš„çµæœä¹‹è®Šæ•¸å‹æ…‹ä»æ˜¯tableå‹æ…‹ã€‚ # Tabulating time and region variables (res_table &lt;- table(df$time, df$region)) ## ## åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ ## 00~02 24 24 15 19 20 28 4 17 17 27 62 15 ## 02~04 17 15 10 12 15 29 13 29 14 12 26 22 ## 04~06 17 14 15 6 15 14 5 22 8 11 22 7 ## 06~08 24 19 9 13 16 17 11 21 9 13 20 19 ## 08~10 22 31 17 16 27 24 24 34 18 20 45 27 ## 10~12 35 34 12 19 33 35 35 41 18 18 38 20 ## 11~03 0 0 0 0 0 0 0 0 0 0 1 0 ## 12~14 34 49 12 15 26 46 23 33 25 20 30 25 ## 14~16 32 32 26 20 39 40 22 32 19 18 43 19 ## 16~18 33 25 13 11 24 30 20 26 16 8 21 19 ## 18~20 40 23 13 18 22 31 17 23 23 23 39 42 ## 18~21 0 0 0 0 0 0 0 0 0 0 1 0 ## 20~22 17 26 13 20 34 41 25 37 15 22 40 13 ## 22~24 15 12 9 9 18 23 14 20 17 16 33 20 # Checking it class and its content class(res_table) ## [1] &quot;table&quot; 5.2.11.2 (2) by tapply() ç”¨tapply()ä¾†åšå…©å€‹è®Šæ•¸äº¤å‰åˆ†æçš„èªæ³•å¦‚ä¸‹ï¼Œå¿…é ˆè¦æŠŠå…©å€‹VectoråŒ…åœ¨ä¸€å€‹list()ä¸­ã€‚å…¶ä»–ä¸è®Šã€‚å…©å€‹è®Šé …ç”¨tapply()äº¤å‰åˆ†æå¾Œçš„çµæœï¼Œè®Šæ•¸å‹æ…‹æœƒè®Šæˆmatrixã€‚å‰è€…ç”¨table()ä¾†äº¤å‰åˆ†æçš„ä»æ˜¯tableå‹æ…‹ã€‚ res_tapply &lt;- tapply(df$ç·¨è™Ÿ, list(df$time, df$region), length) class(res_tapply) ## [1] &quot;matrix&quot; &quot;array&quot; res_tapply ## åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ ## 00~02 24 24 15 19 20 28 4 17 17 27 62 15 ## 02~04 17 15 10 12 15 29 13 29 14 12 26 22 ## 04~06 17 14 15 6 15 14 5 22 8 11 22 7 ## 06~08 24 19 9 13 16 17 11 21 9 13 20 19 ## 08~10 22 31 17 16 27 24 24 34 18 20 45 27 ## 10~12 35 34 12 19 33 35 35 41 18 18 38 20 ## 11~03 NA NA NA NA NA NA NA NA NA NA 1 NA ## 12~14 34 49 12 15 26 46 23 33 25 20 30 25 ## 14~16 32 32 26 20 39 40 22 32 19 18 43 19 ## 16~18 33 25 13 11 24 30 20 26 16 8 21 19 ## 18~20 40 23 13 18 22 31 17 23 23 23 39 42 ## 18~21 NA NA NA NA NA NA NA NA NA NA 1 NA ## 20~22 17 26 13 20 34 41 25 37 15 22 40 13 ## 22~24 15 12 9 9 18 23 14 20 17 16 33 20 # View(res) 5.2.11.3 (3) by dplyr::count() é€™é‚Šå¤šä»‹ç´¹ä¸€å€‹ç”¨dplyrå¥—ä»¶çš„count()å‡½å¼ä¾†åšäº¤å‰åˆ†æçš„æ–¹æ³•ï¼ˆæœªä¾†æœƒå¸¸ç”¨é€™å€‹æ–¹æ³•ï¼Œå› ç‚ºdplyræ˜¯tidyverseç³»åˆ—å¥—ä»¶çš„æ ¸å¿ƒå¥—ä»¶ã€‚dplyrçš„å‡½å¼ç¬¬ä¸€å€‹åƒæ•¸æ°¸é æ˜¯è©²data.frameï¼Œ ä¾‹å¦‚count()ï¼›å¾Œé¢timeèˆ‡regionå‰‡æ˜¯é€™å€‹data.frameä¸­çš„å…©å€‹è®Šé …ã€‚ä¸åƒtapply()æˆ–table()çš„çµæœä¸€æ¨£ï¼Œæ¬„èˆ‡åˆ—åˆ†åˆ¥ç‚ºtimeèˆ‡regionï¼Œcount()å‡ºä¾†çš„çµæœæœƒæœ‰å…©å€‹è®Šé …åˆ†åˆ¥æ˜¯æŒ‡å®šè¦è¨ˆæ•¸çš„timeèˆ‡region ï¼Œä¸”æœƒæ–°å¢ä¸€å€‹è®Šé …nï¼Œä»£è¡¨é€™çµ„æ•¸æ“šï¼ˆtime x regionï¼‰å…±æœ‰å¹¾å€‹ã€‚é€™ç¨®è¡¨é”å‹æ…‹é€šå¸¸ç¨±ç‚ºlong-tableï¼ˆé•·è¡¨ï¼‰ã€è€Œtapply()æˆ–table() çš„çµæœé€šå¸¸ç¨±ç‚ºwide-tableï¼ˆå¯¬è¡¨ï¼‰ç‚ºå…¸å‹çš„äº¤å‰åˆ†æè¡¨ã€‚ ç›®å‰å¤§éƒ¨åˆ†çš„é¡åˆ¥è³‡æ–™åˆ†æé‚„æ˜¯æœƒæ¡ç”¨äº¤å‰åˆ†æè¡¨çš„å‹æ…‹ï¼Œä½†æœªä¾†æˆ‘å€‘è¦ç”¨tidyverseç³»åˆ—å¥—ä»¶åšå¤§é‡çš„æ•¸æ“šå½™æ•´æˆ–è¦–è¦ºåŒ–æ™‚ï¼Œéƒ½æœƒç›¡å¯èƒ½æƒ³è¾¦æ³•è½‰ç‚ºLong-tableå‹æ…‹ï¼Œè®“æ¯ä¸€æ¬„å‰›å¥½å°±æ˜¯ä¸€å€‹è®Šé …ã€‚åªè¦æ˜¯tidyverseç³»åˆ—å¥—ä»¶æ‰€è¨ˆç®—å‡ºä¾†çš„è³‡æ–™å‹æ…‹å¹¾ä¹éƒ½æ˜¯é¡ä¼¼data.frameçš„å‹æ…‹ï¼Œä¾‹å¦‚è§€å¯Ÿcountçš„çµæœä¾¿æ˜¯\"tbl_df\" \"tbl\" \"data.frame\"ã€‚ # counting by dplyr::count() library(dplyr) (res_count &lt;- count(df, time, region)) ## # A tibble: 146 Ã— 3 ## time region n ## &lt;chr&gt; &lt;chr&gt; &lt;int&gt; ## 1 00~02 åŒ—æŠ• 24 ## 2 00~02 å¤§å®‰ 24 ## 3 00~02 å¤§åŒ 15 ## 4 00~02 å—æ¸¯ 19 ## 5 00~02 å…§æ¹– 20 ## 6 00~02 å£«æ— 28 ## 7 00~02 æ¾å±± 4 ## 8 00~02 è¬è¯ 17 ## 9 00~02 æ–‡å±± 17 ## 10 00~02 ä¿¡ç¾© 27 ## # â€¦ with 136 more rows (res_count &lt;- count(df, time, region)) %&gt;% datatable() class(res_count) # &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; é‚£é•·è¡¨åˆ—å¯ä»¥è½‰ç‚ºå¯¬è¡¨å—ï¼Ÿå¯ä»¥ï¼Œtidyverseç³»åˆ—å¥—ä»¶ä¸­çš„tidyrå¥—ä»¶æœ‰å€‹å‡½å¼spread()å¯ä»¥æ¥è‘—æŠŠæŸå€‹è®Šé …å±•é–‹ç‚ºæ¬„ã€‚ä¾‹å¦‚åŸæœ¬ä¸Šè¿°çš„åˆ—æ˜¯æ™‚é–“èˆ‡è¡Œæ”¿å€çš„äº¤å‰çµ„åˆï¼Œä½†æˆ‘å¯ä»¥æŠŠè¡Œæ”¿å€å±•é–‹ç‚ºæ¬„ã€æˆ–è€…æŠŠæ™‚é–“å±•é–‹ç‚ºæ¬„ã€‚spread(res_count, region, n, fill = 0) æœ‰å››å€‹åƒæ•¸ï¼Œéµå¾ªtidyverseç³»åˆ—å¥—ä»¶çš„è¦å‰‡ï¼Œç¬¬ä¸€å€‹ä½ç½®ç‚ºdata.frameï¼Œç¬¬äºŒå€‹åƒæ•¸å‰‡æ˜¯è¦è¢«å±•é–‹è‡³æ¬„çš„è®Šé …é€™è£¡ç‚ºregionï¼Œç¬¬ä¸‰å€‹åƒæ•¸å‰‡æ˜¯å› æ‡‰regionè¢«å±•é–‹å¾Œï¼Œé‚£ä¸­é–“äº¤å‰åˆ†æçš„æ•¸å€¼å°±æ˜¯nï¼Œæœ€å¾Œä¸€å€‹åƒæ•¸æ˜¯é¿å…spreadæ™‚æœ‰äº›äº¤å‰çµ„æ˜¯æ²’æœ‰è³‡æ–™çš„ï¼Œå› æ­¤fill=0å¯ä»¥æŒ‡å®šï¼Œå¦‚æœæŸå€‹time x regionçš„äº¤å‰çµ„åˆ¥æ˜¯æ²’è³‡æ–™çš„ï¼Œå°±å¡«ä¸Š0ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç”¨fill=NAå¡«ä¸ŠNAã€‚ä»¥ä¸‹çš„ä¾‹å­ä¸­ä¹Ÿæä¾›äº†å°‡time å±•é–‹è‡³æ¬„çš„å¯«æ³•ä¾›åƒè€ƒã€‚ å±•é–‹å¾Œçš„è³‡æ–™å‹æ…‹å’Œå‰è€…è¨ˆæ•¸å¾Œçš„è³‡æ–™å‹æ…‹ä¸€æ¨£ï¼Œéƒ½æ˜¯\"tbl_df\" \"tbl\" \"data.frame\"ã€‚é€™æ˜¯ç‚ºä»€éº¼tidyverseç³»åˆ—çš„å¥—ä»¶é€æ¼¸è®ŠæˆRçš„é¡¯å­¸çš„åŸå› ä¹‹ä¸€ã€‚ library(tidyr) # spreading the region into columns (res_count_spread &lt;- spread(res_count, region, n, fill = 0)) ## # A tibble: 14 Ã— 13 ## time åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 00~02 24 24 15 19 20 28 4 17 17 27 62 15 ## 2 02~04 17 15 10 12 15 29 13 29 14 12 26 22 ## 3 04~06 17 14 15 6 15 14 5 22 8 11 22 7 ## 4 06~08 24 19 9 13 16 17 11 21 9 13 20 19 ## 5 08~10 22 31 17 16 27 24 24 34 18 20 45 27 ## 6 10~12 35 34 12 19 33 35 35 41 18 18 38 20 ## 7 11~03 0 0 0 0 0 0 0 0 0 0 1 0 ## 8 12~14 34 49 12 15 26 46 23 33 25 20 30 25 ## 9 14~16 32 32 26 20 39 40 22 32 19 18 43 19 ## 10 16~18 33 25 13 11 24 30 20 26 16 8 21 19 ## 11 18~20 40 23 13 18 22 31 17 23 23 23 39 42 ## 12 18~21 0 0 0 0 0 0 0 0 0 0 1 0 ## 13 20~22 17 26 13 20 34 41 25 37 15 22 40 13 ## 14 22~24 15 12 9 9 18 23 14 20 17 16 33 20 class(res_count_spread) ## [1] &quot;tbl_df&quot; &quot;tbl&quot; &quot;data.frame&quot; # spreading the time into columns # res_count_spread &lt;- spread(res_count, time, n, fill = 0) res_count_spread ## # A tibble: 14 Ã— 13 ## time åŒ—æŠ• å¤§å®‰ å¤§åŒ å—æ¸¯ å…§æ¹– å£«æ— æ¾å±± è¬è¯ æ–‡å±± ä¿¡ç¾© ä¸­å±± ä¸­æ­£ ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 00~02 24 24 15 19 20 28 4 17 17 27 62 15 ## 2 02~04 17 15 10 12 15 29 13 29 14 12 26 22 ## 3 04~06 17 14 15 6 15 14 5 22 8 11 22 7 ## 4 06~08 24 19 9 13 16 17 11 21 9 13 20 19 ## 5 08~10 22 31 17 16 27 24 24 34 18 20 45 27 ## 6 10~12 35 34 12 19 33 35 35 41 18 18 38 20 ## 7 11~03 0 0 0 0 0 0 0 0 0 0 1 0 ## 8 12~14 34 49 12 15 26 46 23 33 25 20 30 25 ## 9 14~16 32 32 26 20 39 40 22 32 19 18 43 19 ## 10 16~18 33 25 13 11 24 30 20 26 16 8 21 19 ## 11 18~20 40 23 13 18 22 31 17 23 23 23 39 42 ## 12 18~21 0 0 0 0 0 0 0 0 0 0 1 0 ## 13 20~22 17 26 13 20 34 41 25 37 15 22 40 13 ## 14 22~24 15 12 9 9 18 23 14 20 17 16 33 20 # ??dplyr::count å¯¬è¡¨æ ¼äº¦å¯ç”¨tidyrçš„gather()å‡½å¼è½‰å›é•·è¡¨æ ¼å‹æ…‹ï¼š (long_table &lt;- tidyr::gather(res_count_spread, region, n, -time)) ## # A tibble: 168 Ã— 3 ## time region n ## &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 00~02 åŒ—æŠ• 24 ## 2 02~04 åŒ—æŠ• 17 ## 3 04~06 åŒ—æŠ• 17 ## 4 06~08 åŒ—æŠ• 24 ## 5 08~10 åŒ—æŠ• 22 ## 6 10~12 åŒ—æŠ• 35 ## 7 11~03 åŒ—æŠ• 0 ## 8 12~14 åŒ—æŠ• 34 ## 9 14~16 åŒ—æŠ• 32 ## 10 16~18 åŒ—æŠ• 33 ## # â€¦ with 158 more rows 5.2.12 (Practice) count() è«‹ç·´ç¿’çœ‹çœ‹å¦‚æœç”¨count()ä¾†è¨ˆæ•¸å–®ä¸€è®Šé …ï¼Œå¦‚å‰è¿°çš„regionã€timeæˆ–å‰é¢ç·´ç¿’ä¸­æ–°ç”¢ç”Ÿçš„monthã€‚ # YOUR CODE SHOULD BE HERE 5.2.13 VII. ç¹ªåœ– Plotting é€šå¸¸é€™ç¨®é¡åˆ¥è³‡æ–™äº¤å‰åˆ†ææœ€å¸¸ç”¨çš„åœ–è¡¨å‹æ…‹ä¹‹ä¸€ä¾¿æ˜¯Mosaic Plotï¼ˆä½†äº‹å¯¦ä¸ŠMosaic Plotä¸è¦‹èƒ½å¤ è¢«ä¸€çœ¼å°±äº†è§£ï¼‰ã€‚æˆ‘å€‘å¯ä»¥æŠŠäº¤å‰åˆ†æå¾Œçš„è®Šé …res_tableç›´æ¥ç”¨MosaicPlotä¾†ç¹ªåœ–ã€‚ # mosaicplot() to plot 2-dim categorical vars. mosaicplot(res_table) # Add argument main (figure title) mosaicplot(res_table, main=&quot;mosaic plot&quot;) 5.2.13.1 (1) ç„¡æ³•é¡¯ç¤ºä¸­æ–‡ å¤§éƒ¨åˆ†çš„è¦–è¦ºåŒ–å¥—ä»¶éƒ½ç„¡æ³•é †åˆ©é¡¯ç¤ºä¸­æ–‡ï¼Œé™¤éç‰¹åˆ¥æŒ‡å®šæ‰€è¦ç”¨çš„ä¸­æ–‡å­—å‹ã€‚é€™æ–¹é¢ç¶²è·¯ä¸Šå¯ä»¥æ‰¾åˆ°å¾ˆå¤šçš„èªªæ˜ï¼Œä½†éå¸¸è¨å­çš„æ˜¯ï¼Œå¹¾ä¹æ¯æ›ä¸€å¥—è¦–è¦ºåŒ–å·¥å…·ï¼Œæ›ä¸€å¥—èªè¨€ï¼Œå°±æœ‰ä¸åŒçš„ä¸­æ–‡å­—é«”æŒ‡å®šæ–¹å¼ã€‚ä¾‹å¦‚ç”¨baseçš„plot()ä¾†ç¹ªåœ–æˆ–ç”¨ggplot()çš„ä¸­æ–‡å­—å‹æŒ‡å®šæ–¹æ³•ä¾¿ä¸åŒï¼Œä¸”è»¸ä¸Šé¢æœ‰ä¸­æ–‡ã€åœ–æ¨™æœ‰ä¸­æ–‡ã€æˆ–è€…åœ–å…§æœ‰ä¸­æ–‡éƒ½è¦åˆ†é–‹æŒ‡å®šï¼Œéå¸¸è¨äººå­ã€‚ Mosaic Plotå±¬æ–¼base Rçš„plot()ï¼Œå…¶ä¸­æ–‡æŒ‡å®šæ–¹æ³•è¦æŒ‡å®šåœ¨ç¹ªåœ–å‰çš„par()å‡½å¼ä¸­ï¼ˆparç‚ºparameterçš„æ„æ€ï¼‰ï¼ŒæŒ‡å®šæ–¹æ³•ç‚ºpar(family=('Heiti TC Light'))ï¼ŒHeiti TC Lightç‚ºå­—é«”åç¨±ï¼Œç‚ºOSXä¸Šåœ¨ç”¨çš„é»‘é«”ç´°å­—ï¼ŒSTKaitiå‰‡ç‚ºæ¨™æ¥·é«”ã€‚ç„¶å¾Œï¼Œpar()å’Œmosaicplot()å…©å€‹å‡½å¼è¦ã€ŒåŒæ™‚åŸ·è¡Œã€ï¼Œä¹Ÿå°±æ˜¯è«‹ä½ ç›´æ¥ç”¨shift-cmd(ctrl)-EnteråŸ·è¡Œæ•´å€‹code-cellï¼Œæˆ–è€…å°‡è©²å…©å€‹å‡½å¼é¸èµ·ä¾†ä¸€æ¬¡åŸ·è¡Œã€‚ par(family=(&#39;STKaiti&#39;)) # par(family=(&#39;Heiti TC Light&#39;)) mosaicplot(res_table, main=&quot;mosaic plot&quot;, color=T) 5.2.13.2 (2) è‡ªè¨‚é¡è‰² ç›®å‰é¡è‰²å¯¦åœ¨éé†œï¼Œä½ å¯ä»¥è‡ªè¨‚é¡è‰²æŒ‡çµ¦mosaicplot()ã€‚ä¾‹å¦‚æˆ‘åº•ä¸‹ä¾¿ç”¢è£½äº†12ç¨®é¡è‰²å¾Œï¼Œå°‡å…¶ä½œç‚ºmosaicplot()çš„åƒæ•¸ # Set up color by yourself. colors &lt;- c(&#39;#D0104C&#39;, &#39;#DB4D6D&#39;, &#39;#E83015&#39;, &#39;#F75C2F&#39;, &#39;#E79460&#39;, &#39;#E98B2A&#39;, &#39;#9B6E23&#39;, &#39;#F7C242&#39;, &#39;#BEC23F&#39;, &#39;#90B44B&#39;, &#39;#66BAB7&#39;, &#39;#1E88A8&#39;) # par(family=(&#39;STKaiti&#39;)) par(family=(&#39;Heiti TC Light&#39;)) mosaicplot(res_table, color=colors, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) 5.2.14 (Option) è¦–è¦ºåŒ–æ®˜å·®åˆ†æ # par(family=(&#39;STKaiti&#39;)) par(family=(&#39;Heiti TC Light&#39;)) mosaicplot(res_table, color=T, shade = T, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) "],["data-manipulation-wity-tidyverse.html", "Chapter 6 Data Manipulation wity tidyverse 6.1 base to dplyr: TP Theft", " Chapter 6 Data Manipulation wity tidyverse 6.1 base to dplyr: TP Theft library(tidyverse) # options(stringsAsFactors = F) # default options in R ver.&gt; 4.0 6.1.1 Reading data # Read by read_csv() # Will raise error # Error in make.names(x) : invalid multibyte string at &#39;&lt;bd&gt;s&lt;b8&gt;&lt;b9&gt;&#39; # df &lt;- read_csv(&quot;data/tp_theft.csv&quot;) # read_csv() with locale = locale(encoding = &quot;Big5&quot;) library(readr) df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) 6.1.2 Cleaning data I Renaming variables by select() Generating variable year Generating variable month Retrieving area selected_df &lt;- df %&gt;% select(id = ç·¨è™Ÿ, cat = æ¡ˆé¡, date = `ç™¼ç”Ÿæ—¥æœŸ`, time = `ç™¼ç”Ÿæ™‚æ®µ`, location = `ç™¼ç”Ÿåœ°é»`) %&gt;% mutate(year = date %/% 10000) %&gt;% mutate(month = date %/% 100 %% 100) %&gt;% mutate(area = stringr::str_sub(location, 4, 6)) %&gt;% mutate(county = stringr::str_sub(location, 1, 3)) 6.1.3 Cleaning data II Filtering out irrelevant data records # readr::guess_encoding(&quot;data/tp_theft.csv&quot;) filtered_df &lt;- selected_df %&gt;% # count(year) %&gt;% View filter(county == &quot;è‡ºåŒ—å¸‚&quot;) %&gt;% filter(year &gt;= 104) %&gt;% # count(time) %&gt;% View # count(location) %&gt;% filter(!area %in% c(&quot;ä¸­å’Œå¸‚&quot;, &quot;æ¿æ©‹å¸‚&quot;)) 6.1.4 Long to wide form count() two variables spread() spread one variable as columns to wide form # count() then spread() df.wide &lt;- filtered_df %&gt;% count(time, area) %&gt;% spread(area, n, fill=0) 6.1.5 Setting time as row.name for mosaicplot row.names(df.wide) &lt;- df.wide$time df.wide$time &lt;- NULL # Specify fonts for Chinese # par(family=(&#39;STKaiti&#39;)) par(family=(&#39;Heiti TC Light&#39;)) # for mac # Specify colors colors &lt;- c(&#39;#D0104C&#39;, &#39;#DB4D6D&#39;, &#39;#E83015&#39;, &#39;#F75C2F&#39;, &#39;#E79460&#39;, &#39;#E98B2A&#39;, &#39;#9B6E23&#39;, &#39;#F7C242&#39;, &#39;#BEC23F&#39;, &#39;#90B44B&#39;, &#39;#66BAB7&#39;, &#39;#1E88A8&#39;) # mosaicplot() mosaicplot(df.wide, color=colors, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) 6.1.6 Clean version library(readr) # options(stringsAsFactors = F) df &lt;- read_csv(&quot;data/è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv&quot;) selected_df &lt;- df %&gt;% select(id = ç·¨è™Ÿ, cat = æ¡ˆé¡, date = `ç™¼ç”Ÿæ—¥æœŸ`, time = `ç™¼ç”Ÿæ™‚æ®µ`, location = `ç™¼ç”Ÿåœ°é»`) %&gt;% mutate(year = date %/% 10000) %&gt;% mutate(month = date %/% 100 %% 100) %&gt;% mutate(area = stringr::str_sub(location, 4, 6)) %&gt;% mutate(county = stringr::str_sub(location, 1, 3)) selected_df %&gt;% count(year) ## # A tibble: 9 Ã— 2 ## year n ## &lt;dbl&gt; &lt;int&gt; ## 1 103 1 ## 2 104 687 ## 3 105 663 ## 4 106 560 ## 5 107 501 ## 6 108 411 ## 7 109 304 ## 8 110 189 ## 9 111 31 selected_df %&gt;% count(time) ## # A tibble: 26 Ã— 2 ## time n ## &lt;chr&gt; &lt;int&gt; ## 1 00~02 272 ## 2 02~04 214 ## 3 03~05 8 ## 4 04~06 156 ## 5 05~07 23 ## 6 06~08 191 ## 7 08~10 305 ## 8 09~11 6 ## 9 10~12 338 ## 10 11~03 1 ## # â€¦ with 16 more rows selected_df %&gt;% arrange(time) ## # A tibble: 3,347 Ã— 9 ## id cat date time location year month area county ## &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; ## 1 2 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚æ–‡å±±å€è¬ç¾é‡Œè¬å¯§â€¦ 104 1 æ–‡å±±â€¦ è‡ºåŒ—å¸‚ ## 2 3 ä½å®…ç«Šç›œ 1040101 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å¯Œå°é‡Œå¿ å­â€¦ 104 1 ä¿¡ç¾©â€¦ è‡ºåŒ—å¸‚ ## 3 6 ä½å®…ç«Šç›œ 1040102 00~02 è‡ºåŒ—å¸‚å£«æ—å€å¤©ç¦é‡Œ1é„°â€¦ 104 1 å£«æ—â€¦ è‡ºåŒ—å¸‚ ## 4 12 ä½å®…ç«Šç›œ 1040105 00~02 è‡ºåŒ—å¸‚ä¸­å±±å€å—äº¬æ±è·¯3â€¦ 104 1 ä¸­å±±â€¦ è‡ºåŒ—å¸‚ ## 5 33 ä½å®…ç«Šç›œ 1040115 00~02 è‡ºåŒ—å¸‚æ¾å±±å€é¥’æ²³è¡—181~â€¦ 104 1 æ¾å±±â€¦ è‡ºåŒ—å¸‚ ## 6 74 ä½å®…ç«Šç›œ 1040131 00~02 è‡ºåŒ—å¸‚å—æ¸¯å€é‡é™½è·¯57å··â€¦ 104 1 å—æ¸¯â€¦ è‡ºåŒ—å¸‚ ## 7 75 ä½å®…ç«Šç›œ 1040201 00~02 è‡ºåŒ—å¸‚åŒ—æŠ•å€ä¸­å¿ƒé‡Œä¸­å’Œâ€¦ 104 2 åŒ—æŠ•â€¦ è‡ºåŒ—å¸‚ ## 8 92 ä½å®…ç«Šç›œ 1040210 00~02 è‡ºåŒ—å¸‚åŒ—æŠ•å€å¤§åŒè·¯200â€¦ 104 2 åŒ—æŠ•â€¦ è‡ºåŒ—å¸‚ ## 9 95 ä½å®…ç«Šç›œ 1040212 00~02 è‡ºåŒ—å¸‚è¬è¯å€è¬å¤§è·¯493â€¦ 104 2 è¬è¯â€¦ è‡ºåŒ—å¸‚ ## 10 106 ä½å®…ç«Šç›œ 1040216 00~02 è‡ºåŒ—å¸‚ä¿¡ç¾©å€å³èˆˆè¡—269â€¦ 104 2 ä¿¡ç¾©â€¦ è‡ºåŒ—å¸‚ ## # â€¦ with 3,337 more rows filtered_df &lt;- selected_df %&gt;% # count(year) %&gt;% View filter(year &gt;= 104) %&gt;% filter(!time %in% c(&quot;03~05&quot;, &quot;05~07&quot;, &quot;09~11&quot;, &quot;11~13&quot;, &quot;15~17&quot;, &quot;17~19&quot;, &quot;18~21&quot;, &quot;21~23&quot;, &quot;23~01&quot;)) # count(time) %&gt;% View # count(location) %&gt;% # filter(!area %in% c(&quot;ä¸­å’Œå¸‚&quot;, &quot;æ¿æ©‹å¸‚&quot;)) df.wide &lt;- filtered_df %&gt;% count(time, area) %&gt;% spread(area, n, fill=0) %&gt;% as.data.frame() row.names(df.wide) &lt;- df.wide$time df.wide$time &lt;- NULL par(family=(&#39;Heiti TC Light&#39;)) # for mac # Specify colors colors &lt;- c(&#39;#D0104C&#39;, &#39;#DB4D6D&#39;, &#39;#E83015&#39;, &#39;#F75C2F&#39;, &#39;#E79460&#39;, &#39;#E98B2A&#39;, &#39;#9B6E23&#39;, &#39;#F7C242&#39;, &#39;#BEC23F&#39;, &#39;#90B44B&#39;, &#39;#66BAB7&#39;, &#39;#1E88A8&#39;) # mosaicplot() mosaicplot(df.wide, color=colors, border=0, off = 3, main=&quot;Theft rate of Taipei city (region by hour)&quot;) "],["visualization.html", "Chapter 7 Visualization 7.1 ggplotç°¡ä»‹ 7.2 ç¹ªåœ–åŸºç¤ï¼šæŠ˜ç·šåœ– 7.3 åœ–è¡¨èª¿æ•´ 7.4 è¦–è¦ºåŒ–èªªæ•…äº‹çš„æŠ€å·§ 7.5 æ™‚é–“è»¸çš„è¦–è¦ºåŒ– 7.6 Budget and TreeMap", " Chapter 7 Visualization 7.1 ggplotç°¡ä»‹ æœ¬ç¯€è‘—é‡åœ¨ä»‹ç´¹ggplotçš„åŸºæœ¬æ¦‚å¿µèˆ‡è¨­å®šã€‚ä¸åŒé¡å‹çš„åœ–è¡¨å‰‡åœ¨ä¸‹ä¸€ç¯€ã€Œggplotåœ–è¡¨é¡å‹(II)ã€ å¯åœ¨ä¸€é–‹å§‹ä¾¿é€éknitr::opts_chunk$set(echo = TRUE, fig.width = 2, fig.asp = 0.4)ä¾†ä¸€æ¬¡è¨­å®šæ‰€æœ‰åœ–ç‰‡ã€‚fig.width = 8èˆ‡fig.height = 6 æ˜¯ä»¥è‹±å‹ï¼ˆinchesï¼‰ç‚ºå–®ä½ï¼Œæˆ–ç”¨fig.dim = c(8, 6)ä¸€æ¬¡è¨­å®šé•·å¯¬1ã€‚echo = TRUEæ˜¯è¨­å®šknitå‡ºè¼¸å‡ºæ ¼å¼ï¼ˆå¦‚htmlï¼‰æ™‚ï¼Œä¹Ÿè¦åŒ…å«ç¨‹å¼ç¢¼ã€‚å¦‚æœecho = FALSEçš„è©±ï¼Œå°±åªæœƒè¼¸å‡ºæ–‡å­—å’Œåœ–å½¢ã€‚ 7.2 ç¹ªåœ–åŸºç¤ï¼šæŠ˜ç·šåœ– 7.2.1 ç¹ªåœ–ä¸‰è¦ç´  ç”¨ggplotä¾†ç¹ªè£½åœ–å½¢æœ‰ä¸‰å€‹åŸºæœ¬å‡½å¼ggplot() + aes() + geom_åœ–è¡¨é¡å‹ã€‚ æŒ‡å®šè¦é€²è¡Œç¹ªåœ–ggplot()ï¼šç”¨%&gt;%å°‡è³‡æ–™ï¼ˆdataframeï¼‰pipeçµ¦ggplot()å¾Œï¼Œåº•ä¸‹å„å¢æ·»çš„ç¹ªåœ–é¸é …éƒ½ç”¨+çš„ç¬¦è™Ÿï¼Œé¡ä¼¼ä¸æ–·ä¿®æ­£ç¹ªåœ–çµæœçš„æ„æ€ã€‚ æŒ‡å®šXï¼Yè»¸èˆ‡ç¾¤çµ„å› å­aes()ï¼šæŒ‡å®šåœ–è¡¨çš„X/Yè»¸åˆ†åˆ¥æ˜¯ä»€éº¼è®Šæ•¸ï¼Œæœ‰äº›åœ–è¡¨åªéœ€è¦å–®ä¸€å€‹è®Šæ•¸ï¼ˆä¾‹å¦‚Density-chartå’ŒHistogramï¼‰ï¼Œæœ‰äº›éœ€è¦X/Yå…©å€‹è®Šæ•¸ï¼ˆä¾‹å¦‚Scatter-chartï¼‰ä»€éº¼çš„è®Šæ•¸è¦åšè¦–è¦ºåŒ–ï¼ŒBoxplotç”šè‡³å¯ä»¥ç›´æ¥æŒ‡å®šæœ€å¤§ã€æœ€å°ã€Q1ã€Q3å’ŒMedianç­‰å¤šå€‹è®Šæ•¸ã€‚ æŒ‡å®šè¦ç¹ªè£½çš„åœ–è¡¨é¡å‹ã€‚ä¾‹å¦‚Line-chartç‚ºgeom_line()ã€Scatter-chartç‚ºgeom_point()ã€Bar-chartç‚ºgeom_col()æˆ–geom_bar()ã€‚æŸ¥é–±ggplot cheat sheetå¯ä»¥å¿«é€Ÿç¿»é–±æœ‰å“ªäº›åœ–è¡¨é¡å‹ã€‚ ggplot-cheat-sheet ggplot() æœƒç§€å‡ºé å‚™è¦ç¹ªè£½çš„ç¹ªåœ–å€ tibble(a=1:5, b=5:1) %&gt;% ggplot() æŒ‡å®šXï¼Yè»¸èˆ‡ç¾¤çµ„å› å­aes()ï¼šaes()æœƒåœ¨ç¹ªåœ–å€ä¸Šç¹ªè£½Xèˆ‡Yè»¸ tibble(a=1:5, b=5:1) %&gt;% ggplot() + aes(x=a, y=b) æŒ‡å®šè¦ç¹ªè£½çš„åœ–è¡¨é¡å‹ã€‚ä¾‹å¦‚Line-chartç‚ºgeom_line()ã€ tibble(a=1:5, b=5:1) %&gt;% ggplot() + aes(x=a, y=b) + geom_line() æ­¤åœ–ç‚ºä¸€é›™è®Šæ•¸çš„åœ–ï¼ŒåŸºæ–¼é›™è®Šæ•¸ï¼Œå¯ä»¥å°‡ä¸åŒçš„åœ–åŒæ™‚ç¹ªè£½åœ¨åŒä¸€å€‹ç¹ªåœ–å€ä¸Šã€‚ä¾‹å¦‚ä»¥ä¸‹åŒæ™‚ç¹ªè£½äº†geom_line()èˆ‡geom_plot()ã€‚ tibble(a=1:5, b=5:1) %&gt;% ggplot() + aes(x=a, y=b) + geom_line() + geom_point() 7.2.2 ç¯„ä¾‹-ç´æ™‚ä¸–ä»£è²§å¯Œä¸å‡ Teach About Inequality With These 28 New York Times Graphs - The New York Times (nytimes.com) ggplotæ˜¯ä»¥è®Šæ•¸ç‚ºåŸºç¤çš„è¦–è¦ºåŒ–å¥—ä»¶ï¼Œä¹Ÿå°±æ˜¯èªªï¼Œç•¶æº–å‚™å¥½dataframeå¾Œï¼Œå°±å¯ä»¥åœ¨ggplotä¸­æŒ‡å®šè¦ç”¨å“ªäº›è®Šæ•¸ä¾†ç¹ªåœ–ã€‚ä¹Ÿå› æ­¤ï¼Œå‹™å¿…æŠŠdataframeæ•´ç†ç‚ºtidyå‹æ…‹ï¼Œä¹Ÿå°±æ˜¯é•·è¡¨æ ¼ï¼ˆlong-formï¼‰çš„å‹æ…‹ã€‚æ•´ç†å®Œè³‡æ–™å¾Œï¼Œæˆ‘æœƒç¿’æ…£åœ°ç”¨names(plot)æˆ–glimpse(plot)ä¾†çœ‹ä¸€ä¸‹è©²è³‡æ–™æ‰€æœ‰çš„è®Šé …ï¼Œå¥½å¯ä»¥åœ¨ä¸‹ä¸€éšæ®µçš„ç¹ªåœ–åšåƒè€ƒã€‚ NW &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(Category, year, Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% ungroup() NW %&gt;% glimpse() ## Rows: 66 ## Columns: 3 ## $ Category &lt;chr&gt; &quot;Less than 35&quot;, &quot;35-44&quot;, &quot;45-54&quot;, &quot;55-64&quot;, &quot;65-74&quot;, &quot;75 or oâ€¦ ## $ year &lt;dbl&gt; 1989, 1989, 1989, 1989, 1989, 1989, 1992, 1992, 1992, 1992, â€¦ ## $ Net_Worth &lt;dbl&gt; 16.17019, 112.47530, 195.11630, 195.25554, 154.34277, 144.29â€¦ é€™æ˜¯é æœŸè¦–è¦ºåŒ–çš„çµæœ å…ˆå°‡yearå’ŒNet_worthåˆ†åˆ¥ç¹ªè£½åœ¨Xèˆ‡Yè»¸ä¸Šï¼Œä¸¦ç”¨geom_line()ç¹ªè£½ç‚ºæŠ˜ç¾åœ–ã€‚çµæœåœ–è¡¨ä¸­å‘ˆç¾é‹¸é½’ç‹€çš„æŠ˜ç·šï¼Œçœ‹ä¼¼æœ‰å•é¡Œï¼Œä½†å…¶å¯¦æ˜¯åˆç†çš„ã€‚å› ç‚ºyearæ˜¯ä¸€å€‹é›¢æ•£è®Šæ•¸ï¼Œè€Œæˆ‘å€‘å¸Œæœ›æ¯å€‹å¹´é½¡å±¤ä¸€æ¢ç·šçš„è©±ï¼Œé‚£å°±è¦ç…§å¹´é½¡å±¤ä¾†åˆ†çµ„ã€‚ä¹Ÿå› æ­¤ï¼Œæ¯ä¸€å¹´éƒ½æœ‰æœ‰æ¯å€‹å¹´é½¡å±¤çš„è³‡æ–™ï¼Œç•¶æˆ‘å€‘æŠŠã€Œå¹´ã€ä½œç‚ºXè»¸æ™‚ï¼Œè‡ªç„¶åŒä¸€å¹´å°±æœƒæœ‰æ•¸ç­†ä¸åŒå¹´é½¡å±¤çš„è³‡æ–™ï¼Œå› æ­¤æ‰æœƒæ˜¯é‹¸é½’ç‹€çš„ã€‚ NW %&gt;% ggplot() + aes(x=year, y=Net_Worth) + geom_line() ä¸åŒçš„åœ–è¡¨é¡å‹æ˜¯å¯ä»¥ç–ŠåŠ åœ¨åŒä¸€å¼µåœ–ä¸Šçš„ã€‚æˆ‘å€‘ä¹Ÿå¯ä»¥æŠŠgeom_point() å¦ä¸€ç¨®åœ–è¡¨å‹æ…‹åŠ å…¥ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå…©è€…çš„Xèˆ‡Yä¸ç›¸è¡çªã€‚geom_line()ã€geom_point()ã€geom_text()ä¸‰è€…æœƒç¶“å¸¸ä¼´éš¨å‡ºç¾ã€‚ NW %&gt;% ggplot() + aes(x=year, y=Net_Worth) + geom_line() + geom_point() 7.2.3 åŠ å…¥è‡ªè®Šé …ç¾¤çµ„ ä¸Šåœ–æ˜¯æˆ‘å€‘æŠŠå¤šå€‹å¹´é½¡å±¤çš„é€å¹´è³‡æ–™ç•«åœ¨åŒä¸€æ¢æŠ˜ç·šä¸Šï¼Œæ‰€ä»¥æœƒå‘ˆç¾é‹¸é½’ç‹€æŠ˜ç¾çš„ç‹€æ³ã€‚ä½†é€™äº›å¹´é½¡å±¤ä¸¦éåœ¨åŒä¸€æ¢ç·šä¸Šå‘€ï¼Ÿå› æ­¤ï¼Œæˆ‘å€‘è¦æ ¹æ“šCategoryé€™å€‹è®Šæ•¸ä¾†åšåˆ†çµ„ã€‚ NW %&gt;% ggplot() + aes(x=year, y=Net_Worth, group=Category) + geom_line() + geom_point(stat=&quot;identity&quot;) å¦‚å¸Œæœ›ä¸åŒç·šæ¢ä¸Šä¸ä¸€æ¨£çš„è‰²å½©ï¼Œæ‡‰æŒ‡å®šcolor=Categoryã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() ç”¨colorã€fillæˆ–groupä¾†åšåˆ†çµ„ï¼Ÿ geom_line()çš„è‰²å½©æ˜¯åœ¨ç·šï¼Œè€Œä¸æ˜¯åœ¨é¢ä¸Šã€‚å¦‚æœè‰²å½©æ˜¯åœ¨é»ï¼ˆå¦‚geom_point()ï¼‰æˆ–ç·šï¼ˆgeom_line()ï¼‰ä¸Šï¼Œå°±æ˜¯ç”¨colorä¾†æŒ‡å®šé¡è‰²ã€‚ä½†å¦‚æœæ˜¯å¦‚é¡ä¼¼ä¸‹é¢çš„ä¾‹å­ï¼Œç”¨geom_area()ä¾†è¦–è¦ºåŒ–çš„è©±ï¼Œå› ç‚ºé¡è‰²å¡«çš„æ˜¯é¢ï¼Œæ‰€ä»¥è¦ç”¨fill=Categoryã€‚ä»¥ä¸‹ç¯„ä¾‹ç”šè‡³åŒæ™‚æŒ‡å®šcolor=Category, fill=Categoryã€‚ä½†æŠ˜ç·šåœ–å¦‚æœè¦ç”¨geom_area()ä¾†è¦–è¦ºåŒ–çš„è©±ï¼Œæœ€å¥½è¦ä¸Šé¡è‰²çš„ä¸è¦è¶…éäºŒå€‹ï¼Œä¸ç„¶å°±æœƒåƒåº•ä¸‹é€™å€‹ä¾‹å­ä¸€æ¨£ï¼Œå³ä½¿è¨­å®šalpha=0.2çš„åŠé€æ˜ï¼Œä»ç„¶æœƒçœ‹ä¸æ‡‚å“ªäº›é¡è‰²ç–Šåœ¨ä¸€èµ·ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category, fill=Category) + geom_area(position=&quot;dodge&quot;, alpha=0.2) 7.3 åœ–è¡¨èª¿æ•´ 7.3.1 é»ç·šå‹æ…‹ ä¸‹é¢çš„ä¾‹å­åŒæ™‚ç”¨äº†geom_line()å’Œgeom_point()ï¼Œä¸”åˆ†åˆ¥è¨­å®šäº†ç·šå¯¬ï¼ˆsize=1ï¼‰ã€é»çš„å¤§å°(size=2)ï¼ŒæŠ˜ç·šå‹æ…‹ï¼ˆlinetype=\"dashed\"ï¼‰ã€åŠé€æ˜ç¨‹åº¦ï¼ˆalphaï¼‰ã€‚ ggplot2 line types : How to change line types of a graph in R software? - Easy Guides - Wiki - STHDA NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line(size=1, linetype = &quot;dashed&quot;, alpha=0.5) + geom_point(size=2, color=&quot;dimgrey&quot;, alpha=0.5) 7.3.2 æ¨™é¡Œã€æ¨™ç±¤èˆ‡åœ–èªª Titles, labels, and legend è¨­å®šæ¨™é¡Œèˆ‡Xï¼Yè»¸æ¨™é¡Œï¼ˆæ³•ä¸€ï¼‰ï¼šä»¥ä¸‹è¨­å®šäº†åœ–è¡¨çš„åœ–è¡¨æ¨™é¡Œã€å’ŒXè»¸èˆ‡Yè»¸çš„è»¸æ¨™é¡Œï¼ˆxlabèˆ‡ylabï¼‰ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + xlab(&quot;Year&quot;) + ylab(&quot;Net Worth&quot;) + ggtitle(&quot;Net Worth by year grouped by age groups&quot;) è¨­å®šæ¨™é¡Œèˆ‡Xï¼Yè»¸æ¨™é¡Œï¼ˆæ³•äºŒï¼‰ï¼šé€™æ˜¯ä¸€æ¬¡è¨­å®šåœ–è¡¨æ¨™é¡Œï¼ˆtitleï¼‰ã€æ¬¡æ¨™é¡Œï¼ˆsuttitleï¼‰ã€Xè»¸èˆ‡Yè»¸æ¨™é¡Œçš„æ–¹æ³•ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, subtitle = &quot;Source from: ...&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) èª¿æ•´Xè»¸èˆ‡Yè»¸æ¨™é¡Œä½ç½®çš„ï¼šå¿…é ˆè¦é€étheme()ä¾†è¨­å®šaxis.title.x = element_text(hjust=1)ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + theme(axis.title.x = element_text(hjust=1), axis.title.y = element_text(hjust=1)) å»é™¤Xï¼Yè»¸æ¨™é¡Œï¼ˆä¸ä½³ï¼‰ï¼šç›´æ¥å°‡ç©ºå­—ä¸²Assignçµ¦titleã€xã€èˆ‡yå³å¯ã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;&quot;, x = &quot;&quot;, y = &quot;&quot;) å»é™¤Xï¼Yè»¸æ¨™é¡Œï¼ˆè¼ƒä½³ï¼‰ï¼šé€éè¨­å®štheme()ä¾†èª¿æ•´ã€‚å¯ç™¼ç¾é€éé€™ç¨®è¨­å®šæ–¹æ³•ï¼ŒåŸæœ¬æ¨™é¡Œå’ŒXï¼Yè»¸æ¨™é¡Œçš„é‚Šç•Œç©ºé–“å°±æœƒè¢«é‡‹æ”¾å‡ºä¾†ã€‚ # No extra space for xlab, ylab and title NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line(show.legend = F) + theme_minimal() + theme(plot.title = element_blank(), axis.title.x = element_blank(), axis.title.y = element_blank()) 7.3.3 å­—é«”æ¨£å¼ èª¿æ•´å­—å‹æœƒå»ºè­°éƒ½å¾theme()ä¾†åšèª¿æ•´ï¼Œæ‰€æœ‰åœ–é¢ä¸Šçœ‹å¾—åˆ°çš„å­—éƒ½æœ‰ç›¸å°æ‡‰çš„è®Šæ•¸å¯ä»¥èª¿æ•´å­—å‹ã€‚ä¾‹å¦‚ä»¥ä¸‹çš„ä¾‹å­ä¸­ï¼ŒæŠŠæ¨™é¡Œçš„å­—å‹å¤§å°èª¿æ•´ç‚º14ç²—é«”ã€Xèˆ‡Yè»¸çš„å­—å‹å‰‡èª¿æ•´äº†å‘å³å°é½Šã€10ç²—æ–œé«”ã€é¡è‰²ç‚ºdimgreyã€‚ NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + theme(plot.title = element_text(size=14, face=&quot;bold&quot;), axis.title.x = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;), axis.title.y = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;) ) 7.3.4 åœ–è¡¨ä¸»é¡Œè‰²èª¿ ggplotä¹Ÿæœ‰å…¶åœ–è¡¨ä¸»é¡Œè‰²èª¿ã€‚ä¹‹å‰ç¯„ä¾‹çš„ç°è‰²åœ–è¡¨èƒŒæ™¯å°±æ˜¯é è¨­çš„ä¸»é¡Œï¼Œggplotä¸­é‚„æœ‰å¥½å¹¾å€‹é è¨­åœ–è¡¨ä¸»é¡Œå¯ä»¥é¸ï¼Œä¾‹å¦‚theme_minimal()æˆ–theme_tw()ç­‰ç­‰ã€‚ Modify components of a theme â€” theme â€¢ ggplot2 (tidyverse.org) bbplot/bbc_style.R at master Â· bbc/bbplot (github.com) NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line() + theme_minimal() 7.3.5 é è¨­ä¸»é¡Œ å¦‚æœå¸Œæœ›æ‰€æœ‰çš„åœ–è¡¨éƒ½æœ‰ä¸€è‡´çš„é¡è‰²å’Œæ’ç‰ˆçš„èª¿æ€§ï¼Œå¯ä»¥åœ¨ä¸€é–‹å§‹ç·¨è¼¯Rmdçš„æ™‚å€™å°±è¨­è¨ˆå¥½ä¸€å¥—theme()ä¸¦æŒ‡çµ¦ä¸€å€‹è®Šæ•¸ï¼ˆä¾‹å¦‚ä»¥ä¸‹çš„thï¼‰ã€‚ th &lt;- theme(plot.title = element_text(size=14, face=&quot;bold&quot;), axis.title.x = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;), axis.title.y = element_text(hjust=1, size=10, color=&quot;dimgrey&quot;, face=&quot;bold.italic&quot;) ) NW %&gt;% ggplot() + aes(year, Net_Worth, color=Category) + geom_line(linetype = &quot;dashed&quot;, alpha=0.5) + geom_point(size=2, color=&quot;dimgrey&quot;, alpha=0.5) + theme_minimal() + labs(title = &quot;Net Worth by year grouped by age groups&quot;, x = &quot;Year&quot;, y = &quot;Net Worth&quot;) + th 7.3.6 é¡¯ç¤ºä¸­æ–‡å­—é«” Pythonå’ŒRé€™äº›ç¨‹å¼èªè¨€çš„é è¨­è¦–è¦ºåŒ–å¥—ä»¶éƒ½æ²’è¾¦æ³•é¡¯ç¤ºä¸­æ–‡ï¼Œæ‰€ä»¥å¦‚æœè¦é¡¯ç¤ºä¸­æ–‡çš„è©±ï¼Œå°±è¦æŒ‡å®šåœ–è¡¨æ¨™é¡Œã€Xã€Yè»¸æ¨™ç±¤ã€åœ–èªªå’Œå„å€‹éƒ¨ä»¶çš„å­—å‹ã€‚å› ç‚ºæˆ‘åœ¨Macä¸Šç¹ªåœ–ï¼Œæ‰€ä»¥æˆ‘å°‡å­—å‹æŒ‡å®šç‚ºHeiti TC Lightã€‚å¦‚æœæƒ³çŸ¥é“è‡ªå·±çš„é›»è…¦ä¸Šæœ‰ä»€éº¼å¯ä»¥ç”¨ï¼Œå¯ä»¥åˆ°é›»è…¦çš„å­—é«”ç°¿ä¸ŠæŸ¥æ‰¾ä¸­æ–‡å­—é«”åç¨±ï¼Œæˆ–è€…ä¸Šç¶²googleã€Œggplot ä¸­æ–‡å­—å‹é¸æ“‡ã€ã€‚ county &lt;- read_csv(&quot;data/tw_population_opendata110N010.csv&quot;) %&gt;% slice(-1, -(370:375)) %&gt;% type_convert() %&gt;% mutate(county = str_sub(site_id, 1, 3)) %&gt;% group_by(county) %&gt;% summarize( area = sum(area), people_total = sum(people_total) ) %&gt;% ungroup() ä¸‹é¢é€™æ˜¯ä¸€å€‹é•·æ¢åœ–çš„ç¯„ä¾‹ï¼ˆbarplotï¼Œä¸æ˜¯histogramï¼‰ã€‚Barplotå¯ä»¥ç›´æ¥æŒ‡å®šXè»¸ç‚ºç¸£å¸‚ï¼ˆcountyï¼‰å’ŒYè»¸ç‚ºç¸½äººå£æ•¸ï¼ˆpeople_totalï¼‰ï¼Œä½†æ˜¯è¦ç”¨geom_col()è€Œégeom_bar()ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒBarçš„é¡è‰²æœ‰ã€Œé¢ã€çš„ç‰¹å¾µï¼Œæ‰€ä»¥è‹¥è¦è‡ªè¨‚æ•´æ¢barçš„é¡è‰²ï¼Œè¦ç”¨fillè€Œécolorï¼Œcoloråªæœƒæ˜¯æ¯æ¢Barçš„å¤–æ¡†ã€‚ county %&gt;% arrange(desc(people_total)) %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;lightgrey&quot;, color=&quot;black&quot;) + theme_minimal() èˆ‰ä¾‹ä¾†èªªï¼Œä¸­æ–‡å­—å‹å¯ä»¥æ˜¯æ¨™æ¥·é«”ï¼ˆBiauKaiï¼‰ã€å®‹é«”ï¼ˆSongti TCï¼‰ã€é»‘é«”ï¼ˆHeiti TC Lightï¼‰ã€è˜‹æ–¹ï¼ˆPingFang TCï¼‰ã€Notoï¼ˆNoto Sans CJK TCï¼‰ th &lt;- theme(title = element_text(family=&quot;Heiti TC Light&quot;), text = element_text(family=&quot;Heiti TC Light&quot;), axis.text.y = element_text(family=&quot;PingFang TC&quot;), axis.text.x = element_text(family=&quot;Heiti TC Light&quot;), legend.text = element_text(family=&quot;Heiti TC Light&quot;), plot.title = element_text(family=&quot;Heiti TC Light&quot;) ) county %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;skyblue&quot;) + theme_minimal() + th + theme(axis.text.x = element_text(angle = 45)) 7.3.7 X/Yè»¸æ–¹å‘ èª¿æ•´åœ–è¡¨æ–¹å‘ county %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;skyblue&quot;) + coord_flip() + theme_minimal() + th + theme(axis.text.x = element_text(angle = 45)) é€šå¸¸coord_flip()å¾Œå¾€å¾€æœƒå¸Œæœ›é€™äº›baræœƒæ˜¯ç”±ä¸Šè€Œä¸‹æ’åºå¥½çš„ï¼Œä½†ç”¨arrange(desc(people_total)æ˜¯ç„¡æ³•è§£æ±ºå•é¡Œçš„ï¼Œå› ç‚ºYè»¸åŸæœ¬æœƒæ˜¯ç…§Yè»¸çš„åˆ»åº¦æ’åˆ—ï¼Œè€Œä¸æ˜¯Yè»¸çš„æ•¸å€¼ã€‚æ‰€ä»¥ï¼Œè¦è¢«æ’åºçš„æ‡‰è©²æ˜¯Yè»¸çš„ã€Œæ–‡å­—ã€ä¹Ÿå°±æ˜¯é‚£äº›ç¸£å¸‚ã€‚å› æ­¤ï¼Œæˆ‘å€‘éœ€è¦å°‡è©²ç¸£å¸‚è½‰ç‚ºfactorï¼ˆ1~nï¼‰ï¼Œä¸¦ä¸”è®“é€™äº›ç¸£å¸‚è¢«å®‰æ’çš„factoræ•¸å€¼ç…§people_totalæ’åˆ—ï¼Œå› æ­¤è¦ç”¨mutate(county = reorder(county, people_total))ã€‚reorder()æ˜¯ä¸€å€‹å°‡æ–‡å­—è½‰factorçš„å‡½å¼ï¼Œä½†åœ¨æ­¤ç‰¹åˆ¥æŒ‡å®šç…§people_totalçš„ç·¨æ’ã€‚ county %&gt;% # arrange(desc(people_total) %&gt;% mutate(county = reorder(county, people_total)) %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;skyblue&quot;) + coord_flip() + theme_minimal() + th 7.4 è¦–è¦ºåŒ–èªªæ•…äº‹çš„æŠ€å·§ ã€Œèªªæ•…äº‹ã€æ‰æ˜¯æ•´å‰‡è³‡æ–™æ–°èçš„æ ¸å¿ƒï¼Œåœ¨é‹ç”¨åœ–è¡¨ä¾†è¼”åŠ©æ•˜äº‹æ™‚ï¼Œæ‡‰æ­é…èªªç†èªªæœçš„å…§å®¹ä¾†çªé¡¯ï¼ˆhighlightï¼‰åœ–é¢ä¸Šçš„ç‰¹å¾µï¼Œè€Œä¸æ˜¯ç•™å¾…è®€è€…è‡ªå·±è§€å¯Ÿã€‚ä»¥ä¸‹æœ‰ä¸‰ç¨®highlightåœ–è¡¨éƒ¨åˆ†è³‡æ–™çš„æ–¹æ³•ã€‚ç¬¬ä¸€å€‹æ–¹æ³•æ˜¯åœ¨ç¹ªåœ–æ™‚ç”¨+ scale_color_manual()æˆ–+ scale_fill_manual()æŒ‡å®šé¡è‰²çµ¦ä¸åŒç¾¤çµ„ï¼›æ–¹æ³•äºŒæ˜¯åˆ©ç”¨gghighlighté€™å€‹å¥—ä»¶ä¾†æŒ‡å®šè¦ä¸Šè‰²çš„ç¾¤çµ„ï¼Œè€Œä¸”gghighlightå¯ä»¥å’Œfillèˆ‡colorç›¸äº’æ­é…ï¼Œä»ç„¶å¯ä»¥ç”¨scale_fill_manualå’Œscale_color_manualä¾†æŒ‡å®šé¡è‰²ã€‚ä½†æœƒæœ‰å€‹ç‹€æ³æ˜¯ï¼Œå¦‚æœåŸæœ¬æ²’ç¾¤çµ„é‚£æ€éº¼è¾¦ï¼Ÿå°±è‡ªå·±ç”¨mutate()æ‰“é€ ç¾¤çµ„å°±å¥½ã€‚æ–¹æ³•å„æœ‰åˆ©å¼Šèˆ‡ä½¿ç”¨æ™‚æ©Ÿã€‚ 7.4.1 ä¾ç¾¤çµ„æŒ‡å®šé¡è‰² scale_color_manual() èˆ‡scale_fill_manual() NW %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line() + scale_color_manual( limits=c(&quot;65-74&quot;, &quot;35-44&quot;), # original chart group values=c(&quot;gold&quot;, &quot;skyblue&quot;), # map to color name=&quot;Age group&quot;, # legend title breaks=c(&quot;65-74&quot;, &quot;35-44&quot;), # original legend group labels labels=c(&quot;elder(65-74)&quot;,&quot;younger(35-44)&quot;), # map to new labels na.value = &quot;lightgrey&quot; # color for other groups ) + theme_minimal() 7.4.2 ä½¿ç”¨gghighlightå¥—ä»¶ library(gghighlight) NW %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;whitesmoke&quot;, colour = &quot;whitesmoke&quot;, size = 0.5, linetype = &quot;solid&quot;)) ä½¿ç”¨gghighlightä»èƒ½è‡ªå·±ä½¿ç”¨scale_color_manual()ä¾†æŒ‡å®šé¡è‰² NW %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + scale_color_manual( limits=c(&quot;65-74&quot;, &quot;35-44&quot;), # original chart group values=c(&quot;gold&quot;, &quot;skyblue&quot;)) + # map to color theme_minimal() 7.4.3 ç‚ºè¦–è¦ºåŒ–å»ºç«‹ç¾¤çµ„ é€™å€‹æ–¹æ³•æ˜¯åœ¨åŸæœ¬çš„è³‡æ–™ä¸¦æ²’æœ‰å¯ä»¥ä½œç‚ºcoloræˆ–fillçš„å› å­ï¼Œæ‰€ä»¥è‡ªè¡Œå‰µå»ºä¸€å€‹è¦çªé¡¯çš„ç¾¤çµ„ã€‚ county %&gt;% mutate(group = if_else(county %in% c(&quot;æ–°ç«¹ç¸£&quot;, &quot;æ–°ç«¹å¸‚&quot;), &quot;highlight&quot;, &quot;other&quot;)) %&gt;% mutate(county = reorder(county, people_total)) %&gt;% ggplot() + aes(county, people_total, fill=group) %&gt;% geom_col() + scale_fill_manual(values=c(&quot;highlight&quot;=&quot;Khaki&quot;, &quot;other&quot;=&quot;lightgrey&quot;)) + guides(fill=&quot;none&quot;) + coord_flip() + theme_minimal() + th ä½†äº‹å¯¦ä¸Šä¹Ÿå¯ä»¥ç”¨gghighlightç›´æ¥é”æˆ county %&gt;% mutate(county = reorder(county, people_total)) %&gt;% ggplot() + aes(county, people_total) %&gt;% geom_col(fill=&quot;deeppink&quot;) + gghighlight(county %in% c(&quot;æ–°ç«¹ç¸£&quot;, &quot;æ–°ç«¹å¸‚&quot;)) + guides(fill=&quot;none&quot;) + coord_flip() + theme_minimal() + th 7.5 æ™‚é–“è»¸çš„è¦–è¦ºåŒ– library(tidyverse) library(lubridate) # options(stringsAsFactors = F) # default option in R &gt; 4.0 7.5.1 æ–‡å­—è½‰æ™‚é–“ Convert â€œcharacter timeâ€ to R date.time object (POSIXct) ptturl &lt;- &quot;https://github.com/P4CSS/R4CSSData/raw/main/ptt_hang_posts.csv&quot; raw &lt;- read.csv(url(ptturl)) clean &lt;- raw %&gt;% mutate(ptime = as.POSIXct(strptime(ptime, &quot;%Y-%m-%dT%H:%M:%SZ&quot;, tz = &quot;ASIA/Taipeiw&quot;))) raw &lt;- read_csv(url(ptturl)) ?read_csv t &lt;- &quot;2019-04-12T00:48:19Z&quot; class(t) ## [1] &quot;character&quot; ?strptime t1 &lt;- strptime(t, &quot;%Y-%m-%dT%H:%M:%SZ&quot;) raw %&gt;% glimpse() ## Rows: 8,317 ## Columns: 7 ## $ plink &lt;chr&gt; &quot;https://www.ptt.cc/bbs/HatePolitics/M.1555035677.A.24B.html&quot;â€¦ ## $ board &lt;chr&gt; &quot;HatePolitics&quot;, &quot;HatePolitics&quot;, &quot;HatePolitics&quot;, &quot;HatePoliticsâ€¦ ## $ pcontent &lt;chr&gt; &quot;\\n\\néŸ“åœ‹ç‘œèµ´å“ˆä½›å¤§å­¸å‰å—è¨ªè¡¨ç¤ºï¼Œå°±æ˜¯ã€Œkeeping practiceã€ï¼Œç›¡â€¦ ## $ poster &lt;chr&gt; &quot;lovebxcx&quot;, &quot;ikr3699654&quot;, &quot;sunyeah&quot;, &quot;rock720429&quot;, &quot;btm978952â€¦ ## $ ptitle &lt;chr&gt; &quot;Re: [æ–°è] é‡ç”³åå°ä¸€åœ‹å…©åˆ¶ éŸ“åœ‹ç‘œï¼šçœ‹è‘—æˆ‘éˆé­‚æ·±&quot;, &quot;Re: [è¨â€¦ ## $ ptime &lt;dttm&gt; 2019-04-12 02:21:14, 2019-04-12 02:13:45, 2019-04-12 02:10:1â€¦ ## $ ipaddr &lt;chr&gt; &quot;83.221.204.163&quot;, &quot;114.43.176.110&quot;, &quot;118.163.130.181&quot;, &quot;118.1â€¦ 7.5.2 æ™‚é–“ä½œç‚ºæ©Ÿç‡åˆ†ä½ˆXè»¸ raw %&gt;% ggplot() + aes(ptime) + geom_density() 7.5.3 é€æœˆçµ±è¨ˆè³‡æ–™ ?lubridate raw %&gt;% mutate(m = month(ptime)) %&gt;% count(m) %&gt;% ggplot() + aes(m, n) + geom_col() 7.5.4 é€æ—¥çµ±è¨ˆè³‡æ–™ï¼ˆä½³ï¼‰ raw %&gt;% filter(ptime &gt;= as_date(&quot;2019-03-18&quot;) &amp; ptime &lt; as_date(&quot;2019-04-01&quot;)) %&gt;% mutate(m = floor_date(ptime, unit = &quot;day&quot;)) %&gt;% count(m) %&gt;% ggplot() + aes(m, n) + geom_col() 7.5.5 æ¯æ—¥é€æ™‚è³‡æ–™ clean %&gt;% filter(ptime &gt;= as_datetime(&quot;2019-03-25&quot;) &amp; ptime &lt; as_datetime(&quot;2019-04-01&quot;)) %&gt;% mutate(d = floor_date(ptime, unit = &quot;day&quot;)) %&gt;% mutate(h = hour(ptime)) %&gt;% count(d, h) %&gt;% mutate(wd = wday(d, label = F, locale = Sys.getlocale(&quot;LC_TIME&quot;))) %&gt;% mutate(isweekend = ifelse(wd &gt;= 6, &quot;weekend&quot;, &quot;weekday&quot;)) %&gt;% ggplot() + aes(h, n, color = as.character(d)) + geom_line() + facet_wrap(~isweekend) ?ifelse 7.6 Budget and TreeMap library(zoo) # raw &lt;- readxl::read_excel(&quot;data/111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—ç¸½è¡¨.xls&quot;) raw &lt;- readxl::read_excel(&quot;data/111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—è¡¨.xls&quot;, skip=3, col_names = F) names(raw) &lt;- c(&quot;æ¬¾&quot;, &quot;ç§‘&quot;, &quot;ç›®&quot;, &quot;ç¯€&quot;, &quot;æ©Ÿæ§‹&quot;, &quot;æœ¬å¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦é ç®—&quot;, &quot;ä¸Šå¹´åº¦æ±ºç®—&quot;, &quot;é ç®—å·®&quot;) # raw$æ¬¾ &lt;- na.locf(raw$æ¬¾) cleand &lt;- raw %&gt;% filter(!is.na(æ¬¾) | !is.na(ç§‘)) %&gt;% slice(-(1:2)) %&gt;% select(-ç›®, -ç¯€) %&gt;% mutate(org = purrr::map(æ©Ÿæ§‹, function(x){str_split(x, &quot;\\n&quot;)[[1]][2]})) %&gt;% mutate(æ¬¾ = ifelse(!is.na(æ¬¾), unlist(org), unlist(æ¬¾))) %&gt;% mutate(æ¬¾ = zoo::na.locf(æ¬¾)) %&gt;% filter(!is.na(ç§‘)) %&gt;% select(-ç§‘) %&gt;% type_convert() %&gt;% mutate(ä¸Šå¹´åº¦é ç®— = as.numeric(ä¸Šå¹´åº¦é ç®—), ä¸Šå¹´åº¦æ±ºç®— = as.integer(ä¸Šå¹´åº¦æ±ºç®—), é ç®—å·® = as.numeric(é ç®—å·®)) %&gt;% replace_na(list(ä¸Šå¹´åº¦é ç®— = 0, ä¸Šå¹´åº¦æ±ºç®— = 0)) %&gt;% mutate(é ç®—å·® = æœ¬å¹´åº¦é ç®— - ä¸Šå¹´åº¦é ç®—) cleand %&gt;% filter(æ¬¾ %in% c(&quot;ç§‘å­¸æ”¯å‡º&quot;)) %&gt;% ggplot() + aes(area = æœ¬å¹´åº¦é ç®—, fill=`æœ¬å¹´åº¦é ç®—`, label=org) + geom_treemap() + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=TRUE, family = &quot;Heiti TC Light&quot; ) + theme(title = element_text(family = &quot;Heiti TC Light&quot;), text = element_text(family = &quot;Heiti TC Light&quot;)) library(treemapify) cleand %&gt;% # filter(æ¬¾ %in% c(&quot;ç§‘å­¸æ”¯å‡º&quot;, &quot;æ•™è‚²æ”¯å‡º&quot;, &quot;åœ‹é˜²æ”¯å‡º&quot;, &quot;å¸æ³•æ”¯å‡º&quot;)) %&gt;% ggplot() + aes(area = æœ¬å¹´åº¦é ç®—, fill=`æœ¬å¹´åº¦é ç®—`, label=org, subgroup = æ¬¾) + geom_treemap() + geom_treemap_subgroup_border(color=&quot;gold&quot;) + geom_treemap_subgroup_text(place = &quot;centre&quot;, grow = T, alpha = 0.5, colour = &quot;gold&quot;, min.size = 0, family = &quot;Heiti TC Light&quot;) + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=F, family = &quot;Heiti TC Light&quot; ) + theme(title = element_text(family = &quot;Heiti TC Light&quot;), text = element_text(family = &quot;Heiti TC Light&quot;), legend.position = &quot;none&quot;) åƒè€ƒè³‡æ–™ï¼š5.4 Control the size of plots/images | R Markdown Cookbook (bookdown.org)â†©ï¸ "],["tw-data-visualization.html", "Chapter 8 TW Data Visualization 8.1 Coordination &amp; Axis 8.2 Log-scale 8.3 Square-root scale 8.4 TW-Salary (boxplot) 8.5 TW-Income (boxplot)", " Chapter 8 TW Data Visualization library(tidyverse) options(stringsAsFactors = F) options(scipen = 999) th &lt;- theme_minimal() + theme(title = element_text(family=&quot;Heiti TC Light&quot;), text = element_text(family=&quot;Heiti TC Light&quot;), axis.text.y = element_text(family=&quot;Heiti TC Light&quot;), axis.text.x = element_text(family=&quot;Heiti TC Light&quot;), legend.text = element_text(family=&quot;Heiti TC Light&quot;), plot.title = element_text(family=&quot;Heiti TC Light&quot;) ) 8.1 Coordination &amp; Axis Chap3 Coordination &amp; Axis Fundamentals of Data Visualization (clauswilke.com) Figure 3.5: Population numbers of Texas counties relative to their median value. Select counties are highlighted by name. The dashed line indicates a ratio of 1, corresponding to a county with median population number. The most populous counties have approximately 100 times more inhabitants than the median county, and the least populous counties have approximately 100 times fewer inhabitants than the median county. Data source: 2010 Decennial U.S. Census. See Whatâ€™s Going On in This Graph? | Vaccination by Country fromWhat Data Shows About Vaccine Supply and Demand in the Most Vulnerable Places - The New York Times (nytimes.com) The original chart is animated along the timeline.What Data Shows About Vaccine Supply and Demand in the Most Vulnerable Places - The New York Times (nytimes.com) 8.2 Log-scale raw &lt;- read_csv(&quot;data/opendata107Y020.csv&quot;, show_col_types = FALSE) %&gt;% slice(-1) %&gt;% type_convert() toplot &lt;- raw %&gt;% select(site_id, village, edu_age_15up_total) %&gt;% arrange(desc(edu_age_15up_total)) %&gt;% mutate(index = row_number()) %&gt;% mutate(label = ifelse(index &lt;= 5 | index &gt; n()-5, paste0(site_id, village), &quot;&quot;)) library(ggrepel) p2 &lt;- toplot %&gt;% ggplot() + aes(index, edu_age_15up_total) + geom_point(alpha=0.5, color=&quot;royalblue&quot;) + geom_text_repel(aes(label = label), point.padding = .4, color = &quot;black&quot;, min.segment.length = 0, family = &quot;Heiti TC Light&quot;) + theme(axis.text.x=element_blank()) + scale_y_log10(breaks = c(0, 1, 10, 100, 1000, 10000)) + theme_minimal() p1 &lt;- toplot %&gt;% ggplot() + aes(index, edu_age_15up_total) + geom_point(alpha=0.5, color=&quot;royalblue&quot;) + theme(axis.text.x=element_blank()) + theme_minimal() cowplot::plot_grid( p2, NULL, p1, labels = c(&quot;a&quot;, &quot;&quot;, &quot;b&quot;), nrow = 1, rel_widths = c(1, 0.1, 1) ) 8.3 Square-root scale Chap3 Coordination &amp; Axis Fundamentals of Data Visualization (clauswilke.com) Figure 3.8: Areas of Northeastern U.S. states. (a) Areas shown on a linear scale. (b) Areas shown on a square-root scale. Data source: Google. å‰é¢æ˜¯è¦–è¦ºåŒ–äº†å„æ‘é‡Œå¤§æ–¼åäº”æ­²ä»¥ä¸Šäººå£çš„äººå£æ•¸åˆ†ä½ˆï¼Œæ¡ç”¨å°æ•¸å°ºåº¦ï¼ˆlog-scaleï¼‰å¯ä»¥è§€å¯Ÿåˆ°æ¯”è¼ƒå°çš„æ‘é‡Œã€‚é‚£æœ‰ä»€éº¼æ˜¯é©åˆç”¨å¹³æ–¹æ ¹å°ºåº¦ï¼ˆsqrt-scaleï¼‰çš„å‘¢ï¼Ÿæ˜¯åœŸåœ°å—ï¼Ÿå¯†åº¦å—ï¼Ÿé‚„æ˜¯äººå£æ•¸ï¼Ÿæ˜¯æ‘é‡Œç­‰ç´šå—ï¼Ÿé„‰é®å¸‚å€ç­‰ç´šå—ï¼Ÿé‚„æ˜¯ç¸£å¸‚ç­‰ç´šï¼Ÿ town &lt;- read_csv(&quot;data/tw_population_opendata110N010.csv&quot;) %&gt;% slice(-1, -(370:375)) %&gt;% type_convert() town %&gt;% arrange(desc(area)) %&gt;% mutate(index = row_number()) %&gt;% ggplot() + aes(index, area) %&gt;% geom_col(fill=&quot;skyblue&quot;) + scale_y_sqrt() + theme_minimal() Figure 8.1: (ref:population-area) county &lt;- town %&gt;% mutate(county = str_sub(site_id, 1, 3)) %&gt;% group_by(county) %&gt;% summarize( area = sum(area), people_total = sum(people_total) ) %&gt;% ungroup() p1 &lt;- county %&gt;% arrange(desc(people_total)) %&gt;% mutate(index = row_number()) %&gt;% ggplot() + aes(index, people_total) %&gt;% geom_col(fill=&quot;lightgrey&quot;) + # scale_y_sqrt() + theme_minimal() p2 &lt;- county %&gt;% arrange(desc(people_total)) %&gt;% mutate(index = row_number()) %&gt;% ggplot() + aes(index, people_total) %&gt;% geom_col(fill=&quot;khaki&quot;) + scale_y_sqrt(breaks=c(0, 250000, 500000, 1000000, 2000000, 4000000)) + theme_minimal() cowplot::plot_grid( p1, p2, labels = c(&quot;a&quot;, &quot;b&quot;), nrow = 1 ) Figure 8.2: (ref:population-area) 8.4 TW-Salary (boxplot) Inspired by Six Myths About Choosing a College Major - The New York Times (nytimes.com) and Whatâ€™s Going On in This Graph? | Jan.Â 9, 2018 - The New York Times (nytimes.com) library(readxl) raw &lt;- read_excel(&quot;data/tw_salary109.xlsx&quot;, sheet=1, trim_ws = T) raw ## # A tibble: 29 Ã— 5 ## Category Q1 Median Q3 Mean ## &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 ç”· 39 53.2 82.3 70.7 ## 2 å¥³ 35.1 46.8 67.6 58.6 ## 3 æœªæ»¿25æ­² 28.1 35.8 45.1 37.7 ## 4 25-29æ­² 36.6 47.8 61.7 53 ## 5 30-39æ­² 39.2 53.3 77 64.1 ## 6 40-49æ­² 39.9 56.9 91.8 74.8 ## 7 50-64æ­² 37.8 53.3 88.4 75.5 ## 8 65æ­²ä»¥ä¸Š 30.6 40.9 63.1 62.6 ## 9 åœ‹ä¸­åŠä»¥ä¸‹ 32.7 40.5 52 45.4 ## 10 é«˜ä¸­ï¼ˆè·ï¼‰ 34.5 44.7 59.8 51.9 ## # â€¦ with 19 more rows raw %&gt;% slice(-(1:12)) %&gt;% mutate(Category = reorder(Category, desc(Median))) %&gt;% ggplot() + aes(y = Category, xlower=Q1, xmiddle=Median, xupper=Q3, xmin=0, xmax=150) + geom_boxplot(stat = &quot;identity&quot;, color=&quot;white&quot;, fill=&quot;skyblue&quot;) + geom_point(aes(x = Mean)) + th + theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank()) 8.5 TW-Income (boxplot) library(gghighlight) toplot &lt;- read_csv(&quot;data/tw_income_107.csv&quot;, ) %&gt;% filter(!`æ‘é‡Œ` %in% c(&quot;åˆè¨ˆ&quot;, &quot;å…¶ä»–&quot;, &quot;ç¦ä½é‡Œ&quot;)) %&gt;% filter(é„‰é®å¸‚å€ %in% c(&quot;ä¿¡ç¾©å€&quot;)) %&gt;% mutate(æ‘é‡Œ = reorder(æ‘é‡Œ, desc(ä¸­ä½æ•¸))) toplot %&gt;% mutate(group = if_else((å¹³å‡æ•¸&gt;ç¬¬ä¸‰åˆ†ä½æ•¸), &quot;highlight&quot;, &quot;none&quot;)) %&gt;% ggplot() + aes(y = æ‘é‡Œ, xlower=ç¬¬ä¸€åˆ†ä½æ•¸, xmiddle=ä¸­ä½æ•¸, xupper=ç¬¬ä¸‰åˆ†ä½æ•¸, xmin= min(ç¬¬ä¸€åˆ†ä½æ•¸), xmax=max(ç¬¬ä¸‰åˆ†ä½æ•¸), fill=group) + geom_boxplot(stat = &quot;identity&quot;, color=&quot;white&quot;) + scale_fill_manual(values = c(&quot;highlight&quot;=&quot;orangered&quot;, &quot;none&quot;=&quot;skyblue&quot;)) + guides(fill=FALSE) + geom_point(aes(x = å¹³å‡æ•¸)) + xlab(&quot;å¹´æ‰€å¾—ï¼ˆå–®ä½ï¼šåƒå…ƒï¼‰&quot;) + th + theme(panel.grid.minor = element_blank(), panel.grid.major = element_blank()) "],["wgoigt-of-nytimes.html", "Chapter 9 WGOIGT of NyTimes 9.1 Net Worth by Age Group 9.2 UNICEF-Optimistic 9.3 Global Carbon Projects", " Chapter 9 WGOIGT of NyTimes library(tidyverse) library(gghighlight) 9.1 Net Worth by Age Group LEARNING NOTES Median for Inequality é€™å€‹æ•™å­¸æ¡ˆä¾‹ä¾†è‡ªç´ç´„æ™‚å ±çš„ã€ŒWhatâ€™s going on in this graghã€ç³»åˆ—è³‡æ–™è¦–è¦ºåŒ–æ•™å­¸ä¹‹Teach About Inequality With These 28 New York Times Graphs - The New York Times (nytimes.com) ã€‚è©²åœ–è¡¨å‘ˆç¾åœ¨ä¸åŒå¹´ä»£ã€ä¸åŒå¹´é½¡å±¤çš„äººæ‰€æ“æœ‰çš„æ·¨è³‡ç”¢ï¼ˆåŒ…å«åœŸåœ°ã€å­˜æ¬¾ã€æŠ•è³‡ç­‰æ¸›å»å‚µå‹™ï¼‰ã€‚è©²åœ–è¡¨çš„çµæœæŒ‡å‡ºï¼Œåœ¨ä¸åŒå¹´ä»£çš„è€å¹´äººæ˜¯è¶Šä¾†è¶Šæœ‰éŒ¢ï¼Œä½†å¹´è¼•äººå»è¶Šä¾†è¶Šçª®ï¼ˆè©²æ›²ç·šç‚ºæ¸›å»1989å¹´ 9.1.1 Read and sort data Sorted by arrange() function. p1 &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(year, Category, Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% ungroup() p1 %&gt;% filter(year &lt;= 1992) %&gt;% knitr::kable() year Category Net_Worth 1989 Less than 35 16.17019 1989 35-44 112.47530 1989 45-54 195.11630 1989 55-64 195.25554 1989 65-74 154.34277 1989 75 or older 144.29855 1992 Less than 35 16.60780 1992 35-44 79.91050 1992 45-54 139.97745 1992 55-64 203.44104 1992 65-74 176.44667 1992 75 or older 155.35173 p1 %&gt;% ggplot() + aes(year, Net_Worth, color = Category) + geom_line(linetype=&quot;dotted&quot;) + geom_point() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;, size = 0.5, linetype = &quot;solid&quot;)) p2 &lt;- read_csv(&quot;nytdata/interactive_bulletin_charts_agecl_median.csv&quot;) %&gt;% select(year, Category, NW = Net_Worth) %&gt;% group_by(Category) %&gt;% arrange(year) %&gt;% mutate(increase = (NW-first(NW))/first(NW)) %&gt;% ungroup() p2 %&gt;% filter(year &lt;= 1992) %&gt;% knitr::kable() year Category NW increase 1989 Less than 35 16.17019 0.0000000 1989 35-44 112.47530 0.0000000 1989 45-54 195.11630 0.0000000 1989 55-64 195.25554 0.0000000 1989 65-74 154.34277 0.0000000 1989 75 or older 144.29855 0.0000000 1992 Less than 35 16.60780 0.0270627 1992 35-44 79.91050 -0.2895285 1992 45-54 139.97745 -0.2825948 1992 55-64 203.44104 0.0419220 1992 65-74 176.44667 0.1432131 1992 75 or older 155.35173 0.0765994 p2 %&gt;% ggplot() + aes(year, increase, color = Category) + geom_line(linetype=&quot;dotted&quot;) + geom_point() + gghighlight(Category %in% c(&quot;65-74&quot;, &quot;35-44&quot;)) + theme_minimal() + scale_y_continuous(labels=scales::parse_format()) + scale_x_continuous(breaks = NULL) + theme(panel.background = element_rect(fill = &quot;white&quot;, colour = &quot;white&quot;, size = 0.5, linetype = &quot;solid&quot;)) 9.2 UNICEF-Optimistic https://www.nytimes.com/2021/11/17/upshot/global-survey-optimism.html https://changingchildhood.unicef.org/about plot.opt &lt;- read_csv(&quot;nytdata/unicef-changing-childhood-data.csv&quot;) %&gt;% select(country = WP5, age = WP22140, bw = WP22092) %&gt;% mutate(country = ordered(country, levels=c(1, 3, 4, 10, 11, 12, 13, 14, 17, 29, 31, 33, 35, 36, 60, 61, 77, 79, 81, 87, 165), labels=c(&quot;USA&quot;, &quot;Morocco&quot;, &quot;Lebanon&quot;, &quot;Indonesia&quot;, &quot;Bangladesh&quot;, &quot;UK&quot;, &quot;France&quot;, &quot;Germany&quot;, &quot;Spain&quot;, &quot;Japan&quot;, &quot;India&quot;, &quot;Brazil&quot;, &quot;Nigeria&quot;, &quot;Kenya&quot;, &quot;Ethiopia&quot;, &quot;Mali&quot;, &quot;Ukraine&quot;, &quot;Cameroon&quot;, &quot;Zimbabwe&quot;, &quot;Argentina&quot;, &quot;Peru&quot;))) %&gt;% count(country, age, bw) %&gt;% group_by(country, age) %&gt;% mutate(perc = n/sum(n)) %&gt;% ungroup() %&gt;% filter(bw == 1) %&gt;% select(country, age, perc) %&gt;% spread(age, perc) %&gt;% rename(`15-24y` = `1`, `40+y` = `2`) plot.opt %&gt;% head(10) %&gt;% knitr::kable() country 15-24y 40+y USA 0.6679842 0.4611465 Morocco 0.4365079 0.4735812 Lebanon 0.5467197 0.4435798 Indonesia 0.7920605 0.8027344 Bangladesh 0.4624506 0.4319527 UK 0.5040000 0.4140000 France 0.3900000 0.2640000 Germany 0.5900000 0.3860000 Spain 0.5160000 0.3340000 Japan 0.6367265 0.2586873 plot.opt %&gt;% ggplot() + aes(`40+y`, `15-24y`, label = country) + geom_point(color = &quot;skyblue&quot;, size = 2) + xlim(0, 1) + ylim(0,1) + geom_text(hjust = -0.1, vjust = -0.5) + geom_abline(intercept = 0, slop = 1, color=&quot;lightgrey&quot;, alpha=0.5, linetype=&quot;dashed&quot;) + theme_minimal() + theme(aspect.ratio=1) 9.3 Global Carbon Projects Who Has The Most Historical Responsibility for Climate Change? - The New York Times (nytimes.com) totreemap &lt;- read_csv(&quot;nytdata/GCB2021v34_MtCO2_flat.csv&quot;) %&gt;% drop_na(`Total`) %&gt;% filter(!Country %in% c(&quot;Global&quot;, &quot;International Transport&quot;)) %&gt;% filter(Year==2020) %&gt;% arrange(desc(`Total`)) %&gt;% mutate(perc = Total/sum(Total)) %&gt;% slice(1:20) library(treemapify) totreemap %&gt;% ggplot() + aes(area = perc, fill=`Per Capita`, label=Country) + geom_treemap() + geom_treemap_text(color=&quot;white&quot;, place=&quot;centre&quot;, grow=TRUE ) "],["text-processing.html", "Chapter 10 Text Processing 10.1 Tweets åˆ†æ", " Chapter 10 Text Processing 10.1 Tweets åˆ†æ æ‡‰ç”¨dplyrå’Œggplotåšç¤¾ç¾¤è¼¿è«–è³‡æ–™ï¼ˆtweetsï¼‰çš„æ¢ç´¢æ€§åˆ†æï¼Œå…¶ä¸­é™¤äº†dplyrå’Œggplotå¤–ï¼Œå°šç”¨åˆ°æ–‡å­—è™•ç†ï¼ˆstringr, extract()ï¼‰ã€æ™‚é–“è™•ç†ï¼ˆlubridateï¼‰ï¼Œç”šè‡³åŒ…å«ä¸€é»keynessåˆ†æï¼Œç‚ºæ‰¾å‡ºå…©å€‹ç¾¤é«”æ–‡æœ¬ä¸­ï¼Œå°å½¼æ­¤ç›¸å°çªå‡ºé—œéµå­—çš„æ–‡æœ¬æ¢å‹˜æ–¹æ³•ã€‚ æœ¬ç¯„ä¾‹å–æè‡ªDavid Robinsonçš„blogæ–‡ç« ã€ŒText analysis of Trumpâ€™s tweets confirms he writes only the (angrier) Android halfã€ã€‚David Robinsonæ˜¯ã€ŒText Mining with Rã€çš„å…±åŒä½œè€…ï¼Œ å¯åƒè€ƒè©²æ›¸ç±ä¸Šçš„ç¯„ä¾‹ã€Œ7 Case study: comparing Twitter archives | Text Mining with R (tidytextmining.com)ã€ã€‚ 10.1.1 è¼‰å…¥ä¸¦æ¸…ç†è³‡æ–™ R4.0å¾ŒstringsAsFactors=Fè®Šç‚ºé è¨­å€¼ï¼Œä¾¿ä¸ç”¨å†å¦è¡Œç”¨options()è¨­ç‚ºå…¨åŸŸé©ç”¨çš„åƒæ•¸ã€‚ library(tidyverse) library(lubridate) options(scipen = 999) th &lt;- theme_minimal() + theme(plot.title = element_text(size=24, face=&quot;bold&quot;), legend.title = element_text(size=18, face=&quot;bold&quot;), legend.text = element_text(size=18), axis.title = element_text(hjust=0.5, size=18, face=&quot;italic&quot;), axis.text = element_text(size=18) ) new_style &lt;- function() { font &lt;- &quot;Helvetica&quot; theme( plot.title = element_text(family=font, size=28, face=&quot;bold&quot;), plot.subtitle = element_text(family=font, size=22, margin=margin(9,0,9,0)), plot.caption = element_blank(), legend.position = &quot;top&quot;, legend.text.align = 0, legend.background = element_blank(), # legend.title = element_blank(), legend.key = element_blank(), legend.text = element_text(family=font, size=18, color=&quot;#222222&quot;), axis.text = element_text(family=font, size=18, color=&quot;#222222&quot;), axis.text.x = element_text(margin=margin(5, b = 10)), axis.ticks = element_blank(), axis.line = element_blank(), panel.grid.minor = element_blank(), panel.grid.major.y = element_line(color=&quot;#cbcbcb&quot;), panel.grid.major.x = element_blank(), panel.background = element_blank(), strip.background = element_rect(fill=&quot;white&quot;), strip.text = element_text(size = 22, hjust = 0) ) } load(url(&quot;http://varianceexplained.org/files/trump_tweets_df.rda&quot;)) dim(trump_tweets_df) ## [1] 1512 16 names(trump_tweets_df) ## [1] &quot;text&quot; &quot;favorited&quot; &quot;favoriteCount&quot; &quot;replyToSN&quot; ## [5] &quot;created&quot; &quot;truncated&quot; &quot;replyToSID&quot; &quot;id&quot; ## [9] &quot;replyToUID&quot; &quot;statusSource&quot; &quot;screenName&quot; &quot;retweetCount&quot; ## [13] &quot;isRetweet&quot; &quot;retweeted&quot; &quot;longitude&quot; &quot;latitude&quot; trump_tweets_df %&gt;% select(id, text, created, favoriteCount, retweetCount, statusSource) %&gt;% head(20) ## # A tibble: 20 Ã— 6 ## id text created favoriteCount retweetCount statusSource ## &lt;chr&gt; &lt;chr&gt; &lt;dttm&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; ## 1 7626698825â€¦ &quot;My â€¦ 2016-08-08 15:20:44 9214 3107 &quot;&lt;a href=\\&quot;â€¦ ## 2 7626415954â€¦ &quot;Joiâ€¦ 2016-08-08 13:28:20 6981 2390 &quot;&lt;a href=\\&quot;â€¦ ## 3 7624396589â€¦ &quot;#ICâ€¦ 2016-08-08 00:05:54 15724 6691 &quot;&lt;a href=\\&quot;â€¦ ## 4 7624253718â€¦ &quot;Micâ€¦ 2016-08-07 23:09:08 19837 6402 &quot;&lt;a href=\\&quot;â€¦ ## 5 7624008698â€¦ &quot;Theâ€¦ 2016-08-07 21:31:46 34051 11717 &quot;&lt;a href=\\&quot;â€¦ ## 6 7622845333â€¦ &quot;I sâ€¦ 2016-08-07 13:49:29 29831 9892 &quot;&lt;a href=\\&quot;â€¦ ## 7 7621109187â€¦ &quot;Thaâ€¦ 2016-08-07 02:19:37 19223 5784 &quot;&lt;a href=\\&quot;â€¦ ## 8 7621069044â€¦ &quot;.@Lâ€¦ 2016-08-07 02:03:39 19543 7930 &quot;&lt;a href=\\&quot;â€¦ ## 9 7621044117â€¦ &quot;I aâ€¦ 2016-08-07 01:53:45 75488 24663 &quot;&lt;a href=\\&quot;â€¦ ## 10 7620164261â€¦ &quot;#Crâ€¦ 2016-08-06 20:04:08 23661 7903 &quot;&lt;a href=\\&quot;â€¦ ## 11 7619881643â€¦ &quot;Heaâ€¦ 2016-08-06 18:11:50 28069 8561 &quot;&lt;a href=\\&quot;â€¦ ## 12 7619369299â€¦ &quot;Anyâ€¦ 2016-08-06 14:48:14 35205 13129 &quot;&lt;a href=\\&quot;â€¦ ## 13 7619310105â€¦ &quot;Croâ€¦ 2016-08-06 14:24:43 36936 13250 &quot;&lt;a href=\\&quot;â€¦ ## 14 7618928294â€¦ &quot;Hilâ€¦ 2016-08-06 11:53:00 32716 9356 &quot;&lt;a href=\\&quot;â€¦ ## 15 7617735761â€¦ &quot;Gooâ€¦ 2016-08-06 03:59:08 34109 10385 &quot;&lt;a href=\\&quot;â€¦ ## 16 7617579885â€¦ &quot;&#39;Trâ€¦ 2016-08-06 02:57:11 19436 8066 &quot;&lt;a href=\\&quot;â€¦ ## 17 7617548986â€¦ &quot;Thaâ€¦ 2016-08-06 02:44:55 19330 5418 &quot;&lt;a href=\\&quot;â€¦ ## 18 7617118564â€¦ &quot;DONâ€¦ 2016-08-05 23:53:53 30869 16786 &quot;&lt;a href=\\&quot;â€¦ ## 19 7616938031â€¦ &quot;Thaâ€¦ 2016-08-05 22:42:08 19431 5681 &quot;&lt;a href=\\&quot;â€¦ ## 20 7616538754â€¦ &quot;#Maâ€¦ 2016-08-05 20:03:29 27568 13869 &quot;&lt;a href=\\&quot;â€¦ 10.1.2 èƒå–è³‡æ–™ Extracting publishing device of tweets # tidyr::extract() # stringr::str_replace trump_tweets_df$statusSource[1] ## [1] &quot;&lt;a href=\\&quot;http://twitter.com/download/android\\&quot; rel=\\&quot;nofollow\\&quot;&gt;Twitter for Android&lt;/a&gt;&quot; tweets &lt;- trump_tweets_df %&gt;% select(id, statusSource, text, created) %&gt;% # mutate(source = str_replace(statusSource, # &quot;.*Twitter for (.*?)&lt;.*&quot;, &quot;\\\\1&quot;)) %&gt;% # mutate(source = str_extract(statusSource, &#39;Twitter for (.*?)&lt;&#39;)) %&gt;% View extract(statusSource, &quot;source&quot;, &quot;Twitter for (.*?)&lt;&quot;) %&gt;% filter(source %in% c(&quot;iPhone&quot;, &quot;Android&quot;)) # Using stringr::str_replace() to mutate a new source variable, replacing tidyr:: # str(tweets) 10.1.3 è¦–è¦ºåŒ–æ¢ç´¢ 10.1.3.1 ç™¼æ–‡æ™‚é–“ Converting timezone lubridate::with_tz() Extracting hour of timestamp by lubridate::hour() Plotting number of tweets by hour Display y-axis as percentage by scales::percent_format() library(scales) # for percent_format() # lubridate::hour() # lubridate::with_tz() # scales::percent_format() toplot1 &lt;- tweets %&gt;% count(source, hour = hour(with_tz(created, &quot;EST&quot;))) %&gt;% # group_by(source) %&gt;% mutate(percent = n / sum(n)) # ungroup() %&gt;% toplot2 &lt;- tweets %&gt;% count(source, hour = hour(with_tz(created, &quot;EST&quot;))) %&gt;% group_by(source) %&gt;% mutate(percent = n / sum(n)) %&gt;% ungroup() p1 &lt;- toplot1 %&gt;% ggplot() + aes(hour, percent, color = source) + geom_line(size = 1) + scale_color_manual(name = &quot;Phone System&quot;, labels = c(&quot;Android&quot;, &quot;iPhone&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + scale_y_continuous(labels = percent_format()) + labs(x = &quot;Hour of day (EST)&quot;, y = &quot;% of tweets&quot;, color = &quot;&quot;) + theme_minimal() p2 &lt;- toplot2 %&gt;% ggplot() + aes(hour, percent, color = source) + geom_line(size = 1) + scale_color_manual(name = &quot;Phone System&quot;, labels = c(&quot;Android&quot;, &quot;iPhone&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + scale_y_continuous(labels = percent_format()) + labs(x = &quot;Hour of day (EST)&quot;, y = &quot;% of tweets&quot;, color = &quot;&quot;) + theme_minimal() cowplot::plot_grid( p1, NULL, p2, labels = c(&quot;(a) Normalized by all&quot;, &quot;&quot;, &quot;(b) Normalized in group&quot;), nrow = 1, rel_widths = c(1, 0.1, 1) ) 10.1.3.2 ç™¼æ–‡é™„åœ– Filtering out tweets starting with \" (those tweets mention #realdonaldtrump) Mutating new variable picture to indicate whether text has picture or not? Counting source by picture Plotting bar chart to compare difference between sources. # library(stringr) toplot &lt;- tweets %&gt;% filter(!str_detect(text, &#39;^&quot;&#39;)) %&gt;% mutate(picture = if_else(str_detect(text, &quot;t.co&quot;), &quot;Picture/link&quot;, &quot;No picture/link&quot;)) %&gt;% count(source, picture) p1 &lt;- toplot %&gt;% ggplot() + aes(source, n, fill = picture) + geom_col(position=&quot;stack&quot;, width = 0.5) + scale_fill_manual(name = &quot;With Picture/link?&quot;, labels = c(&quot;Yes&quot;, &quot;No&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + labs(x = &quot;&quot;, y = &quot;Number of tweets&quot;, fill = &quot;&quot;) + theme_minimal() p2 &lt;- toplot %&gt;% ggplot() + aes(source, n, fill = picture) + geom_col(position=&quot;dodge&quot;) + scale_fill_manual(name = &quot;With Picture/link?&quot;, labels = c(&quot;Yes&quot;, &quot;No&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + labs(x = &quot;&quot;, y = &quot;Number of tweets&quot;, fill = &quot;&quot;) + theme_minimal() cowplot::plot_grid( p1, NULL, p2, labels = c(&quot;(a) Stacked&quot;, &quot;&quot;, &quot;(b) Dodged&quot;), nrow = 1, rel_widths = c(1, 0.1, 1) ) 10.1.4 Keyness library(tidytext) # unnest_tokens() library(stringr) # str_detect(), str_replace_all() # View(test) # stop_words$word tweet_words &lt;- tweets %&gt;% filter(!str_detect(text, &#39;^&quot;&#39;)) %&gt;% mutate(text = str_replace_all(text, &quot;https://t.co/[A-Za-z\\\\d]+|&amp;amp;&quot;, &quot;&quot;)) %&gt;% # unnest_tokens(word, text) %&gt;% # unnest_tokens(word, text, token = &quot;regex&quot;, pattern = &quot;[^A-Za-z\\\\d#@&#39;]&quot;) %&gt;% mutate(word = str_split(text, &quot; &quot;)) %&gt;% select(id, text, word, everything()) %&gt;% unnest(word) %&gt;% filter(!word %in% stop_words$word, str_detect(word, &quot;[a-z]&quot;)) # View(tweet_words) tweet_words %&gt;% count(word, sort = TRUE) %&gt;% head(20) %&gt;% mutate(word = reorder(word, n)) %&gt;% ggplot(aes(word, n)) + geom_col(fill = &quot;royalblue&quot;) + ylab(&quot;Occurrences&quot;) + coord_flip() + theme_minimal() + theme(axis.text = element_text(size=10)) 10.1.4.1 è©é »å·®ç•° test &lt;- tweet_words %&gt;% count(word, source) %&gt;% filter(n &gt;= 5) %&gt;% pivot_wider(names_from = source, values_from = n, values_fill = 0) # View(test) word_by_source &lt;- tweet_words %&gt;% count(word, source) %&gt;% filter(n &gt;= 5) %&gt;% pivot_wider(names_from = source, values_from = n, values_fill = 0) %&gt;% # spread(source, n, fill = 0) %&gt;% ungroup() sum(word_by_source$iPhone) ## [1] 1383 sum(word_by_source$Android) ## [1] 2132 android_iphone_ratios &lt;- word_by_source %&gt;% mutate(iPhone = (iPhone+1)/sum(iPhone+1)) %&gt;% mutate(Android = (Android+1)/sum(Android+1)) %&gt;% # mutate_at(.cols = vars(iPhone, Android), # .funs = funs((. + 1) / sum(. + 1))) %&gt;% mutate(logratio = log2(Android / iPhone)) %&gt;% arrange(desc(logratio)) 10.1.4.2 è¦–è¦ºåŒ–log-ratio android_iphone_ratios %&gt;% group_by(logratio &gt; 0) %&gt;% top_n(15, abs(logratio)) %&gt;% ungroup() %&gt;% mutate(word = reorder(word, logratio)) %&gt;% ggplot(aes(word, logratio, fill = logratio &lt; 0)) + geom_col() + coord_flip() + ylab(&quot;Android / iPhone log ratio&quot;) + scale_fill_manual(name = &quot;&quot;, labels = c(&quot;Android&quot;, &quot;iPhone&quot;), values = c(&quot;royalblue&quot;, &quot;gold&quot;)) + theme_minimal() + theme(axis.text = element_text(size=14)) "],["crawler.html", "Chapter 11 Crawler 11.1 Scraping 104.com", " Chapter 11 Crawler 11.1 Scraping 104.com 11.1.1 Complete Code library(tidyverse) library(httr) library(jsonlite) # options(stringsAsFactors = F) all.df &lt;- tibble() refer_url &lt;- &quot;https://www.104.com.tw&quot; for(p in 1:10){ url &lt;- str_c(&#39;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8&amp;order=12&amp;asc=0&amp;page=&#39;, p, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) print(p) res &lt;- GET(url, add_headers(&quot;referer&quot;=refer_url)) %&gt;% content(&quot;text&quot;) %&gt;% fromJSON() res$data$list$tags &lt;- NULL res$data$list$link &lt;- NULL all.df &lt;- bind_rows(all.df, res$data$list) } all.df$jobNo %&gt;% unique %&gt;% length 11.1.2 Step-by-Step 11.1.2.1 Get the first pages Must loading the second page url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Assigning the 2nd page data url to url2 url2 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E8%B3%87%E6%96%99%E7%A7%91%E5%AD%B8&amp;order=14&amp;asc=0&amp;page=2&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Assigning the 3rd page data url to url3 url3 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=3&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Getting back the url1 data, assigning to result1 res &lt;- GET(url2, config = add_headers(&quot;Referer&quot; = &quot;https://www.104.com.tw/&quot;)) res1 &lt;- content(res, &quot;text&quot;) %&gt;% fromJSON() result2 &lt;- fromJSON(content(GET(url2), &quot;text&quot;)) # Tracing variable result2 and finding the data.frame, assigning to df2 df2 &lt;- res1$data$list 11.1.2.2 Get the first page by modifying url # Guessing the 1st page data url to url1 url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Getting back the 1st page data url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; result1 &lt;- fromJSON(content(GET(url1), &quot;text&quot;)) df1 &lt;- result1$data$list 11.1.2.3 Combine two data with the same variables # all.df &lt;- bind_rows(df1, df2) # will raise error # Error in bind_rows_(x, .id) : # Argument 31 can&#39;t be a list containing data frames 11.1.2.4 Drop out hierarchical variables Preserving numeric or character, dropping list of data.frame by assigning NULL to the variable # Drop list and data.frame inside the data.frame df1$link &lt;- NULL df1$tags &lt;- NULL df2$link &lt;- NULL df2$tags &lt;- NULL # Re-binding two data.frame df1 and df2 all.df &lt;- bind_rows(df1, df2) 11.1.2.5 Dropping hierarchical variables by dplyr way # Getting the 1st page data and dropping variable tags and link # Assigning to df1 df1 &lt;- result1$data$list %&gt;% select(-tags, -link) # Getting the 2nd page data and dropping variable tags and link # Assigning to df2 df2 &lt;- result2$data$list %&gt;% select(-tags, -link) # binding df1 and df2 all.df &lt;- bind_rows(df1, df2) 11.1.2.6 Finding out the last page number # Tracing the number of pages in result1 last_page_num &lt;- result1$data$totalPage # Checking the availability of the last page # Examining if the last page data available by re-composing URL with paste0() url.last_page &lt;- paste0(&quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=&quot;, last_page_num, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) # Getting back and parsing the last page data result.last_page &lt;- fromJSON(content(GET(url.last_page), &quot;text&quot;)) 11.1.2.7 Using for-loop to get all pages for(p in 1:last_page_num){ url &lt;- paste0(&quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=&quot;, p, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) result &lt;- fromJSON(content(GET(url), &quot;text&quot;)) temp.df &lt;- select(result$data$list) print(paste(p, nrow(temp.df))) } 11.1.2.8 combine all data.frame # The 1st url of the query url1 &lt;- &quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=1&amp;mode=s&amp;jobsource=2018indexpoc&quot; # Getting back the 1st page data result1 &lt;- fromJSON(content(GET(url1), &quot;text&quot;)) # Tracing and getting total number of page last_page_num &lt;- result1$data$totalPage # Truncating hierarchical variables: link and tags all.df &lt;- select(result1$data$list, -link, -tags) # for-loop to getting back data and joining them for(p in 1:last_page_num){ url &lt;- paste0(&quot;https://www.104.com.tw/jobs/search/list?ro=0&amp;kwop=7&amp;keyword=%E7%88%AC%E8%9F%B2&amp;order=1&amp;asc=0&amp;page=&quot;, p, &quot;&amp;mode=s&amp;jobsource=2018indexpoc&quot;) result &lt;- fromJSON(content(GET(url), &quot;text&quot;)) temp.df &lt;- select(result$data$list) all.df &lt;- bind_rows(all.df, temp.df) print(paste(p, nrow(all.df))) } library(tidyverse) "],["visual-principles.html", "Chapter 12 Visual Principles 12.1 Dataset 12.2 Distribution: Histogram and Density plot", " Chapter 12 Visual Principles Most of contet in the chapter comes from the book Claus o. Wilkeâ€™s â€œFoundamentals of Data Visualizationâ€ 12.1 Dataset 111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—è¡¨.xls - 111Bæ­²å‡ºæ”¿äº‹åˆ¥é ç®—ç¸½è¡¨.xls è‡ºåŒ—å¸‚ä½å®…ç«Šç›œé»ä½è³‡è¨Š-UTF8-BOM-1.csv opendata107Y020.csv opendata110Y060.csv tptheft.csv tw_income_107.csv tw_population_opendata110N010.csv tw_salary109.xlsx villmast_excel.xls WORLD-MACHE_Gender_6.8.15.xls 12.2 Distribution: Histogram and Density plot vilmaster &lt;- readr::read_csv(&quot;data/tw_vil2018_elccand.csv&quot;) %&gt;% drop_na(ç•¶é¸è¨»è¨˜) 12.2.1 Density plot p1 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density() + th p2 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_density(alpha=0.5) + th + scale_fill_manual( limits=c(&#39;1&#39;, &#39;2&#39;), # original chart group values=c(&quot;gold&quot;, &quot;skyblue&quot;), # map to color name=&quot;æ€§åˆ¥&quot;, # legend title breaks=c(1, 2), # original legend group labels labels=c(&quot;Male&quot;,&quot;Female&quot;), # map to new labels na.value = &quot;lightgrey&quot; # color for other groups ) cowplot::plot_grid( p1, p2, labels = c(&quot;(a) Overall&quot;, &quot;(b) Group by gender&quot;), nrow = 1, rel_widths = c(1, 1) ) 12.2.2 Density with different bandwidth library(ggridges) # for geom_density_line() p.b05 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=0.5, kernel=&#39;gaussian&#39;) + th p.b1 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=1, kernel=&#39;gaussian&#39;) + th p.b5 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=5, kernel=&#39;gaussian&#39;) + th p.rect &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_density_line(fill=&#39;gold&#39;, bw=8, kernel=&#39;rectangular&#39;) + th cowplot::plot_grid( p.b05, p.b1, p.b5, p.rect, labels = c(&quot;(a) bw=.5&quot;, &quot;(b) bw=1&quot;, &quot;(c) bw=2&quot;, &quot;(b) rect&quot;), nrow = 2, rel_widths = c(1, 1) ) 12.2.3 Histogram with different number of bins p10 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=10, fill=&#39;royalblue&#39;) + th p20 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=20, fill=&#39;royalblue&#39;) + th p30 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=30, fill=&#39;royalblue&#39;) + th p40 &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡) + geom_histogram(bins=40, fill=&#39;royalblue&#39;) + th cowplot::plot_grid( p10, p20, p30, p40, labels = c(&quot;(a) bins=10&quot;, &quot;(b) bins=20&quot;, &quot;(c) bins=30&quot;, &quot;(b) bins=40&quot;), nrow = 2, rel_widths = c(1, 1) ) 12.2.4 Density vs histogram pd &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_density(alpha=0.5) + th + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue&quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) ph &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;dodge&quot;) + th + scale_fill_manual(values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;)) + theme(legend.position=&quot;none&quot;) cowplot::plot_grid( pd, ph, labels = c(&quot;(a) geom_density()&quot;, &quot;(b) geom_histogram()&quot;), nrow = 1, rel_widths = c(6, 4) ) 12.2.5 Positions of bar chart p.hist.dodge &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;dodge&quot;) + th + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) p.hist.stack &lt;- vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;stack&quot;) + th + scale_fill_manual(values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;)) + theme(legend.position=&quot;none&quot;) cowplot::plot_grid( p.hist.dodge, p.hist.stack, labels = c(&quot;(a) position:dodge&quot;, &quot;(b) position:stack&quot;), nrow = 1, rel_widths = c(6, 4) ) 12.2.6 Display two groups histogram by facet_wrap() vilmaster %&gt;% ggplot() + aes(å¹´é½¡, fill=factor(æ€§åˆ¥)) + geom_histogram(bins=20, position=&quot;dodge&quot;) + th + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) + facet_wrap(.~æ€§åˆ¥, nrow=1) 12.2.7 Modify geom_col() to pyramid plot vilmaster %&gt;% group_by(æ€§åˆ¥) %&gt;% mutate(age_group = cut(å¹´é½¡, 0:20*5+.01)) %&gt;% count(age_group) %&gt;% ungroup() %&gt;% ggplot() + aes(x=age_group, y=ifelse(æ€§åˆ¥==&#39;1&#39;, -1, 1)*n, fill=factor(æ€§åˆ¥)) + geom_col() + scale_y_continuous(name = &quot;Count&quot;, breaks = 250*(-6:2), labels = c(&quot;1500&quot;, &quot;1250&quot;, &quot;1000&quot;, &quot;750&quot;, &quot;500&quot;, &quot;250&quot;, &quot;0&quot;, &quot;250&quot;, &quot;500&quot;)) + coord_flip() + scale_fill_manual( values=c(&quot;1&quot;=&#39;gold&#39;, &#39;2&#39;=&quot;skyblue &quot;), labels=c(&#39;1&#39;=&quot;Male&quot;,&#39;2&#39;=&quot;Female&quot;), name=&#39;Sex&#39; ) + th + labs(y=&quot;Count&quot;, x=&quot;Age Group&quot;) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
